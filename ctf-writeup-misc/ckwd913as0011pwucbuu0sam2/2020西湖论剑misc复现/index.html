<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>2020西湖论剑misc复现 | Damya&#39;s Blog | あややこやや</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="个人ctf竞赛">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="Damya's Blog" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>2020西湖论剑misc复现</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">2020西湖论剑misc复现</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-10-12T13:30:01.000Z" itemprop="datePublished" class="page-time">
  2020-10-12
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup-misc/">ctf writeup misc</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-2020西湖论剑misc复现"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">2020西湖论剑misc复现</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-10-12 21:30:01" datetime="2020-10-12T13:30:01.000Z"  itemprop="datePublished">2020-10-12</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup-misc/">ctf writeup misc</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做的时候就觉得题目阴间得一匹,没想到官方wp也这么阴间,原理呢?分析呢?不管怎么说看着就是不明不白脑洞也贼多,复现起来也怪怪的</p>
<h2 id="yusa-yyds"><a href="#yusa-yyds" class="headerlink" title="yusa_yyds"></a>yusa_yyds</h2><p>回过头仔细看时才注意到Xbox360提示,当时其实队友有注意到可能是xbox,我们还看了<a href="https://www.partsnotincluded.com/understanding-the-xbox-360-wired-controllers-usb-data/" target="_blank" rel="noopener">官方文档</a>,但想多了,注意力全放在提取出来的usbdata上,最后也没看懂</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./1.png" title="图片" data-fancybox="images"><img src="./1.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>xbox传入的信息在流量包的DEVICE DESCRIPTOR部分,以下截一个包分析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DEVICE DESCRIPTOR</span><br><span class="line">    bLength: 18</span><br><span class="line">    bDescriptorType: 0x01 (DEVICE)</span><br><span class="line">//设备描述符长度为18个字节</span><br><span class="line">    bcdUSB: 0x0200</span><br><span class="line">//控制器使用USB2.0</span><br><span class="line">    bDeviceClass: Vendor Specific (0xff)</span><br><span class="line">    bDeviceSubClass: 255</span><br><span class="line">    bDeviceProtocol: 255</span><br><span class="line">//设备的USB设备类别被设定为0xFF，子类设定为255,设备协议设定为255</span><br><span class="line">    bMaxPacketSize0: 8</span><br><span class="line">//端点0（设备控制端点）的最大数据包大小为8字节</span><br><span class="line">    idVendor: Microsoft Corp. (0x045e)</span><br><span class="line">    idProduct: Xbox360 Controller (0x028e)</span><br><span class="line">//供应商VID和PID信息信息</span><br><span class="line">    bcdDevice: 0x0114</span><br><span class="line">//供应商定义的版本号,被编码为二进制编码的十进制,使用8421编码可转为1.1.4版本</span><br><span class="line">    iManufacturer: 1</span><br><span class="line">    iProduct: 2</span><br><span class="line">    iSerialNumber: 3</span><br><span class="line">    bNumConfigurations: 1</span><br><span class="line">//描述制造商,产品,序列号的字符串在索引1,2,3,该设备只有1种配置</span><br></pre></td></tr></table></figure>
<p>通过time可以发现,中间断电缺失了一段时间的数据<br><figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./2.png" title="图片" data-fancybox="images"><img src="./2.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<p>然后wp里说的</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./3.png" title="图片" data-fancybox="images"><img src="./3.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>恕我直言没看懂,希望能有师傅教教我</p>
<p>下面是之前常规做法时提取的usbdata</p>
<p>提取usb流量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r game.pcapng -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>
<p>读取出来的usb流量,不是常规的键盘和鼠标敲击码<br>键盘一般是八位一组,第一二位都是00,第三位开始记录击键信息.</p>
<p>鼠标一般是四位一组,第一位代表按键,取00时没有按键,取01时按左键,取02时按右键;第二位可以看成是一个signed byte类型,最高位为符号位,当这个值为正时代表鼠标水平右移多少像素,为负时代表水平左移多少像素.第三位与第二位类似,代表垂直上下移动的偏移.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">01:00:00:00:65:00:00:00:00:00:00:53:00:00:00:00:00:00:00:00:00:00:05:04:00:00:00:00:00:00:00:45:00:00:05:00:00:00:04:00:02:0b:b8:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:01:06:00:00:00:08:00:00:00:05:25:03:78:ce:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:02:01:00:00:00:04:00:00:00:01</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">01:00:00:00:65:00:00:00:00:00:00:53:00:00:00:00:00:00:00:00:00:00:05:04:00:00:00:00:00:00:00:45:00:00:05:00:00:00:04:00:02:0b:b8:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:01:06:00:00:00:08:00:00:00:05:25:90:30:ce:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:02:01:00:00:00:04:00:00:00:02</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br></pre></td></tr></table></figure>
<h2 id="yusapapa"><a href="#yusapapa" class="headerlink" title="yusapapa"></a>yusapapa</h2><p>在网页注释里有提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Maybe these texts are really helpful for you</span><br><span class="line">Biometric list is OK!</span><br><span class="line">endow gremlin indulge bison flatfoot fallout goldfish bison hockey fracture fracture bison goggles jawbone bison flatfoot gremlin glucose glucose fracture flatfoot indoors gazelle gremlin goldfish bison guidance indulge keyboard keyboard glucose fracture hockey bison gazelle goldfish bison cement frighten gazelle goldfish indoors buzzard highchair fallout highchair bison fallout goldfish flytrap bison fallout goldfish gremlin indoors frighten fracture highchair bison cement fracture goldfish flatfoot gremlin flytrap fracture buzzard guidance goldfish freedom buzzard allow crowfoot jawbone bison indoors frighten fracture bison involve fallout jawbone Burbank indoors frighten fracture bison guidance gazelle flatfoot indoors indulge highchair fracture bison hockey frighten gremlin indulge flytrap bison flagpole fracture bison indulge hockey fracture flytrap bison allow blockade endow indulge hockey fallout blockade bison gazelle hockey bison inverse fracture highchair jawbone bison gazelle goggles guidance gremlin highchair indoors fallout goldfish indoors bison gazelle goldfish bison indoors frighten gazelle hockey bison flatfoot frighten fallout glucose glucose fracture goldfish freedom fracture blackjack blackjack</span><br></pre></td></tr></table></figure>
<p>去重整理列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">endow</span><br><span class="line">gremlin</span><br><span class="line">indulge</span><br><span class="line">bison</span><br><span class="line">flatfoot</span><br><span class="line">fallout</span><br><span class="line">goldfish</span><br><span class="line">hockey</span><br><span class="line">fracture</span><br><span class="line">goggles</span><br><span class="line">jawbone</span><br><span class="line">glucose</span><br><span class="line">indoors</span><br><span class="line">gazelle</span><br><span class="line">guidance</span><br><span class="line">keyboard</span><br><span class="line">cement</span><br><span class="line">frighten</span><br><span class="line">buzzard</span><br><span class="line">highchair</span><br><span class="line">flytrap</span><br><span class="line">freedom</span><br><span class="line">allow</span><br><span class="line">crowfoot</span><br><span class="line">involve</span><br><span class="line">Burbank</span><br><span class="line">flagpole</span><br><span class="line">blockade</span><br><span class="line">inverse</span><br><span class="line">blackjack</span><br></pre></td></tr></table></figure></p>
<p>根据PGP词汇表对应写个脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">a = <span class="string">"endow gremlin indulge bison flatfoot fallout goldfish bison hockey fracture fracture bison goggles jawbone bison flatfoot gremlin glucose glucose fracture flatfoot indoors gazelle gremlin goldfish bison guidance indulge keyboard keyboard glucose fracture hockey bison gazelle goldfish bison cement frighten gazelle goldfish indoors buzzard highchair fallout highchair bison fallout goldfish flytrap bison fallout goldfish gremlin indoors frighten fracture highchair bison cement fracture goldfish flatfoot gremlin flytrap fracture buzzard guidance goldfish freedom buzzard allow crowfoot jawbone bison indoors frighten fracture bison involve fallout jawbone Burbank indoors frighten fracture bison guidance gazelle flatfoot indoors indulge highchair fracture bison hockey frighten gremlin indulge flytrap bison flagpole fracture bison indulge hockey fracture flytrap bison allow blockade endow indulge hockey fallout blockade bison gazelle hockey bison inverse fracture highchair jawbone bison gazelle goggles guidance gremlin highchair indoors fallout goldfish indoors bison gazelle goldfish bison indoors frighten gazelle hockey bison flatfoot frighten fallout glucose glucose fracture goldfish freedom fracture blackjack blackjack"</span></span><br><span class="line">s = a.split(<span class="string">" "</span>)</span><br><span class="line">dict = &#123;<span class="string">'endow'</span>: <span class="string">'59'</span>,</span><br><span class="line"><span class="string">'gremlin'</span>: <span class="string">'6F'</span>,</span><br><span class="line"><span class="string">'indulge'</span>: <span class="string">'75'</span>,</span><br><span class="line"><span class="string">'bison'</span>:<span class="string">'20'</span>,</span><br><span class="line"><span class="string">'flatfoot'</span>:<span class="string">'63'</span>,</span><br><span class="line"><span class="string">'fallout'</span>:<span class="string">'61'</span>,</span><br><span class="line"><span class="string">'goldfish'</span>: <span class="string">'6E'</span>,</span><br><span class="line"><span class="string">'hockey'</span>: <span class="string">'73'</span>,</span><br><span class="line"><span class="string">'fracture'</span>: <span class="string">'65'</span>,</span><br><span class="line"><span class="string">'goggles'</span>:<span class="string">'6D'</span>,</span><br><span class="line"><span class="string">'jawbone'</span>: <span class="string">'79'</span>,</span><br><span class="line"><span class="string">'glucose'</span>: <span class="string">'6C'</span>,</span><br><span class="line"><span class="string">'indoors'</span>: <span class="string">'74'</span>,</span><br><span class="line"><span class="string">'gazelle'</span>: <span class="string">'69'</span>,</span><br><span class="line"><span class="string">'guidance'</span>: <span class="string">'70'</span>,</span><br><span class="line"><span class="string">'keyboard'</span>: <span class="string">'7A'</span>,</span><br><span class="line"><span class="string">'cement'</span>: <span class="string">'2F'</span>,</span><br><span class="line"><span class="string">'frighten'</span>: <span class="string">'68'</span>,</span><br><span class="line"><span class="string">'buzzard'</span>: <span class="string">'2E'</span>,</span><br><span class="line"><span class="string">'highchair'</span>: <span class="string">'72'</span>,</span><br><span class="line"><span class="string">'flytrap'</span>: <span class="string">'64'</span>,</span><br><span class="line"><span class="string">'freedom'</span>: <span class="string">'67'</span>,</span><br><span class="line"><span class="string">'allow'</span>: <span class="string">'0A'</span>,</span><br><span class="line"><span class="string">'crowfoot'</span>: <span class="string">'42'</span>,</span><br><span class="line"><span class="string">'involve'</span>: <span class="string">'77'</span>,</span><br><span class="line"><span class="string">'Burbank'</span>: <span class="string">'2C'</span>,</span><br><span class="line"><span class="string">'flagpole'</span>: <span class="string">'62'</span>,</span><br><span class="line"><span class="string">'blockade'</span>: <span class="string">'22'</span>,</span><br><span class="line"><span class="string">'inverse'</span>: <span class="string">'76'</span>,</span><br><span class="line"><span class="string">'blackjack'</span>: <span class="string">'21'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line"><span class="keyword">print</span> (dict[item],end=<span class="string">''</span>)</span><br><span class="line"><span class="number">596</span>F752063616E20736565206D7920636F6C6C656374696F6E2070757A7A6C657320696E202F68696E742E72617220616E6420616E6F74686572202F656E636F64652E706E672E0A427920746865207761792C74686520706963747572652073686F75642062652075736564200A225975736122206973207665727920696D706F7274616E7420696E2074686973206368616C6C656E67652121</span><br></pre></td></tr></table></figure></p>
<p>解hex<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You can see my collection puzzles in /hint.rar and another /encode.png.</span><br><span class="line">By the way,the picture shoud be used</span><br><span class="line">&quot;Yusa&quot; is very important in this challenge!!</span><br></pre></td></tr></table></figure></p>
<p>也可以在<a href="https://goto.pachanka.org/crypto/pgp-wordlist" target="_blank" rel="noopener">在线网站解密</a><br>同时发现页面的图片是.webp格式,存在webp隐写</p>
<p>stegpy工具安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install stegpy</span><br><span class="line">git clone https://github.com/dhsdshdhk/stegpy.git</span><br><span class="line">cd stegpy</span><br><span class="line">python3 setup.py install</span><br></pre></td></tr></table></figure>
<p>使用命令行解密<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stegpy encode.webp</span><br><span class="line">得到密码</span><br><span class="line">the_key_is:Yus@_yydsstegpy!!</span><br></pre></td></tr></table></figure></p>
<p>下载hint.rar后,注释里提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用一种较为古老和不常见的工具。USE your google and Baidu</span><br></pre></td></tr></table></figure></p>
<p>使用刚才用stegpy解出来的密码解压缩,得到一张图片<br><figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./4.jpg" title="图片" data-fancybox="images"><img src="./4.jpg" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<p>根据比赛放出的提示搜到 invisible Secrets 工具,我下的是pro 3.0 版本</p>
<p>使用工具解密文件,密码是Yusa,得到encode.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,random</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageDraw</span><br><span class="line">p=Image.open(<span class="string">'flag.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">flag = []</span><br><span class="line">a,b = p.size</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        <span class="keyword">if</span> p.getpixel((x,y)) == <span class="number">255</span>:</span><br><span class="line">            flag.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="number">1</span>)</span><br><span class="line">key1stream = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    key1stream.append(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">key2stream = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    key2stream.append(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    enc.append(flag[i]^key1stream[i]^key2stream[i])</span><br><span class="line">hide=Image.open(<span class="string">'source.png'</span>).convert(<span class="string">'RGB'</span>)</span><br><span class="line">R=[]</span><br><span class="line">G=[]</span><br><span class="line">B=[]</span><br><span class="line">a,b = hide.size</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        R.append(bin(hide.getpixel((x,y))[<span class="number">0</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        G.append(bin(hide.getpixel((x, y))[<span class="number">1</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        B.append(bin(hide.getpixel((x, y))[<span class="number">2</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">R1=[]</span><br><span class="line">G1=[]</span><br><span class="line">B1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key1stream)):</span><br><span class="line">    <span class="keyword">if</span> key1stream[i] == <span class="number">1</span>:</span><br><span class="line">        R1.append(R[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        R1.append(R[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key2stream)):</span><br><span class="line">    <span class="keyword">if</span> key2stream[i] == <span class="number">1</span>:</span><br><span class="line">        G1.append(G[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        G1.append(G[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">if</span> enc[i] == <span class="number">1</span>:</span><br><span class="line">        B1.append(B[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        B1.append(B[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> range(len(R)):</span><br><span class="line">    R[r] = int(R1[r],<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> g <span class="keyword">in</span> range(len(G)):</span><br><span class="line">    G[g] = int(G1[g],<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> range(len(B)):</span><br><span class="line">    B[b] = int(B1[b],<span class="number">2</span>)</span><br><span class="line">a,b = hide.size</span><br><span class="line">en_p = Image.new(<span class="string">'RGB'</span>,(a,b),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        en_p.putpixel((x,y),(R[y+x*b],G[y+x*b],B[y+x*b]))</span><br><span class="line">en_p.save(<span class="string">'encode.png'</span>)</span><br></pre></td></tr></table></figure>
<p>根据加密脚本写解密脚本,这里直接贴官方wp的<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageDraw</span><br><span class="line">p = Image.open(<span class="string">'encode.png'</span>).convert(<span class="string">'RGB'</span>)</span><br><span class="line">a,b = p.size</span><br><span class="line">R=[]</span><br><span class="line">G=[]</span><br><span class="line">B=[]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        R.append(bin(p.getpixel((x,y))[<span class="number">0</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        G.append(bin(p.getpixel((x, y))[<span class="number">1</span>]).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        B.append(bin(p.getpixel((x, y))[<span class="number">2</span>]).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">R1=[]</span><br><span class="line">G1=[]</span><br><span class="line">B1=[]</span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(R)):</span><br><span class="line">    R1.append(int(R[i][<span class="number">-1</span>:]))</span><br><span class="line">    G1.append(int(G[i][<span class="number">-1</span>:]))</span><br><span class="line">    B1.append(int(B[i][<span class="number">-1</span>:]))</span><br><span class="line">print(R1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">print(G1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">print(B1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(R1)):</span><br><span class="line">    flag.append(B1[i]^G1[i]^R1[i])</span><br><span class="line">print(flag[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">de_p = Image.new(<span class="string">'L'</span>,(a,b),<span class="number">255</span>)</span><br><span class="line">c=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        <span class="keyword">if</span> flag[c] == <span class="number">1</span>:</span><br><span class="line">            de_p.putpixel((x,y),<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            de_p.putpixel((x, y), <span class="number">255</span>)</span><br><span class="line">        c=c+<span class="number">1</span></span><br><span class="line">de_p.save(<span class="string">'out.png'</span>)</span><br></pre></td></tr></table></figure></p>
<p>好家伙,差点把我电脑跑死机<br><figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./5.png" title="图片" data-fancybox="images"><img src="./5.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<p>flag{fa0a8cb83f26dead82e1a45f8af2f44b}</p>
<h2 id="指鹿为马"><a href="#指鹿为马" class="headerlink" title="指鹿为马"></a>指鹿为马</h2><p>show source code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_horse</span><span class="params">()</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(<span class="string">'./horse.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">0</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_deer</span><span class="params">()</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(<span class="string">'./deer.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">1</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_test</span><span class="params">(pic)</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(pic).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">1</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">euclideanDistance</span><span class="params">(instance1, instance2, length)</span>:</span></span><br><span class="line">distance = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(length):</span><br><span class="line">distance += pow((instance1[x] - instance2[x]), <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> math.sqrt(distance)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNeighbors</span><span class="params">(trainingSet, testInstance, k)</span>:</span></span><br><span class="line">distances = []</span><br><span class="line">length = len(testInstance) - <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(trainingSet)):</span><br><span class="line">dist = euclideanDistance(testInstance, trainingSet[x], length)</span><br><span class="line">distances.append((trainingSet[x], dist))</span><br><span class="line">distances.sort(key=operator.itemgetter(<span class="number">1</span>))</span><br><span class="line">neighbors = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(k):</span><br><span class="line">neighbors.append(distances[x][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> neighbors</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getResponse</span><span class="params">(neighbors)</span>:</span></span><br><span class="line">classVotes = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(neighbors)):</span><br><span class="line">response = neighbors[x][<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">if</span> response <span class="keyword">in</span> classVotes:</span><br><span class="line">classVotes[response] += <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">classVotes[response] = <span class="number">1</span></span><br><span class="line">sortedVotes = sorted(classVotes.items(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">return</span> sortedVotes[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAccuracy</span><span class="params">(testSet, predictions)</span>:</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(testSet)):</span><br><span class="line"><span class="keyword">if</span> testSet[x][<span class="number">-1</span>] == predictions[x]:</span><br><span class="line">correct += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> (correct / float(len(testSet))) * <span class="number">100.0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(pic)</span>:</span></span><br><span class="line">source_p = Image.open(<span class="string">'deer.png'</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">c_p = Image.open(pic)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">print(<span class="string">"Please upload right picture."</span>)</span><br><span class="line">exit()</span><br><span class="line">diff_pixel = <span class="number">0</span></span><br><span class="line">a, b = source_p.size</span><br><span class="line"><span class="keyword">if</span> c_p.size[<span class="number">0</span>] != a <span class="keyword">and</span> c_p.size[<span class="number">1</span>] != b:</span><br><span class="line">print(<span class="string">"Please upload right picture size("</span>+str(a)+<span class="string">','</span>+str(b)+<span class="string">')'</span>)</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">diff_pixel += abs(source_p.getpixel((x, y)) - c_p.getpixel((x, y)))</span><br><span class="line"><span class="keyword">return</span> diff_pixel</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">print(<span class="string">'-'</span> * <span class="number">134</span>)</span><br><span class="line">print(<span class="string">'''      ____       __            _          _   _                _                              _   _            _</span></span><br><span class="line"><span class="string">|  __ \     / _|          | |        | | | |              | |                            | | | |          | |</span></span><br><span class="line"><span class="string">| |__) |___| |_ ___ _ __  | |_ ___   | |_| |__   ___    __| | ___  ___ _ __    __ _ ___  | |_| |__   ___  | |__   ___  _ __ ___  ___</span></span><br><span class="line"><span class="string">|  _  // _ \  _/ _ \ '__| | __/ _ \  | __| '_ \ / _ \  / _` |/ _ \/ _ \ '__|  / _` / __| | __| '_ \ / _ \ | '_ \ / _ \| '__/ __|/ _ \\</span></span><br><span class="line"><span class="string">| | \ \  __/ ||  __/ |    | || (_) | | |_| | | |  __/ | (_| |  __/  __/ |    | (_| \__ \ | |_| | | |  __/ | | | | (_) | |  \__ \  __/</span></span><br><span class="line"><span class="string">|_|  \_\___|_| \___|_|     \__\___/   \__|_| |_|\___|  \__,_|\___|\___|_|     \__,_|___/  \__|_| |_|\___| |_| |_|\___/|_|  |___/\___|</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">134</span>)</span><br><span class="line">print(<span class="string">'\t1.show source code'</span>)</span><br><span class="line">print(<span class="string">'\t2.give me the source pictures'</span>)</span><br><span class="line">print(<span class="string">'\t3.upload picture'</span>)</span><br><span class="line">print(<span class="string">'\t4.exit'</span>)</span><br><span class="line">choose = input(<span class="string">'&gt;'</span>)</span><br><span class="line"><span class="keyword">if</span> choose == <span class="string">'1'</span>:</span><br><span class="line">w = open(<span class="string">'run.py'</span>,<span class="string">'r'</span>)</span><br><span class="line">print(w.read())</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'2'</span>:</span><br><span class="line">print(<span class="string">'this is horse`s picture:'</span>)</span><br><span class="line">h = base64.b64encode(open(<span class="string">'horse.png'</span>,<span class="string">'rb'</span>).read())</span><br><span class="line">print(h.decode())</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">134</span>)</span><br><span class="line">print(<span class="string">'this is deer`s picture:'</span>)</span><br><span class="line">d = base64.b64encode(open(<span class="string">'deer.png'</span>, <span class="string">'rb'</span>).read())</span><br><span class="line">print(d.decode())</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'4'</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'3'</span>:</span><br><span class="line">print(<span class="string">'Please input your deer picture`s base64(Preferably in png format)'</span>)</span><br><span class="line">pic = input(<span class="string">'&gt;'</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">pic = base64.b64decode(pic)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">if</span> <span class="string">b"&lt;?php"</span> <span class="keyword">in</span> pic <span class="keyword">or</span> <span class="string">b'eval'</span> <span class="keyword">in</span> pic:</span><br><span class="line">print(<span class="string">"Hacker!!This is not WEB,It`s Just a misc!!!"</span>)</span><br><span class="line">exit()</span><br><span class="line">salt = str(random.getrandbits(<span class="number">15</span>))</span><br><span class="line">pic_name = <span class="string">'tmp_'</span>+salt+<span class="string">'.png'</span></span><br><span class="line">tmp_pic = open(pic_name,<span class="string">'wb'</span>)</span><br><span class="line">tmp_pic.write(pic)</span><br><span class="line">tmp_pic.close()</span><br><span class="line"><span class="keyword">if</span> check(pic_name)&gt;=<span class="number">100000</span>:</span><br><span class="line">print(<span class="string">'Don`t give me the horse source picture!!!'</span>)</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">ma = load_horse()</span><br><span class="line">lu = load_deer()</span><br><span class="line">k = <span class="number">1</span></span><br><span class="line">trainingSet = np.append(ma, lu).reshape(<span class="number">2</span>, <span class="number">5185</span>)</span><br><span class="line">testSet = load_test(pic_name)</span><br><span class="line">neighbors = getNeighbors(trainingSet, testSet[<span class="number">0</span>], k)</span><br><span class="line">result = getResponse(neighbors)</span><br><span class="line"><span class="keyword">if</span> repr(result) == <span class="string">'0'</span>:</span><br><span class="line">os.system(<span class="string">'clear'</span>)</span><br><span class="line">print(<span class="string">'Yes,I want this horse like deer,here is your flag encoded by base64'</span>)</span><br><span class="line">flag = base64.b64encode(open(<span class="string">'flag'</span>,<span class="string">'rb'</span>).read())</span><br><span class="line">print(flag.decode())</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'I want horse but not deer!!!'</span>)</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'wrong choose!!!'</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>give me the source pictures<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">this is horse`s picture:</span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAAAAABwhuybAAAFeElEQVR4nO2Xy28TVxTGvzN2ZpLYIY5dkgImIU4I2DFqQqiaqGpL2gXqv8AC2lUX/BFl032lSpWqblqpGyQ2LQhERQhUDSqk4ZnEtHnxCATn4TjP8fOeLmZszzPEUpeclefeM7/z3e/OfRh4G/9n+Dtk907v7jnKh42vc6690u5BTe/u1FsFyEPVgGoaqkAbw+pR5+m5689dq+5QxApSWjuO/DhbGoRgU6dcv7E7UH1472EUw2fuFDVS8e+UKblmX3JXoHBfiEKAOJjSClPOOpTOp2k3kCG19aN3IADA08habGyZk7nxRN2bFTWc8AuEWiWADtG8AIAF1ZLNrZ77SwynqIAa19cpHpMZgLddmcsTCpmwBACFZLGcFQ69TKoaivPragVKxl/9Z/YI/WlxRiVtoKC1qyoAtJzyAgAx66+LrWdPNu2KGL2n/el6vaFZntogzUBS8wCALXUPA2CQXl0KBPbdXtFfN5gdPxt68M210lNTNFj6mSxooJdWX5ibB3w20JEv9vLMqyeFUlJDtEX7pb4kSZIInFi3rTZuOWIdWuTLfUJiVNxjpUuZFwA8xwVAUzNYvTvgs03ZoYRqAsW+CgnAh3rDWL3t8tMCULMfAD0H8CxzbH+NQQ4A9jeYQF3fHR1LE/fXdHkMNaWD8kyGwAAKaQBIpkJBWRsf1YeCEgOSvmtqrW3fnxTp+2kiYov21alNAkDL1zLWQdW2xQMMcX1eKwoA9edPFjnQG2AWVg+CsSAA8LSNg8w/N1cq7ksA8P7nAuBAT4CJyDwz3HC0BcCLaRsHwModtZztBYC4XwDgpt6RJY/gBo+JVNslL6/N+f12Tl59PRczgXQsN937SRY43StM+d5ION9nx5DILSeWyqvQCwDjmz4GQBt/LQIYOqqYX5FqXTaPgz3p5flSEgDcveohgDyXRwFgctK2NbNzCA50HJYNoO2vL2xJ0uYv51UAyA5btyH3YBz4WPtEdXt8J7p5fGxbe1DO9QmXFx0i98NdA8gcvecUp2bnkB59m4XLSTsxUcUpye0H4AbKVeES2Bd2BWGyGklSozuoKknat+hSuSpJtAMod8NdkvPtxq1w4pFbD684XtuMZ78n3Fx+u7hWdKxMuZnNQFuNvcMI6vqk8h1yIzuBqHB58XgKDiTDAChSKyrheMJT4cpvOULqWX4nRZKX4Walzslf/bVAABw0WW9sBX222OFKTdlLV3Sj7SQLSEoOaQtfdMet0yalLo6UzmE7yaZoQ99BVItJxE8uJgCQv0ySjSm7u/kTide3bq0DQEenftmZHTvVZCC5ghjQ55S5sD1//552UwsNKAwAtPBHMnk2UCG5gho8QPbWGoGLanpxKau1Kv26iumRNYzCQLKCvB5NudzvFdL4BctqoN4IA6Dio9EMYCJZpka0HNNaYt0C6rB1VUXeAwBSR25rJ/joz6ul784AKqYBeD/o8QCQB+sgjScsnOCAAkBKDz0snYujQ6U+o6KHrwio6WsuCbppEaQMBBmgV9dmy84o7WScFz3SQwuE4sMlQD5ZB2li0syhnggDmP7d8D8i1i2gzllBSA0tiNGxAhCNOzjU3gOQeHBjzaBxsA7SZAKwzlrqRsu/RUAerBM2QcEBhUkdfVw0tEVjAupw1g7CygrgLEjpDzHSf84Zl4U8WCekSa2g0wfpKKgzwsgMvzC1RbvLghz3bEeH/B5QbtVaECVBTiD507KDO0c0LpC5mXUFxQyCDWG7XmqCJvQnu0dGBw2RXWPaNO1R0bhAplzQDup2FpSYZYhtW8GSIDtIcRaErBUdMwmyexSLOQqyhdkhh//9n/kEOQiyRfwYpKyhoA00PgU8frMg5C8JWp94c97bqMR/qKdMxhtIpukAAAAASUVORK5CYII=</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">this is deer`s picture:</span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAAAAABwhuybAAAEXUlEQVR4nO2XS2xbRRSG/5l7b/xSb2wnDqbBSdU0FcQUmsRZVCAkorZJumkrFWEkWLJgyZINC5bsQQKEVAkhNRKJRKWqjUiFEAgUkYRQtYQ+ZCc4jzbk4dgkaWzfOSwSP+7D9r3Jtmc198ycz/+ZmTMzBp6Zc2N959wAXGdjDEDTxY6DggJfXT8FoOv7L/wArox/xG2FmUcpHsUNwKO4FYB3QNABQaCKyGi39pc9kKzT8p/Yb3pdfkhNSvTtpvu/2eLoQBfPfjkNAGh7+bTqlYIfs8aGha9XHYOkUyd7pgFAes/L8iIHldIzo4/scSpB2mPRpWYAwLtwK1EAINZW8jY5utQmzr8Uv5YB+MKnf9uNtwTdGbt8uWtW8tG4c44OVPiWBqJRiELSOUcHQvbqw4FjDR4qHBbU/mane0MJy+e2Z7VDgFj3W01ZhZFGL4bGx2wvVzG63IzF/TMjZwYYh0Dh1k2HpHKtxeIqJZcfaqRpRPLgkGI3cM9KqcXiKjHCfoWSPIiamviQd3KuspyL4FhcJcALLyuRampiJ4Y+OFMxL0VFvXGVAOpTTkg2NQktcGm5YsNxAGCxd/wAQIH+SElu3XkSgV6jotbXsptySNKfafXnCWGpvN1kANB+JzraLxnH1SVJFZMkA0BWcvlebTAfqSQPSjef1tJkAG0pA17F6mgm+XxoLCUseqxB9AveCO5lxhViABVjifd13vlzYctUepVZASiVCGsMKQAg2j8JCrDtmaelgYzl0umcEcQiR4jf/ax8TuzvI0qn9xrJxCsaoC3Pl9MjOdRiToUI5A8vlL6NJbP73bYQgrfplpCE2Qig1vejVUH46Z4EUIvfzrVIR989WRW0el0AcEdscADRfEmtBsKNJQ6g1WvrphYdxTIxgx7c5gCpYVuSwHtc1UDaaIYBUti4UayNwoFqIExMcQCyTZBbrQrKjhYA8cRWYQCSUhWEHxKySM7ZU1SqDdmiK/XNlfUnebsgVAfRyPNHWJljyJFZ/4IVCKnp/nK0K6iP3NmwDxK3OyNFkgi+rp/H3amUVYz123dlZL3UwbjevLE2+yDcu5ood+lTI48lyTI1ALPLvd3HJQBM7EqGsuOntUVTQI1FDn8YIIAt/2xYNmrpyUvB4pf2+d2aigAUCADY6o/GA7vVxRtEs8Fp74+G3hjn+X/WioDQwUEAWG5+bW9W+IXYYUBguflFAgBqjEftgaosB9u6NskAgPzHgZqTvR9Q5VnKVh4tsT4C9t9m9RSxjV+tSSKhZYcny3LrKGLp4T+sO9YXgcwwSk+kOorYxJTZ6eMAJXcAbN7IFDXVS23H7JLaGNjW3p2+W8r7AMvf/BwBqU2D9wCgdheQSxrvT+cgXwRgj1eMbuegVpUgEqY94RgkHeNg60smv2NQcwuB5syL6RjU7gLbmjP7nYJ8EQCpjLmjVokwTtxY+y80guUTpBtTD7Q95iF23+icBnb+1Y95UEPMM6uw/wEb7IPCRqC/gwAAAABJRU5ErkJggg==</span><br></pre></td></tr></table></figure></p>
<p>horse<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./7.jpg" title="图片](./6.jpg)deer![图片" data-fancybox="images"><img src="./7.jpg" alt="图片](./6.jpg)deer![图片" title class></a>
                <p>图片](./6.jpg)deer![图片</p>
            </figure></p>
<p>根据官方说的知识点  KNN图像识别漏洞 单文件网页文件格式识别</p>
<p>审计代码得知需要进行图像操作使上传一个不能是马的图，但是需要识别成马，所以我们使用脚本对其进行修改，对鹿图进行弱化处理，再附加上马图，但是两图的距离（详情请看knn的图像识别原理）马图需要比鹿图增加得慢，这样才可以识别成鹿图。</p>
<p><a href="https://blog.csdn.net/chaipp0607/article/details/77915298" target="_blank" rel="noopener">knn原理</a><a href="https://blog.csdn.net/qq_35206320/article/details/81946246" target="_blank" rel="noopener">带例子分析</a>反正我是没看懂</p>
<p>大概就是要传一个72*72的图，欧氏距离和horse更近一点</p>
<p>解密exp如下,源自官方</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">h = Image.open(<span class="string">'horse.png'</span>)</span><br><span class="line">d = Image.open(<span class="string">'deer.png'</span>)</span><br><span class="line">a,b = h.size</span><br><span class="line">h_pixels = []</span><br><span class="line">d_pixels = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        h_pixels.append(h.getpixel((x,y))//<span class="number">50</span>)</span><br><span class="line">        d_pixels.append(d.getpixel((x,y)))  </span><br><span class="line">plt.imshow(np.array(h_pixels).reshape(<span class="number">72</span>,<span class="number">72</span>))</span><br><span class="line">plt.show()</span><br><span class="line">plt.imshow(np.array(d_pixels).reshape(<span class="number">72</span>,<span class="number">72</span>))</span><br><span class="line">plt.show()</span><br><span class="line">res1_png = Image.new(<span class="string">'L'</span>,(a,b))</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        <span class="keyword">if</span> d_pixels[x+a*y] != <span class="number">0</span>:</span><br><span class="line">            res1_png.putpixel((x,y),d_pixels[x+a*y]<span class="number">-100</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res1_png.putpixel((x,y),<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        res1_png.putpixel((x,y),res1_png.getpixel((x,y))+h_pixels[x+a*y]*<span class="number">33</span>)</span><br><span class="line">res1_png.save(<span class="string">'deer1.png'</span>)</span><br><span class="line">plt.imshow(res1_png)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>从deer开始随手改了几个像素点为horse同位置的数值，然后保存为deer1.png,base64提交一下<br><figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./8.png" title="图片" data-fancybox="images"><img src="./8.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<p>收到一大串base64，扔进<a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener">cyberchef</a>解一下里面又有个base64，转图片得到flag。</p>
<h2 id="Barbar"><a href="#Barbar" class="headerlink" title="Barbar"></a>Barbar</h2><p>首先发现电脑端CQR和手机端扫描结果不一样,怀疑有隐藏信息</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./9.png" title="图片" data-fancybox="images"><img src="./9.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>foremost分离文件</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./10.png" title="图片" data-fancybox="images"><img src="./10.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p><a href="https://yuanfux.github.io/zero-width-web/" target="_blank" rel="noopener">在线网站</a>零宽字节隐写,扫描出隐藏密码</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./11.png" title="图片" data-fancybox="images"><img src="./11.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>用该密码YcfVgMBUraXftwO6Cp92YBGAbyRyWNOO解压缩包得到</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./12.png" title="图片" data-fancybox="images"><img src="./12.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>docx里暂无别的信息,选择先修二维码</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./13.png" title="图片" data-fancybox="images"><img src="./13.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>队友修完后扫描结果为</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./14.png" title="图片" data-fancybox="images"><img src="./14.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>修了个寂寞,于是倒回去继续看docx解码,在document.xml里发现base64图片</p>
<figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./15.png" title="图片" data-fancybox="images"><img src="./15.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>是个Aztec code,中国编码app扫出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">di`f&#123;e1c64e14db14c6bb8faabab5bd7be1dc&#125;</span><br></pre></td></tr></table></figure></p>
<p>再进行npiet解密<br><a href="http://www.bertnase.de/npiet/npiet-execute.php" target="_blank" rel="noopener">在线网站</a><br><figure class="image-box">
                <a rel=2020西湖论剑misc复现 href="./16.png" title="图片" data-fancybox="images"><img src="./16.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<p>flag{f2d76g36fd16cbb6abaaf8db57cbd1ed}</p>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-10-12T13:47:18.836Z" itemprop="dateUpdated">2020-10-12 21:47:18</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/" target="_blank" rel="external">https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/</a>
        
    </div>
    <footer>
        <a href="https://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/个人ctf竞赛/">个人ctf竞赛</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/&title=《2020西湖论剑misc复现》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/&title=《2020西湖论剑misc复现》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/工具/ckwd913e9005lpwucl9e5worh/一些我常用的在线网站-持续更新/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">一些我常用的在线网站(持续更新)</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/AWD/ckwd9139k0000pwucjz8d1gos/10-8-队内AWD小结/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">10.8 队内AWD小结</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#yusa-yyds"><span class="post-toc-number">2.</span> <span class="post-toc-text">yusa_yyds</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#yusapapa"><span class="post-toc-number">3.</span> <span class="post-toc-text">yusapapa</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#指鹿为马"><span class="post-toc-number">4.</span> <span class="post-toc-text">指鹿为马</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Barbar"><span class="post-toc-number">5.</span> <span class="post-toc-text">Barbar</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        让这个世界的bug有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://phoebe233.cn/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://39.97.247.119/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ysllz.com/" target="_blank">ysllz</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2018 - 2021
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/&title=《2020西湖论剑misc复现》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020西湖论剑misc复现/&title=《2020西湖论剑misc复现》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADMUlEQVR42u3a0U7rQAwE0P7/T3NfkW5bZrxBaszJE4KwyVkkXI/38Yivr2/X9+/8//X/9+e/m9z56lmP37iwsbGxb8L+enu9uid/ZL5OAp7d+eQ9sbGxsdexk9fNSbNtzUta+2fAxsbGxs4LVf7S7zcrXxkbGxsbe8aOPu6/fcp5ccLGxsbGnrUKbaPSthznAdPFWRo2Njb2x7Pzqejnf/0r821sbGzsD2Z/lVc+EmgbhqTYzMYPT1bGxsbGXsSeRf+/0ULMDv2cjC6wsbGx97HzolIUiUvHA2289cPWYGNjYy9l5y3H7GGzYW0+EsgbG2xsbOwd7KRUtOUkD4POx8ZtmXyZpWFjY2OvYycPnh3rOT9Gk5eul1uGjY2NvYjdNiR1qShXvmqofHEfho2Njf3B7FlMcxTKHzQb7WDg5f3Y2NjYi9jtcu3H/bzlyOOt2Yg6OqmEjY2NfVt2S50Vs5O4vy2KRWiFjY2NvYg9O0BzbTx0MnKYbSs2Njb23dntP/rZSCAvgS14VnqxsbGx97FnAU3+yDZCyoOqvExiY2Nj/zV2W04SWHK1sddw+7CxsbGXsk9GBbNBbxsYzQpe1FFhY2Nj35adNwYt4GT92Wr1dmBjY2OvYL8PkpKmoi2Hs63Jn17UbWxsbOyl7Hzp9hhN21S0b1i0MdjY2NiL2LOhbF5g8tYiObhzEjMNczVsbGzsW7HbyGbWkMyGvlcVP2xsbOx97Pwxj/jKNyh5Yjs2jizY2NjYi9izYGh2WCf/aRIqXVCrsbGxsdexz4ObWSORbNBsC+pEDRsbG/u27HZ0modNbRnLS1R755PvYGNjY69jJ9R26Nt2AbPYKG9dsLGxsXezk8Izw5yUuqvajyfvj42Njb2CPTtG025QPnw9aV3yjcPGxsbexJ5NQttjMXkZS4a+s5jpggEwNjY29gez86KVDGvz+Kn9O8wK1QWhEjY2NvZN2Ocj1Xxwm48Z8oZkeDoJGxsb+0+y2+g/WW02sj1ZHxsbGxv7PPrPZ9Gz0D+ab2NjY2MvYp+Pb5PI6WSz2nDqh6YIGxsbexE7H/Tmn+TzIKktReejBWxsbOxF7H9nnJHNsK+IhQAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '等你回来呀~';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)欢迎回来!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
